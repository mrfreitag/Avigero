<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.mozilla.org/bugzilla.dtd">

<bugzilla version="3.6.4+"
          urlbase="https://bugzilla.mozilla.org/"
          
          maintainer="bugzilla-admin@mozilla.org"
>

    <bug>
          <bug_id>648156</bug_id>
          
          <creation_ts>2011-04-06 16:12:00 -0700</creation_ts>
          <short_desc>Remove gtkmozembed</short_desc>
          <delta_ts>2011-04-09 13:02:37 -0700</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>3</classification_id>
          <classification>Components</classification>
          <product>Core</product>
          <component>Embedding: GTK Widget</component>
          <version>unspecified</version>
          <rep_platform>x86</rep_platform>
          <op_sys>Mac OS X</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          
          <priority>--</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>mozilla2.2</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Benjamin Smedberg  [:bsmedberg]">benjamin</reporter>
          <assigned_to name="Benjamin Smedberg  [:bsmedberg]">benjamin</assigned_to>
          <cc>bmo</cc>
    
    <cc>djcater+bugzilla</cc>
    
    <cc>matjk7</cc>
          <qa_contact>gtk-widget</qa_contact>
          <cf_blocking_fennec>---</cf_blocking_fennec>
          <cf_blocking_fx>---</cf_blocking_fx>
          <cf_blocking_20>---</cf_blocking_20>
          <cf_status_20>---</cf_status_20>
          <cf_blocking_192>---</cf_blocking_192>
          <cf_status_192>---</cf_status_192>
          <cf_blocking_191>---</cf_blocking_191>
          <cf_status_191>---</cf_status_191>
          
          
          
          
          
          
          
          
          
          

      

      

      

          <long_desc isprivate="0">
            <commentid>5393495</commentid>
            <who name="Benjamin Smedberg  [:bsmedberg]">benjamin</who>
            <bug_when>2011-04-06 16:12:26 -0700</bug_when>
            <thetext>Per the recent decision and thread on dev.embedding, we are removing gtkmozembed.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>5393496</commentid>
              <attachid>524300</attachid>
            <who name="Benjamin Smedberg  [:bsmedberg]">benjamin</who>
            <bug_when>2011-04-06 16:13:24 -0700</bug_when>
            <thetext>Created attachment 524300
Remove gtkmozembed, rev. 1</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>5394027</commentid>
              <attachid>524300</attachid>
            <who name="Boris Zbarsky (:bz)">bzbarsky</who>
            <bug_when>2011-04-06 23:42:51 -0700</bug_when>
            <thetext>Comment on attachment 524300
Remove gtkmozembed, rev. 1

r=me</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>5398332</commentid>
            <who name="Daniel Cater">djcater+bugzilla</who>
            <bug_when>2011-04-09 07:29:14 -0700</bug_when>
            <thetext>This landed as http://hg.mozilla.org/mozilla-central/rev/2038ba37a2e8</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
              isurl="0"
          >
            <attachid>524300</attachid>
            <date>2011-04-06 16:13:00 -0700</date>
            <delta_ts>2011-04-06 23:42:51 -0700</delta_ts>
            <desc>Remove gtkmozembed, rev. 1</desc>
            <filename>remove-gtkmozembed</filename>
            <type>text/plain</type>
            <size>289252</size>
            <attacher>benjamin</attacher>
            
              <data encoding="base64">IyBIRyBjaGFuZ2VzZXQgcGF0Y2gKIyBQYXJlbnQgZGE5ZGRjNzY0Zjg0ODA0OGI0NThmOTQ3MGMx
ZDRjOTYwMzc3ODBmMwpSZW1vdmUgZ3RrbW96ZW1iZWQsIHI/dGVkIHNyP2J6CgpkaWZmIC0tZ2l0
IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL01ha2VmaWxlLmluIGIvZW1iZWRkaW5nL2Jyb3dzZXIv
Z3RrL01ha2VmaWxlLmluCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcv
YnJvd3Nlci9ndGsvTWFrZWZpbGUuaW4KKysrIC9kZXYvbnVsbApAQCAtMSw1NCArMCwwIEBACi0j
IAotIyAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0jIFZlcnNpb246IE1QTCAxLjEv
R1BMIDIuMC9MR1BMIDIuMQotIwotIyBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJq
ZWN0IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KLSMgMS4xICh0aGUgIkxp
Y2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3
aXRoCi0jIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2Ug
YXQKLSMgaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCi0jCi0jIFNvZnR3YXJlIGRpc3RyaWJ1
dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMs
Ci0jIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxp
ZWQuIFNlZSB0aGUgTGljZW5zZQotIyBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu
ZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQotIyBMaWNlbnNlLgotIwotIyBUaGUg
T3JpZ2luYWwgQ29kZSBpcyB0aGUgTW96aWxsYSBicm93c2VyLgotIwotIyBUaGUgSW5pdGlhbCBE
ZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMKLSMgQ2hyaXN0b3BoZXIgQmxpenphcmQu
Ci0jIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmln
aHQgKEMpIDE5OTkKLSMgdGhlIEluaXRpYWwgRGV2ZWxvcGVyLiBBbGwgUmlnaHRzIFJlc2VydmVk
LgotIwotIyBDb250cmlidXRvcihzKToKLSMgICBDaHJpc3RvcGhlciBCbGl6emFyZCA8Ymxpenph
cmRAbW96aWxsYS5vcmc+Ci0jCi0jIEFsdGVybmF0aXZlbHksIHRoZSBjb250ZW50cyBvZiB0aGlz
IGZpbGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0jIGVpdGhlciB0aGUgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyIG9yIGxhdGVyICh0aGUgIkdQTCIpLCBvcgot
IyB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxh
dGVyICh0aGUgIkxHUEwiKSwKLSMgaW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlzaW9ucyBvZiB0aGUg
R1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQKLSMgb2YgdGhvc2UgYWJvdmUu
IElmIHlvdSB3aXNoIHRvIGFsbG93IHVzZSBvZiB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIG9u
bHkKLSMgdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQg
bm90IHRvIGFsbG93IG90aGVycyB0bwotIyB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUgeW91cgotIyBkZWNpc2lvbiBieSBk
ZWxldGluZyB0aGUgcHJvdmlzaW9ucyBhYm92ZSBhbmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIG5v
dGljZQotIyBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBM
R1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotIyB0aGUgcHJvdmlzaW9ucyBhYm92ZSwgYSByZWNp
cGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyCi0jIHRoZSB0ZXJt
cyBvZiBhbnkgb25lIG9mIHRoZSBNUEwsIHRoZSBHUEwgb3IgdGhlIExHUEwuCi0jCi0jICoqKioq
IEVORCBMSUNFTlNFIEJMT0NLICoqKioqCi0KLURFUFRICQk9IC4uLy4uLy4uCi10b3BzcmNkaXIJ
PSBAdG9wX3NyY2RpckAKLXNyY2RpcgkJPSBAc3JjZGlyQAotVlBBVEgJCT0gQHNyY2RpckAKLQot
aW5jbHVkZSAkKERFUFRIKS9jb25maWcvYXV0b2NvbmYubWsKLQotTU9EVUxFCQk9IGd0a2VtYmVk
bW96Ci0KLURJUlM9c3JjCi0KLWlmZGVmIEVOQUJMRV9URVNUUwotVE9PTF9ESVJTICArPSB0ZXN0
cwotZW5kaWYKLQotaW5jbHVkZSAkKHRvcHNyY2RpcikvY29uZmlnL3J1bGVzLm1rCmRpZmYgLS1n
aXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkQ2VydGlmaWNhdGVzLmNwcCBiL2Vt
YmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRDZXJ0aWZpY2F0ZXMuY3BwCmRlbGV0ZWQgZmls
ZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkQ2VydGlm
aWNhdGVzLmNwcAorKysgL2Rldi9udWxsCkBAIC0xLDI1MyArMCwwIEBACi0vKiAtKi0gTW9kZTog
QysrOyB0YWItd2lkdGg6IDI7IGluZGVudC10YWJzLW1vZGU6IG5pbDsgYy1iYXNpYy1vZmZzZXQ6
IDIgLSotICovCi0vKiB2aW06c2V0IHRzPTIgc3c9MiBzdHM9MiB0dz04MCBldCBjaW5kZW50OiAq
LwotLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEu
MS9HUEwgMi4wL0xHUEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUg
c3ViamVjdCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRo
ZSAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh
bmNlIHdpdGgKLSAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp
Y2Vuc2UgYXQKLSAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJl
IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJ
UyIgYmFzaXMsCi0gKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVz
cyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3Vh
Z2UgZ292ZXJuaW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNl
LgotICoKLSAqIFRoZSBPcmlnaW5hbCBDb2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICog
VGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBOZXRzY2Fw
ZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhl
IEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIwMDEKLSAqIHRoZSBJbml0aWFs
IERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToK
LSAqICAgVGVycnkgSGF5ZXMgPHRoYXllc0BuZXRzY2FwZS5jb20+Ci0gKiAgIEphdmllciBEZWxn
YWRpbGxvIDxqYXZpQG5ldHNjYXBlLmNvbT4KLSAqICAgT2xlZyBSb21hc2hpbiA8cm9tYXhhQGdt
YWlsLmNvbT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxl
IG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0
aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVy
ICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQ
TCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4g
SWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25s
eQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQg
bm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5
IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUg
bm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRo
ZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEg
cmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhl
IHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0g
KiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotLyoqCi0gKiBEZXJpdmVkIGZyb20g
bnNOU1NEaWFsb2dzIGh0dHA6Ly9sYW5kZmlsbC5tb3ppbGxhLm9yZy9teHItdGVzdC9zZWFtb25r
ZXkvc291cmNlL3NlY3VyaXR5L21hbmFnZXIvcGtpL3NyYy9uc05TU0RpYWxvZ3MuY3BwCi0gKi8K
LSNpbmNsdWRlIDxzdHJpbmdzLmg+Ci0jaW5jbHVkZSAibnNJVVJJLmgiCi0jaW5jbHVkZSAiRW1i
ZWRQcml2YXRlLmgiCi0jaW5jbHVkZSAibnNTZXJ2aWNlTWFuYWdlclV0aWxzLmgiCi0jaW5jbHVk
ZSAibnNJV2ViTmF2aWdhdGlvbkluZm8uaCIKLSNpbmNsdWRlICJuc0RvY1NoZWxsQ0lELmgiCi0j
aW5jbHVkZSAibnNDT01QdHIuaCIKLSNpZmRlZiBNT1pJTExBX0lOVEVSTkFMX0FQSQotI2luY2x1
ZGUgIm5zU3RyaW5nLmgiCi0jaW5jbHVkZSAibnNYUElETFN0cmluZy5oIgotI2luY2x1ZGUgIm5z
UmVhZGFibGVVdGlscy5oIgotI2Vsc2UKLSNpbmNsdWRlICJuc1N0cmluZ0FQSS5oIgotI2VuZGlm
Ci0jaW5jbHVkZSAibnNJUHJvbXB0LmgiCi0jaW5jbHVkZSAibnNJRE9NV2luZG93SW50ZXJuYWwu
aCIKLSNpbmNsdWRlICJuc0lDb21wb25lbnRNYW5hZ2VyLmgiCi0jaW5jbHVkZSAibnNJU2Vydmlj
ZU1hbmFnZXIuaCIKLSNpbmNsdWRlICJuc0lTdHJpbmdCdW5kbGUuaCIKLSNpbmNsdWRlICJuc0lJ
bnRlcmZhY2VSZXF1ZXN0b3IuaCIKLSNpbmNsdWRlICJuc0lJbnRlcmZhY2VSZXF1ZXN0b3JVdGls
cy5oIgotI2luY2x1ZGUgIm5zSVg1MDlDZXJ0LmgiCi0jaW5jbHVkZSAibnNJWDUwOUNlcnREQi5o
IgotI2luY2x1ZGUgIm5zSURhdGVUaW1lRm9ybWF0LmgiCi0jaW5jbHVkZSAibnNEYXRlVGltZUZv
cm1hdENJRC5oIgotI2luY2x1ZGUgIkVtYmVkQ2VydGlmaWNhdGVzLmgiCi0jaW5jbHVkZSAibnNJ
S2V5Z2VuVGhyZWFkLmgiCi0jaW5jbHVkZSAibnNJWDUwOUNlcnRWYWxpZGl0eS5oIgotI2luY2x1
ZGUgIm5zSUNSTEluZm8uaCIKLSNpbmNsdWRlICJndGttb3plbWJlZC5oIgotCi0jZGVmaW5lIFBJ
UFNUUklOR19CVU5ETEVfVVJMICJjaHJvbWU6Ly9waXBwa2kvbG9jYWxlL3BpcHBraS5wcm9wZXJ0
aWVzIgotCi1FbWJlZENlcnRpZmljYXRlczo6RW1iZWRDZXJ0aWZpY2F0ZXModm9pZCkKLXsKLX0K
LQotRW1iZWRDZXJ0aWZpY2F0ZXM6On5FbWJlZENlcnRpZmljYXRlcygpCi17Ci19Ci0KLU5TX0lN
UExfVEhSRUFEU0FGRV9BRERSRUYoRW1iZWRDZXJ0aWZpY2F0ZXMpCi1OU19JTVBMX1RIUkVBRFNB
RkVfUkVMRUFTRShFbWJlZENlcnRpZmljYXRlcykKLU5TX0lOVEVSRkFDRV9NQVBfQkVHSU4oRW1i
ZWRDZXJ0aWZpY2F0ZXMpCi1OU19JTlRFUkZBQ0VfTUFQX0VOVFJZKG5zSVRva2VuUGFzc3dvcmRE
aWFsb2dzKQotTlNfSU5URVJGQUNFX01BUF9FTlRSWShuc0lDZXJ0aWZpY2F0ZURpYWxvZ3MpCi1O
U19JTlRFUkZBQ0VfTUFQX0VOVFJZKG5zSUNsaWVudEF1dGhEaWFsb2dzKQotTlNfSU5URVJGQUNF
X01BUF9FTlRSWShuc0lDZXJ0UGlja0RpYWxvZ3MpCi1OU19JTlRFUkZBQ0VfTUFQX0VOVFJZKG5z
SVRva2VuRGlhbG9ncykKLU5TX0lOVEVSRkFDRV9NQVBfRU5UUlkobnNJR2VuZXJhdGluZ0tleXBh
aXJJbmZvRGlhbG9ncykKLU5TX0lOVEVSRkFDRV9NQVBfRU5UUllfQU1CSUdVT1VTKG5zSVN1cHBv
cnRzLCBuc0lET01DcnlwdG9EaWFsb2dzKQotTlNfSU5URVJGQUNFX01BUF9FTkQKLQotbnNyZXN1
bHQKLUVtYmVkQ2VydGlmaWNhdGVzOjpJbml0KHZvaWQpCi17Ci0gIG5zcmVzdWx0IHJ2OwotICBu
c0NPTVB0cjxuc0lTdHJpbmdCdW5kbGVTZXJ2aWNlPiBzZXJ2aWNlID0KLSAgICAgICAgICAgZG9f
R2V0U2VydmljZShOU19TVFJJTkdCVU5ETEVfQ09OVFJBQ1RJRCwgJnJ2KTsKLSAgaWYgKE5TX0ZB
SUxFRChydikpIHJldHVybiBOU19PSzsKLSAgcnYgPSBzZXJ2aWNlLT5DcmVhdGVCdW5kbGUoUElQ
U1RSSU5HX0JVTkRMRV9VUkwsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldHRlcl9B
ZGRSZWZzKG1QSVBTdHJpbmdCdW5kbGUpKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1uc3Jlc3Vs
dAotRW1iZWRDZXJ0aWZpY2F0ZXM6OlNldFBhc3N3b3JkKG5zSUludGVyZmFjZVJlcXVlc3RvciAq
Y3R4LAotICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBQUlVuaWNoYXIgKnRva2VuTmFt
ZSwgUFJCb29sKiBfY2FuY2VsZWQpCi17Ci0gICpfY2FuY2VsZWQgPSBQUl9GQUxTRTsKLSAgcmV0
dXJuIE5TX09LOwotfQotCi1uc3Jlc3VsdAotRW1iZWRDZXJ0aWZpY2F0ZXM6OkdldFBhc3N3b3Jk
KG5zSUludGVyZmFjZVJlcXVlc3RvciAqY3R4LAotICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBQUlVuaWNoYXIgKnRva2VuTmFtZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgUFJV
bmljaGFyICoqX3Bhc3N3b3JkLAotICAgICAgICAgICAgICAgICAgICAgICAgICBQUkJvb2wqIF9j
YW5jZWxlZCkKLXsKLSAgKl9jYW5jZWxlZCA9IFBSX0ZBTFNFOwotICByZXR1cm4gTlNfT0s7Ci19
Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkQ2VydGlmaWNhdGVzOjpDcmxJbXBvcnRTdGF0dXNEaWFs
b2cobnNJSW50ZXJmYWNlUmVxdWVzdG9yICpjdHgsIG5zSUNSTEluZm8gKmNybCkKLXsKLSAgcmV0
dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZENlcnRpZmljYXRlczo6Q29uZmly
bURvd25sb2FkQ0FDZXJ0KG5zSUludGVyZmFjZVJlcXVlc3RvciAqY3R4LAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbnNJWDUwOUNlcnQgKmNlcnQsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBQUlVpbnQzMiAqX3RydXN0LAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgUFJCb29sICpfcmV0dmFsKQotewotICAvLyBJZiBhbiBpbXBs
ZW1lbnRhdGlvbiBjaG9vc2VzIG5vdCB0byBpbXBsZW1lbnQgVUkgZm9yIGRpc3BsYXlpbmcKLSAg
Ly8gdGhlIGNlcnQgYW5kIGFza2luZyB0aGUgdXNlciBmb3IgY29uZmlybWF0aW9uLAotICAvLyB0
aGVuIHRoaXMgZnVuY3Rpb24gbXVzdCByZXR1cm4gUFJfRkFMU0UuCi0gICpfcmV0dmFsID0gUFJf
RkFMU0U7Ci0gICpfdHJ1c3QgPSBuc0lYNTA5Q2VydERCOjpVTlRSVVNURUQ7Ci0gIHJldHVybiBO
U19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDZXJ0aWZpY2F0ZXM6Ok5vdGlmeUNBQ2Vy
dEV4aXN0cyhuc0lJbnRlcmZhY2VSZXF1ZXN0b3IgKmN0eCkKLXsKLSAgcmV0dXJuIE5TX09LOwot
fQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZENlcnRpZmljYXRlczo6Q2hvb3NlQ2VydGlmaWNhdGUo
Ci0gIG5zSUludGVyZmFjZVJlcXVlc3RvciAqY3R4LAotICBjb25zdCBQUlVuaWNoYXIgKmNuLAot
ICBjb25zdCBQUlVuaWNoYXIgKm9yZ2FuaXphdGlvbiwKLSAgY29uc3QgUFJVbmljaGFyICppc3N1
ZXIsCi0gIGNvbnN0IFBSVW5pY2hhciAqKmNlcnROaWNrTGlzdCwKLSAgY29uc3QgUFJVbmljaGFy
ICoqY2VydERldGFpbHNMaXN0LAotICBQUlVpbnQzMiBjb3VudCwKLSAgUFJJbnQzMiAqc2VsZWN0
ZWRJbmRleCwKLSAgUFJCb29sICpjYW5jZWxlZCkKLXsKLSAgKmNhbmNlbGVkID0gUFJfRkFMU0U7
Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDZXJ0aWZpY2F0ZXM6
OlBpY2tDZXJ0aWZpY2F0ZSgKLSAgbnNJSW50ZXJmYWNlUmVxdWVzdG9yICpjdHgsCi0gIGNvbnN0
IFBSVW5pY2hhciAqKmNlcnROaWNrTGlzdCwKLSAgY29uc3QgUFJVbmljaGFyICoqY2VydERldGFp
bHNMaXN0LAotICBQUlVpbnQzMiBjb3VudCwKLSAgUFJJbnQzMiAqc2VsZWN0ZWRJbmRleCwKLSAg
UFJCb29sICpjYW5jZWxlZCkKLXsKLSAgKmNhbmNlbGVkID0gUFJfRkFMU0U7Ci0gIHJldHVybiBO
U19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDZXJ0aWZpY2F0ZXM6OlNldFBLQ1MxMkZp
bGVQYXNzd29yZCgKLSAgbnNJSW50ZXJmYWNlUmVxdWVzdG9yICpjdHgsCi0gIG5zQVN0cmluZyAm
X3Bhc3N3b3JkLAotICBQUkJvb2wgKl9yZXR2YWwpCi17Ci0gIC8qIFRoZSBwZXJzb24gd2hvIHdy
b3RlIHRoaXMgbWV0aG9kIGltcGxlbWVudGF0aW9uIGRpZAotICAgKiBub3QgcmVhZCB0aGUgY29u
dHJhY3QuCi0gICAqLwotICAqX3JldHZhbCA9IFBSX0ZBTFNFOwotICByZXR1cm4gTlNfT0s7Ci19
Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkQ2VydGlmaWNhdGVzOjpHZXRQS0NTMTJGaWxlUGFzc3dv
cmQoCi0gIG5zSUludGVyZmFjZVJlcXVlc3RvciAqY3R4LAotICBuc0FTdHJpbmcgJl9wYXNzd29y
ZCwKLSAgUFJCb29sICpfcmV0dmFsKQotewotICAvKiBUaGUgcGVyc29uIHdobyB3cm90ZSB0aGlz
IG1ldGhvZCBpbXBsZW1lbnRhdGlvbiBkaWQKLSAgICogbm90IHJlYWQgdGhlIGNvbnRyYWN0Lgot
ICAgKi8KLSAgKl9yZXR2YWwgPSBQUl9GQUxTRTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi0vKiB2
b2lkIHZpZXdDZXJ0IChpbiBuc0lYNTA5Q2VydCBjZXJ0KTsgKi8KLU5TX0lNRVRIT0RJTVAKLUVt
YmVkQ2VydGlmaWNhdGVzOjpWaWV3Q2VydCgKLSAgbnNJSW50ZXJmYWNlUmVxdWVzdG9yICpjdHgs
Ci0gIG5zSVg1MDlDZXJ0ICpjZXJ0KQotewotICByZXR1cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRI
T0RJTVAKLUVtYmVkQ2VydGlmaWNhdGVzOjpEaXNwbGF5R2VuZXJhdGluZ0tleXBhaXJJbmZvKG5z
SUludGVyZmFjZVJlcXVlc3RvciAqYUN0eCwgbnNJS2V5Z2VuVGhyZWFkICpydW5uYWJsZSkKLXsK
LSAgcmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZENlcnRpZmljYXRlczo6
Q2hvb3NlVG9rZW4oCi0gIG5zSUludGVyZmFjZVJlcXVlc3RvciAqYUN0eCwKLSAgY29uc3QgUFJV
bmljaGFyICoqYVRva2VuTGlzdCwKLSAgUFJVaW50MzIgYUNvdW50LAotICBQUlVuaWNoYXIgKiph
VG9rZW5DaG9zZW4sCi0gIFBSQm9vbCAqYUNhbmNlbGVkKQotewotICAqYUNhbmNlbGVkID0gUFJf
RkFMU0U7Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDZXJ0aWZp
Y2F0ZXM6OkRpc3BsYXlQcm90ZWN0ZWRBdXRoKAotICBuc0lJbnRlcmZhY2VSZXF1ZXN0b3IgKmFD
dHgsCi0gIG5zSVByb3RlY3RlZEF1dGhUaHJlYWQgKnJ1bm5hYmxlKQotewotICByZXR1cm4gTlNf
T0s7Ci19Ci0KLS8qIGJvb2xlYW4gQ29uZmlybUtleUVzY3JvdyAoaW4gbnNJWDUwOUNlcnQgZXNj
cm93QXV0aG9yaXR5KTsgKi8KLU5TX0lNRVRIT0RJTVAKLUVtYmVkQ2VydGlmaWNhdGVzOjpDb25m
aXJtS2V5RXNjcm93KG5zSVg1MDlDZXJ0ICplc2Nyb3dBdXRob3JpdHksIFBSQm9vbCAqX3JldHZh
bCkKLXsKLSAgLy8gSWYgYW4gaW1wbGVtZW50YXRpb24gY2hvb3NlcyBub3QgdG8gaW1wbGVtZW50
IFVJIHRoYXQgYXNrcyB0aGUgdXNlciBmb3IgCi0gIC8vIGNvbmZpcm1hdGlvbiB0byBoYW5kIG91
dCB0aGUgcHJpdmF0ZSBrZXksIAotICAvLyB0aGVuIHRoaXMgZnVuY3Rpb24gbXVzdCByZXR1cm4g
UFJfRkFMU0UuCi0gICpfcmV0dmFsID0gUFJfRkFMU0U7Ci0gIHJldHVybiBOU19PSzsKLX0KLQpk
aWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZENlcnRpZmljYXRlcy5o
IGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZENlcnRpZmljYXRlcy5oCmRlbGV0ZWQg
ZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkQ2Vy
dGlmaWNhdGVzLmgKKysrIC9kZXYvbnVsbApAQCAtMSw4NCArMCwwIEBACi0vKiAtKi0gTW9kZTog
QysrOyB0YWItd2lkdGg6IDI7IGluZGVudC10YWJzLW1vZGU6IG5pbDsgYy1iYXNpYy1vZmZzZXQ6
IDIgLSotICovCi0vKiB2aW06c2V0IHRzPTIgc3c9MiBzdHM9MiBldCBjaW5kZW50OiAqLwotLyog
KioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwg
Mi4wL0xHUEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVj
dCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGlj
ZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdp
dGgKLSAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2Ug
YXQKLSAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3Ry
aWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFz
aXMsCi0gKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBp
bXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292
ZXJuaW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoK
LSAqIFRoZSBPcmlnaW5hbCBDb2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIElu
aXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBOZXRzY2FwZSBDb21t
dW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRp
YWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIwMDEKLSAqIHRoZSBJbml0aWFsIERldmVs
b3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICAg
VGVycnkgSGF5ZXMgPHRoYXllc0BuZXRzY2FwZS5jb20+Ci0gKiAgIEphdmllciBEZWxnYWRpbGxv
IDxqYXZpQG5ldHNjYXBlLmNvbT4KLSAqICAgT2xlZyBSb21hc2hpbiA8cm9tYXhhQGdtYWlsLmNv
bT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBi
ZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUg
IkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0
aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91
IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICog
dW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRv
IGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0
aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNl
Ci0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BM
LiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBp
ZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1z
IG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioq
KiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotLyoqCi0gKiBEZXJpdmVkIGZyb20gbnNOU1NE
aWFsb2dzIGh0dHA6Ly9sYW5kZmlsbC5tb3ppbGxhLm9yZy9teHItdGVzdC9zZWFtb25rZXkvc291
cmNlL3NlY3VyaXR5L21hbmFnZXIvcGtpL3NyYy9uc05TU0RpYWxvZ3MuaAotICovCi0jaWZuZGVm
IF9fRW1iZWRDZXJ0aWZpY2F0ZXNfaAotI2RlZmluZSBfX0VtYmVkQ2VydGlmaWNhdGVzX2gKLSNp
bmNsdWRlICJuc0lUb2tlblBhc3N3b3JkRGlhbG9ncy5oIgotI2luY2x1ZGUgIm5zSUNlcnRpZmlj
YXRlRGlhbG9ncy5oIgotI2luY2x1ZGUgIm5zSUNsaWVudEF1dGhEaWFsb2dzLmgiCi0jaW5jbHVk
ZSAibnNJQ2VydFBpY2tEaWFsb2dzLmgiCi0jaW5jbHVkZSAibnNJVG9rZW5EaWFsb2dzLmgiCi0j
aW5jbHVkZSAibnNJRE9NQ3J5cHRvRGlhbG9ncy5oIgotI2luY2x1ZGUgIm5zSUdlbktleXBhaXJJ
bmZvRGxnLmgiCi0jaW5jbHVkZSAibnNDT01QdHIuaCIKLSNpbmNsdWRlICJuc0lTdHJpbmdCdW5k
bGUuaCIKLSNkZWZpbmUgRU1CRURfQ0VSVElGSUNBVEVTX0NJRCBcCi0gIHsgMHg1MThlMDcxZiwg
MHgxZGQyLCAweDExYjIsIFwKLSAgeyAweDkzLCAweDdlLCAweGM0LCAweDVmLCAweDE0LCAweGRl
LCAweGY3LCAweDc4IH19Ci0jZGVmaW5lIEVNQkVEX0NFUlRJRklDQVRFU19ERVNDUklQVElPTiAi
Q2VydGlmaWNhdGVzIExpc3RlbmVyIEltcGwiCi1jbGFzcyBFbWJlZFByaXZhdGU7Ci1jbGFzcyBF
bWJlZENlcnRpZmljYXRlcwotOiBwdWJsaWMgbnNJVG9rZW5QYXNzd29yZERpYWxvZ3MsCi0gIHB1
YmxpYyBuc0lDZXJ0aWZpY2F0ZURpYWxvZ3MsCi0gIHB1YmxpYyBuc0lDbGllbnRBdXRoRGlhbG9n
cywKLSAgcHVibGljIG5zSUNlcnRQaWNrRGlhbG9ncywKLSAgcHVibGljIG5zSVRva2VuRGlhbG9n
cywKLSAgcHVibGljIG5zSURPTUNyeXB0b0RpYWxvZ3MsCi0gIHB1YmxpYyBuc0lHZW5lcmF0aW5n
S2V5cGFpckluZm9EaWFsb2dzCi17Ci0gIHB1YmxpYzoKLSAgICBOU19ERUNMX0lTVVBQT1JUUwot
ICAgIE5TX0RFQ0xfTlNJVE9LRU5QQVNTV09SRERJQUxPR1MKLSAgICBOU19ERUNMX05TSUNFUlRJ
RklDQVRFRElBTE9HUwotICAgIE5TX0RFQ0xfTlNJQ0xJRU5UQVVUSERJQUxPR1MKLSAgICBOU19E
RUNMX05TSUNFUlRQSUNLRElBTE9HUwotICAgIE5TX0RFQ0xfTlNJVE9LRU5ESUFMT0dTCi0gICAg
TlNfREVDTF9OU0lET01DUllQVE9ESUFMT0dTCi0gICAgTlNfREVDTF9OU0lHRU5FUkFUSU5HS0VZ
UEFJUklORk9ESUFMT0dTCi0gICAgRW1iZWRDZXJ0aWZpY2F0ZXMoKTsKLSAgICB2aXJ0dWFsIH5F
bWJlZENlcnRpZmljYXRlcygpOwotICAgIG5zcmVzdWx0IEluaXQodm9pZCk7Ci0gIHByb3RlY3Rl
ZDoKLSAgbnNDT01QdHI8bnNJU3RyaW5nQnVuZGxlPiBtUElQU3RyaW5nQnVuZGxlOwotfTsKLSNl
bmRpZiAvKiBfX0VtYmVkQ2VydGlmaWNhdGVzX2ggKi8KZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9i
cm93c2VyL2d0ay9zcmMvRW1iZWRDb250ZW50TGlzdGVuZXIuY3BwIGIvZW1iZWRkaW5nL2Jyb3dz
ZXIvZ3RrL3NyYy9FbWJlZENvbnRlbnRMaXN0ZW5lci5jcHAKZGVsZXRlZCBmaWxlIG1vZGUgMTAw
NjQ0Ci0tLSBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRDb250ZW50TGlzdGVuZXIu
Y3BwCisrKyAvZGV2L251bGwKQEAgLTEsMTU2ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VO
U0UgQkxPQ0sgKioqKioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoK
LSAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEg
UHVibGljIExpY2Vuc2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBu
b3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5z
ZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3
Lm1vemlsbGEub3JnL01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg
TGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBX
QVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBM
aWNlbnNlCi0gKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5k
IGxpbWl0YXRpb25zIHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwg
Q29kZSBpcyBtb3ppbGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBv
ZiB0aGUgT3JpZ2luYWwgQ29kZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0
aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAy
MDAxCi0gKiB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgot
ICogQ29udHJpYnV0b3Iocyk6Ci0gKiAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBt
b3ppbGxhLm9yZz4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBm
aWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0g
KiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxh
dGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhl
IEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92
ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUg
b25seQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBh
bmQgbm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZp
bGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9u
IGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0
aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9y
IHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUs
IGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICog
dGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAq
Ci0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5jbHVkZSAibnNJVVJJ
LmgiCi0KLSNpbmNsdWRlICJFbWJlZENvbnRlbnRMaXN0ZW5lci5oIgotI2luY2x1ZGUgIkVtYmVk
UHJpdmF0ZS5oIgotCi0jaW5jbHVkZSAibnNTZXJ2aWNlTWFuYWdlclV0aWxzLmgiCi0jaW5jbHVk
ZSAibnNJV2ViTmF2aWdhdGlvbkluZm8uaCIKLSNpbmNsdWRlICJuc0RvY1NoZWxsQ0lELmgiCi0K
LUVtYmVkQ29udGVudExpc3RlbmVyOjpFbWJlZENvbnRlbnRMaXN0ZW5lcih2b2lkKQotewotICBt
T3duZXIgPSBuc251bGw7Ci19Ci0KLUVtYmVkQ29udGVudExpc3RlbmVyOjp+RW1iZWRDb250ZW50
TGlzdGVuZXIoKQotewotfQotCi1OU19JTVBMX0lTVVBQT1JUUzIoRW1iZWRDb250ZW50TGlzdGVu
ZXIsCi0gICAgICAgICAgICAgICAgICAgbnNJVVJJQ29udGVudExpc3RlbmVyLAotICAgICAgICAg
ICAgICAgICAgIG5zSVN1cHBvcnRzV2Vha1JlZmVyZW5jZSkKLQotbnNyZXN1bHQKLUVtYmVkQ29u
dGVudExpc3RlbmVyOjpJbml0KEVtYmVkUHJpdmF0ZSAqYU93bmVyKQotewotICBtT3duZXIgPSBh
T3duZXI7Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDb250ZW50
TGlzdGVuZXI6Ok9uU3RhcnRVUklPcGVuKG5zSVVSSSAgICAgKmFVUkksCi0JCQkJICAgICBQUkJv
b2wgICAgICphQWJvcnRPcGVuKQotewotICBuc3Jlc3VsdCBydjsKLQotICBuc0NBdXRvU3RyaW5n
IHNwZWNTdHJpbmc7Ci0gIHJ2ID0gYVVSSS0+R2V0U3BlYyhzcGVjU3RyaW5nKTsKLQotICBpZiAo
TlNfRkFJTEVEKHJ2KSkKLSAgICByZXR1cm4gcnY7Ci0KLSAgZ2ludCByZXR1cm5fdmFsID0gRkFM
U0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwKLSAg
ICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tPUEVOX1VSSV0sIDAsCi0gICAgICAgICAg
ICAgICAgc3BlY1N0cmluZy5nZXQoKSwgJnJldHVybl92YWwpOwotCi0gICphQWJvcnRPcGVuID0g
cmV0dXJuX3ZhbDsKLQotICByZXR1cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVk
Q29udGVudExpc3RlbmVyOjpEb0NvbnRlbnQoY29uc3QgY2hhciAgICAgICAgICphQ29udGVudFR5
cGUsCi0JCQkJUFJCb29sICAgICAgICAgICAgIGFJc0NvbnRlbnRQcmVmZXJyZWQsCi0JCQkJbnNJ
UmVxdWVzdCAgICAgICAgICphUmVxdWVzdCwKLQkJCQluc0lTdHJlYW1MaXN0ZW5lciAqKmFDb250
ZW50SGFuZGxlciwKLQkJCQlQUkJvb2wgICAgICAgICAgICAgKmFBYm9ydFByb2Nlc3MpCi17Ci0g
IHJldHVybiBOU19FUlJPUl9OT1RfSU1QTEVNRU5URUQ7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVt
YmVkQ29udGVudExpc3RlbmVyOjpJc1ByZWZlcnJlZChjb25zdCBjaGFyICAgICAgICAqYUNvbnRl
bnRUeXBlLAotCQkJCSAgY2hhciAgICAgICAgICAgICAqKmFEZXNpcmVkQ29udGVudFR5cGUsCi0J
CQkJICBQUkJvb2wgICAgICAgICAgICAqYUNhbkhhbmRsZUNvbnRlbnQpCi17Ci0gIHJldHVybiBD
YW5IYW5kbGVDb250ZW50KGFDb250ZW50VHlwZSwgUFJfVFJVRSwgYURlc2lyZWRDb250ZW50VHlw
ZSwKLQkJCSAgYUNhbkhhbmRsZUNvbnRlbnQpOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZENv
bnRlbnRMaXN0ZW5lcjo6Q2FuSGFuZGxlQ29udGVudChjb25zdCBjaGFyICAgICAgICAqYUNvbnRl
bnRUeXBlLAotCQkJCSAgICAgICBQUkJvb2wgICAgICAgICAgIGFJc0NvbnRlbnRQcmVmZXJyZWQs
Ci0JCQkJICAgICAgIGNoYXIgICAgICAgICAgICAgKiphRGVzaXJlZENvbnRlbnRUeXBlLAotCQkJ
CSAgICAgICBQUkJvb2wgICAgICAgICAgICAqX3JldHZhbCkKLXsKLSAgKl9yZXR2YWwgPSBQUl9G
QUxTRTsKLSAgKmFEZXNpcmVkQ29udGVudFR5cGUgPSBuc251bGw7Ci0gIAotICBpZiAoYUNvbnRl
bnRUeXBlKSB7Ci0gICAgbnNDT01QdHI8bnNJV2ViTmF2aWdhdGlvbkluZm8+IHdlYk5hdkluZm8o
Ci0gICAgICAgICAgIGRvX0dldFNlcnZpY2UoTlNfV0VCTkFWSUdBVElPTl9JTkZPX0NPTlRSQUNU
SUQpKTsKLSAgICBpZiAod2ViTmF2SW5mbykgewotICAgICAgUFJVaW50MzIgY2FuSGFuZGxlOwot
ICAgICAgbnNyZXN1bHQgcnYgPQotCXdlYk5hdkluZm8tPklzVHlwZVN1cHBvcnRlZChuc0RlcGVu
ZGVudENTdHJpbmcoYUNvbnRlbnRUeXBlKSwKLQkJCQkgICAgbU93bmVyID8gbU93bmVyLT5tTmF2
aWdhdGlvbi5nZXQoKSA6IG5zbnVsbCwKLQkJCQkgICAgJmNhbkhhbmRsZSk7Ci0gICAgICBOU19F
TlNVUkVfU1VDQ0VTUyhydiwgcnYpOwotICAgICAgKl9yZXR2YWwgPSAoY2FuSGFuZGxlICE9IG5z
SVdlYk5hdmlnYXRpb25JbmZvOjpVTlNVUFBPUlRFRCk7Ci0gICAgfQotICB9Ci0gIHJldHVybiBO
U19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDb250ZW50TGlzdGVuZXI6OkdldExvYWRD
b29raWUobnNJU3VwcG9ydHMgKiphTG9hZENvb2tpZSkKLXsKLSAgcmV0dXJuIE5TX0VSUk9SX05P
VF9JTVBMRU1FTlRFRDsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRDb250ZW50TGlzdGVuZXI6
OlNldExvYWRDb29raWUobnNJU3VwcG9ydHMgKmFMb2FkQ29va2llKQotewotICByZXR1cm4gTlNf
RVJST1JfTk9UX0lNUExFTUVOVEVEOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZENvbnRlbnRM
aXN0ZW5lcjo6R2V0UGFyZW50Q29udGVudExpc3RlbmVyKG5zSVVSSUNvbnRlbnRMaXN0ZW5lciAq
KmFQYXJlbnQpCi17Ci0gIHJldHVybiBOU19FUlJPUl9OT1RfSU1QTEVNRU5URUQ7Ci19Ci0KLU5T
X0lNRVRIT0RJTVAKLUVtYmVkQ29udGVudExpc3RlbmVyOjpTZXRQYXJlbnRDb250ZW50TGlzdGVu
ZXIobnNJVVJJQ29udGVudExpc3RlbmVyICphUGFyZW50KQotewotICByZXR1cm4gTlNfRVJST1Jf
Tk9UX0lNUExFTUVOVEVEOwotfQotCmRpZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsv
c3JjL0VtYmVkQ29udGVudExpc3RlbmVyLmggYi9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0Vt
YmVkQ29udGVudExpc3RlbmVyLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Ci0tLSBhL2VtYmVk
ZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRDb250ZW50TGlzdGVuZXIuaAorKysgL2Rldi9udWxs
CkBAIC0xLDY2ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKLSAq
IFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250ZW50cyBv
ZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVy
c2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBl
eGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4g
YSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8K
LSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmli
dXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lO
RCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBmb3IgdGhl
IHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVy
IHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3ppbGxhLm9y
ZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29k
ZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IHRo
ZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAxCi0gKiB0aGUgSW5pdGlh
bCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0b3Iocyk6
Ci0gKiAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3ppbGxhLm9yZz4KLSAqCi0g
KiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVu
ZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwK
LSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBh
cmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8g
YWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhl
IHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90
aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBw
cm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQg
b3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3Ug
ZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1
c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBv
bmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElD
RU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaWZuZGVmIF9fRW1iZWRDb250ZW50TGlzdGVuZXJfaAot
I2RlZmluZSBfX0VtYmVkQ29udGVudExpc3RlbmVyX2gKLQotI2luY2x1ZGUgIm5zSVVSSUNvbnRl
bnRMaXN0ZW5lci5oIgotI2luY2x1ZGUgIm5zV2Vha1JlZmVyZW5jZS5oIgotCi1jbGFzcyBFbWJl
ZFByaXZhdGU7Ci0KLWNsYXNzIEVtYmVkQ29udGVudExpc3RlbmVyIDogcHVibGljIG5zSVVSSUNv
bnRlbnRMaXN0ZW5lciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIG5zU3Vw
cG9ydHNXZWFrUmVmZXJlbmNlCi17Ci0gcHVibGljOgotCi0gIEVtYmVkQ29udGVudExpc3RlbmVy
KCk7Ci0gIHZpcnR1YWwgfkVtYmVkQ29udGVudExpc3RlbmVyKCk7Ci0KLSAgbnNyZXN1bHQgSW5p
dCAoRW1iZWRQcml2YXRlICphT3duZXIpOwotCi0gIE5TX0RFQ0xfSVNVUFBPUlRTCi0KLSAgTlNf
REVDTF9OU0lVUklDT05URU5UTElTVEVORVIKLQotIHByaXZhdGU6Ci0KLSAgRW1iZWRQcml2YXRl
ICptT3duZXI7Ci0gIAotfTsKLQotI2VuZGlmIC8qIF9fRW1iZWRDb250ZW50TGlzdGVuZXJfaCAq
LwpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZENvbnRleHRNZW51
SW5mby5jcHAgYi9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkQ29udGV4dE1lbnVJbmZv
LmNwcApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3Rr
L3NyYy9FbWJlZENvbnRleHRNZW51SW5mby5jcHAKKysrIC9kZXYvbnVsbApAQCAtMSw2MTggKzAs
MCBAQAotLyogLSotIE1vZGU6IEMrKzsgdGFiLXdpZHRoOiAyOyBpbmRlbnQtdGFicy1tb2RlOiBu
aWw7IGMtYmFzaWMtb2Zmc2V0OiAyIC0qLSAqLwotLyogdmltOnNldCB0cz0yIHN3PTIgc3RzPTIg
dHc9ODAgZXQgY2luZGVudDogKi8KLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioK
LSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250ZW50
cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2Ug
VmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmls
ZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRh
aW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01Q
TC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0
cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkg
S0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBmb3Ig
dGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVu
ZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3ppbGxh
Lm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwg
Q29kZSBpcwotICogT2xlZyBSb21hc2hpbi4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIElu
aXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIwMDYKLSAqIHRoZSBJbml0aWFsIERl
dmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAq
ICAgT2xlZyBSb21hc2hpbiA8cm9tYXhhQGdtYWlsLmNvbT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5
LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBv
ZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3Ig
bGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNh
c2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBp
bnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlv
dXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhl
ciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNl
IHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGlu
ZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3Zl
IGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9u
cyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQot
ICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9u
IG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwg
dGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioq
KiAqLwotI2luY2x1ZGUgIkVtYmVkQ29udGV4dE1lbnVJbmZvLmgiCi0jaW5jbHVkZSAibnNJSW1h
Z2VMb2FkaW5nQ29udGVudC5oIgotI2luY2x1ZGUgImltZ0lMb2FkZXIuaCIKLSNpbmNsdWRlICJu
c0lET01Eb2N1bWVudC5oIgotI2luY2x1ZGUgIm5zSURPTUhUTUxEb2N1bWVudC5oIgotI2luY2x1
ZGUgIm5zSURPTUhUTUxFbGVtZW50LmgiCi0jaW5jbHVkZSAibnNJRE9NSFRNTEh0bWxFbGVtZW50
LmgiCi0jaW5jbHVkZSAibnNJRE9NSFRNTEFuY2hvckVsZW1lbnQuaCIKLSNpbmNsdWRlICJuc0lE
T01IVE1MSW1hZ2VFbGVtZW50LmgiCi0jaW5jbHVkZSAibnNJRE9NSFRNTEFyZWFFbGVtZW50Lmgi
Ci0jaW5jbHVkZSAibnNJRE9NSFRNTExpbmtFbGVtZW50LmgiCi0jaW5jbHVkZSAibnNJRE9NRG9j
dW1lbnRWaWV3LmgiCi0jaW5jbHVkZSAibnNJRE9NQWJzdHJhY3RWaWV3LmgiCi0jaW5jbHVkZSAi
bnNJRE9NVmlld0NTUy5oIgotI2luY2x1ZGUgIm5zSURPTUNTU1N0eWxlRGVjbGFyYXRpb24uaCIK
LSNpbmNsdWRlICJuc0lET01DU1NWYWx1ZS5oIgotI2luY2x1ZGUgIm5zSURPTUNTU1ByaW1pdGl2
ZVZhbHVlLmgiCi0jaW5jbHVkZSAibnNOZXRVdGlsLmgiCi0jaW5jbHVkZSAibnNVbmljaGFyVXRp
bHMuaCIKLSNpbmNsdWRlICJuc0lET01Nb3VzZUV2ZW50LmgiCi0jaW5jbHVkZSAibnNJRE9NTlNF
dmVudC5oIgotI2luY2x1ZGUgIm5zSURPTVdpbmRvdy5oIgotI2luY2x1ZGUgIm5zSURPTVdpbmRv
d0NvbGxlY3Rpb24uaCIKLSNpbmNsdWRlICJuc0lXZWJCcm93c2VyLmgiCi0jaW5jbHVkZSAibnNJ
Q29udGVudC5oIgotI2luY2x1ZGUgIm5zSVByZXNTaGVsbC5oIgotI2luY2x1ZGUgIm5zSUZvcm1D
b250cm9sLmgiCi0jaW5jbHVkZSAibnNJRE9NTlNIVE1MVGV4dEFyZWFFbGVtZW50LmgiCi0jaW5j
bHVkZSAibnNJRE9NSFRNTElucHV0RWxlbWVudC5oIgotI2luY2x1ZGUgIm5zSURPTUhUTUxUZXh0
QXJlYUVsZW1lbnQuaCIKLSNpbmNsdWRlICJuc0lET01OU0hUTUxEb2N1bWVudC5oIgotI2luY2x1
ZGUgIm5zSURPTU5vZGVMaXN0LmgiCi0jaW5jbHVkZSAibnNJU2VsZWN0aW9uLmgiCi0jaW5jbHVk
ZSAibnNJRG9jdW1lbnQuaCIKLSNpbmNsdWRlICJFbWJlZFByaXZhdGUuaCIKLSNpbmNsdWRlIDxz
dGRpby5oPgotI2luY2x1ZGUgPHN0ZGFyZy5oPgotI2luY2x1ZGUgPHN0ZGxpYi5oPgotI2luY2x1
ZGUgPGdsaWIuaD4KLSNpZiBkZWZpbmVkKEZJWEVEX0JVRzM0NzczMSkgfHwgIWRlZmluZWQoTU9a
X0VOQUJMRV9MSUJYVUwpCi0jaW5jbHVkZSAibnNJRnJhbWUuaCIKLSNlbmRpZgotCi0vLyoqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqCi0vLyBjbGFzcyBFbWJlZENvbnRleHRNZW51SW5mbwotLy8qKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKgotRW1iZWRDb250ZXh0TWVudUluZm86OkVtYmVkQ29udGV4dE1lbnVJbmZv
KEVtYmVkUHJpdmF0ZSAqYU93bmVyKSA6IG1DdHhGcmFtZU51bSgtMSksIG1FbWJlZEN0eFR5cGUo
MCkKLXsKLSAgbU93bmVyID0gYU93bmVyOwotICBtRXZlbnROb2RlID0gbnNudWxsOwotICBtQ3R4
RG9jdW1lbnQgPSBuc251bGw7Ci0gIG1OU0hIVE1MRWxlbWVudCA9IG5zbnVsbDsKLSAgbU5TSEhU
TUxFbGVtZW50U2MgPSBuc251bGw7Ci0gIG1DdHhFdmVudCA9IG5zbnVsbDsKLSAgbUV2ZW50Tm9k
ZSA9IG5zbnVsbDsKLSAgbUZvcm1SZWN0ID0gbnNJbnRSZWN0KDAsMCwwLDApOwotfQotCi1FbWJl
ZENvbnRleHRNZW51SW5mbzo6fkVtYmVkQ29udGV4dE1lbnVJbmZvKHZvaWQpCi17Ci0gIG1FdmVu
dE5vZGUgPSBuc251bGw7Ci0gIG1DdHhEb2N1bWVudCA9IG5zbnVsbDsKLSAgbU5TSEhUTUxFbGVt
ZW50ID0gbnNudWxsOwotICBtTlNISFRNTEVsZW1lbnRTYyA9IG5zbnVsbDsKLSAgbUN0eEV2ZW50
ID0gbnNudWxsOwotICBtRXZlbnROb2RlID0gbnNudWxsOwotfQotCi1OU19JTVBMX0FERFJFRihF
bWJlZENvbnRleHRNZW51SW5mbykKLU5TX0lNUExfUkVMRUFTRShFbWJlZENvbnRleHRNZW51SW5m
bykKLU5TX0lOVEVSRkFDRV9NQVBfQkVHSU4oRW1iZWRDb250ZXh0TWVudUluZm8pCi1OU19JTlRF
UkZBQ0VfTUFQX0VOVFJZKG5zSVN1cHBvcnRzKQotTlNfSU5URVJGQUNFX01BUF9FTkQKLQotbnNy
ZXN1bHQKLUVtYmVkQ29udGV4dE1lbnVJbmZvOjpTZXRGcmFtZUluZGV4KCkKLXsKLSAgbnNDT01Q
dHI8bnNJRE9NV2luZG93Q29sbGVjdGlvbj4gZnJhbWVzOwotICBtQ3R4RG9tV2luZG93LT5HZXRG
cmFtZXMoZ2V0dGVyX0FkZFJlZnMoZnJhbWVzKSk7Ci0gIG5zQ09NUHRyPG5zSURPTVdpbmRvdz4g
Y3VycmVudFdpbmRvdzsKLSAgUFJVaW50MzIgZnJhbWVDb3VudCA9IDA7Ci0gIGZyYW1lcy0+R2V0
TGVuZ3RoKCZmcmFtZUNvdW50KTsKLSAgZm9yICh1bnNpZ25lZCBpbnQgaT0gMDsgaSA8IGZyYW1l
Q291bnQ7IGkrKykgewotICAgIGZyYW1lcy0+SXRlbShpLCBnZXR0ZXJfQWRkUmVmcyhjdXJyZW50
V2luZG93KSk7Ci0gICAgbnNDT01QdHI8bnNJRE9NRG9jdW1lbnQ+IGN1cnJlbnREb2M7Ci0gICAg
Y3VycmVudFdpbmRvdy0+R2V0RG9jdW1lbnQoZ2V0dGVyX0FkZFJlZnMoY3VycmVudERvYykpOwot
ICAgIGlmIChjdXJyZW50RG9jID09IG1DdHhEb2N1bWVudCkgewotICAgICAgbUN0eEZyYW1lTnVt
ID0gaTsKLSAgICAgIG1DdHhEb21XaW5kb3cgPSBjdXJyZW50V2luZG93OwotICAgICAgbnNDT01Q
dHI8bnNJRE9NTlNEb2N1bWVudD4gZG9jID0gZG9fUXVlcnlJbnRlcmZhY2UoY3VycmVudERvYyk7
Ci0gICAgICBpZiAoZG9jKQotICAgICAgICBkb2MtPkdldFRpdGxlKG1DdHhEb2NUaXRsZSk7Ci0g
ICAgICByZXR1cm4gTlNfT0s7Ci0gICAgfQotICB9Ci0gIHJldHVybiBOU19FUlJPUl9GQUlMVVJF
OwotfQotCi1uc3Jlc3VsdAotRW1iZWRDb250ZXh0TWVudUluZm86OkdldEZvcm1Db250cm9sVHlw
ZShuc0lET01FdmVudCogYUV2ZW50KQotewotICBpZiAoIWFFdmVudCkKLSAgICByZXR1cm4gTlNf
T0s7Ci0gIG5zQ09NUHRyPG5zSURPTU5TRXZlbnQ+IG5zZXZlbnQoZG9fUXVlcnlJbnRlcmZhY2Uo
YUV2ZW50KSk7Ci0gIG5zQ09NUHRyPG5zSURPTUV2ZW50VGFyZ2V0PiB0YXJnZXQ7Ci0gIG5zZXZl
bnQtPkdldE9yaWdpbmFsVGFyZ2V0KGdldHRlcl9BZGRSZWZzKHRhcmdldCkpOwotICAvLyAgICBt
T3JpZ1RhcmdldCAgPSB0YXJnZXQ7Ci0gIGlmIChTZXRGb3JtQ29udHJvbFR5cGUodGFyZ2V0KSkg
ewotICAgIG5zQ09NUHRyPG5zSURPTU5vZGU+IGV2ZW50Tm9kZSA9IGRvX1F1ZXJ5SW50ZXJmYWNl
KHRhcmdldCk7Ci0gICAgaWYgKCFldmVudE5vZGUpCi0gICAgICByZXR1cm4gTlNfT0s7Ci0gICAg
Ly9GcmFtZSBTdHVmZgotICAgIG5zQ09NUHRyPG5zSURPTURvY3VtZW50PiBkb21Eb2M7Ci0gICAg
bnNyZXN1bHQgcnYgPSBldmVudE5vZGUtPkdldE93bmVyRG9jdW1lbnQoZ2V0dGVyX0FkZFJlZnMo
ZG9tRG9jKSk7Ci0gICAgaWYgKCFOU19TVUNDRUVERUQocnYpIHx8ICFkb21Eb2MpIHsKLSAgICAg
IHJldHVybiBOU19PSzsKLSAgICB9Ci0gICAgbUV2ZW50Tm9kZSA9IGV2ZW50Tm9kZTsKLSAgICBt
Q3R4RG9jdW1lbnQgPSBkb21Eb2M7Ci0gICAgbnNDT01QdHI8bnNJRG9jdW1lbnQ+IGRvYyA9IGRv
X1F1ZXJ5SW50ZXJmYWNlKG1DdHhEb2N1bWVudCk7Ci0gICAgaWYgKCFkb2MpCi0gICAgICByZXR1
cm4gTlNfT0s7Ci0gICAgbnNJUHJlc1NoZWxsICpwcmVzU2hlbGwgPSBkb2MtPkdldFNoZWxsKCk7
Ci0gICAgaWYgKCFwcmVzU2hlbGwpCi0gICAgICByZXR1cm4gTlNfT0s7Ci0gICAgbnNDT01QdHI8
bnNJQ29udGVudD4gdGdDb250ZW50ID0gZG9fUXVlcnlJbnRlcmZhY2UobUV2ZW50VGFyZ2V0KTsK
LSAgICBuc0lGcmFtZSogZnJhbWUgPSBuc251bGw7Ci0jaWYgZGVmaW5lZChGSVhFRF9CVUczNDc3
MzEpIHx8ICFkZWZpbmVkKE1PWl9FTkFCTEVfTElCWFVMKQotICAgIGZyYW1lID0gdGdDb250ZW50
LT5HZXREb2N1bWVudCgpID09IHByZXNTaGVsbC0+R2V0RG9jdW1lbnQoKSA/Ci0gICAgICB0Z0Nv
bnRlbnQtPkdldFByaW1hcnlGcmFtZSgpIDogbnNudWxsOwotICAgIGlmIChmcmFtZSkKLSAgICAg
IG1Gb3JtUmVjdCA9IGZyYW1lLT5HZXRTY3JlZW5SZWN0RXh0ZXJuYWwoKTsKLSNlbmRpZgotICAg
IHJldHVybiBOU19PSzsKLSAgfQotICByZXR1cm4gTlNfRVJST1JfRkFJTFVSRTsKLX0KLQotbnNy
ZXN1bHQKLUVtYmVkQ29udGV4dE1lbnVJbmZvOjpTZXRGb3JtQ29udHJvbFR5cGUobnNJRE9NRXZl
bnRUYXJnZXQgKm9yaWdpbmFsVGFyZ2V0KQotewotICBuc3Jlc3VsdCBydiA9IE5TX0VSUk9SX0ZB
SUxVUkU7Ci0gIG5zQ09NUHRyPG5zSUNvbnRlbnQ+IHRhcmdldENvbnRlbnQgPSBkb19RdWVyeUlu
dGVyZmFjZShvcmlnaW5hbFRhcmdldCk7Ci0gIG1DdHhGb3JtVHlwZSA9IDA7Ci0gIGlmICh0YXJn
ZXRDb250ZW50ICYmIHRhcmdldENvbnRlbnQtPklzTm9kZU9mVHlwZShuc0lDb250ZW50OjplSFRN
TF9GT1JNX0NPTlRST0wpKSB7Ci0gICAgbnNDT01QdHI8bnNJRm9ybUNvbnRyb2w+IGZvcm1Db250
cm9sKGRvX1F1ZXJ5SW50ZXJmYWNlKHRhcmdldENvbnRlbnQpKTsKLSAgICBpZiAoZm9ybUNvbnRy
b2wpIHsKLSAgICAgIG1DdHhGb3JtVHlwZSA9IGZvcm1Db250cm9sLT5HZXRUeXBlKCk7Ci0gICAg
ICBydiA9IE5TX09LOwotICAgICAgLy8jaWZkZWYgTU9aX0xPR0dJTkcKLSAgICAgIHN3aXRjaCAo
bUN0eEZvcm1UeXBlKSB7Ci0gICAgICBjYXNlIE5TX0ZPUk1fQlVUVE9OX0JVVFRPTjoKLSAgICAg
ICAgYnJlYWs7Ci0gICAgICBjYXNlIE5TX0ZPUk1fQlVUVE9OX1JFU0VUOgotICAgICAgICBicmVh
azsKLSAgICAgIGNhc2UgTlNfRk9STV9CVVRUT05fU1VCTUlUOgotICAgICAgICBicmVhazsKLSAg
ICAgIGNhc2UgTlNfRk9STV9JTlBVVF9CVVRUT046Ci0gICAgICAgIGJyZWFrOwotICAgICAgY2Fz
ZSBOU19GT1JNX0lOUFVUX0NIRUNLQk9YOgotICAgICAgICBicmVhazsKLSAgICAgIGNhc2UgTlNf
Rk9STV9JTlBVVF9GSUxFOgotICAgICAgICBtRW1iZWRDdHhUeXBlIHw9IEdUS19NT1pfRU1CRURf
Q1RYX0lOUFVUOwotICAgICAgICBicmVhazsKLSAgICAgIGNhc2UgTlNfRk9STV9JTlBVVF9ISURE
RU46Ci0gICAgICAgIGJyZWFrOwotICAgICAgY2FzZSBOU19GT1JNX0lOUFVUX1JFU0VUOgotICAg
ICAgICBicmVhazsKLSAgICAgIGNhc2UgTlNfRk9STV9JTlBVVF9JTUFHRToKLSAgICAgICAgYnJl
YWs7Ci0gICAgICBjYXNlIE5TX0ZPUk1fSU5QVVRfUEFTU1dPUkQ6Ci0gICAgICAgIG1FbWJlZEN0
eFR5cGUgfD0gR1RLX01PWl9FTUJFRF9DVFhfSU5QVVQ7Ci0gICAgICAgIG1FbWJlZEN0eFR5cGUg
fD0gR1RLX01PWl9FTUJFRF9DVFhfSVBBU1NXT1JEOwotICAgICAgICBicmVhazsKLSAgICAgIGNh
c2UgTlNfRk9STV9JTlBVVF9SQURJTzoKLSAgICAgICAgYnJlYWs7Ci0gICAgICBjYXNlIE5TX0ZP
Uk1fSU5QVVRfU1VCTUlUOgotICAgICAgICBicmVhazsKLSAgICAgIGNhc2UgTlNfRk9STV9JTlBV
VF9FTUFJTDoKLSAgICAgIGNhc2UgTlNfRk9STV9JTlBVVF9TRUFSQ0g6Ci0gICAgICBjYXNlIE5T
X0ZPUk1fSU5QVVRfVEVYVDoKLSAgICAgIGNhc2UgTlNfRk9STV9JTlBVVF9URUw6Ci0gICAgICBj
YXNlIE5TX0ZPUk1fSU5QVVRfVVJMOgotICAgICAgICBtRW1iZWRDdHhUeXBlIHw9IEdUS19NT1pf
RU1CRURfQ1RYX0lOUFVUOwotICAgICAgICBicmVhazsKLSAgICAgIGNhc2UgTlNfRk9STV9MQUJF
TDoKLSAgICAgICAgYnJlYWs7Ci0gICAgICBjYXNlIE5TX0ZPUk1fU0VMRUNUOgotICAgICAgICBi
cmVhazsKLSAgICAgIGNhc2UgTlNfRk9STV9URVhUQVJFQToKLSAgICAgICAgbUVtYmVkQ3R4VHlw
ZSB8PSBHVEtfTU9aX0VNQkVEX0NUWF9JTlBVVDsKLSAgICAgICAgYnJlYWs7Ci0gICAgICBjYXNl
IE5TX0ZPUk1fT0JKRUNUOgotICAgICAgICBicmVhazsKLSAgICAgIGNhc2UgTlNfRk9STV9PVVRQ
VVQ6Ci0gICAgICAgIGJyZWFrOwotICAgICAgZGVmYXVsdDoKLSAgICAgICAgYnJlYWs7Ci0gICAg
ICB9Ci0gICAgICBpZiAobUVtYmVkQ3R4VHlwZSAmIEdUS19NT1pfRU1CRURfQ1RYX0lOUFVUKSB7
Ci0gICAgICAgIFBSQm9vbCByZG9ubHkgPSBQUl9GQUxTRTsKLSAgICAgICAgaWYgKG1DdHhGb3Jt
VHlwZSA9PSBOU19GT1JNX1RFWFRBUkVBKSB7Ci0gICAgICAgICAgbnNDT01QdHI8bnNJRE9NSFRN
TFRleHRBcmVhRWxlbWVudD4gaW5wdXQ7Ci0gICAgICAgICAgaW5wdXQgPSBkb19RdWVyeUludGVy
ZmFjZShtRXZlbnROb2RlLCAmcnYpOwotICAgICAgICAgIGlmICghTlNfRkFJTEVEKHJ2KSAmJiBp
bnB1dCkKLSAgICAgICAgICAgIHJ2ID0gaW5wdXQtPkdldFJlYWRPbmx5KCZyZG9ubHkpOwotICAg
ICAgICAgIGlmICghTlNfRkFJTEVEKHJ2KSAmJiByZG9ubHkpIHsKLSAgICAgICAgICAgIG1FbWJl
ZEN0eFR5cGUgfD0gR1RLX01PWl9FTUJFRF9DVFhfUk9JTlBVVDsKLSAgICAgICAgICB9Ci0gICAg
ICAgIH0gZWxzZSB7Ci0gICAgICAgICAgbnNDT01QdHI8bnNJRE9NSFRNTElucHV0RWxlbWVudD4g
aW5wdXQ7Ci0gICAgICAgICAgaW5wdXQgPSBkb19RdWVyeUludGVyZmFjZShtRXZlbnROb2RlLCAm
cnYpOwotICAgICAgICAgIGlmICghTlNfRkFJTEVEKHJ2KSAmJiBpbnB1dCkKLSAgICAgICAgICAg
IHJ2ID0gaW5wdXQtPkdldFJlYWRPbmx5KCZyZG9ubHkpOwotICAgICAgICAgIGlmICghTlNfRkFJ
TEVEKHJ2KSAmJiByZG9ubHkpIHsKLSAgICAgICAgICAgIG1FbWJlZEN0eFR5cGUgfD0gR1RLX01P
Wl9FTUJFRF9DVFhfUk9JTlBVVDsKLSAgICAgICAgICB9Ci0gICAgICAgIH0KLSAgICAgIH0KLSAg
ICAgIC8vI2VuZGlmCi0gICAgfQotICB9Ci0gIHJldHVybiBydjsKLX0KLQotY29uc3QgY2hhcioK
LUVtYmVkQ29udGV4dE1lbnVJbmZvOjpHZXRTZWxlY3RlZFRleHQoKQotewotICBuc1N0cmluZyBj
U3RyaW5nOwotICBuc3Jlc3VsdCBydiA9IE5TX0VSUk9SX0ZBSUxVUkU7Ci0gIGlmIChtQ3R4Rm9y
bVR5cGUgIT0gMCAmJiBtRXZlbnROb2RlKSB7Ci0gICAgUFJJbnQzMiBUZXh0TGVuZ3RoID0gMCwg
c2VsU3RhcnQgPSAwLCBzZWxFbmQgPSAwOwotICAgIGlmIChtQ3R4Rm9ybVR5cGUgPT0gTlNfRk9S
TV9JTlBVVF9URVhUIHx8IG1DdHhGb3JtVHlwZSA9PSBOU19GT1JNX0lOUFVUX0ZJTEUpIHsKLSAg
ICAgIG5zQ09NUHRyPG5zSURPTUhUTUxJbnB1dEVsZW1lbnQ+IG5zaW5wdXQgPSBkb19RdWVyeUlu
dGVyZmFjZShtRXZlbnROb2RlLCAmcnYpOwotICAgICAgaWYgKE5TX1NVQ0NFRURFRChydikgJiYg
bnNpbnB1dCkKLSAgICAgICAgbnNpbnB1dC0+R2V0VGV4dExlbmd0aCgmVGV4dExlbmd0aCk7Ci0g
ICAgICBpZiAoVGV4dExlbmd0aCA+IDApIHsKLSAgICAgICAgbnNpbnB1dC0+R2V0U2VsZWN0aW9u
RW5kKCZzZWxFbmQpOwotICAgICAgICBuc2lucHV0LT5HZXRTZWxlY3Rpb25TdGFydCgmc2VsU3Rh
cnQpOwotICAgICAgICBpZiAoc2VsU3RhcnQgPCBzZWxFbmQgfHwgbUN0eEZvcm1UeXBlID09IE5T
X0ZPUk1fSU5QVVRfRklMRSkgewotICAgICAgICAgIG5zQ09NUHRyPG5zSURPTUhUTUxJbnB1dEVs
ZW1lbnQ+IGlucHV0ID0gZG9fUXVlcnlJbnRlcmZhY2UobUV2ZW50Tm9kZSwgJnJ2KTsKLSAgICAg
ICAgICBydiA9IGlucHV0LT5HZXRWYWx1ZShjU3RyaW5nKTsKLSAgICAgICAgfQotICAgICAgfQot
ICAgIH0gZWxzZSBpZiAobUN0eEZvcm1UeXBlID09IE5TX0ZPUk1fVEVYVEFSRUEpIHsKLSAgICAg
IG5zQ09NUHRyPG5zSURPTU5TSFRNTFRleHRBcmVhRWxlbWVudD4gbnNpbnB1dCA9IGRvX1F1ZXJ5
SW50ZXJmYWNlKG1FdmVudE5vZGUsICZydik7Ci0gICAgICBpZiAoTlNfU1VDQ0VFREVEKHJ2KSAm
JiBuc2lucHV0KQotICAgICAgICBuc2lucHV0LT5HZXRUZXh0TGVuZ3RoKCZUZXh0TGVuZ3RoKTsK
LSAgICAgIGlmIChUZXh0TGVuZ3RoID4gMCkgewotICAgICAgICBuc2lucHV0LT5HZXRTZWxlY3Rp
b25TdGFydCgmc2VsU3RhcnQpOwotICAgICAgICBuc2lucHV0LT5HZXRTZWxlY3Rpb25FbmQoJnNl
bEVuZCk7Ci0gICAgICAgIGlmIChzZWxTdGFydCA8IHNlbEVuZCkgewotICAgICAgICAgIG5zQ09N
UHRyPG5zSURPTUhUTUxUZXh0QXJlYUVsZW1lbnQ+IGlucHV0ID0gZG9fUXVlcnlJbnRlcmZhY2Uo
bUV2ZW50Tm9kZSwgJnJ2KTsKLSAgICAgICAgICBydiA9IGlucHV0LT5HZXRWYWx1ZShjU3RyaW5n
KTsKLSAgICAgICAgfQotICAgICAgfQotICAgIH0KLSAgICBpZiAoTlNfU1VDQ0VFREVEKHJ2KSAm
JiAhY1N0cmluZy5Jc0VtcHR5KCkpIHsKLSAgICAgIGlmIChzZWxTdGFydCA8IHNlbEVuZCkgewot
ICAgICAgICBjU3RyaW5nLkN1dCgwLCBzZWxTdGFydCk7Ci0gICAgICAgIGNTdHJpbmcuQ3V0KHNl
bEVuZC1zZWxTdGFydCwgVGV4dExlbmd0aCk7Ci0gICAgICB9Ci0gICAgICBydiA9IE5TX09LOwot
ICAgIH0KLSAgfSBlbHNlIGlmIChtQ3R4RG9jdW1lbnQpIHsKLSAgICBuc0NPTVB0cjxuc0lET01O
U0hUTUxEb2N1bWVudD4gaHRtbERvYyA9IGRvX1F1ZXJ5SW50ZXJmYWNlKG1DdHhEb2N1bWVudCwg
JnJ2KTsKLSAgICBpZiAoTlNfRkFJTEVEKHJ2KSB8fCAhaHRtbERvYykKLSAgICAgIHJldHVybiBu
c251bGw7Ci0gICAgcnYgPSBodG1sRG9jLT5HZXRTZWxlY3Rpb24oY1N0cmluZyk7Ci0gICAgaWYg
KE5TX0ZBSUxFRChydikgfHwgY1N0cmluZy5Jc0VtcHR5KCkpCi0gICAgICByZXR1cm4gbnNudWxs
OwotICAgIHJ2ID0gTlNfT0s7Ci0gIH0KLSAgaWYgKHJ2ID09IE5TX09LKSB7Ci0gICAgcmV0dXJu
IE5TX0NvbnZlcnRVVEYxNnRvVVRGOChjU3RyaW5nKS5nZXQoKTsKLSAgfQotICByZXR1cm4gbnNu
dWxsOwotfQotCi1uc3Jlc3VsdAotRW1iZWRDb250ZXh0TWVudUluZm86OkNoZWNrRG9tSW1hZ2VF
bGVtZW50KG5zSURPTU5vZGUgKm5vZGUsIG5zU3RyaW5nJiBhSHJlZiwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUkludDMyICphV2lkdGgsIFBSSW50MzIgKmFI
ZWlnaHQpCi17Ci0gIG5zcmVzdWx0IHJ2ID0gTlNfRVJST1JfRkFJTFVSRTsKLSAgbnNDT01QdHI8
bnNJRE9NSFRNTEltYWdlRWxlbWVudD4gaW1hZ2UgPQotICAgIGRvX1F1ZXJ5SW50ZXJmYWNlKG5v
ZGUsICZydik7Ci0gIGlmIChpbWFnZSkgewotICAgIHJ2ID0gaW1hZ2UtPkdldFNyYyhhSHJlZik7
Ci0gICAgaWYgKE5TX0ZBSUxFRChydikpIHsKLSAgICAgIHJldHVybiBydjsKLSAgICB9Ci0gICAg
cnYgPSBpbWFnZS0+R2V0V2lkdGgoYVdpZHRoKTsKLSAgICBydiA9IGltYWdlLT5HZXRIZWlnaHQo
YUhlaWdodCk7Ci0gICAgcnYgPSBOU19PSzsKLSAgfQotICByZXR1cm4gcnY7Ci19Ci0KLW5zcmVz
dWx0Ci1FbWJlZENvbnRleHRNZW51SW5mbzo6R2V0SW1hZ2VSZXF1ZXN0KGltZ0lSZXF1ZXN0ICoq
YVJlcXVlc3QsIG5zSURPTU5vZGUgKmFET01Ob2RlKQotewotICBOU19FTlNVUkVfQVJHKGFET01O
b2RlKTsKLSAgTlNfRU5TVVJFX0FSR19QT0lOVEVSKGFSZXF1ZXN0KTsKLQotICAvLyBHZXQgY29u
dGVudAotICBuc0NPTVB0cjxuc0lJbWFnZUxvYWRpbmdDb250ZW50PiBjb250ZW50KGRvX1F1ZXJ5
SW50ZXJmYWNlKGFET01Ob2RlKSk7Ci0gIE5TX0VOU1VSRV9UUlVFKGNvbnRlbnQsIE5TX0VSUk9S
X0ZBSUxVUkUpOwotCi0gIHJldHVybiBjb250ZW50LT5HZXRSZXF1ZXN0KG5zSUltYWdlTG9hZGlu
Z0NvbnRlbnQ6OkNVUlJFTlRfUkVRVUVTVCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YVJlcXVlc3QpOwotfQotCi1uc3Jlc3VsdAotRW1iZWRDb250ZXh0TWVudUluZm86OkNoZWNrRG9t
SHRtbE5vZGUobnNJRE9NTm9kZSAqYU5vZGUpCi17Ci0gIG5zcmVzdWx0IHJ2ID0gTlNfRVJST1Jf
RkFJTFVSRTsKLSAgbnNTdHJpbmcgdVRhZzsKLSAgUFJVaW50MTYgZG5vZGVfdHlwZTsKLQotICBu
c0NPTVB0cjxuc0lET01Ob2RlPiBub2RlOwotICBpZiAoIWFOb2RlICYmIG1FdmVudE5vZGUpCi0g
ICAgbm9kZSA9IG1FdmVudE5vZGU7Ci0gIG5zQ09NUHRyPG5zSURPTUhUTUxFbGVtZW50PiBlbGVt
ZW50ICA9IGRvX1F1ZXJ5SW50ZXJmYWNlKG5vZGUsICZydik7Ci0gIGlmICghZWxlbWVudCkgewot
ICAgIGVsZW1lbnQgPSBkb19RdWVyeUludGVyZmFjZShtT3JpZ05vZGUsICZydik7Ci0gICAgaWYg
KGVsZW1lbnQpIHsKLSAgICAgIG5vZGUgPSBtT3JpZ05vZGU7Ci0gICAgICBlbGVtZW50ICA9IGRv
X1F1ZXJ5SW50ZXJmYWNlKG5vZGUsICZydik7Ci0gICAgfQotICB9Ci0KLSAgcnYgPSBub2RlLT5H
ZXROb2RlVHlwZSgmZG5vZGVfdHlwZSk7Ci0gIGlmIChOU19GQUlMRUQocnYpKSB7Ci0gICAgcmV0
dXJuIHJ2OwotICB9Ci0KLSAgaWYgKCEoKG5zSURPTU5vZGU6OkVMRU1FTlRfTk9ERSA9PSBkbm9k
ZV90eXBlKSAmJiBlbGVtZW50KSkgewotICAgIHJldHVybiBydjsKLSAgfQotICBuc0NPTVB0cjxu
c0lET01OU0hUTUxFbGVtZW50PiBub2RlRWxlbWVudCA9IGRvX1F1ZXJ5SW50ZXJmYWNlKG5vZGUs
ICZydik7Ci0gIGlmIChOU19TVUNDRUVERUQocnYpICYmIG5vZGVFbGVtZW50KSB7Ci0gICAgbU5T
SEhUTUxFbGVtZW50ID0gbm9kZUVsZW1lbnQ7Ci0gIH0gZWxzZSB7Ci0gICAgbU5TSEhUTUxFbGVt
ZW50ID0gbnNudWxsOwotICB9Ci0gIHJ2ID0gZWxlbWVudC0+R2V0TG9jYWxOYW1lKHVUYWcpOwot
ICBpZiAoTlNfRkFJTEVEKHJ2KSkgewotICAgIHJldHVybiBydjsKLSAgfQotICBpZiAodVRhZy5M
b3dlckNhc2VFcXVhbHNMaXRlcmFsKCJvYmplY3QiKSkgewotICB9Ci0gIGVsc2UgaWYgKHVUYWcu
TG93ZXJDYXNlRXF1YWxzTGl0ZXJhbCgiaHRtbCIpKSB7Ci0gIH0KLSAgZWxzZSBpZiAodVRhZy5M
b3dlckNhc2VFcXVhbHNMaXRlcmFsKCJhIikpIHsKLSAgICBuc0NPTVB0cjxuc0lET01IVE1MQW5j
aG9yRWxlbWVudD4gYW5jaG9yID0gZG9fUXVlcnlJbnRlcmZhY2Uobm9kZSk7Ci0gICAgYW5jaG9y
LT5HZXRIcmVmKG1DdHhIcmVmKTsKLSAgICBtRW1iZWRDdHhUeXBlIHw9IEdUS19NT1pfRU1CRURf
Q1RYX0xJTks7Ci0gICAgaWYgKGFuY2hvciAmJiAhbUN0eEhyZWYuSXNFbXB0eSgpKSB7Ci0gICAg
ICBpZiAobUN0eEhyZWYuTG93ZXJDYXNlRXF1YWxzTGl0ZXJhbCgidGV4dC9zbWFydGJvb2ttYXJr
IikpIHsKLSAgICAgICAgbnNDT01QdHI8bnNJRE9NTm9kZT4gY2hpbGROb2RlOwotICAgICAgICBu
b2RlLT5HZXRGaXJzdENoaWxkKGdldHRlcl9BZGRSZWZzKGNoaWxkTm9kZSkpOwotICAgICAgICBp
ZiAoY2hpbGROb2RlKSB7Ci0gICAgICAgICAgUFJJbnQzMiB3aWR0aCwgaGVpZ2h0OwotICAgICAg
ICAgIHJ2ID0gQ2hlY2tEb21JbWFnZUVsZW1lbnQobm9kZSwgbUN0eEltZ0hyZWYsICZ3aWR0aCwg
JmhlaWdodCk7Ci0gICAgICAgICAgaWYgKE5TX1NVQ0NFRURFRChydikpCi0gICAgICAgICAgICBt
RW1iZWRDdHhUeXBlIHw9IEdUS19NT1pfRU1CRURfQ1RYX0lNQUdFOwotICAgICAgICB9Ci0gICAg
ICB9IGVsc2UgaWYgKFN0cmluZ0JlZ2luc1dpdGgobUN0eEhyZWYsIE5TX0xJVEVSQUxfU1RSSU5H
KCJtYWlsdG86IikpKSB7Ci0gICAgICAgIG1FbWJlZEN0eFR5cGUgfD0gR1RLX01PWl9FTUJFRF9D
VFhfRU1BSUw7Ci0gICAgICB9Ci0gICAgfQotICB9Ci0gIGVsc2UgaWYgKHVUYWcuTG93ZXJDYXNl
RXF1YWxzTGl0ZXJhbCgiYXJlYSIpKSB7Ci0gICAgbnNDT01QdHI8bnNJRE9NSFRNTEFyZWFFbGVt
ZW50PiBhcmVhID0gZG9fUXVlcnlJbnRlcmZhY2Uobm9kZSwgJnJ2KTsKLSAgICBpZiAoTlNfU1VD
Q0VFREVEKHJ2KSAmJiBhcmVhKSB7Ci0gICAgICBQUkJvb2wgYU5vSHJlZiA9IFBSX0ZBTFNFOwot
ICAgICAgcnYgPSBhcmVhLT5HZXROb0hyZWYoJmFOb0hyZWYpOwotICAgICAgaWYgKCFhTm9IcmVm
KQotICAgICAgICBydiA9IGFyZWEtPkdldEhyZWYobUN0eEhyZWYpOwotICAgICAgZWxzZQotICAg
ICAgICBydiA9IGFyZWEtPkdldFRhcmdldChtQ3R4SHJlZik7Ci0gICAgICBtRW1iZWRDdHhUeXBl
IHw9IEdUS19NT1pfRU1CRURfQ1RYX0xJTks7Ci0gICAgICBydiA9IE5TX09LOwotICAgIH0KLSAg
fQotICBlbHNlIGlmICh1VGFnLkxvd2VyQ2FzZUVxdWFsc0xpdGVyYWwoImltZyIpKSB7Ci0gICAg
UFJJbnQzMiB3aWR0aCwgaGVpZ2h0OwotICAgIHJ2ID0gQ2hlY2tEb21JbWFnZUVsZW1lbnQobm9k
ZSwgbUN0eEltZ0hyZWYsICZ3aWR0aCwgJmhlaWdodCk7Ci0gICAgaWYgKE5TX1NVQ0NFRURFRChy
dikpCi0gICAgICBtRW1iZWRDdHhUeXBlIHw9IEdUS19NT1pfRU1CRURfQ1RYX0lNQUdFOwotICB9
IGVsc2UgewotICAgIHJ2ID0gTlNfRVJST1JfRkFJTFVSRTsKLSAgfQotICByZXR1cm4gcnY7Ci19
Ci0KLW5zcmVzdWx0Ci1FbWJlZENvbnRleHRNZW51SW5mbzo6VXBkYXRlQ29udGV4dERhdGEodm9p
ZCAqYUV2ZW50KQotewotICBOU19FTlNVUkVfQVJHX1BPSU5URVIoYUV2ZW50KTsKLSAgbnNyZXN1
bHQgcnY7Ci0gIG5zQ09NUHRyPG5zSURPTUV2ZW50PiBldmVudCA9IGRvX1F1ZXJ5SW50ZXJmYWNl
KChuc0lTdXBwb3J0cyopYUV2ZW50LCAmcnYpOwotICBpZiAoTlNfRkFJTEVEKHJ2KSB8fCAhZXZl
bnQpCi0gICAgcmV0dXJuIE5TX0VSUk9SX0ZBSUxVUkU7Ci0gIHJldHVybiBVcGRhdGVDb250ZXh0
RGF0YShldmVudCk7Ci19Ci0KLW5zcmVzdWx0Ci1FbWJlZENvbnRleHRNZW51SW5mbzo6R2V0RWxl
bWVudEZvclNjcm9sbChuc0lET01FdmVudCAqYUV2ZW50KQotewotICBpZiAoIWFFdmVudCkgcmV0
dXJuIE5TX0VSUk9SX1VORVhQRUNURUQ7Ci0gIG5zQ09NUHRyPG5zSURPTU5TRXZlbnQ+IG5zZXZl
bnQoZG9fUXVlcnlJbnRlcmZhY2UoYUV2ZW50KSk7Ci0gIG5zQ09NUHRyPG5zSURPTUV2ZW50VGFy
Z2V0PiB0YXJnZXQ7Ci0gIG5zZXZlbnQtPkdldE9yaWdpbmFsVGFyZ2V0KGdldHRlcl9BZGRSZWZz
KHRhcmdldCkpOwotICBpZiAoIXRhcmdldCkgcmV0dXJuIE5TX0VSUk9SX1VORVhQRUNURUQ7Ci0g
IG5zQ09NUHRyPG5zSURPTU5vZGU+IHRhcmdldERPTU5vZGUoZG9fUXVlcnlJbnRlcmZhY2UodGFy
Z2V0KSk7Ci0gIGlmICghdGFyZ2V0RE9NTm9kZSkgcmV0dXJuIE5TX0VSUk9SX1VORVhQRUNURUQ7
Ci0gIG5zQ09NUHRyPG5zSURPTURvY3VtZW50PiB0YXJnZXRET01Eb2N1bWVudDsKLSAgdGFyZ2V0
RE9NTm9kZS0+R2V0T3duZXJEb2N1bWVudChnZXR0ZXJfQWRkUmVmcyh0YXJnZXRET01Eb2N1bWVu
dCkpOwotICBpZiAoIXRhcmdldERPTURvY3VtZW50KSByZXR1cm4gTlNfRVJST1JfVU5FWFBFQ1RF
RDsKLSAgcmV0dXJuIEdldEVsZW1lbnRGb3JTY3JvbGwodGFyZ2V0RE9NRG9jdW1lbnQpOwotfQot
Ci1uc3Jlc3VsdAotRW1iZWRDb250ZXh0TWVudUluZm86OkdldEVsZW1lbnRGb3JTY3JvbGwobnNJ
RE9NRG9jdW1lbnQgKnRhcmdldERPTURvY3VtZW50KQotewotICBuc0NPTVB0cjxuc0lET01FbGVt
ZW50PiB0YXJnZXRET01FbGVtZW50OwotICB0YXJnZXRET01Eb2N1bWVudC0+R2V0RG9jdW1lbnRF
bGVtZW50KGdldHRlcl9BZGRSZWZzKHRhcmdldERPTUVsZW1lbnQpKTsKLSAgaWYgKCF0YXJnZXRE
T01FbGVtZW50KSByZXR1cm4gTlNfRVJST1JfVU5FWFBFQ1RFRDsKLSAgbnNTdHJpbmcgYm9keU5h
bWUoTlNfTElURVJBTF9TVFJJTkcoImJvZHkiKSk7Ci0gIG5zQ09NUHRyPG5zSURPTU5vZGVMaXN0
PiBib2R5TGlzdDsKLSAgdGFyZ2V0RE9NRWxlbWVudC0+R2V0RWxlbWVudHNCeVRhZ05hbWUoYm9k
eU5hbWUsIGdldHRlcl9BZGRSZWZzKGJvZHlMaXN0KSk7Ci0gIFBSVWludDMyIGkgPSAwOwotICBi
b2R5TGlzdC0+R2V0TGVuZ3RoKCZpKTsKLSAgaWYgKGkpIHsKLSAgICBuc0NPTVB0cjxuc0lET01O
b2RlPiBkb21Cb2R5Tm9kZTsKLSAgICBib2R5TGlzdC0+SXRlbSgwLCBnZXR0ZXJfQWRkUmVmcyhk
b21Cb2R5Tm9kZSkpOwotICAgIGlmICghZG9tQm9keU5vZGUpIHJldHVybiBOU19FUlJPUl9VTkVY
UEVDVEVEOwotICAgIG1OU0hIVE1MRWxlbWVudFNjID0gZG9fUXVlcnlJbnRlcmZhY2UoZG9tQm9k
eU5vZGUpOwotICAgIGlmICghbU5TSEhUTUxFbGVtZW50U2MpIHJldHVybiBOU19FUlJPUl9VTkVY
UEVDVEVEOwotICB9Ci0gIHJldHVybiBOU19PSzsKLX0KLQotbnNyZXN1bHQKLUVtYmVkQ29udGV4
dE1lbnVJbmZvOjpVcGRhdGVDb250ZXh0RGF0YShuc0lET01FdmVudCAqYURPTUV2ZW50KQotewot
ICBpZiAobUN0eEV2ZW50ID09IGFET01FdmVudCkKLSAgICByZXR1cm4gTlNfT0s7Ci0KLSAgbnNy
ZXN1bHQgcnYgPSBuc251bGw7Ci0gIG1DdHhFdmVudCA9IGFET01FdmVudDsKLSAgTlNfRU5TVVJF
X0FSR19QT0lOVEVSKG1DdHhFdmVudCk7Ci0KLSAgUFJVaW50MTYgZXZlbnRwaGFzZTsKLSAgbUN0
eEV2ZW50LT5HZXRFdmVudFBoYXNlKCZldmVudHBoYXNlKTsKLSAgaWYgKCFldmVudHBoYXNlKSB7
Ci0gICAgbUN0eEV2ZW50ID0gbnNudWxsOwotICAgIHJldHVybiBOU19FUlJPUl9GQUlMVVJFOwot
ICB9Ci0KLSAgbnNDT01QdHI8bnNJRE9NRXZlbnRUYXJnZXQ+IG9yaWdpbmFsVGFyZ2V0ID0gbnNu
dWxsOwotICBuc0NPTVB0cjxuc0lET01Ob2RlPiBvcmlnaW5hbE5vZGUgPSBuc251bGw7Ci0KLSAg
bnNDT01QdHI8bnNJRE9NTlNFdmVudD4gYUV2ZW50ID0gZG9fUXVlcnlJbnRlcmZhY2UobUN0eEV2
ZW50LCAmcnYpOwotICBpZiAoTlNfRkFJTEVEKHJ2KSB8fCAhYUV2ZW50KQotICAgIHJldHVybiBO
U19PSzsKLQotICBuc0NPTVB0cjxuc0lET01Nb3VzZUV2ZW50PiBtb3VzZUV2ZW50KGRvX1F1ZXJ5
SW50ZXJmYWNlKG1DdHhFdmVudCwgJnJ2KSk7Ci0gIGlmIChtb3VzZUV2ZW50KSB7Ci0gICAgKChu
c0lET01Nb3VzZUV2ZW50Kiltb3VzZUV2ZW50KS0+R2V0Q2xpZW50WCgmbVgpOwotICAgICgobnNJ
RE9NTW91c2VFdmVudCopbW91c2VFdmVudCktPkdldENsaWVudFkoJm1ZKTsKLSAgfQotCi0gIGlm
IChhRXZlbnQpCi0gICAgcnYgPSBhRXZlbnQtPkdldE9yaWdpbmFsVGFyZ2V0KGdldHRlcl9BZGRS
ZWZzKG9yaWdpbmFsVGFyZ2V0KSk7Ci0gIG9yaWdpbmFsTm9kZSA9IGRvX1F1ZXJ5SW50ZXJmYWNl
KG9yaWdpbmFsVGFyZ2V0KTsKLSAgaWYgKE5TX0ZBSUxFRChydikgfHwgIW9yaWdpbmFsTm9kZSkK
LSAgICByZXR1cm4gTlNfRVJST1JfTlVMTF9QT0lOVEVSOwotCi0gIC8vICAgIG5zcmVzdWx0IFNl
bFRleHQgPSBtT3duZXItPkNsaXBCb2FyZEFjdGlvbihHVEtfTU9aX0VNQkVEX0NBTl9DT1BZKTsK
LSAgaWYgKG9yaWdpbmFsTm9kZSA9PSBtT3JpZ05vZGUpCi0gICAgcmV0dXJuIE5TX09LOwotCi0g
IG1FbWJlZEN0eFR5cGUgPSBHVEtfTU9aX0VNQkVEX0NUWF9OT05FOwotICBtT3JpZ05vZGUgPSBv
cmlnaW5hbE5vZGU7Ci0gIGlmIChtT3JpZ05vZGUpIHsKLSAgICBuc1N0cmluZyBTT3JpZ05vZGU7
Ci0gICAgbU9yaWdOb2RlLT5HZXROb2RlTmFtZShTT3JpZ05vZGUpOwotICAgIGlmIChTT3JpZ05v
ZGUuRXF1YWxzTGl0ZXJhbCgiI2RvY3VtZW50IikpCi0gICAgICByZXR1cm4gTlNfT0s7Ci0gICAg
aWYgKFNPcmlnTm9kZS5FcXVhbHNMaXRlcmFsKCJ4dWw6dGh1bWIiKQotICAgICAgICB8fCBTT3Jp
Z05vZGUuRXF1YWxzTGl0ZXJhbCgieHVsOnNsaWRlciIpCi0gICAgICAgIHx8IFNPcmlnTm9kZS5F
cXVhbHNMaXRlcmFsKCJ4dWw6c2Nyb2xsYmFyYnV0dG9uIikKLSAgICAgICAgfHwgU09yaWdOb2Rl
LkVxdWFsc0xpdGVyYWwoInh1bDp2Ym94IikKLSAgICAgICAgfHwgU09yaWdOb2RlLkVxdWFsc0xp
dGVyYWwoInh1bDpzcGFjZXIiKSkgewotICAgICAgbUVtYmVkQ3R4VHlwZSB8PSBHVEtfTU9aX0VN
QkVEX0NUWF9YVUw7Ci0gICAgICByZXR1cm4gTlNfT0s7Ci0gICAgfQotICB9Ci0gIGlmIChtQ3R4
RXZlbnQpCi0gICAgcnYgPSBtQ3R4RXZlbnQtPkdldFRhcmdldChnZXR0ZXJfQWRkUmVmcyhtRXZl
bnRUYXJnZXQpKTsKLSAgaWYgKE5TX0ZBSUxFRChydikgfHwgIW1FdmVudFRhcmdldCkgewotICAg
IHJldHVybiBOU19PSzsKLSAgfQotICBuc0NPTVB0cjxuc0lET01Ob2RlPiBldmVudE5vZGUgPSBk
b19RdWVyeUludGVyZmFjZShtRXZlbnRUYXJnZXQsICZydik7Ci0gIG1FdmVudE5vZGUgPSBldmVu
dE5vZGU7Ci0gIC8vRnJhbWUgU3R1ZmYKLSAgbnNDT01QdHI8bnNJRE9NRG9jdW1lbnQ+IGRvbURv
YzsKLSAgaWYgKG1FdmVudE5vZGUpCi0gICAgcnYgPSBtRXZlbnROb2RlLT5HZXRPd25lckRvY3Vt
ZW50KGdldHRlcl9BZGRSZWZzKGRvbURvYykpOwotICBpZiAoIU5TX1NVQ0NFRURFRChydikgfHwg
IWRvbURvYykgewotICAgIC8vICByZXR1cm4gTlNfT0s7Ci0gIH0KLSAgaWYgKE5TX1NVQ0NFRURF
RChydikgJiYgZG9tRG9jICYmIG1DdHhEb2N1bWVudCAhPSBkb21Eb2MpIHsKLSAgICBtQ3R4RG9j
dW1lbnQgPSBkb21Eb2M7Ci0gICAgbU5TSEhUTUxFbGVtZW50U2MgPSBuc251bGw7Ci0gICAgbUN0
eERvY3VtZW50LT5HZXREb2N1bWVudFVSSShtQ3R4VVJJKTsKLSAgICBOU19FTlNVUkVfQVJHX1BP
SU5URVIobU93bmVyKTsKLSAgICBuc0NPTVB0cjxuc0lXZWJCcm93c2VyPiB3ZWJCcm93c2VyOwot
ICAgIG1Pd25lci0+bVdpbmRvdy0+R2V0V2ViQnJvd3NlcihnZXR0ZXJfQWRkUmVmcyh3ZWJCcm93
c2VyKSk7Ci0gICAgd2ViQnJvd3Nlci0+R2V0Q29udGVudERPTVdpbmRvdyhnZXR0ZXJfQWRkUmVm
cyhtQ3R4RG9tV2luZG93KSk7Ci0gICAgbnNDT01QdHI8bnNJRE9NRG9jdW1lbnQ+IG1haW5Eb2N1
bWVudDsKLSAgICBtQ3R4RG9tV2luZG93LT5HZXREb2N1bWVudChnZXR0ZXJfQWRkUmVmcyhtYWlu
RG9jdW1lbnQpKTsKLSAgICBpZiAoIW1haW5Eb2N1bWVudCkgewotICAgICAgcmV0dXJuIE5TX09L
OwotICAgIH0KLSAgICBtQ3R4RnJhbWVOdW0gPSAtMTsKLSAgICBpZiAobWFpbkRvY3VtZW50ICE9
IGRvbURvYykgewotICAgICAgbUVtYmVkQ3R4VHlwZSB8PSBHVEtfTU9aX0VNQkVEX0NUWF9JRlJB
TUU7Ci0gICAgICBTZXRGcmFtZUluZGV4KCk7Ci0gICAgfQotICB9Ci0gIG5zQ09NUHRyPG5zSURP
TUVsZW1lbnQ+IHRhcmdldERPTUVsZW1lbnQ7Ci0gIG1DdHhEb2N1bWVudC0+R2V0RG9jdW1lbnRF
bGVtZW50KGdldHRlcl9BZGRSZWZzKHRhcmdldERPTUVsZW1lbnQpKTsKLSAgaWYgKCF0YXJnZXRE
T01FbGVtZW50KSByZXR1cm4gTlNfRVJST1JfVU5FWFBFQ1RFRDsKLSAgbnNDT01QdHI8bnNJRE9N
TlNIVE1MRG9jdW1lbnQ+IGh0bWxEb2MgPSBkb19RdWVyeUludGVyZmFjZShtQ3R4RG9jdW1lbnQp
OwotICBpZiAoaHRtbERvYykgewotICAgIG5zU3RyaW5nIERNb2RlOwotICAgIGh0bWxEb2MtPkdl
dERlc2lnbk1vZGUoRE1vZGUpOwotICAgIGlmIChETW9kZS5FcXVhbHNMaXRlcmFsKCJvbiIpKSB7
Ci0gICAgICBtRW1iZWRDdHhUeXBlIHw9IEdUS19NT1pfRU1CRURfQ1RYX0lOUFVUOwotICAgICAg
bUVtYmVkQ3R4VHlwZSB8PSBHVEtfTU9aX0VNQkVEX0NUWF9SSUNIRURJVDsKLSAgICB9Ci0gIH0K
LSAgbnNDT01QdHI8bnNJRG9jdW1lbnQ+IGRvYyA9IGRvX1F1ZXJ5SW50ZXJmYWNlKG1DdHhEb2N1
bWVudCk7Ci0gIGlmICghZG9jKQotICAgIHJldHVybiBOU19PSzsKLSAgbnNJUHJlc1NoZWxsICpw
cmVzU2hlbGwgPSBkb2MtPkdldFNoZWxsKCk7Ci0gIGlmICghcHJlc1NoZWxsKQotICAgIHJldHVy
biBOU19PSzsKLSAgbnNDT01QdHI8bnNJQ29udGVudD4gdGdDb250ZW50ID0gZG9fUXVlcnlJbnRl
cmZhY2UobUV2ZW50VGFyZ2V0KTsKLSAgbnNJRnJhbWUqIGZyYW1lID0gbnNudWxsOwotI2lmIGRl
ZmluZWQoRklYRURfQlVHMzQ3NzMxKSB8fCAhZGVmaW5lZChNT1pfRU5BQkxFX0xJQlhVTCkKLSAg
aWYgKG1FbWJlZEN0eFR5cGUgJiBHVEtfTU9aX0VNQkVEX0NUWF9SSUNIRURJVCkKLSAgICBmcmFt
ZSA9IHByZXNTaGVsbC0+R2V0Um9vdEZyYW1lKCk7Ci0gIGVsc2UgaWYgKHRnQ29udGVudC0+R2V0
RG9jdW1lbnQoKSA9PSBwcmVzU2hlbGwtPkdldERvY3VtZW50KCkpIHsKLSAgICBmcmFtZSA9IHRn
Q29udGVudC0+R2V0UHJpbWFyeUZyYW1lKCk7Ci0gIH0KLSAgaWYgKGZyYW1lKSB7Ci0gICAgbUZv
cm1SZWN0ID0gZnJhbWUtPkdldFNjcmVlblJlY3RFeHRlcm5hbCgpOwotICB9Ci0jZW5kaWYKLSAg
aWYgKE5TX1NVQ0NFRURFRChTZXRGb3JtQ29udHJvbFR5cGUobUV2ZW50VGFyZ2V0KSkpIHsKLSAg
ICByZXR1cm4gTlNfT0s7Ci0gIH0KLSAgQ2hlY2tEb21IdG1sTm9kZSgpOwotICBuc0NPTVB0cjxu
c0lET01Ob2RlPiBub2RlID0gbUV2ZW50Tm9kZTsKLSAgbnNDT01QdHI8bnNJRE9NTm9kZT4gcGFy
ZW50Tm9kZTsKLSAgbm9kZS0+R2V0UGFyZW50Tm9kZShnZXR0ZXJfQWRkUmVmcyhwYXJlbnROb2Rl
KSk7Ci0gIG5vZGUgPSBwYXJlbnROb2RlOwotICB3aGlsZSAobm9kZSkgewotICAgIGlmIChOU19G
QUlMRUQoQ2hlY2tEb21IdG1sTm9kZSgpKSkKLSAgICAgIGJyZWFrOwotICAgIG5vZGUtPkdldFBh
cmVudE5vZGUoZ2V0dGVyX0FkZFJlZnMocGFyZW50Tm9kZSkpOwotICAgIG5vZGUgPSBwYXJlbnRO
b2RlOwotICB9Ci0gIG1FbWJlZEN0eFR5cGUgfD0gR1RLX01PWl9FTUJFRF9DVFhfRE9DVU1FTlQ7
Ci0gIHJldHVybiBOU19PSzsKLX0KZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9z
cmMvRW1iZWRDb250ZXh0TWVudUluZm8uaCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1i
ZWRDb250ZXh0TWVudUluZm8uaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRk
aW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZENvbnRleHRNZW51SW5mby5oCisrKyAvZGV2L251bGwK
QEAgLTEsMTAxICswLDAgQEAKLS8qIC0qLSBNb2RlOiBDKys7IHRhYi13aWR0aDogMjsgaW5kZW50
LXRhYnMtbW9kZTogbmlsOyBjLWJhc2ljLW9mZnNldDogMiAtKi0gKi8KLS8qIHZpbTpzZXQgdHM9
MiBzdz0yIHN0cz0yIHR3PTgwIGV0IGNpbmRlbnQ6ICovCi0vKgotICogKioqKiogQkVHSU4gTElD
RU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4wL0xHUEwgMi4xCi0g
KgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0byB0aGUgTW96aWxs
YSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5
IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgKLSAqIHRoZSBMaWNl
bnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLSAqIGh0dHA6Ly93
d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRo
ZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMsCi0gKiBXSVRIT1VU
IFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhl
IExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHJpZ2h0cyBh
bmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoKLSAqIFRoZSBPcmlnaW5h
bCBDb2RlIGlzIHRoZSBNb3ppbGxhIGJyb3dzZXIuCi0gKgotICogVGhlIE9yaWdpbmFsIENvZGUg
aXMgbW96aWxsYS5vcmcgY29kZS4KLSAqCi0gKiBUaGUgSW5pdGlhbCBEZXZlbG9wZXIgb2YgdGhl
IE9yaWdpbmFsIENvZGUgaXMKLSAqIE9sZWcgUm9tYXNoaW4uCi0gKiBQb3J0aW9ucyBjcmVhdGVk
IGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDA2Ci0gKiB0aGUg
SW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0
b3Iocyk6Ci0gKiAgIE9sZWcgUm9tYXNoaW4gPHJvbWF4YUBnbWFpbC5jb20+Ci0gKgotICogQWx0
ZXJuYXRpdmVseSwgdGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0
aGUgdGVybXMgb2YKLSAqIGVpdGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVy
c2lvbiAyIG9yIGxhdGVyICh0aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBp
biB3aGljaCBjYXNlIHRoZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFw
cGxpY2FibGUgaW5zdGVhZAotICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93
IHVzZSBvZiB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJt
cyBvZiBlaXRoZXIgdGhlIEdQTCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMg
dG8KLSAqIHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgTVBMLCBpbmRpY2F0ZSB5b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlz
aW9ucyBhYm92ZSBhbmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVy
IHByb3Zpc2lvbnMgcmVxdWlyZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5v
dCBkZWxldGUKLSAqIHRoZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlv
dXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9m
IHRoZSBNUEwsIHRoZSBHUEwgb3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0Ug
QkxPQ0sgKioqKiogKi8KLSNpZm5kZWYgRW1iZWRDb250ZXh0TWVudUluZm9faF9fCi0jZGVmaW5l
IEVtYmVkQ29udGV4dE1lbnVJbmZvX2hfXwotI2luY2x1ZGUgIm5zQ09NUHRyLmgiCi0jaW5jbHVk
ZSAibnNJRE9NTm9kZS5oIgotI2luY2x1ZGUgIm5zSURPTUV2ZW50LmgiCi0jaW5jbHVkZSAiaW1n
SUNvbnRhaW5lci5oIgotI2luY2x1ZGUgImltZ0lSZXF1ZXN0LmgiCi0jaW5jbHVkZSAibnNJRE9N
RXZlbnRUYXJnZXQuaCIKLSNpbmNsdWRlICJuc1JlY3QuaCIKLS8vIGZvciBzdHJpbmdzCi0jaWZk
ZWYgTU9aSUxMQV9JTlRFUk5BTF9BUEkKLSNpbmNsdWRlICJuc1hQSURMU3RyaW5nLmgiCi0jaW5j
bHVkZSAibnNSZWFkYWJsZVV0aWxzLmgiCi0jZW5kaWYKLSNpbmNsdWRlICJFbWJlZFdpbmRvdy5o
IgotI2luY2x1ZGUgIm5zSURPTU5TSFRNTEVsZW1lbnQuaCIKLS8vKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioKLS8vIGNsYXNzIEVtYmVkQ29udGV4dE1lbnVJbmZvCi0vLwotLy8qKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKgotY2xhc3MgRW1iZWRDb250ZXh0TWVudUluZm8gOiBwdWJsaWMgbnNJU3VwcG9ydHMKLXsK
LXB1YmxpYzoKLSAgRW1iZWRDb250ZXh0TWVudUluZm8oRW1iZWRQcml2YXRlICphT3duZXIpOwot
ICB2aXJ0dWFsIH5FbWJlZENvbnRleHRNZW51SW5mbyh2b2lkKTsKLSAgTlNfREVDTF9JU1VQUE9S
VFMKLSAgbnNyZXN1bHQgICAgICAgICAgR2V0Rm9ybUNvbnRyb2xUeXBlKG5zSURPTUV2ZW50ICph
RE9NRXZlbnQpOwotICBuc3Jlc3VsdCAgICAgICAgICBVcGRhdGVDb250ZXh0RGF0YShuc0lET01F
dmVudCAqYURPTUV2ZW50KTsKLSAgbnNyZXN1bHQgICAgICAgICAgVXBkYXRlQ29udGV4dERhdGEo
dm9pZCAqYUV2ZW50KTsKLSAgY29uc3QgY2hhciogICAgICAgR2V0U2VsZWN0ZWRUZXh0KCk7Ci0g
IG5zcmVzdWx0ICAgICAgICAgIEdldEVsZW1lbnRGb3JTY3JvbGwobnNJRE9NRG9jdW1lbnQgKnRh
cmdldERPTURvY3VtZW50KTsKLSAgbnNyZXN1bHQgICAgICAgICAgR2V0RWxlbWVudEZvclNjcm9s
bChuc0lET01FdmVudCAqYUV2ZW50KTsKLSAgbnNyZXN1bHQgICAgICAgICAgQ2hlY2tEb21JbWFn
ZUVsZW1lbnQobnNJRE9NTm9kZSAqbm9kZSwgbnNTdHJpbmcmIGFIcmVmLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJbnQzMiAqYVdpZHRoLCBQUkludDMyICphSGVp
Z2h0KTsKLSAgbnNyZXN1bHQgICAgICAgICAgR2V0SW1hZ2VSZXF1ZXN0KGltZ0lSZXF1ZXN0ICoq
YVJlcXVlc3QsIG5zSURPTU5vZGUgKmFET01Ob2RlKTsKLSAgbnNTdHJpbmcgICAgICAgICAgR2V0
Q3R4RG9jVGl0bGUodm9pZCkgeyByZXR1cm4gbUN0eERvY1RpdGxlOyB9Ci0KLQotICBQUkludDMy
ICAgICAgICAgICAgICAgICBtWCwgbVksIG1PYmpXaWR0aCwgbU9iakhlaWdodCwgbUN0eEZyYW1l
TnVtOwotICBuc1N0cmluZyAgICAgICAgICAgICAgICBtQ3R4VVJJLCBtQ3R4SHJlZiwgbUN0eElt
Z0hyZWY7Ci0gIFBSVWludDMyICAgICAgICAgICAgICAgIG1FbWJlZEN0eFR5cGU7Ci0gIFBSSW50
MzIgbUN0eEZvcm1UeXBlOwotICBuc0NPTVB0cjxuc0lET01Ob2RlPiAgICBtRXZlbnROb2RlOwot
ICBuc0NPTVB0cjxuc0lET01FdmVudFRhcmdldD4gbUV2ZW50VGFyZ2V0OwotICBuc0NPTVB0cjxu
c0lET01Eb2N1bWVudD5tQ3R4RG9jdW1lbnQ7Ci0gIG5zSW50UmVjdCAgICAgICAgICAgICAgIG1G
b3JtUmVjdDsKLSAgbnNDT01QdHI8bnNJRE9NV2luZG93PiAgbUN0eERvbVdpbmRvdzsKLSAgbnND
T01QdHI8bnNJRE9NRXZlbnQ+ICAgbUN0eEV2ZW50OwotICBuc0NPTVB0cjxuc0lET01OU0hUTUxF
bGVtZW50PiBtTlNISFRNTEVsZW1lbnQ7Ci0gIG5zQ09NUHRyPG5zSURPTU5TSFRNTEVsZW1lbnQ+
IG1OU0hIVE1MRWxlbWVudFNjOwotcHJpdmF0ZToKLSAgbnNyZXN1bHQgICAgICAgICAgU2V0RnJh
bWVJbmRleCgpOwotICBuc3Jlc3VsdCAgICAgICAgICBTZXRGb3JtQ29udHJvbFR5cGUobnNJRE9N
RXZlbnRUYXJnZXQgKm9yaWdpbmFsVGFyZ2V0KTsKLSAgbnNyZXN1bHQgICAgICAgICAgQ2hlY2tE
b21IdG1sTm9kZShuc0lET01Ob2RlICphTm9kZSA9IG5zbnVsbCk7Ci0KLSAgRW1iZWRQcml2YXRl
ICAgICAgICAgICAqbU93bmVyOwotICBuc0NPTVB0cjxuc0lET01Ob2RlPiAgICBtT3JpZ05vZGU7
Ci0gIG5zU3RyaW5nICAgICAgICAgICAgICAgIG1DdHhEb2NUaXRsZTsKLX07IC8vIGNsYXNzIEVt
YmVkQ29udGV4dE1lbnVJbmZvCi0jZW5kaWYgLy8gRW1iZWRDb250ZXh0TWVudUluZm9faF9fCmRp
ZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkRXZlbnRMaXN0ZW5lci5j
cHAgYi9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkRXZlbnRMaXN0ZW5lci5jcHAKZGVs
ZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Ci0tLSBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1i
ZWRFdmVudExpc3RlbmVyLmNwcAorKysgL2Rldi9udWxsCkBAIC0xLDMwNCArMCwwIEBACi0vKiAq
KioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0gKiBWZXJzaW9uOiBNUEwgMS4xL0dQTCAy
LjAvTEdQTCAyLjEKLSAqCi0gKiBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0
IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KLSAqIDEuMSAodGhlICJMaWNl
bnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0
aAotICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBh
dAotICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCi0gKgotICogU29mdHdhcmUgZGlzdHJp
YnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNp
cywKLSAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt
cGxpZWQuIFNlZSB0aGUgTGljZW5zZQotICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zl
cm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKLSAqIExpY2Vuc2UuCi0gKgot
ICogVGhlIE9yaWdpbmFsIENvZGUgaXMgbW96aWxsYS5vcmcgY29kZS4KLSAqCi0gKiBUaGUgSW5p
dGlhbCBEZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMKLSAqIENocmlzdG9waGVyIEJs
aXp6YXJkLgotICogUG9ydGlvbnMgY3JlYXRlZCBieSB0aGUgSW5pdGlhbCBEZXZlbG9wZXIgYXJl
IENvcHlyaWdodCAoQykgMjAwMQotICogdGhlIEluaXRpYWwgRGV2ZWxvcGVyLiBBbGwgUmlnaHRz
IFJlc2VydmVkLgotICoKLSAqIENvbnRyaWJ1dG9yKHMpOgotICogICBDaHJpc3RvcGhlciBCbGl6
emFyZCA8YmxpenphcmRAbW96aWxsYS5vcmc+Ci0gKgotICogQWx0ZXJuYXRpdmVseSwgdGhlIGNv
bnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YKLSAqIGVp
dGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyIG9yIGxhdGVyICh0
aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBW
ZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBpbiB3aGljaCBjYXNlIHRoZSBw
cm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFwcGxpY2FibGUgaW5zdGVhZAot
ICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93IHVzZSBvZiB5b3VyIHZlcnNp
b24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJtcyBvZiBlaXRoZXIgdGhlIEdQ
TCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMgdG8KLSAqIHVzZSB5b3VyIHZl
cnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTVBMLCBpbmRpY2F0ZSB5
b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlzaW9ucyBhYm92ZSBhbmQgcmVw
bGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVyIHByb3Zpc2lvbnMgcmVxdWly
ZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5vdCBkZWxldGUKLSAqIHRoZSBw
cm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlz
IGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9mIHRoZSBNUEwsIHRoZSBHUEwg
b3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8KLQot
I2luY2x1ZGUgIm5zQ09NUHRyLmgiCi0jaW5jbHVkZSAibnNJRE9NTW91c2VFdmVudC5oIgotCi0j
aW5jbHVkZSAibnNJRE9NS2V5RXZlbnQuaCIKLSNpbmNsdWRlICJuc0lET01VSUV2ZW50LmgiCi0K
LSNpbmNsdWRlICJFbWJlZEV2ZW50TGlzdGVuZXIuaCIKLSNpbmNsdWRlICJFbWJlZFByaXZhdGUu
aCIKLQotRW1iZWRFdmVudExpc3RlbmVyOjpFbWJlZEV2ZW50TGlzdGVuZXIodm9pZCkKLXsKLSAg
bU93bmVyID0gbnNudWxsOwotfQotCi1FbWJlZEV2ZW50TGlzdGVuZXI6On5FbWJlZEV2ZW50TGlz
dGVuZXIoKQotewotfQotCi1OU19JTVBMX0FERFJFRihFbWJlZEV2ZW50TGlzdGVuZXIpCi1OU19J
TVBMX1JFTEVBU0UoRW1iZWRFdmVudExpc3RlbmVyKQotTlNfSU5URVJGQUNFX01BUF9CRUdJTihF
bWJlZEV2ZW50TGlzdGVuZXIpCi0gIE5TX0lOVEVSRkFDRV9NQVBfRU5UUllfQU1CSUdVT1VTKG5z
SVN1cHBvcnRzLCBuc0lET01LZXlMaXN0ZW5lcikKLSAgTlNfSU5URVJGQUNFX01BUF9FTlRSWV9B
TUJJR1VPVVMobnNJRE9NRXZlbnRMaXN0ZW5lciwgbnNJRE9NS2V5TGlzdGVuZXIpCi0gIE5TX0lO
VEVSRkFDRV9NQVBfRU5UUlkobnNJRE9NS2V5TGlzdGVuZXIpCi0gIE5TX0lOVEVSRkFDRV9NQVBf
RU5UUlkobnNJRE9NTW91c2VMaXN0ZW5lcikKLSAgTlNfSU5URVJGQUNFX01BUF9FTlRSWShuc0lE
T01VSUxpc3RlbmVyKQotTlNfSU5URVJGQUNFX01BUF9FTkQKLQotbnNyZXN1bHQKLUVtYmVkRXZl
bnRMaXN0ZW5lcjo6SW5pdChFbWJlZFByaXZhdGUgKmFPd25lcikKLXsKLSAgbU93bmVyID0gYU93
bmVyOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkRXZlbnRMaXN0
ZW5lcjo6SGFuZGxlRXZlbnQobnNJRE9NRXZlbnQqIGFET01FdmVudCkKLXsKLSAgcmV0dXJuIE5T
X09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZEV2ZW50TGlzdGVuZXI6OktleURvd24obnNJ
RE9NRXZlbnQqIGFET01FdmVudCkKLXsKLSAgbnNDT01QdHIgPG5zSURPTUtleUV2ZW50PiBrZXlF
dmVudDsKLSAga2V5RXZlbnQgPSBkb19RdWVyeUludGVyZmFjZShhRE9NRXZlbnQpOwotICBpZiAo
IWtleUV2ZW50KQotICAgIHJldHVybiBOU19PSzsKLSAgLy8gUmV0dXJuIEZBTFNFIHRvIHRoaXMg
ZnVuY3Rpb24gdG8gbWFyayB0aGUgZXZlbnQgYXMgbm90Ci0gIC8vIGNvbnN1bWVkLi4uCi0gIGdp
bnQgcmV0dXJuX3ZhbCA9IEZBTFNFOwotICBnX3NpZ25hbF9lbWl0KEdfT0JKRUNUKG1Pd25lci0+
bU93bmluZ1dpZGdldCksCi0gICAgICAgICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNbRE9NX0tF
WV9ET1dOXSwgMCwKLSAgICAgICAgICAgICAgICAodm9pZCAqKWtleUV2ZW50LCAmcmV0dXJuX3Zh
bCk7Ci0gIGlmIChyZXR1cm5fdmFsKSB7Ci0gICAgYURPTUV2ZW50LT5TdG9wUHJvcGFnYXRpb24o
KTsKLSAgICBhRE9NRXZlbnQtPlByZXZlbnREZWZhdWx0KCk7Ci0gIH0KLSAgcmV0dXJuIE5TX09L
OwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZEV2ZW50TGlzdGVuZXI6OktleVVwKG5zSURPTUV2
ZW50KiBhRE9NRXZlbnQpCi17Ci0gIG5zQ09NUHRyIDxuc0lET01LZXlFdmVudD4ga2V5RXZlbnQ7
Ci0gIGtleUV2ZW50ID0gZG9fUXVlcnlJbnRlcmZhY2UoYURPTUV2ZW50KTsKLSAgaWYgKCFrZXlF
dmVudCkKLSAgICByZXR1cm4gTlNfT0s7Ci0gIC8vIHJldHVybiBGQUxTRSB0byB0aGlzIGZ1bmN0
aW9uIHRvIG1hcmsgdGhpcyBldmVudCBhcyBub3QKLSAgLy8gY29uc3VtZWQuLi4KLSAgZ2ludCBy
ZXR1cm5fdmFsID0gRkFMU0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3du
aW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tET01fS0VZX1VQ
XSwgMCwKLSAgICAgICAgICAgICAgICAodm9pZCAqKWtleUV2ZW50LCAmcmV0dXJuX3ZhbCk7Ci0g
IGlmIChyZXR1cm5fdmFsKSB7Ci0gICAgYURPTUV2ZW50LT5TdG9wUHJvcGFnYXRpb24oKTsKLSAg
ICBhRE9NRXZlbnQtPlByZXZlbnREZWZhdWx0KCk7Ci0gIH0KLSAgcmV0dXJuIE5TX09LOwotfQot
Ci1OU19JTUVUSE9ESU1QCi1FbWJlZEV2ZW50TGlzdGVuZXI6OktleVByZXNzKG5zSURPTUV2ZW50
KiBhRE9NRXZlbnQpCi17Ci0gIG5zQ09NUHRyIDxuc0lET01LZXlFdmVudD4ga2V5RXZlbnQ7Ci0g
IGtleUV2ZW50ID0gZG9fUXVlcnlJbnRlcmZhY2UoYURPTUV2ZW50KTsKLSAgaWYgKCFrZXlFdmVu
dCkKLSAgICByZXR1cm4gTlNfT0s7Ci0gIC8vIFJldHVybiBUUlVFIGZyb20geW91ciBzaWduYWwg
aGFuZGxlciB0byBtYXJrIHRoZSBldmVudCBhcyBjb25zdW1lZC4KLSAgZ2ludCByZXR1cm5fdmFs
ID0gRkFMU0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0
KSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tET01fS0VZX1BSRVNTXSwgMCwK
LSAgICAgICAgICAgICAgICAodm9pZCAqKWtleUV2ZW50LCAmcmV0dXJuX3ZhbCk7Ci0gIGlmIChy
ZXR1cm5fdmFsKSB7Ci0gICAgYURPTUV2ZW50LT5TdG9wUHJvcGFnYXRpb24oKTsKLSAgICBhRE9N
RXZlbnQtPlByZXZlbnREZWZhdWx0KCk7Ci0gIH0KLSAgcmV0dXJuIE5TX09LOwotfQotCi1OU19J
TUVUSE9ESU1QCi1FbWJlZEV2ZW50TGlzdGVuZXI6Ok1vdXNlRG93bihuc0lET01FdmVudCogYURP
TUV2ZW50KQotewotICBuc0NPTVB0ciA8bnNJRE9NTW91c2VFdmVudD4gbW91c2VFdmVudDsKLSAg
bW91c2VFdmVudCA9IGRvX1F1ZXJ5SW50ZXJmYWNlKGFET01FdmVudCk7Ci0gIGlmICghbW91c2VF
dmVudCkKLSAgICByZXR1cm4gTlNfT0s7Ci0gIC8vIFJldHVybiBUUlVFIGZyb20geW91ciBzaWdu
YWwgaGFuZGxlciB0byBtYXJrIHRoZSBldmVudCBhcyBjb25zdW1lZC4KLSAgZ2ludCByZXR1cm5f
dmFsID0gRkFMU0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lk
Z2V0KSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tET01fTU9VU0VfRE9XTl0s
IDAsCi0gICAgICAgICAgICAgICAgKHZvaWQgKiltb3VzZUV2ZW50LCAmcmV0dXJuX3ZhbCk7Ci0g
IGlmIChyZXR1cm5fdmFsKSB7Ci0gICAgYURPTUV2ZW50LT5TdG9wUHJvcGFnYXRpb24oKTsKLSAg
ICBhRE9NRXZlbnQtPlByZXZlbnREZWZhdWx0KCk7Ci0gIH0KLSAgcmV0dXJuIE5TX09LOwotfQot
Ci1OU19JTUVUSE9ESU1QCi1FbWJlZEV2ZW50TGlzdGVuZXI6Ok1vdXNlVXAobnNJRE9NRXZlbnQq
IGFET01FdmVudCkKLXsKLSAgbnNDT01QdHIgPG5zSURPTU1vdXNlRXZlbnQ+IG1vdXNlRXZlbnQ7
Ci0gIG1vdXNlRXZlbnQgPSBkb19RdWVyeUludGVyZmFjZShhRE9NRXZlbnQpOwotICBpZiAoIW1v
dXNlRXZlbnQpCi0gICAgcmV0dXJuIE5TX09LOwotICAvLyBSZXR1cm4gVFJVRSBmcm9tIHlvdXIg
c2lnbmFsIGhhbmRsZXIgdG8gbWFyayB0aGUgZXZlbnQgYXMgY29uc3VtZWQuCi0gIGdpbnQgcmV0
dXJuX3ZhbCA9IEZBTFNFOwotICBnX3NpZ25hbF9lbWl0KEdfT0JKRUNUKG1Pd25lci0+bU93bmlu
Z1dpZGdldCksCi0gICAgICAgICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX1VQ
XSwgMCwKLSAgICAgICAgICAgICAgICAodm9pZCAqKW1vdXNlRXZlbnQsICZyZXR1cm5fdmFsKTsK
LSAgaWYgKHJldHVybl92YWwpIHsKLSAgICBhRE9NRXZlbnQtPlN0b3BQcm9wYWdhdGlvbigpOwot
ICAgIGFET01FdmVudC0+UHJldmVudERlZmF1bHQoKTsKLSAgfQotICByZXR1cm4gTlNfT0s7Ci19
Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkRXZlbnRMaXN0ZW5lcjo6TW91c2VDbGljayhuc0lET01F
dmVudCogYURPTUV2ZW50KQotewotICBuc0NPTVB0ciA8bnNJRE9NTW91c2VFdmVudD4gbW91c2VF
dmVudDsKLSAgbW91c2VFdmVudCA9IGRvX1F1ZXJ5SW50ZXJmYWNlKGFET01FdmVudCk7Ci0gIGlm
ICghbW91c2VFdmVudCkKLSAgICByZXR1cm4gTlNfT0s7Ci0gIC8vIFJldHVybiBUUlVFIGZyb20g
eW91ciBzaWduYWwgaGFuZGxlciB0byBtYXJrIHRoZSBldmVudCBhcyBjb25zdW1lZC4KLSAgZ2lu
dCByZXR1cm5fdmFsID0gRkFMU0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5t
T3duaW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tET01fTU9V
U0VfQ0xJQ0tdLCAwLAotICAgICAgICAgICAgICAgICh2b2lkICopbW91c2VFdmVudCwgJnJldHVy
bl92YWwpOwotICBpZiAocmV0dXJuX3ZhbCkgewotICAgIGFET01FdmVudC0+U3RvcFByb3BhZ2F0
aW9uKCk7Ci0gICAgYURPTUV2ZW50LT5QcmV2ZW50RGVmYXVsdCgpOwotICB9Ci0gIHJldHVybiBO
U19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRFdmVudExpc3RlbmVyOjpNb3VzZURibENs
aWNrKG5zSURPTUV2ZW50KiBhRE9NRXZlbnQpCi17Ci0gIG5zQ09NUHRyIDxuc0lET01Nb3VzZUV2
ZW50PiBtb3VzZUV2ZW50OwotICBtb3VzZUV2ZW50ID0gZG9fUXVlcnlJbnRlcmZhY2UoYURPTUV2
ZW50KTsKLSAgaWYgKCFtb3VzZUV2ZW50KQotICAgIHJldHVybiBOU19PSzsKLSAgLy8gUmV0dXJu
IFRSVUUgZnJvbSB5b3VyIHNpZ25hbCBoYW5kbGVyIHRvIG1hcmsgdGhlIGV2ZW50IGFzIGNvbnN1
bWVkLgotICBnaW50IHJldHVybl92YWwgPSBGQUxTRTsKLSAgZ19zaWduYWxfZW1pdChHX09CSkVD
VChtT3duZXItPm1Pd25pbmdXaWRnZXQpLAotICAgICAgICAgICAgICAgIG1vel9lbWJlZF9zaWdu
YWxzW0RPTV9NT1VTRV9EQkxfQ0xJQ0tdLCAwLAotICAgICAgICAgICAgICAgICh2b2lkICopbW91
c2VFdmVudCwgJnJldHVybl92YWwpOwotICBpZiAocmV0dXJuX3ZhbCkgewotICAgIGFET01FdmVu
dC0+U3RvcFByb3BhZ2F0aW9uKCk7Ci0gICAgYURPTUV2ZW50LT5QcmV2ZW50RGVmYXVsdCgpOwot
ICB9Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRFdmVudExpc3Rl
bmVyOjpNb3VzZU92ZXIobnNJRE9NRXZlbnQqIGFET01FdmVudCkKLXsKLSAgbnNDT01QdHIgPG5z
SURPTU1vdXNlRXZlbnQ+IG1vdXNlRXZlbnQ7Ci0gIG1vdXNlRXZlbnQgPSBkb19RdWVyeUludGVy
ZmFjZShhRE9NRXZlbnQpOwotICBpZiAoIW1vdXNlRXZlbnQpCi0gICAgcmV0dXJuIE5TX09LOwot
ICAvLyBSZXR1cm4gVFJVRSBmcm9tIHlvdXIgc2lnbmFsIGhhbmRsZXIgdG8gbWFyayB0aGUgZXZl
bnQgYXMgY29uc3VtZWQuCi0gIGdpbnQgcmV0dXJuX3ZhbCA9IEZBTFNFOwotICBnX3NpZ25hbF9l
bWl0KEdfT0JKRUNUKG1Pd25lci0+bU93bmluZ1dpZGdldCksCi0gICAgICAgICAgICAgICAgbW96
X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX09WRVJdLCAwLAotICAgICAgICAgICAgICAgICh2b2lk
ICopbW91c2VFdmVudCwgJnJldHVybl92YWwpOwotICBpZiAocmV0dXJuX3ZhbCkgewotICAgIGFE
T01FdmVudC0+U3RvcFByb3BhZ2F0aW9uKCk7Ci0gICAgYURPTUV2ZW50LT5QcmV2ZW50RGVmYXVs
dCgpOwotICB9Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRFdmVu
dExpc3RlbmVyOjpNb3VzZU91dChuc0lET01FdmVudCogYURPTUV2ZW50KQotewotICBuc0NPTVB0
ciA8bnNJRE9NTW91c2VFdmVudD4gbW91c2VFdmVudDsKLSAgbW91c2VFdmVudCA9IGRvX1F1ZXJ5
SW50ZXJmYWNlKGFET01FdmVudCk7Ci0gIGlmICghbW91c2VFdmVudCkKLSAgICByZXR1cm4gTlNf
T0s7Ci0gIC8vIFJldHVybiBUUlVFIGZyb20geW91ciBzaWduYWwgaGFuZGxlciB0byBtYXJrIHRo
ZSBldmVudCBhcyBjb25zdW1lZC4KLSAgZ2ludCByZXR1cm5fdmFsID0gRkFMU0U7Ci0gIGdfc2ln
bmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAg
ICBtb3pfZW1iZWRfc2lnbmFsc1tET01fTU9VU0VfT1VUXSwgMCwKLSAgICAgICAgICAgICAgICAo
dm9pZCAqKW1vdXNlRXZlbnQsICZyZXR1cm5fdmFsKTsKLSAgaWYgKHJldHVybl92YWwpIHsKLSAg
ICBhRE9NRXZlbnQtPlN0b3BQcm9wYWdhdGlvbigpOwotICAgIGFET01FdmVudC0+UHJldmVudERl
ZmF1bHQoKTsKLSAgfQotICByZXR1cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVk
RXZlbnRMaXN0ZW5lcjo6QWN0aXZhdGUobnNJRE9NRXZlbnQqIGFET01FdmVudCkKLXsKLSAgbnND
T01QdHIgPG5zSURPTVVJRXZlbnQ+IHVpRXZlbnQgPSBkb19RdWVyeUludGVyZmFjZShhRE9NRXZl
bnQpOwotICBpZiAoIXVpRXZlbnQpCi0gICAgcmV0dXJuIE5TX09LOwotICAvLyBSZXR1cm4gVFJV
RSBmcm9tIHlvdXIgc2lnbmFsIGhhbmRsZXIgdG8gbWFyayB0aGUgZXZlbnQgYXMgY29uc3VtZWQu
Ci0gIGdpbnQgcmV0dXJuX3ZhbCA9IEZBTFNFOwotICBnX3NpZ25hbF9lbWl0KEdfT0JKRUNUKG1P
d25lci0+bU93bmluZ1dpZGdldCksCi0gICAgICAgICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNb
RE9NX0FDVElWQVRFXSwgMCwKLSAgICAgICAgICAgICAgICAodm9pZCAqKXVpRXZlbnQsICZyZXR1
cm5fdmFsKTsKLSAgaWYgKHJldHVybl92YWwpIHsKLSAgICBhRE9NRXZlbnQtPlN0b3BQcm9wYWdh
dGlvbigpOwotICAgIGFET01FdmVudC0+UHJldmVudERlZmF1bHQoKTsKLSAgfQotICByZXR1cm4g
TlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkRXZlbnRMaXN0ZW5lcjo6Rm9jdXNJbihu
c0lET01FdmVudCogYURPTUV2ZW50KQotewotICBuc0NPTVB0ciA8bnNJRE9NVUlFdmVudD4gdWlF
dmVudCA9IGRvX1F1ZXJ5SW50ZXJmYWNlKGFET01FdmVudCk7Ci0gIGlmICghdWlFdmVudCkKLSAg
ICByZXR1cm4gTlNfT0s7Ci0gIC8vIFJldHVybiBUUlVFIGZyb20geW91ciBzaWduYWwgaGFuZGxl
ciB0byBtYXJrIHRoZSBldmVudCBhcyBjb25zdW1lZC4KLSAgZ2ludCByZXR1cm5fdmFsID0gRkFM
U0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwKLSAg
ICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tET01fRk9DVVNfSU5dLCAwLAotICAgICAg
ICAgICAgICAgICh2b2lkICopdWlFdmVudCwgJnJldHVybl92YWwpOwotICBpZiAocmV0dXJuX3Zh
bCkgewotICAgIGFET01FdmVudC0+U3RvcFByb3BhZ2F0aW9uKCk7Ci0gICAgYURPTUV2ZW50LT5Q
cmV2ZW50RGVmYXVsdCgpOwotICB9Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElN
UAotRW1iZWRFdmVudExpc3RlbmVyOjpGb2N1c091dChuc0lET01FdmVudCogYURPTUV2ZW50KQot
ewotICBuc0NPTVB0ciA8bnNJRE9NVUlFdmVudD4gdWlFdmVudCA9IGRvX1F1ZXJ5SW50ZXJmYWNl
KGFET01FdmVudCk7Ci0gIGlmICghdWlFdmVudCkKLSAgICByZXR1cm4gTlNfT0s7Ci0gIC8vIFJl
dHVybiBUUlVFIGZyb20geW91ciBzaWduYWwgaGFuZGxlciB0byBtYXJrIHRoZSBldmVudCBhcyBj
b25zdW1lZC4KLSAgZ2ludCByZXR1cm5fdmFsID0gRkFMU0U7Ci0gIGdfc2lnbmFsX2VtaXQoR19P
QkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRf
c2lnbmFsc1tET01fRk9DVVNfT1VUXSwgMCwKLSAgICAgICAgICAgICAgICAodm9pZCAqKXVpRXZl
bnQsICZyZXR1cm5fdmFsKTsKLSAgaWYgKHJldHVybl92YWwpIHsKLSAgICBhRE9NRXZlbnQtPlN0
b3BQcm9wYWdhdGlvbigpOwotICAgIGFET01FdmVudC0+UHJldmVudERlZmF1bHQoKTsKLSAgfQot
ICByZXR1cm4gTlNfT0s7Ci19CmRpZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3Jj
L0VtYmVkRXZlbnRMaXN0ZW5lci5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZEV2
ZW50TGlzdGVuZXIuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jy
b3dzZXIvZ3RrL3NyYy9FbWJlZEV2ZW50TGlzdGVuZXIuaAorKysgL2Rldi9udWxsCkBAIC0xLDkw
ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKLSAqIFZlcnNpb246
IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZp
bGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbgotICog
MS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4g
Y29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9m
IHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8KLSAqCi0gKiBT
b2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBh
biAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVy
IGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBmb3IgdGhlIHNwZWNpZmlj
IGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQotICog
TGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3ppbGxhLm9yZyBjb2RlLgot
ICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBpcwotICog
Q2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFs
IERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAxCi0gKiB0aGUgSW5pdGlhbCBEZXZlbG9w
ZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0b3Iocyk6Ci0gKiAgIENo
cmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3ppbGxhLm9yZz4KLSAqCi0gKiBBbHRlcm5h
dGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0
ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9u
IDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdo
aWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGlj
YWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNl
IG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhlIHRlcm1zIG9m
IGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90aGVycyB0bwot
ICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBN
UEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25z
IGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJv
dmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRl
bGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2
ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhl
IE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9D
SyAqKioqKiAqLwotCi0jaWZuZGVmIF9fRW1iZWRFdmVudExpc3RlbmVyX2gKLSNkZWZpbmUgX19F
bWJlZEV2ZW50TGlzdGVuZXJfaAotCi0jaW5jbHVkZSAibnNJRE9NS2V5TGlzdGVuZXIuaCIKLSNp
bmNsdWRlICJuc0lET01Nb3VzZUxpc3RlbmVyLmgiCi0jaW5jbHVkZSAibnNJRE9NVUlMaXN0ZW5l
ci5oIgotCi1jbGFzcyBFbWJlZFByaXZhdGU7Ci0KLWNsYXNzIEVtYmVkRXZlbnRMaXN0ZW5lciA6
IHB1YmxpYyBuc0lET01LZXlMaXN0ZW5lciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1
YmxpYyBuc0lET01Nb3VzZUxpc3RlbmVyLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVi
bGljIG5zSURPTVVJTGlzdGVuZXIKLXsKLSBwdWJsaWM6Ci0KLSAgRW1iZWRFdmVudExpc3RlbmVy
KCk7Ci0gIHZpcnR1YWwgfkVtYmVkRXZlbnRMaXN0ZW5lcigpOwotCi0gIG5zcmVzdWx0IEluaXQo
RW1iZWRQcml2YXRlICphT3duZXIpOwotCi0gIE5TX0RFQ0xfSVNVUFBPUlRTCi0KLSAgLy8gbnNJ
RE9NRXZlbnRMaXN0ZW5lcgotCi0gIE5TX0lNRVRIT0QgSGFuZGxlRXZlbnQobnNJRE9NRXZlbnQq
IGFFdmVudCk7Ci0KLSAgLy8gbnNJRE9NS2V5TGlzdGVuZXIKLSAgCi0gIE5TX0lNRVRIT0QgS2V5
RG93bihuc0lET01FdmVudCogYURPTUV2ZW50KTsKLSAgTlNfSU1FVEhPRCBLZXlVcChuc0lET01F
dmVudCogYURPTUV2ZW50KTsKLSAgTlNfSU1FVEhPRCBLZXlQcmVzcyhuc0lET01FdmVudCogYURP
TUV2ZW50KTsKLQotICAvLyBuc0lET01Nb3VzZUxpc3RlbmVyCi0KLSAgTlNfSU1FVEhPRCBNb3Vz
ZURvd24obnNJRE9NRXZlbnQqIGFET01FdmVudCk7Ci0gIE5TX0lNRVRIT0QgTW91c2VVcChuc0lE
T01FdmVudCogYURPTUV2ZW50KTsKLSAgTlNfSU1FVEhPRCBNb3VzZUNsaWNrKG5zSURPTUV2ZW50
KiBhRE9NRXZlbnQpOwotICBOU19JTUVUSE9EIE1vdXNlRGJsQ2xpY2sobnNJRE9NRXZlbnQqIGFE
T01FdmVudCk7Ci0gIE5TX0lNRVRIT0QgTW91c2VPdmVyKG5zSURPTUV2ZW50KiBhRE9NRXZlbnQp
OwotICBOU19JTUVUSE9EIE1vdXNlT3V0KG5zSURPTUV2ZW50KiBhRE9NRXZlbnQpOwotCi0gIC8v
IG5zSURPTVVJTGlzdGVuZXIKLQotICBOU19JTUVUSE9EIEFjdGl2YXRlKG5zSURPTUV2ZW50KiBh
RE9NRXZlbnQpOwotICBOU19JTUVUSE9EIEZvY3VzSW4obnNJRE9NRXZlbnQqIGFET01FdmVudCk7
Ci0gIE5TX0lNRVRIT0QgRm9jdXNPdXQobnNJRE9NRXZlbnQqIGFET01FdmVudCk7Ci0KLSBwcml2
YXRlOgotCi0gIEVtYmVkUHJpdmF0ZSAqbU93bmVyOwotfTsKLQotI2VuZGlmIC8qIF9fRW1iZWRF
dmVudExpc3RlbmVyX2ggKi8KZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMv
RW1iZWRHdGtUb29scy5jcHAgYi9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkR3RrVG9v
bHMuY3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9n
dGsvc3JjL0VtYmVkR3RrVG9vbHMuY3BwCisrKyAvZGV2L251bGwKQEAgLTEsODggKzAsMCBAQAot
LyogLSotIE1vZGU6IEMrKzsgdGFiLXdpZHRoOiAyOyBpbmRlbnQtdGFicy1tb2RlOiBuaWw7IGMt
YmFzaWMtb2Zmc2V0OiAyIC0qLSAqLwotLyogdmltOnNldCB0cz0yIHN3PTQgc3RzPTIgdHc9ODAg
ZXQgY2luZGVudDogKi8KLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKLSAqIFZl
cnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250ZW50cyBvZiB0
aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lv
bgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNl
cHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBj
b3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8KLSAq
Ci0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRl
ZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwg
ZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBmb3IgdGhlIHNw
ZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRo
ZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3ppbGxhLm9yZyBj
b2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBp
cwotICogT2xlZyBSb21hc2hpbi4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwg
RGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIwMDYKLSAqIHRoZSBJbml0aWFsIERldmVsb3Bl
ci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICAgT2xl
ZyBSb21hc2hpbiA8cm9tYXhhQGdtYWlsLmNvbT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUg
Y29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICog
ZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIg
KHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhl
IHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFk
Ci0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVy
c2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUg
R1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIg
dmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRl
IHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCBy
ZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1
aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhl
IHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRo
aXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQ
TCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwot
Ci0jaW5jbHVkZSAiRW1iZWRHdGtUb29scy5oIgotI2lmbmRlZiBNT1pJTExBX0lOVEVSTkFMX0FQ
SQotI2luY2x1ZGUgIm5zU2VydmljZU1hbmFnZXJVdGlscy5oIgotI2VuZGlmCi0jaW5jbHVkZSAi
RW1iZWRQcml2YXRlLmgiCi0KLUd0a1dpZGdldCAqIEdldEd0a1dpZGdldEZvckRPTVdpbmRvdyhu
c0lET01XaW5kb3cqIGFET01XaW5kb3cpCi17Ci0gIG5zQ09NUHRyPG5zSVdpbmRvd1dhdGNoZXI+
IHd3YXRjaCA9IGRvX0dldFNlcnZpY2UoIkBtb3ppbGxhLm9yZy9lbWJlZGNvbXAvd2luZG93LXdh
dGNoZXI7MSIpOwotICBpZiAoIWFET01XaW5kb3cpCi0gICAgcmV0dXJuIE5VTEw7Ci0gIG5zQ09N
UHRyPG5zSVdlYkJyb3dzZXJDaHJvbWU+IGNocm9tZTsKLSAgd3dhdGNoLT5HZXRDaHJvbWVGb3JX
aW5kb3coYURPTVdpbmRvdywgZ2V0dGVyX0FkZFJlZnMoY2hyb21lKSk7Ci0gIGlmICghY2hyb21l
KSB7Ci0gICAgcmV0dXJuIEdUS19XSURHRVQoRW1iZWRDb21tb246OkdldEFueUxpdmVXaWRnZXQo
KSk7Ci0gIH0KLQotICBuc0NPTVB0cjxuc0lFbWJlZGRpbmdTaXRlV2luZG93PiBzaXRlV2luZG93
ID0gbnNudWxsOwotICBzaXRlV2luZG93ID0gZG9fUXVlcnlJbnRlcmZhY2UoY2hyb21lKTsKLQot
ICBpZiAoIXNpdGVXaW5kb3cpIHsKLSAgICByZXR1cm4gR1RLX1dJREdFVChFbWJlZENvbW1vbjo6
R2V0QW55TGl2ZVdpZGdldCgpKTsKLSAgfQotCi0gIEd0a1dpZGdldCogcGFyZW50V2lkZ2V0Owot
ICBzaXRlV2luZG93LT5HZXRTaXRlV2luZG93KCh2b2lkKiopJnBhcmVudFdpZGdldCk7Ci0gIGlm
IChHVEtfSVNfV0lER0VUKHBhcmVudFdpZGdldCkpCi0gICAgcmV0dXJuIHBhcmVudFdpZGdldDsK
LSAgcmV0dXJuIE5VTEw7Ci19Ci0KLUd0a1dpbmRvdyAqIEdldEd0a1dpbmRvd0ZvckRPTVdpbmRv
dyhuc0lET01XaW5kb3cqIGFET01XaW5kb3cpCi17Ci0gIEd0a1dpZGdldCogcGFyZW50V2lkZ2V0
ID0gR2V0R3RrV2lkZ2V0Rm9yRE9NV2luZG93KGFET01XaW5kb3cpOwotICBpZiAoIXBhcmVudFdp
ZGdldCkKLSAgICByZXR1cm4gTlVMTDsKLSAgR3RrV2lkZ2V0KiBndGtXaW4gPSBndGtfd2lkZ2V0
X2dldF90b3BsZXZlbChwYXJlbnRXaWRnZXQpOwotICBpZiAoR1RLX1dJREdFVF9UT1BMRVZFTChn
dGtXaW4pKQotICAgIHJldHVybiBHVEtfV0lORE9XKGd0a1dpbik7Ci0gIHJldHVybiBOVUxMOwot
fQotCi1uc3Jlc3VsdCBHZXRDb250ZW50Vmlld2VyKG5zSVdlYkJyb3dzZXIgKndlYkJyb3dzZXIs
IG5zSUNvbnRlbnRWaWV3ZXIgKiphVmlld2VyKQotewotICBnX3JldHVybl92YWxfaWZfZmFpbCh3
ZWJCcm93c2VyLCBOU19FUlJPUl9GQUlMVVJFKTsKLSAgbnNDT01QdHI8bnNJRG9jU2hlbGw+IGRv
Y1NoZWxsKGRvX0dldEludGVyZmFjZSgobnNJU3VwcG9ydHMqKXdlYkJyb3dzZXIpKTsKLSAgTlNf
RU5TVVJFX1RSVUUoZG9jU2hlbGwsIE5TX0VSUk9SX0ZBSUxVUkUpOwotICByZXR1cm4gZG9jU2hl
bGwtPkdldENvbnRlbnRWaWV3ZXIoYVZpZXdlcik7Ci19CmRpZmYgLS1naXQgYS9lbWJlZGRpbmcv
YnJvd3Nlci9ndGsvc3JjL0VtYmVkR3RrVG9vbHMuaCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9z
cmMvRW1iZWRHdGtUb29scy5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkR3RrVG9vbHMuaAorKysgL2Rldi9udWxsCkBAIC0xLDY3
ICswLDAgQEAKLS8qIC0qLSBNb2RlOiBDKys7IHRhYi13aWR0aDogMjsgaW5kZW50LXRhYnMtbW9k
ZTogbmlsOyBjLWJhc2ljLW9mZnNldDogMiAtKi0gKi8KLS8qIHZpbTpzZXQgdHM9MiBzdz0yIHN0
cz0yIGV0IGNpbmRlbnQ6ICovCi0vKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0g
KiBWZXJzaW9uOiBNUEwgMS4xL0dQTCAyLjAvTEdQTCAyLjEKLSAqCi0gKiBUaGUgY29udGVudHMg
b2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZl
cnNpb24KLSAqIDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUg
ZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aAotICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWlu
IGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAotICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwv
Ci0gKgotICogU29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJp
YnV0ZWQgb24gYW4gIkFTIElTIiBiYXNpcywKLSAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJ
TkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZQotICogZm9yIHRo
ZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRl
ciB0aGUKLSAqIExpY2Vuc2UuCi0gKgotICogVGhlIE9yaWdpbmFsIENvZGUgaXMgbW96aWxsYS5v
cmcgY29kZS4KLSAqCi0gKiBUaGUgSW5pdGlhbCBEZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENv
ZGUgaXMKLSAqIE9sZWcgUm9tYXNoaW4uCi0gKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0
aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDA2Ci0gKiB0aGUgSW5pdGlhbCBEZXZl
bG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0b3Iocyk6Ci0gKiAg
IE9sZWcgUm9tYXNoaW4gPHJvbWF4YUBnbWFpbC5jb20+Ci0gKgotICogQWx0ZXJuYXRpdmVseSwg
dGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YK
LSAqIGVpdGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyIG9yIGxh
dGVyICh0aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBWZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBpbiB3aGljaCBjYXNl
IHRoZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFwcGxpY2FibGUgaW5z
dGVhZAotICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93IHVzZSBvZiB5b3Vy
IHZlcnNpb24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJtcyBvZiBlaXRoZXIg
dGhlIEdQTCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMgdG8KLSAqIHVzZSB5
b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTVBMLCBpbmRp
Y2F0ZSB5b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlzaW9ucyBhYm92ZSBh
bmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVyIHByb3Zpc2lvbnMg
cmVxdWlyZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5vdCBkZWxldGUKLSAq
IHRoZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlvdXIgdmVyc2lvbiBv
ZiB0aGlzIGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9mIHRoZSBNUEwsIHRo
ZSBHUEwgb3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiog
Ki8KLSNpZm5kZWYgX19FbWJlZFRvb2xzX2gKLSNkZWZpbmUgX19FbWJlZFRvb2xzX2gKLQotI2lu
Y2x1ZGUgIm5zQ09NUHRyLmgiCi0jaWZkZWYgTU9aSUxMQV9JTlRFUk5BTF9BUEkKLSNpbmNsdWRl
ICJuc1N0cmluZy5oIgotI2Vsc2UKLSNpbmNsdWRlICJuc1N0cmluZ0FQSS5oIgotI2VuZGlmCi0j
aW5jbHVkZSAibnNJRE9NV2luZG93LmgiCi0jaW5jbHVkZSAibnNJV2luZG93V2F0Y2hlci5oIgot
I2luY2x1ZGUgIm5zSVdlYkJyb3dzZXJDaHJvbWUuaCIKLSNpbmNsdWRlICJuc0lFbWJlZGRpbmdT
aXRlV2luZG93LmgiCi0jaW5jbHVkZSAibnNJU2VydmljZU1hbmFnZXIuaCIKLSNpbmNsdWRlICJu
c0lDb250ZW50Vmlld2VyLmgiCi0jaW5jbHVkZSAibnNJRG9jU2hlbGwuaCIKLSNpbmNsdWRlICJu
c0lJbnRlcmZhY2VSZXF1ZXN0b3JVdGlscy5oIgotI2luY2x1ZGUgPGd0ay9ndGsuaD4KLQotR3Rr
V2lkZ2V0KgotR2V0R3RrV2lkZ2V0Rm9yRE9NV2luZG93KG5zSURPTVdpbmRvdyogYURPTVdpbmRv
dyk7Ci0KLUd0a1dpbmRvdyoKLUdldEd0a1dpbmRvd0ZvckRPTVdpbmRvdyhuc0lET01XaW5kb3cq
IGFET01XaW5kb3cpOwotCi1uc3Jlc3VsdAotR2V0Q29udGVudFZpZXdlcihuc0lXZWJCcm93c2Vy
ICp3ZWJCcm93c2VyLCBuc0lDb250ZW50Vmlld2VyICoqYVZpZXdlcik7Ci0KLSNlbmRpZiAvKiBf
X0VtYmVkVG9vbHNfaCAqLwpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9F
bWJlZFByaXZhdGUuY3BwIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZFByaXZhdGUu
Y3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsv
c3JjL0VtYmVkUHJpdmF0ZS5jcHAKKysrIC9kZXYvbnVsbApAQCAtMSw5ODMgKzAsMCBAQAotLyog
KioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwg
Mi4wL0xHUEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVj
dCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGlj
ZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdp
dGgKLSAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2Ug
YXQKLSAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3Ry
aWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFz
aXMsCi0gKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBp
bXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292
ZXJuaW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoK
LSAqIFRoZSBPcmlnaW5hbCBDb2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIElu
aXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBDaHJpc3RvcGhlciBC
bGl6emFyZC4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFy
ZSBDb3B5cmlnaHQgKEMpIDIwMDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0
cyBSZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIgQmxp
enphcmQgPGJsaXp6YXJkQG1vemlsbGEub3JnPgotICoKLSAqIEFsdGVybmF0aXZlbHksIHRoZSBj
b250ZW50cyBvZiB0aGlzIGZpbGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0gKiBl
aXRoZXIgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAo
dGhlICJHUEwiKSwgb3IKLSAqIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
VmVyc2lvbiAyLjEgb3IgbGF0ZXIgKHRoZSAiTEdQTCIpLAotICogaW4gd2hpY2ggY2FzZSB0aGUg
cHJvdmlzaW9ucyBvZiB0aGUgR1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQK
LSAqIG9mIHRob3NlIGFib3ZlLiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJz
aW9uIG9mIHRoaXMgZmlsZSBvbmx5Ci0gKiB1bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBH
UEwgb3IgdGhlIExHUEwsIGFuZCBub3QgdG8gYWxsb3cgb3RoZXJzIHRvCi0gKiB1c2UgeW91ciB2
ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUg
eW91cgotICogZGVjaXNpb24gYnkgZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJl
cGxhY2UgdGhlbSB3aXRoIHRoZSBub3RpY2UKLSAqIGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVp
cmVkIGJ5IHRoZSBHUEwgb3IgdGhlIExHUEwuIElmIHlvdSBkbyBub3QgZGVsZXRlCi0gKiB0aGUg
cHJvdmlzaW9ucyBhYm92ZSwgYSByZWNpcGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhp
cyBmaWxlIHVuZGVyCi0gKiB0aGUgdGVybXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BM
IG9yIHRoZSBMR1BMLgotICoKLSAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCi0K
LSNpbmNsdWRlICJuc0lEb2NTaGVsbC5oIgotI2luY2x1ZGUgIm5zSVdlYlByb2dyZXNzLmgiCi0j
aW5jbHVkZSAibnNJV2lkZ2V0LmgiCi0jaW5jbHVkZSAibnNDUlQuaCIKLSNpbmNsdWRlICJuc05l
dFV0aWwuaCIKLSNpbmNsdWRlICJuc0lXZWJCcm93c2VyU3RyZWFtLmgiCi0jaW5jbHVkZSAibnNJ
V2ViQnJvd3NlckZvY3VzLmgiCi0jaW5jbHVkZSAibnNJRGlyZWN0b3J5U2VydmljZS5oIgotI2lu
Y2x1ZGUgIm5zQXBwRGlyZWN0b3J5U2VydmljZURlZnMuaCIKLQotLy8gZm9yIGRvX0dldEludGVy
ZmFjZQotI2luY2x1ZGUgIm5zSUludGVyZmFjZVJlcXVlc3Rvci5oIgotLy8gZm9yIGRvX0NyZWF0
ZUluc3RhbmNlCi0jaW5jbHVkZSAibnNJQ29tcG9uZW50TWFuYWdlci5oIgotI2luY2x1ZGUgIm5z
Q29tcG9uZW50TWFuYWdlclV0aWxzLmgiCi0KLS8vIGZvciBpbml0aWFsaXppbmcgb3VyIHdpbmRv
dyB3YXRjaGVyIHNlcnZpY2UKLSNpbmNsdWRlICJuc0lXaW5kb3dXYXRjaGVyLmgiCi0KLSNpbmNs
dWRlICJuc0lMb2NhbEZpbGUuaCIKLQotI2luY2x1ZGUgIm5zWFVMQXBwQVBJLmgiCi0KLS8vIGFs
bCBvZiB0aGUgY3JhcCB0aGF0IHdlIG5lZWQgZm9yIGV2ZW50IGxpc3RlbmVycwotLy8gYW5kIHdo
ZW4gY2hyb21lIHdpbmRvd3MgZmluaXNoIGxvYWRpbmcKLSNpbmNsdWRlICJuc0lET01XaW5kb3cu
aCIKLSNpbmNsdWRlICJuc1BJRE9NV2luZG93LmgiCi0jaW5jbHVkZSAibnNJRE9NV2luZG93SW50
ZXJuYWwuaCIKLQotLy8gRm9yIHNldGluZyBzY3JvbGxiYXIgdmlzaWJpbHR5Ci0jaW5jbHVkZSAi
bnNJRE9NQmFyUHJvcC5oIgotCi0vLyBhbGwgb2Ygb3VyIGxvY2FsIGluY2x1ZGVzCi0jaW5jbHVk
ZSAiRW1iZWRQcml2YXRlLmgiCi0jaW5jbHVkZSAiRW1iZWRXaW5kb3cuaCIKLSNpbmNsdWRlICJF
bWJlZFByb2dyZXNzLmgiCi0jaW5jbHVkZSAiRW1iZWRDb250ZW50TGlzdGVuZXIuaCIKLSNpbmNs
dWRlICJFbWJlZEV2ZW50TGlzdGVuZXIuaCIKLSNpbmNsdWRlICJFbWJlZFdpbmRvd0NyZWF0b3Iu
aCIKLSNpbmNsdWRlICJHdGtQcm9tcHRTZXJ2aWNlLmgiCi0KLSNpbmNsdWRlICJtb3ppbGxhL01v
ZHVsZVV0aWxzLmgiCi0KLSNpZmRlZiBNT1pfQUNDRVNTSUJJTElUWV9BVEsKLSNpbmNsdWRlICJu
c0lBY2Nlc3NpYmlsaXR5U2VydmljZS5oIgotI2luY2x1ZGUgIm5zSUFjY2Vzc2libGUuaCIKLSNp
bmNsdWRlICJuc0lET01Eb2N1bWVudC5oIgotI2VuZGlmCi0KLVBSVWludDMyICAgICAgICAgICAg
ICAgICBFbWJlZFByaXZhdGU6OnNXaWRnZXRDb3VudCA9IDA7Ci0KLWNoYXIgICAgICAgICAgICAg
ICAgICAgICpFbWJlZFByaXZhdGU6OnNQYXRoICAgICAgICA9IG5zbnVsbDsKLWNoYXIgICAgICAg
ICAgICAgICAgICAgICpFbWJlZFByaXZhdGU6OnNDb21wUGF0aCAgICA9IG5zbnVsbDsKLW5zVEFy
cmF5PEVtYmVkUHJpdmF0ZSo+ICpFbWJlZFByaXZhdGU6OnNXaW5kb3dMaXN0ICA9IG5zbnVsbDsK
LW5zSUxvY2FsRmlsZSAgICAgICAgICAgICpFbWJlZFByaXZhdGU6OnNQcm9maWxlRGlyICA9IG5z
bnVsbDsKLW5zSVN1cHBvcnRzICAgICAgICAgICAgICpFbWJlZFByaXZhdGU6OnNQcm9maWxlTG9j
ayA9IG5zbnVsbDsKLUd0a1dpZGdldCAgICAgICAgICAgICAgICpFbWJlZFByaXZhdGU6OnNPZmZz
Y3JlZW5XaW5kb3cgPSAwOwotR3RrV2lkZ2V0ICAgICAgICAgICAgICAgKkVtYmVkUHJpdmF0ZTo6
c09mZnNjcmVlbkZpeGVkICA9IDA7Ci0KLW5zSURpcmVjdG9yeVNlcnZpY2VQcm92aWRlciAqRW1i
ZWRQcml2YXRlOjpzQXBwRmlsZUxvY1Byb3ZpZGVyID0gbnNudWxsOwotCi1jbGFzcyBHVEtFbWJl
ZERpcmVjdG9yeVByb3ZpZGVyIDogcHVibGljIG5zSURpcmVjdG9yeVNlcnZpY2VQcm92aWRlcjIK
LXsKLXB1YmxpYzoKLSAgTlNfREVDTF9JU1VQUE9SVFNfSU5IRVJJVEVECi0gIE5TX0RFQ0xfTlNJ
RElSRUNUT1JZU0VSVklDRVBST1ZJREVSCi0gIE5TX0RFQ0xfTlNJRElSRUNUT1JZU0VSVklDRVBS
T1ZJREVSMgotfTsKLQotc3RhdGljIGNvbnN0IEdUS0VtYmVkRGlyZWN0b3J5UHJvdmlkZXIga0Rp
cmVjdG9yeVByb3ZpZGVyOwotCi1OU19JTVBMX1FVRVJZX0lOVEVSRkFDRTIoR1RLRW1iZWREaXJl
Y3RvcnlQcm92aWRlciwKLSAgICAgICAgICAgICAgICAgICAgICAgICBuc0lEaXJlY3RvcnlTZXJ2
aWNlUHJvdmlkZXIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgbnNJRGlyZWN0b3J5U2Vydmlj
ZVByb3ZpZGVyMikKLQotTlNfSU1FVEhPRElNUF8obnNyZWZjbnQpCi1HVEtFbWJlZERpcmVjdG9y
eVByb3ZpZGVyOjpBZGRSZWYoKQotewotICByZXR1cm4gMTsKLX0KLQotTlNfSU1FVEhPRElNUF8o
bnNyZWZjbnQpCi1HVEtFbWJlZERpcmVjdG9yeVByb3ZpZGVyOjpSZWxlYXNlKCkKLXsKLSAgcmV0
dXJuIDE7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUdUS0VtYmVkRGlyZWN0b3J5UHJvdmlkZXI6Okdl
dEZpbGUoY29uc3QgY2hhciAqYUtleSwgUFJCb29sICphUGVyc2lzdCwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbnNJRmlsZSogKmFSZXN1bHQpCi17Ci0gIGlmIChFbWJlZFBy
aXZhdGU6OnNBcHBGaWxlTG9jUHJvdmlkZXIpIHsKLSAgICBuc3Jlc3VsdCBydiA9IEVtYmVkUHJp
dmF0ZTo6c0FwcEZpbGVMb2NQcm92aWRlci0+R2V0RmlsZShhS2V5LCBhUGVyc2lzdCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBh
UmVzdWx0KTsKLSAgICBpZiAoTlNfU1VDQ0VFREVEKHJ2KSkKLSAgICAgIHJldHVybiBydjsKLSAg
fQotCi0gIGlmIChFbWJlZFByaXZhdGU6OnNQcm9maWxlRGlyICYmICghc3RyY21wKGFLZXksIE5T
X0FQUF9VU0VSX1BST0ZJTEVfNTBfRElSKQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfHwgIXN0cmNtcChhS2V5LCBOU19BUFBfUFJPRklMRV9ESVJfU1RBUlRVUCkpKSB7Ci0gICAg
KmFQZXJzaXN0ID0gUFJfVFJVRTsKLSAgICByZXR1cm4gRW1iZWRQcml2YXRlOjpzUHJvZmlsZURp
ci0+Q2xvbmUoYVJlc3VsdCk7Ci0gIH0KLQotICByZXR1cm4gTlNfRVJST1JfRkFJTFVSRTsKLX0K
LQotTlNfSU1FVEhPRElNUAotR1RLRW1iZWREaXJlY3RvcnlQcm92aWRlcjo6R2V0RmlsZXMoY29u
c3QgY2hhciAqYUtleSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5zSVNp
bXBsZUVudW1lcmF0b3IqICphUmVzdWx0KQotewotICBuc0NPTVB0cjxuc0lEaXJlY3RvcnlTZXJ2
aWNlUHJvdmlkZXIyPgotICAgIGRwMihkb19RdWVyeUludGVyZmFjZShFbWJlZFByaXZhdGU6OnNB
cHBGaWxlTG9jUHJvdmlkZXIpKTsKLQotICBpZiAoIWRwMikKLSAgICByZXR1cm4gTlNfRVJST1Jf
RkFJTFVSRTsKLQotICByZXR1cm4gZHAyLT5HZXRGaWxlcyhhS2V5LCBhUmVzdWx0KTsKLX0KLQot
I2RlZmluZSBOU19QUk9NUFRTRVJWSUNFX0NJRCBcCi0gezB4OTU2MTEzNTYsIDB4ZjU4MywgMHg0
NmY1LCB7MHg4MSwgMHhmZiwgMHg0YiwgMHgzZSwgMHgwMSwgMHg2MiwgMHhjNiwgMHgxOX19Ci0K
LU5TX0dFTkVSSUNfRkFDVE9SWV9DT05TVFJVQ1RPUihHdGtQcm9tcHRTZXJ2aWNlKQotTlNfREVG
SU5FX05BTUVEX0NJRChOU19QUk9NUFRTRVJWSUNFX0NJRCk7Ci0KLXN0YXRpYyBjb25zdCBtb3pp
bGxhOjpNb2R1bGU6OkNJREVudHJ5IGtEZWZhdWx0UHJvbXB0Q0lEc1tdID0gewotICB7ICZrTlNf
UFJPTVBUU0VSVklDRV9DSUQsIGZhbHNlLCBOVUxMLCBHdGtQcm9tcHRTZXJ2aWNlQ29uc3RydWN0
b3IgfSwKLSAgeyBOVUxMIH0KLX07Ci0KLXN0YXRpYyBjb25zdCBtb3ppbGxhOjpNb2R1bGU6OkNv
bnRyYWN0SURFbnRyeSBrRGVmYXVsdFByb21wdENvbnRyYWN0c1tdID0gewotICB7ICJAbW96aWxs
YS5vcmcvZW1iZWRjb21wL3Byb21wdC1zZXJ2aWNlOzEiLCAma05TX1BST01QVFNFUlZJQ0VfQ0lE
IH0sCi0gIHsgTlVMTCB9Ci19OwotCi1zdGF0aWMgY29uc3QgbW96aWxsYTo6TW9kdWxlIGtEZWZh
dWx0UHJvbXB0TW9kdWxlID0gewotICBtb3ppbGxhOjpNb2R1bGU6OmtWZXJzaW9uLAotICBrRGVm
YXVsdFByb21wdENJRHMsCi0gIGtEZWZhdWx0UHJvbXB0Q29udHJhY3RzCi19OwotCi1FbWJlZFBy
aXZhdGU6OkVtYmVkUHJpdmF0ZSh2b2lkKQotewotICBtT3duaW5nV2lkZ2V0ICAgICA9IG5zbnVs
bDsKLSAgbVdpbmRvdyAgICAgICAgICAgPSBuc251bGw7Ci0gIG1Qcm9ncmVzcyAgICAgICAgID0g
bnNudWxsOwotICBtQ29udGVudExpc3RlbmVyICA9IG5zbnVsbDsKLSAgbUV2ZW50TGlzdGVuZXIg
ICAgPSBuc251bGw7Ci0gIG1DaHJvbWVNYXNrICAgICAgID0gbnNJV2ViQnJvd3NlckNocm9tZTo6
Q0hST01FX0FMTDsKLSAgbUlzQ2hyb21lICAgICAgICAgPSBQUl9GQUxTRTsKLSAgbUNocm9tZUxv
YWRlZCAgICAgPSBQUl9GQUxTRTsKLSAgbUxpc3RlbmVyc0F0dGFjaGVkID0gUFJfRkFMU0U7Ci0g
IG1Nb3pXaW5kb3dXaWRnZXQgID0gMDsKLSAgbUlzRGVzdHJveWVkICAgICAgPSBQUl9GQUxTRTsK
LQotICBQdXNoU3RhcnR1cCgpOwotICBpZiAoIXNXaW5kb3dMaXN0KSB7Ci0gICAgc1dpbmRvd0xp
c3QgPSBuZXcgbnNUQXJyYXk8RW1iZWRQcml2YXRlKj4oKTsKLSAgfQotICBzV2luZG93TGlzdC0+
QXBwZW5kRWxlbWVudCh0aGlzKTsKLX0KLQotRW1iZWRQcml2YXRlOjp+RW1iZWRQcml2YXRlKCkK
LXsKLSAgc1dpbmRvd0xpc3QtPlJlbW92ZUVsZW1lbnQodGhpcyk7Ci0gIFBvcFN0YXJ0dXAoKTsK
LX0KLQotbnNyZXN1bHQKLUVtYmVkUHJpdmF0ZTo6SW5pdChHdGtNb3pFbWJlZCAqYU93bmluZ1dp
ZGdldCkKLXsKLSAgLy8gYXJlIHdlIGJlaW5nIHJlLWluaXRpYWxpemVkPwotICBpZiAobU93bmlu
Z1dpZGdldCkKLSAgICByZXR1cm4gTlNfT0s7Ci0KLSAgLy8gaGFuZyBvbiB3aXRoIGEgcmVmZXJl
bmNlIHRvIHRoZSBvd25pbmcgd2lkZ2V0Ci0gIG1Pd25pbmdXaWRnZXQgPSBhT3duaW5nV2lkZ2V0
OwotCi0gIC8vIENyZWF0ZSBvdXIgZW1iZWQgd2luZG93LCBhbmQgY3JlYXRlIGFuIG93bmluZyBy
ZWZlcmVuY2UgdG8gaXQgYW5kCi0gIC8vIGluaXRpYWxpemUgaXQuICBJdCBpcyBhc3N1bWVkIHRo
YXQgdGhpcyB3aW5kb3cgd2lsbCBiZSBkZXN0cm95ZWQKLSAgLy8gd2hlbiB3ZSBnbyBvdXQgb2Yg
c2NvcGUuCi0gIG1XaW5kb3cgPSBuZXcgRW1iZWRXaW5kb3coKTsKLSAgbVdpbmRvd0d1YXJkID0g
c3RhdGljX2Nhc3Q8bnNJV2ViQnJvd3NlckNocm9tZSAqPihtV2luZG93KTsKLSAgbVdpbmRvdy0+
SW5pdCh0aGlzKTsKLQotICAvLyBDcmVhdGUgb3VyIHByb2dyZXNzIGxpc3RlbmVyIG9iamVjdCwg
bWFrZSBhbiBvd25pbmcgcmVmZXJlbmNlLAotICAvLyBhbmQgaW5pdGlhbGl6ZSBpdC4gIEl0IGlz
IGFzc3VtZWQgdGhhdCB0aGlzIHByb2dyZXNzIGxpc3RlbmVyCi0gIC8vIHdpbGwgYmUgZGVzdHJv
eWVkIHdoZW4gd2UgZ28gb3V0IG9mIHNjb3BlLgotICBtUHJvZ3Jlc3MgPSBuZXcgRW1iZWRQcm9n
cmVzcygpOwotICBtUHJvZ3Jlc3NHdWFyZCA9IHN0YXRpY19jYXN0PG5zSVdlYlByb2dyZXNzTGlz
dGVuZXIgKj4KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1Qcm9ncmVzcyk7Ci0g
IG1Qcm9ncmVzcy0+SW5pdCh0aGlzKTsKLQotICAvLyBDcmVhdGUgb3VyIGNvbnRlbnQgbGlzdGVu
ZXIgb2JqZWN0LCBpbml0aWFsaXplIGl0IGFuZCBhdHRhY2ggaXQuCi0gIC8vIEl0IGlzIGFzc3Vt
ZWQgdGhhdCB0aGlzIHdpbGwgYmUgZGVzdHJveWVkIHdoZW4gd2UgZ28gb3V0IG9mCi0gIC8vIHNj
b3BlLgotICBtQ29udGVudExpc3RlbmVyID0gbmV3IEVtYmVkQ29udGVudExpc3RlbmVyKCk7Ci0g
IG1Db250ZW50TGlzdGVuZXJHdWFyZCA9IHN0YXRpY19jYXN0PG5zSVN1cHBvcnRzKj4oc3RhdGlj
X2Nhc3Q8bnNJVVJJQ29udGVudExpc3RlbmVyKj4obUNvbnRlbnRMaXN0ZW5lcikpOwotICBtQ29u
dGVudExpc3RlbmVyLT5Jbml0KHRoaXMpOwotCi0gIC8vIENyZWF0ZSBvdXIga2V5IGxpc3RlbmVy
IG9iamVjdCBhbmQgaW5pdGlhbGl6ZSBpdC4gIEl0IGlzIGFzc3VtZWQKLSAgLy8gdGhhdCB0aGlz
IHdpbGwgYmUgZGVzdHJveWVkIGJlZm9yZSB3ZSBnbyBvdXQgb2Ygc2NvcGUuCi0gIG1FdmVudExp
c3RlbmVyID0gbmV3IEVtYmVkRXZlbnRMaXN0ZW5lcigpOwotICBtRXZlbnRMaXN0ZW5lckd1YXJk
ID0KLSAgICBzdGF0aWNfY2FzdDxuc0lTdXBwb3J0cyAqPihzdGF0aWNfY2FzdDxuc0lET01LZXlM
aXN0ZW5lciAqPihtRXZlbnRMaXN0ZW5lcikpOwotICBtRXZlbnRMaXN0ZW5lci0+SW5pdCh0aGlz
KTsKLQotICAvLyBoYXMgdGhlIHdpbmRvdyBjcmVhdG9yIHNlcnZpY2UgYmVlbiBzZXQgdXA/Ci0g
IHN0YXRpYyBpbnQgaW5pdGlhbGl6ZWQgPSBQUl9GQUxTRTsKLSAgLy8gU2V0IHVwIG91ciB3aW5k
b3cgY3JlYXRvciAoIG9ubHkgb25jZSApCi0gIGlmICghaW5pdGlhbGl6ZWQpIHsKLSAgICAvLyBX
ZSBzZXQgdGhpcyBmbGFnIGhlcmUgaW5zdGVhZCBvZiBvbiBzdWNjZXNzLiAgSWYgaXQgZmFpbGVk
IHdlCi0gICAgLy8gZG9uJ3Qgd2FudCB0byBrZWVwIHRyeWluZyBhbmQgbGVha2luZyB3aW5kb3cg
Y3JlYXRvciBvYmplY3RzLgotICAgIGluaXRpYWxpemVkID0gUFJfVFJVRTsKLQotICAgIC8vIGNy
ZWF0ZSBvdXIgbG9jYWwgb2JqZWN0Ci0gICAgRW1iZWRXaW5kb3dDcmVhdG9yICpjcmVhdG9yID0g
bmV3IEVtYmVkV2luZG93Q3JlYXRvcigpOwotICAgIG5zQ09NUHRyPG5zSVdpbmRvd0NyZWF0b3I+
IHdpbmRvd0NyZWF0b3I7Ci0gICAgd2luZG93Q3JlYXRvciA9IHN0YXRpY19jYXN0PG5zSVdpbmRv
d0NyZWF0b3IgKj4oY3JlYXRvcik7Ci0KLSAgICAvLyBBdHRhY2ggaXQgdmlhIHRoZSB3YXRjaGVy
IHNlcnZpY2UKLSAgICBuc0NPTVB0cjxuc0lXaW5kb3dXYXRjaGVyPiB3YXRjaGVyID0gZG9fR2V0
U2VydmljZShOU19XSU5ET1dXQVRDSEVSX0NPTlRSQUNUSUQpOwotICAgIGlmICh3YXRjaGVyKQot
ICAgICAgd2F0Y2hlci0+U2V0V2luZG93Q3JlYXRvcih3aW5kb3dDcmVhdG9yKTsKLSAgfQotICBy
ZXR1cm4gTlNfT0s7Ci19Ci0KLW5zcmVzdWx0Ci1FbWJlZFByaXZhdGU6OlJlYWxpemUoUFJCb29s
ICphQWxyZWFkeVJlYWxpemVkKQotewotCi0gICphQWxyZWFkeVJlYWxpemVkID0gUFJfRkFMU0U7
Ci0KLSAgLy8gY3JlYXRlIHRoZSBvZmZzY3JlZW4gd2luZG93IGlmIHdlIGhhdmUgdG8KLSAgRW5z
dXJlT2Zmc2NyZWVuV2luZG93KCk7Ci0KLSAgLy8gSGF2ZSB3ZSBldmVyIGJlZW4gaW5pdGlhbGl6
ZWQgYmVmb3JlPyAgSWYgc28gdGhlbiBqdXN0IHJlcGFyZW50Ci0gIC8vIGZyb20gdGhlIG9mZnNj
cmVlbiB3aW5kb3cuCi0gIGlmIChtTW96V2luZG93V2lkZ2V0KSB7Ci0gICAgZ3RrX3dpZGdldF9y
ZXBhcmVudChtTW96V2luZG93V2lkZ2V0LCBHVEtfV0lER0VUKG1Pd25pbmdXaWRnZXQpKTsKLSAg
ICAqYUFscmVhZHlSZWFsaXplZCA9IFBSX1RSVUU7Ci0gICAgcmV0dXJuIE5TX09LOwotICB9Ci0K
LSAgLy8gR2V0IHRoZSBuc0lXZWJCcm93c2VyIG9iamVjdCBmb3Igb3VyIGVtYmVkZGVkIHdpbmRv
dy4KLSAgbnNDT01QdHI8bnNJV2ViQnJvd3Nlcj4gd2ViQnJvd3NlcjsKLSAgbVdpbmRvdy0+R2V0
V2ViQnJvd3NlcihnZXR0ZXJfQWRkUmVmcyh3ZWJCcm93c2VyKSk7Ci0KLSAgLy8gZ2V0IGEgaGFu
ZGxlIG9uIHRoZSBuYXZpZ2F0aW9uIG9iamVjdAotICBtTmF2aWdhdGlvbiA9IGRvX1F1ZXJ5SW50
ZXJmYWNlKHdlYkJyb3dzZXIpOwotCi0gIC8vIENyZWF0ZSBvdXIgc2Vzc2lvbiBoaXN0b3J5IG9i
amVjdCBhbmQgdGVsbCB0aGUgbmF2aWdhdGlvbiBvYmplY3QKLSAgLy8gdG8gdXNlIGl0LiAgV2Ug
bmVlZCB0byBkbyB0aGlzIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIHdlYiBicm93c2VyCi0gIC8vIHdp
bmRvdy4KLSAgbVNlc3Npb25IaXN0b3J5ID0gZG9fQ3JlYXRlSW5zdGFuY2UoTlNfU0hJU1RPUllf
Q09OVFJBQ1RJRCk7Ci0gIG1OYXZpZ2F0aW9uLT5TZXRTZXNzaW9uSGlzdG9yeShtU2Vzc2lvbkhp
c3RvcnkpOwotCi0gIC8vIGNyZWF0ZSB0aGUgd2luZG93Ci0gIG1XaW5kb3ctPkNyZWF0ZVdpbmRv
dygpOwotCi0gIC8vIGJpbmQgdGhlIHByb2dyZXNzIGxpc3RlbmVyIHRvIHRoZSBicm93c2VyIG9i
amVjdAotICBuc0NPTVB0cjxuc0lTdXBwb3J0c1dlYWtSZWZlcmVuY2U+IHN1cHBvcnRzV2VhazsK
LSAgc3VwcG9ydHNXZWFrID0gZG9fUXVlcnlJbnRlcmZhY2UobVByb2dyZXNzR3VhcmQpOwotICBu
c0NPTVB0cjxuc0lXZWFrUmVmZXJlbmNlPiB3ZWFrUmVmOwotICBzdXBwb3J0c1dlYWstPkdldFdl
YWtSZWZlcmVuY2UoZ2V0dGVyX0FkZFJlZnMod2Vha1JlZikpOwotICB3ZWJCcm93c2VyLT5BZGRX
ZWJCcm93c2VyTGlzdGVuZXIod2Vha1JlZiwKLQkJCQkgICAgTlNfR0VUX0lJRChuc0lXZWJQcm9n
cmVzc0xpc3RlbmVyKSk7Ci0KLSAgLy8gc2V0IG91cnNlbHZlcyBhcyB0aGUgcGFyZW50IHVyaSBj
b250ZW50IGxpc3RlbmVyCi0gIG5zQ09NUHRyPG5zSVVSSUNvbnRlbnRMaXN0ZW5lcj4gdXJpTGlz
dGVuZXI7Ci0gIHVyaUxpc3RlbmVyID0gZG9fUXVlcnlJbnRlcmZhY2UobUNvbnRlbnRMaXN0ZW5l
ckd1YXJkKTsKLSAgd2ViQnJvd3Nlci0+U2V0UGFyZW50VVJJQ29udGVudExpc3RlbmVyKHVyaUxp
c3RlbmVyKTsKLQotICAvLyBzYXZlIHRoZSB3aW5kb3cgaWQgb2YgdGhlIG5ld2x5IGNyZWF0ZWQg
d2luZG93Ci0gIG5zQ09NUHRyPG5zSVdpZGdldD4gbW96V2lkZ2V0OwotICBtV2luZG93LT5tQmFz
ZVdpbmRvdy0+R2V0TWFpbldpZGdldChnZXR0ZXJfQWRkUmVmcyhtb3pXaWRnZXQpKTsKLSAgLy8g
Z2V0IHRoZSBuYXRpdmUgZHJhd2luZyBhcmVhCi0gIEdka1dpbmRvdyAqdG1wX3dpbmRvdyA9Ci0g
ICAgc3RhdGljX2Nhc3Q8R2RrV2luZG93ICo+KAotCQkgICBtb3pXaWRnZXQtPkdldE5hdGl2ZURh
dGEoTlNfTkFUSVZFX1dJTkRPVykpOwotICAvLyBhbmQsIHRoYW5rcyB0byBzdXBlcndpbiB3ZSBh
Y3R1YWxseSBuZWVkIHRoZSBwYXJlbnQgb2YgdGhhdC4KLSAgdG1wX3dpbmRvdyA9IGdka193aW5k
b3dfZ2V0X3BhcmVudCh0bXBfd2luZG93KTsKLSAgLy8gc2F2ZSB0aGUgd2lkZ2V0IElEIC0gaXQg
c2hvdWxkIGJlIHRoZSBtb3phcmVhIG9mIHRoZSB3aW5kb3cuCi0gIGdwb2ludGVyIGRhdGEgPSBu
c251bGw7Ci0gIGdka193aW5kb3dfZ2V0X3VzZXJfZGF0YSh0bXBfd2luZG93LCAmZGF0YSk7Ci0g
IG1Nb3pXaW5kb3dXaWRnZXQgPSBzdGF0aWNfY2FzdDxHdGtXaWRnZXQgKj4oZGF0YSk7Ci0KLSAg
Ly8gQXBwbHkgdGhlIGN1cnJlbnQgY2hyb21lIG1hc2sKLSAgQXBwbHlDaHJvbWVNYXNrKCk7Ci0K
LSAgcmV0dXJuIE5TX09LOwotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OlVucmVhbGl6ZSh2b2lk
KQotewotICAvLyByZXBhcmVudCB0byBvdXIgb2Zmc2NyZWVuIHdpbmRvdwotICBndGtfd2lkZ2V0
X3JlcGFyZW50KG1Nb3pXaW5kb3dXaWRnZXQsIHNPZmZzY3JlZW5GaXhlZCk7Ci19Ci0KLXZvaWQK
LUVtYmVkUHJpdmF0ZTo6U2hvdyh2b2lkKQotewotICAvLyBHZXQgdGhlIG5zSVdlYkJyb3dzZXIg
b2JqZWN0IGZvciBvdXIgZW1iZWRkZWQgd2luZG93LgotICBuc0NPTVB0cjxuc0lXZWJCcm93c2Vy
PiB3ZWJCcm93c2VyOwotICBtV2luZG93LT5HZXRXZWJCcm93c2VyKGdldHRlcl9BZGRSZWZzKHdl
YkJyb3dzZXIpKTsKLQotICAvLyBhbmQgc2V0IHRoZSB2aXNpYmlsaXR5IG9uIHRoZSB0aGluZwot
ICBuc0NPTVB0cjxuc0lCYXNlV2luZG93PiBiYXNlV2luZG93ID0gZG9fUXVlcnlJbnRlcmZhY2Uo
d2ViQnJvd3Nlcik7Ci0gIGJhc2VXaW5kb3ctPlNldFZpc2liaWxpdHkoUFJfVFJVRSk7Ci19Ci0K
LXZvaWQKLUVtYmVkUHJpdmF0ZTo6SGlkZSh2b2lkKQotewotICAvLyBHZXQgdGhlIG5zSVdlYkJy
b3dzZXIgb2JqZWN0IGZvciBvdXIgZW1iZWRkZWQgd2luZG93LgotICBuc0NPTVB0cjxuc0lXZWJC
cm93c2VyPiB3ZWJCcm93c2VyOwotICBtV2luZG93LT5HZXRXZWJCcm93c2VyKGdldHRlcl9BZGRS
ZWZzKHdlYkJyb3dzZXIpKTsKLQotICAvLyBhbmQgc2V0IHRoZSB2aXNpYmlsaXR5IG9uIHRoZSB0
aGluZwotICBuc0NPTVB0cjxuc0lCYXNlV2luZG93PiBiYXNlV2luZG93ID0gZG9fUXVlcnlJbnRl
cmZhY2Uod2ViQnJvd3Nlcik7Ci0gIGJhc2VXaW5kb3ctPlNldFZpc2liaWxpdHkoUFJfRkFMU0Up
OwotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OlJlc2l6ZShQUlVpbnQzMiBhV2lkdGgsIFBSVWlu
dDMyIGFIZWlnaHQpCi17Ci0gIG1XaW5kb3ctPlNldERpbWVuc2lvbnMobnNJRW1iZWRkaW5nU2l0
ZVdpbmRvdzo6RElNX0ZMQUdTX1BPU0lUSU9OIHwKLQkJCSBuc0lFbWJlZGRpbmdTaXRlV2luZG93
OjpESU1fRkxBR1NfU0laRV9JTk5FUiwKLQkJCSAwLCAwLCBhV2lkdGgsIGFIZWlnaHQpOwotfQot
Ci12b2lkCi1FbWJlZFByaXZhdGU6OkRlc3Ryb3kodm9pZCkKLXsKLSAgLy8gVGhpcyBmbGFnIG1p
Z2h0IGhhdmUgYmVlbiBzZXQgZnJvbQotICAvLyBFbWJlZFdpbmRvdzo6RGVzdHJveUJyb3dzZXJX
aW5kb3coKSBhcyB3ZWxsIGlmIHNvbWVvbmUgdXNlZCBhCi0gIC8vIHdpbmRvdy5jbG9zZSgpIG9y
IHNvbWV0aGluZyBvciBzb21lIG90aGVyIHNjcmlwdCBhY3Rpb24gdG8gY2xvc2UKLSAgLy8gdGhl
IHdpbmRvdy4gIE5vIGhhcm0gc2V0dGluZyBpdCBhZ2Fpbi4KLSAgbUlzRGVzdHJveWVkID0gUFJf
VFJVRTsKLQotICAvLyBHZXQgdGhlIG5zSVdlYkJyb3dzZXIgb2JqZWN0IGZvciBvdXIgZW1iZWRk
ZWQgd2luZG93LgotICBuc0NPTVB0cjxuc0lXZWJCcm93c2VyPiB3ZWJCcm93c2VyOwotICBtV2lu
ZG93LT5HZXRXZWJCcm93c2VyKGdldHRlcl9BZGRSZWZzKHdlYkJyb3dzZXIpKTsKLQotICAvLyBS
ZWxlYXNlIG91ciBwcm9ncmVzcyBsaXN0ZW5lcgotICBuc0NPTVB0cjxuc0lTdXBwb3J0c1dlYWtS
ZWZlcmVuY2U+IHN1cHBvcnRzV2VhazsKLSAgc3VwcG9ydHNXZWFrID0gZG9fUXVlcnlJbnRlcmZh
Y2UobVByb2dyZXNzR3VhcmQpOwotICBuc0NPTVB0cjxuc0lXZWFrUmVmZXJlbmNlPiB3ZWFrUmVm
OwotICBzdXBwb3J0c1dlYWstPkdldFdlYWtSZWZlcmVuY2UoZ2V0dGVyX0FkZFJlZnMod2Vha1Jl
ZikpOwotICB3ZWJCcm93c2VyLT5SZW1vdmVXZWJCcm93c2VyTGlzdGVuZXIod2Vha1JlZiwKLQkJ
CQkgICAgICAgTlNfR0VUX0lJRChuc0lXZWJQcm9ncmVzc0xpc3RlbmVyKSk7Ci0gIHdlYWtSZWYg
PSBuc251bGw7Ci0gIHN1cHBvcnRzV2VhayA9IG5zbnVsbDsKLQotICAvLyBSZWxlYXNlIG91ciBj
b250ZW50IGxpc3RlbmVyCi0gIHdlYkJyb3dzZXItPlNldFBhcmVudFVSSUNvbnRlbnRMaXN0ZW5l
cihuc251bGwpOwotICBtQ29udGVudExpc3RlbmVyR3VhcmQgPSBuc251bGw7Ci0gIG1Db250ZW50
TGlzdGVuZXIgPSBuc251bGw7Ci0KLSAgLy8gTm93IHRoYXQgd2UgaGF2ZSByZW1vdmVkIHRoZSBs
aXN0ZW5lciwgcmVsZWFzZSBvdXIgcHJvZ3Jlc3MKLSAgLy8gb2JqZWN0Ci0gIG1Qcm9ncmVzc0d1
YXJkID0gbnNudWxsOwotICBtUHJvZ3Jlc3MgPSBuc251bGw7Ci0KLSAgLy8gZGV0YWNoIG91ciBl
dmVudCBsaXN0ZW5lcnMgYW5kIHJlbGVhc2UgdGhlIGV2ZW50IHJlY2VpdmVyCi0gIERldGFjaExp
c3RlbmVycygpOwotICBpZiAobUV2ZW50VGFyZ2V0KQotICAgIG1FdmVudFRhcmdldCA9IG5zbnVs
bDsKLQotICAvLyBkZXN0cm95IG91ciBjaGlsZCB3aW5kb3cKLSAgbVdpbmRvdy0+UmVsZWFzZUNo
aWxkcmVuKCk7Ci0KLSAgLy8gcmVsZWFzZSBuYXZpZ2F0aW9uCi0gIG1OYXZpZ2F0aW9uID0gbnNu
dWxsOwotCi0gIC8vIHJlbGVhc2Ugc2Vzc2lvbiBoaXN0b3J5Ci0gIG1TZXNzaW9uSGlzdG9yeSA9
IG5zbnVsbDsKLQotICBtT3duaW5nV2lkZ2V0ID0gbnNudWxsOwotCi0gIG1Nb3pXaW5kb3dXaWRn
ZXQgPSAwOwotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OlNldFVSSShjb25zdCBjaGFyICphVVJJ
KQotewotICBtVVJJLkFzc2lnbihhVVJJKTsKLX0KLQotdm9pZAotRW1iZWRQcml2YXRlOjpMb2Fk
Q3VycmVudFVSSSh2b2lkKQotewotICBpZiAobVVSSS5MZW5ndGgoKSkgewotICAgIG5zQ09NUHRy
PG5zUElET01XaW5kb3c+IHBpV2luOwotICAgIEdldFBJRE9NV2luZG93KGdldHRlcl9BZGRSZWZz
KHBpV2luKSk7Ci0KLSAgICBuc0F1dG9Qb3B1cFN0YXRlUHVzaGVyIHBvcHVwU3RhdGVQdXNoZXIo
cGlXaW4sIG9wZW5BbGxvd2VkKTsKLQotICAgIG1OYXZpZ2F0aW9uLT5Mb2FkVVJJKE5TX0NvbnZl
cnRVVEY4dG9VVEYxNihtVVJJKS5nZXQoKSwgLy8gVVJJIHN0cmluZwotICAgICAgICAgICAgICAg
ICAgICAgICAgIG5zSVdlYk5hdmlnYXRpb246OkxPQURfRkxBR1NfTk9ORSB8IC8vIExvYWQgZmxh
Z3MKLSAgICAgICAgICAgICAgICAgICAgICAgICBuc0lXZWJOYXZpZ2F0aW9uOjpMT0FEX0ZMQUdT
X0FMTE9XX1RISVJEX1BBUlRZX0ZJWFVQLCAgLy8gQWxsb3cga2V5d29yZC5VUkwuLiBmdW5jdGlv
bmFsaXR5Ci0gICAgICAgICAgICAgICAgICAgICAgICAgbnNudWxsLCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAvLyBSZWZlcnJpbmcgVVJJCi0gICAgICAgICAgICAgICAgICAgICAgICAgbnNu
dWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb3N0IGRhdGEKLSAgICAgICAgICAg
ICAgICAgICAgICAgICBuc251bGwpOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4dHJh
IGhlYWRlcnMKLSAgfQotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OlJlbG9hZChQUlVpbnQzMiBy
ZWxvYWRGbGFncykKLXsKLSAgLyogVXNlIHRoZSBzZXNzaW9uIGhpc3RvcnkgaWYgaXQgaXMgYXZh
aWxhYmxlLCB0aGlzCi0gICAqIGFsbG93cyBmcmFtZXNldHMgdG8gcmVsb2FkIGNvcnJlY3RseSAq
LwotICBuc0NPTVB0cjxuc0lXZWJOYXZpZ2F0aW9uPiB3bjsKLQotICBpZiAobVNlc3Npb25IaXN0
b3J5KSB7Ci0gICAgd24gPSBkb19RdWVyeUludGVyZmFjZShtU2Vzc2lvbkhpc3RvcnkpOwotICB9
Ci0gIGlmICghd24pCi0gICAgd24gPSBtTmF2aWdhdGlvbjsKLQotICBpZiAod24pCi0gICAgd24t
PlJlbG9hZChyZWxvYWRGbGFncyk7Ci19Ci0KLQotdm9pZAotRW1iZWRQcml2YXRlOjpBcHBseUNo
cm9tZU1hc2soKQotewotICAgaWYgKG1XaW5kb3cpIHsKLSAgICAgIG5zQ09NUHRyPG5zSVdlYkJy
b3dzZXI+IHdlYkJyb3dzZXI7Ci0gICAgICBtV2luZG93LT5HZXRXZWJCcm93c2VyKGdldHRlcl9B
ZGRSZWZzKHdlYkJyb3dzZXIpKTsKLQotICAgICAgbnNDT01QdHI8bnNJRE9NV2luZG93PiBkb21X
aW5kb3c7Ci0gICAgICB3ZWJCcm93c2VyLT5HZXRDb250ZW50RE9NV2luZG93KGdldHRlcl9BZGRS
ZWZzKGRvbVdpbmRvdykpOwotICAgICAgaWYgKGRvbVdpbmRvdykgewotCi0gICAgICAgICBuc0NP
TVB0cjxuc0lET01CYXJQcm9wPiBzY3JvbGxiYXJzOwotICAgICAgICAgZG9tV2luZG93LT5HZXRT
Y3JvbGxiYXJzKGdldHRlcl9BZGRSZWZzKHNjcm9sbGJhcnMpKTsKLSAgICAgICAgIGlmIChzY3Jv
bGxiYXJzKSB7Ci0KLSAgICAgICAgICAgIHNjcm9sbGJhcnMtPlNldFZpc2libGUKLSAgICAgICAg
ICAgICAgIChtQ2hyb21lTWFzayAmIG5zSVdlYkJyb3dzZXJDaHJvbWU6OkNIUk9NRV9TQ1JPTExC
QVJTID8KLSAgICAgICAgICAgICAgICBQUl9UUlVFIDogUFJfRkFMU0UpOwotICAgICAgICAgfQot
ICAgICAgfQotICAgfQotfQotCi0KLXZvaWQKLUVtYmVkUHJpdmF0ZTo6U2V0Q2hyb21lTWFzayhQ
UlVpbnQzMiBhQ2hyb21lTWFzaykKLXsKLSAgIG1DaHJvbWVNYXNrID0gYUNocm9tZU1hc2s7Ci0K
LSAgIEFwcGx5Q2hyb21lTWFzaygpOwotfQotCi0KLS8qIHN0YXRpYyAqLwotdm9pZAotRW1iZWRQ
cml2YXRlOjpQdXNoU3RhcnR1cCh2b2lkKQotewotICAvLyBpbmNyZW1lbnQgdGhlIG51bWJlciBv
ZiB3aWRnZXRzCi0gIHNXaWRnZXRDb3VudCsrOwotCi0gIC8vIGlmIHRoaXMgaXMgdGhlIGZpcnN0
IHdpZGdldCwgZmlyZSB1cCB4cGNvbQotICBpZiAoc1dpZGdldENvdW50ID09IDEpIHsKLSAgICBu
c3Jlc3VsdCBydjsKLQotICAgIG5zQ09NUHRyPG5zSUxvY2FsRmlsZT4gYmluRGlyOwotICAgIGlm
IChzQ29tcFBhdGgpIHsKLSAgICAgIHJ2ID0gTlNfTmV3TmF0aXZlTG9jYWxGaWxlKG5zRGVwZW5k
ZW50Q1N0cmluZyhzQ29tcFBhdGgpLCAxLCBnZXR0ZXJfQWRkUmVmcyhiaW5EaXIpKTsKLSAgICAg
IGlmIChOU19GQUlMRUQocnYpKQotCXJldHVybjsKLSAgICB9Ci0KLSAgICBjb25zdCBjaGFyICpn
cmVQYXRoID0gc1BhdGg7Ci0KLSAgICBpZiAoIWdyZVBhdGgpCi0gICAgICBncmVQYXRoID0gZ2V0
ZW52KCJNT1pJTExBX0ZJVkVfSE9NRSIpOwotCi0gICAgaWYgKCFncmVQYXRoKQotICAgICAgcmV0
dXJuOwotCi0gICAgbnNDT01QdHI8bnNJTG9jYWxGaWxlPiBncmVEaXI7Ci0gICAgcnYgPSBOU19O
ZXdOYXRpdmVMb2NhbEZpbGUobnNEZXBlbmRlbnRDU3RyaW5nKGdyZVBhdGgpLCBQUl9UUlVFLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldHRlcl9BZGRSZWZzKGdyZURpcikpOwot
ICAgIGlmIChOU19GQUlMRUQocnYpKQotICAgICAgcmV0dXJuOwotCi0gICAgaWYgKHNQcm9maWxl
RGlyICYmICFzUHJvZmlsZUxvY2spIHsKLSAgICAgIHJ2ID0gWFJFX0xvY2tQcm9maWxlRGlyZWN0
b3J5KHNQcm9maWxlRGlyLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnNQ
cm9maWxlTG9jayk7Ci0gICAgICBpZiAoTlNfRkFJTEVEKHJ2KSkgcmV0dXJuOwotICAgIH0KLQot
ICAgIHJ2ID0gWFJFX0luaXRFbWJlZGRpbmcyKGdyZURpciwgYmluRGlyLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0X2Nhc3Q8R1RLRW1iZWREaXJlY3RvcnlQcm92aWRlcio+KCZr
RGlyZWN0b3J5UHJvdmlkZXIpKTsKLSAgICBpZiAoTlNfRkFJTEVEKHJ2KSkKLSAgICAgIHJldHVy
bjsKLQotICAgIGlmIChzUHJvZmlsZURpcikKLSAgICAgIFhSRV9Ob3RpZnlQcm9maWxlKCk7Ci0K
LSAgICBSZWdpc3RlckFwcENvbXBvbmVudHMoKTsKLSAgfQotfQotCi0vKiBzdGF0aWMgKi8KLXZv
aWQKLUVtYmVkUHJpdmF0ZTo6UG9wU3RhcnR1cCh2b2lkKQotewotICBzV2lkZ2V0Q291bnQtLTsK
LSAgaWYgKHNXaWRnZXRDb3VudCA9PSAwKSB7Ci0KLSAgICAvLyBkZXN0cm95IHRoZSBvZmZzY3Jl
ZW4gd2luZG93Ci0gICAgRGVzdHJveU9mZnNjcmVlbldpbmRvdygpOwotCi0gICAgLy8gd2Ugbm8g
bG9uZ2VyIG5lZWQgYSByZWZlcmVuY2UgdG8gdGhlIERpcmVjdG9yeVNlcnZpY2VQcm92aWRlcgot
ICAgIGlmIChzQXBwRmlsZUxvY1Byb3ZpZGVyKSB7Ci0gICAgICBOU19SRUxFQVNFKHNBcHBGaWxl
TG9jUHJvdmlkZXIpOwotICAgICAgc0FwcEZpbGVMb2NQcm92aWRlciA9IG5zbnVsbDsKLSAgICB9
Ci0KLSAgICAvLyBzaHV0IGRvd24gWFBDT00vRW1iZWRkaW5nCi0gICAgWFJFX1Rlcm1FbWJlZGRp
bmcoKTsKLQotICAgIE5TX0lGX1JFTEVBU0Uoc1Byb2ZpbGVMb2NrKTsKLSAgICBOU19JRl9SRUxF
QVNFKHNQcm9maWxlRGlyKTsKLSAgfQotfQotCi0vKiBzdGF0aWMgKi8KLXZvaWQgRW1iZWRQcml2
YXRlOjpTZXRQYXRoKGNvbnN0IGNoYXIgKmFQYXRoKQotewotICBpZiAoc1BhdGgpCi0gICAgZnJl
ZShzUGF0aCk7Ci0gIGlmIChhUGF0aCkKLSAgICBzUGF0aCA9IHN0cmR1cChhUGF0aCk7Ci0gIGVs
c2UKLSAgICBzUGF0aCA9IG5zbnVsbDsKLX0KLQotLyogc3RhdGljICovCi12b2lkCi1FbWJlZFBy
aXZhdGU6OlNldENvbXBQYXRoKGNvbnN0IGNoYXIgKmFQYXRoKQotewotICBpZiAoc0NvbXBQYXRo
KQotICAgIGZyZWUoc0NvbXBQYXRoKTsKLSAgaWYgKGFQYXRoKQotICAgIHNDb21wUGF0aCA9IHN0
cmR1cChhUGF0aCk7Ci0gIGVsc2UKLSAgICBzQ29tcFBhdGggPSBuc251bGw7Ci19Ci0KLS8qIHN0
YXRpYyAqLwotdm9pZAotRW1iZWRQcml2YXRlOjpTZXRQcm9maWxlUGF0aChjb25zdCBjaGFyICph
RGlyLCBjb25zdCBjaGFyICphTmFtZSkKLXsKLSAgaWYgKHNQcm9maWxlRGlyKSB7Ci0gICAgaWYg
KHNXaWRnZXRDb3VudCkgewotICAgICAgTlNfRVJST1IoIkNhbm5vdCBjaGFuZ2UgcHJvZmlsZSBk
aXJlY3RvcnkgZHVyaW5nIHJ1bi4iKTsKLSAgICAgIHJldHVybjsKLSAgICB9Ci0KLSAgICBOU19S
RUxFQVNFKHNQcm9maWxlRGlyKTsKLSAgICBOU19SRUxFQVNFKHNQcm9maWxlTG9jayk7Ci0gIH0K
LQotICBuc3Jlc3VsdCBydiA9Ci0gICAgTlNfTmV3TmF0aXZlTG9jYWxGaWxlKG5zRGVwZW5kZW50
Q1N0cmluZyhhRGlyKSwgUFJfVFJVRSwgJnNQcm9maWxlRGlyKTsKLQotICBpZiAoTlNfU1VDQ0VF
REVEKHJ2KSAmJiBhTmFtZSkKLSAgICBydiA9IHNQcm9maWxlRGlyLT5BcHBlbmROYXRpdmUobnNE
ZXBlbmRlbnRDU3RyaW5nKGFOYW1lKSk7Ci0KLSAgaWYgKE5TX1NVQ0NFRURFRChydikpIHsKLSAg
ICBQUkJvb2wgZXhpc3RzID0gUFJfRkFMU0U7Ci0gICAgcnYgPSBzUHJvZmlsZURpci0+RXhpc3Rz
KCZleGlzdHMpOwotICAgIGlmICghZXhpc3RzKQotICAgICAgcnYgPSBzUHJvZmlsZURpci0+Q3Jl
YXRlKG5zSUZpbGU6OkRJUkVDVE9SWV9UWVBFLCAwNzAwKTsKLSAgICBydiA9IFhSRV9Mb2NrUHJv
ZmlsZURpcmVjdG9yeShzUHJvZmlsZURpciwgJnNQcm9maWxlTG9jayk7Ci0gIH0KLQotICBpZiAo
TlNfU1VDQ0VFREVEKHJ2KSkgewotICAgIGlmIChzV2lkZ2V0Q291bnQpCi0gICAgICBYUkVfTm90
aWZ5UHJvZmlsZSgpOwotCi0gICAgcmV0dXJuOwotICB9Ci0KLSAgTlNfV0FSTklORygiRmFpbGVk
IHRvIGxvY2sgcHJvZmlsZS4iKTsKLQotICAvLyBGYWlsZWQKLSAgTlNfSUZfUkVMRUFTRShzUHJv
ZmlsZURpcik7Ci0gIE5TX0lGX1JFTEVBU0Uoc1Byb2ZpbGVMb2NrKTsKLX0KLQotdm9pZAotRW1i
ZWRQcml2YXRlOjpTZXREaXJlY3RvcnlTZXJ2aWNlUHJvdmlkZXIobnNJRGlyZWN0b3J5U2Vydmlj
ZVByb3ZpZGVyICogYXBwRmlsZUxvY1Byb3ZpZGVyKQotewotICBpZiAoc0FwcEZpbGVMb2NQcm92
aWRlcikKLSAgICBOU19SRUxFQVNFKHNBcHBGaWxlTG9jUHJvdmlkZXIpOwotCi0gIGlmIChhcHBG
aWxlTG9jUHJvdmlkZXIpIHsKLSAgICBzQXBwRmlsZUxvY1Byb3ZpZGVyID0gYXBwRmlsZUxvY1By
b3ZpZGVyOwotICAgIE5TX0FERFJFRihzQXBwRmlsZUxvY1Byb3ZpZGVyKTsKLSAgfQotfQotCi1u
c3Jlc3VsdAotRW1iZWRQcml2YXRlOjpPcGVuU3RyZWFtKGNvbnN0IGNoYXIgKmFCYXNlVVJJLCBj
b25zdCBjaGFyICphQ29udGVudFR5cGUpCi17Ci0gIG5zQ09NUHRyPG5zSVdlYkJyb3dzZXI+IHdl
YkJyb3dzZXI7Ci0gIG1XaW5kb3ctPkdldFdlYkJyb3dzZXIoZ2V0dGVyX0FkZFJlZnMod2ViQnJv
d3NlcikpOwotCi0gIG5zQ09NUHRyPG5zSVdlYkJyb3dzZXJTdHJlYW0+IHdiU3RyZWFtID0gZG9f
UXVlcnlJbnRlcmZhY2Uod2ViQnJvd3Nlcik7Ci0gIGlmICghd2JTdHJlYW0pIHJldHVybiBOU19F
UlJPUl9GQUlMVVJFOwotCi0gIG5zQ09NUHRyPG5zSVVSST4gdXJpOwotICBuc3Jlc3VsdCBydiA9
IE5TX05ld1VSSShnZXR0ZXJfQWRkUmVmcyh1cmkpLCBhQmFzZVVSSSk7Ci0gIGlmIChOU19GQUlM
RUQocnYpKQotICAgIHJldHVybiBydjsKLQotICBydiA9IHdiU3RyZWFtLT5PcGVuU3RyZWFtKHVy
aSwgbnNEZXBlbmRlbnRDU3RyaW5nKGFDb250ZW50VHlwZSkpOwotICByZXR1cm4gcnY7Ci19Ci0K
LW5zcmVzdWx0Ci1FbWJlZFByaXZhdGU6OkFwcGVuZFRvU3RyZWFtKGNvbnN0IFBSVWludDggKmFE
YXRhLCBQUlVpbnQzMiBhTGVuKQotewotICAvLyBBdHRhY2ggbGlzdGVuZXJzIHRvIHRoaXMgZG9j
dW1lbnQgc2luY2UgaW4gc29tZSBjYXNlcyB3ZSBkb24ndAotICAvLyBnZXQgdXBkYXRlcyBmb3Ig
Y29udGVudCBhZGRlZCB0aGlzIHdheS4KLSAgQ29udGVudFN0YXRlQ2hhbmdlKCk7Ci0KLSAgbnND
T01QdHI8bnNJV2ViQnJvd3Nlcj4gd2ViQnJvd3NlcjsKLSAgbVdpbmRvdy0+R2V0V2ViQnJvd3Nl
cihnZXR0ZXJfQWRkUmVmcyh3ZWJCcm93c2VyKSk7Ci0KLSAgbnNDT01QdHI8bnNJV2ViQnJvd3Nl
clN0cmVhbT4gd2JTdHJlYW0gPSBkb19RdWVyeUludGVyZmFjZSh3ZWJCcm93c2VyKTsKLSAgaWYg
KCF3YlN0cmVhbSkgcmV0dXJuIE5TX0VSUk9SX0ZBSUxVUkU7Ci0KLSAgcmV0dXJuIHdiU3RyZWFt
LT5BcHBlbmRUb1N0cmVhbShhRGF0YSwgYUxlbik7Ci19Ci0KLW5zcmVzdWx0Ci1FbWJlZFByaXZh
dGU6OkNsb3NlU3RyZWFtKHZvaWQpCi17Ci0gIG5zQ09NUHRyPG5zSVdlYkJyb3dzZXI+IHdlYkJy
b3dzZXI7Ci0gIG1XaW5kb3ctPkdldFdlYkJyb3dzZXIoZ2V0dGVyX0FkZFJlZnMod2ViQnJvd3Nl
cikpOwotCi0gIG5zQ09NUHRyPG5zSVdlYkJyb3dzZXJTdHJlYW0+IHdiU3RyZWFtID0gZG9fUXVl
cnlJbnRlcmZhY2Uod2ViQnJvd3Nlcik7Ci0gIGlmICghd2JTdHJlYW0pIHJldHVybiBOU19FUlJP
Ul9GQUlMVVJFOwotCi0gIHJldHVybiB3YlN0cmVhbS0+Q2xvc2VTdHJlYW0oKTsKLX0KLQotLyog
c3RhdGljICovCi1FbWJlZFByaXZhdGUgKgotRW1iZWRQcml2YXRlOjpGaW5kUHJpdmF0ZUZvckJy
b3dzZXIobnNJV2ViQnJvd3NlckNocm9tZSAqYUJyb3dzZXIpCi17Ci0gIGlmICghc1dpbmRvd0xp
c3QpCi0gICAgcmV0dXJuIG5zbnVsbDsKLQotICAvLyBHZXQgdGhlIG51bWJlciBvZiBicm93c2Vy
IHdpbmRvd3MuCi0gIFBSSW50MzIgY291bnQgPSBzV2luZG93TGlzdC0+TGVuZ3RoKCk7Ci0gIC8v
IFRoaXMgZnVuY3Rpb24gZG9lc24ndCBnZXQgY2FsbGVkIHZlcnkgb2Z0ZW4gYXQgYWxsICggb25s
eSB3aGVuCi0gIC8vIGNyZWF0aW5nIGEgbmV3IHdpbmRvdyApIHNvIGl0J3MgT0sgdG8gd2FsayB0
aGUgbGlzdCBvZiBvcGVuCi0gIC8vIHdpbmRvd3MuCi0gIGZvciAoaW50IGkgPSAwOyBpIDwgY291
bnQ7IGkrKykgewotICAgIEVtYmVkUHJpdmF0ZSAqdG1wUHJpdmF0ZSA9IHNXaW5kb3dMaXN0LT5F
bGVtZW50QXQoaSk7Ci0gICAgLy8gZ2V0IHRoZSBicm93c2VyIG9iamVjdCBmb3IgdGhhdCB3aW5k
b3cKLSAgICBuc0lXZWJCcm93c2VyQ2hyb21lICpjaHJvbWUgPSBzdGF0aWNfY2FzdDxuc0lXZWJC
cm93c2VyQ2hyb21lICo+KAotCQkJCQkJIHRtcFByaXZhdGUtPm1XaW5kb3cpOwotICAgIGlmIChj
aHJvbWUgPT0gYUJyb3dzZXIpCi0gICAgICByZXR1cm4gdG1wUHJpdmF0ZTsKLSAgfQotCi0gIHJl
dHVybiBuc251bGw7Ci19Ci0KLXZvaWQKLUVtYmVkUHJpdmF0ZTo6Q29udGVudFN0YXRlQ2hhbmdl
KHZvaWQpCi17Ci0KLSAgLy8gd2UgZG9uJ3QgYXR0YWNoIGxpc3RlbmVycyB0byBjaHJvbWUKLSAg
aWYgKG1MaXN0ZW5lcnNBdHRhY2hlZCAmJiAhbUlzQ2hyb21lKQotICAgIHJldHVybjsKLQotICBH
ZXRMaXN0ZW5lcigpOwotCi0gIGlmICghbUV2ZW50VGFyZ2V0KQotICAgIHJldHVybjsKLQotICBB
dHRhY2hMaXN0ZW5lcnMoKTsKLQotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OkNvbnRlbnRGaW5p
c2hlZExvYWRpbmcodm9pZCkKLXsKLSAgaWYgKG1Jc0Nocm9tZSkgewotICAgIC8vIFdlJ3JlIGRv
bmUgbG9hZGluZy4KLSAgICBtQ2hyb21lTG9hZGVkID0gUFJfVFJVRTsKLQotICAgIC8vIGdldCB0
aGUgd2ViIGJyb3dzZXIKLSAgICBuc0NPTVB0cjxuc0lXZWJCcm93c2VyPiB3ZWJCcm93c2VyOwot
ICAgIG1XaW5kb3ctPkdldFdlYkJyb3dzZXIoZ2V0dGVyX0FkZFJlZnMod2ViQnJvd3NlcikpOwot
Ci0gICAgLy8gZ2V0IHRoZSBjb250ZW50IERPTSB3aW5kb3cgZm9yIHRoYXQgd2ViIGJyb3dzZXIK
LSAgICBuc0NPTVB0cjxuc0lET01XaW5kb3c+IGRvbVdpbmRvdzsKLSAgICB3ZWJCcm93c2VyLT5H
ZXRDb250ZW50RE9NV2luZG93KGdldHRlcl9BZGRSZWZzKGRvbVdpbmRvdykpOwotICAgIGlmICgh
ZG9tV2luZG93KSB7Ci0gICAgICBOU19XQVJOSU5HKCJubyBkb20gd2luZG93IGluIGNvbnRlbnQg
ZmluaXNoZWQgbG9hZGluZ1xuIik7Ci0gICAgICByZXR1cm47Ci0gICAgfQotCi0gICAgLy8gcmVz
aXplIHRoZSBjb250ZW50Ci0gICAgZG9tV2luZG93LT5TaXplVG9Db250ZW50KCk7Ci0KLSAgICAv
LyBhbmQgc2luY2Ugd2UncmUgZG9uZSBsb2FkaW5nIHNob3cgdGhlIHdpbmRvdywgYXNzdW1pbmcg
dGhhdCB0aGUKLSAgICAvLyB2aXNpYmlsaXR5IGZsYWcgaGFzIGJlZW4gc2V0LgotICAgIFBSQm9v
bCB2aXNpYmlsaXR5OwotICAgIG1XaW5kb3ctPkdldFZpc2liaWxpdHkoJnZpc2liaWxpdHkpOwot
ICAgIGlmICh2aXNpYmlsaXR5KQotICAgICAgbVdpbmRvdy0+U2V0VmlzaWJpbGl0eShQUl9UUlVF
KTsKLSAgfQotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OkNoaWxkRm9jdXNJbih2b2lkKQotewot
ICBpZiAobUlzRGVzdHJveWVkKQotICAgIHJldHVybjsKLQotICBuc3Jlc3VsdCBydjsKLSAgbnND
T01QdHI8bnNJV2ViQnJvd3Nlcj4gd2ViQnJvd3NlcjsKLSAgcnYgPSBtV2luZG93LT5HZXRXZWJC
cm93c2VyKGdldHRlcl9BZGRSZWZzKHdlYkJyb3dzZXIpKTsKLSAgaWYgKE5TX0ZBSUxFRChydikp
Ci0gICAgcmV0dXJuOwotCi0gIG5zQ09NUHRyPG5zSVdlYkJyb3dzZXJGb2N1cz4gd2ViQnJvd3Nl
ckZvY3VzKGRvX1F1ZXJ5SW50ZXJmYWNlKHdlYkJyb3dzZXIpKTsKLSAgaWYgKCF3ZWJCcm93c2Vy
Rm9jdXMpCi0gICAgcmV0dXJuOwotICAKLSAgd2ViQnJvd3NlckZvY3VzLT5BY3RpdmF0ZSgpOwot
fQotCi12b2lkCi1FbWJlZFByaXZhdGU6OkNoaWxkRm9jdXNPdXQodm9pZCkKLXsKLSAgaWYgKG1J
c0Rlc3Ryb3llZCkKLSAgICByZXR1cm47Ci0KLSAgbnNyZXN1bHQgcnY7Ci0gIG5zQ09NUHRyPG5z
SVdlYkJyb3dzZXI+IHdlYkJyb3dzZXI7Ci0gIHJ2ID0gbVdpbmRvdy0+R2V0V2ViQnJvd3Nlcihn
ZXR0ZXJfQWRkUmVmcyh3ZWJCcm93c2VyKSk7Ci0gIGlmIChOU19GQUlMRUQocnYpKQotCSAgcmV0
dXJuOwotCi0gIG5zQ09NUHRyPG5zSVdlYkJyb3dzZXJGb2N1cz4gd2ViQnJvd3NlckZvY3VzKGRv
X1F1ZXJ5SW50ZXJmYWNlKHdlYkJyb3dzZXIpKTsKLSAgaWYgKCF3ZWJCcm93c2VyRm9jdXMpCi0J
ICByZXR1cm47Ci0gIAotICB3ZWJCcm93c2VyRm9jdXMtPkRlYWN0aXZhdGUoKTsKLX0KLQotLy8g
R2V0IHRoZSBldmVudCBsaXN0ZW5lciBmb3IgdGhlIGNocm9tZSBldmVudCBoYW5kbGVyLgotCi12
b2lkCi1FbWJlZFByaXZhdGU6OkdldExpc3RlbmVyKHZvaWQpCi17Ci0gIGlmIChtRXZlbnRUYXJn
ZXQpCi0gICAgcmV0dXJuOwotCi0gIG5zQ09NUHRyPG5zUElET01XaW5kb3c+IHBpV2luOwotICBH
ZXRQSURPTVdpbmRvdyhnZXR0ZXJfQWRkUmVmcyhwaVdpbikpOwotCi0gIGlmICghcGlXaW4pCi0g
ICAgcmV0dXJuOwotCi0gIG1FdmVudFRhcmdldCA9IGRvX1F1ZXJ5SW50ZXJmYWNlKHBpV2luLT5H
ZXRDaHJvbWVFdmVudEhhbmRsZXIoKSk7Ci19Ci0KLS8vIGF0dGFjaCBrZXkgYW5kIG1vdXNlIGV2
ZW50IGxpc3RlbmVycwotCi12b2lkCi1FbWJlZFByaXZhdGU6OkF0dGFjaExpc3RlbmVycyh2b2lk
KQotewotICBpZiAoIW1FdmVudFRhcmdldCB8fCBtTGlzdGVuZXJzQXR0YWNoZWQpCi0gICAgcmV0
dXJuOwotCi0gIG5zSURPTUV2ZW50TGlzdGVuZXIgKmV2ZW50TGlzdGVuZXIgPQotICAgIHN0YXRp
Y19jYXN0PG5zSURPTUV2ZW50TGlzdGVuZXIgKj4oc3RhdGljX2Nhc3Q8bnNJRE9NS2V5TGlzdGVu
ZXIgKj4obUV2ZW50TGlzdGVuZXIpKTsKLQotICAvLyBhZGQgdGhlIGtleSBsaXN0ZW5lcgotICBu
c3Jlc3VsdCBydjsKLSAgcnYgPSBtRXZlbnRUYXJnZXQtPkFkZEV2ZW50TGlzdGVuZXJCeUlJRChl
dmVudExpc3RlbmVyLAotCQkJCQkgICAgIE5TX0dFVF9JSUQobnNJRE9NS2V5TGlzdGVuZXIpKTsK
LSAgaWYgKE5TX0ZBSUxFRChydikpIHsKLSAgICBOU19XQVJOSU5HKCJGYWlsZWQgdG8gYWRkIGtl
eSBsaXN0ZW5lclxuIik7Ci0gICAgcmV0dXJuOwotICB9Ci0KLSAgcnYgPSBtRXZlbnRUYXJnZXQt
PkFkZEV2ZW50TGlzdGVuZXJCeUlJRChldmVudExpc3RlbmVyLAotCQkJCQkgICAgIE5TX0dFVF9J
SUQobnNJRE9NTW91c2VMaXN0ZW5lcikpOwotICBpZiAoTlNfRkFJTEVEKHJ2KSkgewotICAgIE5T
X1dBUk5JTkcoIkZhaWxlZCB0byBhZGQgbW91c2UgbGlzdGVuZXJcbiIpOwotICAgIHJldHVybjsK
LSAgfQotCi0gIHJ2ID0gbUV2ZW50VGFyZ2V0LT5BZGRFdmVudExpc3RlbmVyQnlJSUQoZXZlbnRM
aXN0ZW5lciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5T
X0dFVF9JSUQobnNJRE9NVUlMaXN0ZW5lcikpOwotICBpZiAoTlNfRkFJTEVEKHJ2KSkgewotICAg
IE5TX1dBUk5JTkcoIkZhaWxlZCB0byBhZGQgVUkgbGlzdGVuZXJcbiIpOwotICAgIHJldHVybjsK
LSAgfQotCi0gIC8vIG9rLCBhbGwgc2V0LgotICBtTGlzdGVuZXJzQXR0YWNoZWQgPSBQUl9UUlVF
OwotfQotCi12b2lkCi1FbWJlZFByaXZhdGU6OkRldGFjaExpc3RlbmVycyh2b2lkKQotewotICBp
ZiAoIW1MaXN0ZW5lcnNBdHRhY2hlZCB8fCAhbUV2ZW50VGFyZ2V0KQotICAgIHJldHVybjsKLQot
ICBuc0lET01FdmVudExpc3RlbmVyICpldmVudExpc3RlbmVyID0KLSAgICBzdGF0aWNfY2FzdDxu
c0lET01FdmVudExpc3RlbmVyICo+KHN0YXRpY19jYXN0PG5zSURPTUtleUxpc3RlbmVyICo+KG1F
dmVudExpc3RlbmVyKSk7Ci0KLSAgbnNyZXN1bHQgcnY7Ci0gIHJ2ID0gbUV2ZW50VGFyZ2V0LT5S
ZW1vdmVFdmVudExpc3RlbmVyQnlJSUQoZXZlbnRMaXN0ZW5lciwKLQkJCQkJCU5TX0dFVF9JSUQo
bnNJRE9NS2V5TGlzdGVuZXIpKTsKLSAgaWYgKE5TX0ZBSUxFRChydikpIHsKLSAgICBOU19XQVJO
SU5HKCJGYWlsZWQgdG8gcmVtb3ZlIGtleSBsaXN0ZW5lclxuIik7Ci0gICAgcmV0dXJuOwotICB9
Ci0KLSAgcnYgPQotICAgIG1FdmVudFRhcmdldC0+UmVtb3ZlRXZlbnRMaXN0ZW5lckJ5SUlEKGV2
ZW50TGlzdGVuZXIsCi0JCQkJCSAgICAgTlNfR0VUX0lJRChuc0lET01Nb3VzZUxpc3RlbmVyKSk7
Ci0gIGlmIChOU19GQUlMRUQocnYpKSB7Ci0gICAgTlNfV0FSTklORygiRmFpbGVkIHRvIHJlbW92
ZSBtb3VzZSBsaXN0ZW5lclxuIik7Ci0gICAgcmV0dXJuOwotICB9Ci0KLSAgcnYgPSBtRXZlbnRU
YXJnZXQtPlJlbW92ZUV2ZW50TGlzdGVuZXJCeUlJRChldmVudExpc3RlbmVyLAotCQkJCQkJTlNf
R0VUX0lJRChuc0lET01VSUxpc3RlbmVyKSk7Ci0gIGlmIChOU19GQUlMRUQocnYpKSB7Ci0gICAg
TlNfV0FSTklORygiRmFpbGVkIHRvIHJlbW92ZSBVSSBsaXN0ZW5lclxuIik7Ci0gICAgcmV0dXJu
OwotICB9Ci0KLSAgbUxpc3RlbmVyc0F0dGFjaGVkID0gUFJfRkFMU0U7Ci19Ci0KLW5zcmVzdWx0
Ci1FbWJlZFByaXZhdGU6OkdldFBJRE9NV2luZG93KG5zUElET01XaW5kb3cgKiphUElXaW4pCi17
Ci0gICphUElXaW4gPSBuc251bGw7Ci0KLSAgLy8gZ2V0IHRoZSB3ZWIgYnJvd3NlcgotICBuc0NP
TVB0cjxuc0lXZWJCcm93c2VyPiB3ZWJCcm93c2VyOwotICBtV2luZG93LT5HZXRXZWJCcm93c2Vy
KGdldHRlcl9BZGRSZWZzKHdlYkJyb3dzZXIpKTsKLQotICAvLyBnZXQgdGhlIGNvbnRlbnQgRE9N
IHdpbmRvdyBmb3IgdGhhdCB3ZWIgYnJvd3NlcgotICBuc0NPTVB0cjxuc0lET01XaW5kb3c+IGRv
bVdpbmRvdzsKLSAgd2ViQnJvd3Nlci0+R2V0Q29udGVudERPTVdpbmRvdyhnZXR0ZXJfQWRkUmVm
cyhkb21XaW5kb3cpKTsKLSAgaWYgKCFkb21XaW5kb3cpCi0gICAgcmV0dXJuIE5TX0VSUk9SX0ZB
SUxVUkU7Ci0KLSAgLy8gZ2V0IHRoZSBwcml2YXRlIERPTSB3aW5kb3cKLSAgbnNDT01QdHI8bnNQ
SURPTVdpbmRvdz4gZG9tV2luZG93UHJpdmF0ZSA9IGRvX1F1ZXJ5SW50ZXJmYWNlKGRvbVdpbmRv
dyk7Ci0gIC8vIGFuZCB0aGUgcm9vdCB3aW5kb3cgZm9yIHRoYXQgRE9NIHdpbmRvdwotICAqYVBJ
V2luID0gZG9tV2luZG93UHJpdmF0ZS0+R2V0UHJpdmF0ZVJvb3QoKTsKLQotICBpZiAoKmFQSVdp
bikgewotICAgIE5TX0FERFJFRigqYVBJV2luKTsKLSAgICByZXR1cm4gTlNfT0s7Ci0gIH0KLQot
ICByZXR1cm4gTlNfRVJST1JfRkFJTFVSRTsKLQotfQotCi0jaWZkZWYgTU9aX0FDQ0VTU0lCSUxJ
VFlfQVRLCi12b2lkICoKLUVtYmVkUHJpdmF0ZTo6R2V0QXRrT2JqZWN0Rm9yQ3VycmVudERvY3Vt
ZW50KCkKLXsKLSAgaWYgKCFtTmF2aWdhdGlvbikKLSAgICByZXR1cm4gbnNudWxsOwotCi0gIG5z
Q09NUHRyPG5zSUFjY2Vzc2liaWxpdHlTZXJ2aWNlPiBhY2NTZXJ2aWNlID0KLSAgICBkb19HZXRT
ZXJ2aWNlKCJAbW96aWxsYS5vcmcvYWNjZXNzaWJpbGl0eVNlcnZpY2U7MSIpOwotICBpZiAoYWNj
U2VydmljZSkgewotICAgIC8vZ2V0IGN1cnJlbnQgZG9jdW1lbnQKLSAgICBuc0NPTVB0cjxuc0lE
T01Eb2N1bWVudD4gZG9tRG9jOwotICAgIG1OYXZpZ2F0aW9uLT5HZXREb2N1bWVudChnZXR0ZXJf
QWRkUmVmcyhkb21Eb2MpKTsKLSAgICBOU19FTlNVUkVfVFJVRShkb21Eb2MsIG5zbnVsbCk7Ci0K
LSAgICBuc0NPTVB0cjxuc0lET01Ob2RlPiBkb21Ob2RlKGRvX1F1ZXJ5SW50ZXJmYWNlKGRvbURv
YykpOwotICAgIE5TX0VOU1VSRV9UUlVFKGRvbU5vZGUsIG5zbnVsbCk7Ci0KLSAgICBuc0NPTVB0
cjxuc0lBY2Nlc3NpYmxlPiBhY2M7Ci0gICAgYWNjU2VydmljZS0+R2V0QWNjZXNzaWJsZUZvcihk
b21Ob2RlLCBnZXR0ZXJfQWRkUmVmcyhhY2MpKTsKLSAgICBOU19FTlNVUkVfVFJVRShhY2MsIG5z
bnVsbCk7Ci0KLSAgICB2b2lkICphdGtPYmogPSBuc251bGw7Ci0gICAgaWYgKE5TX1NVQ0NFRURF
RChhY2MtPkdldE5hdGl2ZUludGVyZmFjZSgmYXRrT2JqKSkpCi0gICAgICByZXR1cm4gYXRrT2Jq
OwotICB9Ci0gIHJldHVybiBuc251bGw7Ci19Ci0jZW5kaWYgLyogTU9aX0FDQ0VTU0lCSUxJVFlf
QVRLICovCi0KLS8qIHN0YXRpYyAqLwotdm9pZAotRW1iZWRQcml2YXRlOjpSZWdpc3RlckFwcENv
bXBvbmVudHModm9pZCkKLXsKLSAgWFJFX0FkZFN0YXRpY0NvbXBvbmVudCgma0RlZmF1bHRQcm9t
cHRNb2R1bGUpOwotfQotCi0vKiBzdGF0aWMgKi8KLXZvaWQKLUVtYmVkUHJpdmF0ZTo6RW5zdXJl
T2Zmc2NyZWVuV2luZG93KHZvaWQpCi17Ci0gIGlmIChzT2Zmc2NyZWVuV2luZG93KQotICAgIHJl
dHVybjsKLSAgc09mZnNjcmVlbldpbmRvdyA9IGd0a193aW5kb3dfbmV3KEdUS19XSU5ET1dfVE9Q
TEVWRUwpOwotICBndGtfd2lkZ2V0X3JlYWxpemUoc09mZnNjcmVlbldpbmRvdyk7Ci0gIHNPZmZz
Y3JlZW5GaXhlZCA9IGd0a19maXhlZF9uZXcoKTsKLSAgZ3RrX2NvbnRhaW5lcl9hZGQoR1RLX0NP
TlRBSU5FUihzT2Zmc2NyZWVuV2luZG93KSwgc09mZnNjcmVlbkZpeGVkKTsKLSAgZ3RrX3dpZGdl
dF9yZWFsaXplKHNPZmZzY3JlZW5GaXhlZCk7Ci19Ci0KLS8qIHN0YXRpYyAqLwotdm9pZAotRW1i
ZWRQcml2YXRlOjpEZXN0cm95T2Zmc2NyZWVuV2luZG93KHZvaWQpCi17Ci0gIGlmICghc09mZnNj
cmVlbldpbmRvdykKLSAgICByZXR1cm47Ci0gIGd0a193aWRnZXRfZGVzdHJveShzT2Zmc2NyZWVu
V2luZG93KTsKLSAgc09mZnNjcmVlbldpbmRvdyA9IDA7Ci19CmRpZmYgLS1naXQgYS9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJpdmF0ZS5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3Rr
L3NyYy9FbWJlZFByaXZhdGUuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRk
aW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZFByaXZhdGUuaAorKysgL2Rldi9udWxsCkBAIC0xLDE4
OCArMCwwIEBACi0vKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0gKiBWZXJzaW9u
OiBNUEwgMS4xL0dQTCAyLjAvTEdQTCAyLjEKLSAqCi0gKiBUaGUgY29udGVudHMgb2YgdGhpcyBm
aWxlIGFyZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KLSAq
IDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGlu
IGNvbXBsaWFuY2Ugd2l0aAotICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBv
ZiB0aGUgTGljZW5zZSBhdAotICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCi0gKgotICog
U29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24g
YW4gIkFTIElTIiBiYXNpcywKLSAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhl
ciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZQotICogZm9yIHRoZSBzcGVjaWZp
YyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKLSAq
IExpY2Vuc2UuCi0gKgotICogVGhlIE9yaWdpbmFsIENvZGUgaXMgbW96aWxsYS5vcmcgY29kZS4K
LSAqCi0gKiBUaGUgSW5pdGlhbCBEZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMKLSAq
IENocmlzdG9waGVyIEJsaXp6YXJkLgotICogUG9ydGlvbnMgY3JlYXRlZCBieSB0aGUgSW5pdGlh
bCBEZXZlbG9wZXIgYXJlIENvcHlyaWdodCAoQykgMjAwMQotICogdGhlIEluaXRpYWwgRGV2ZWxv
cGVyLiBBbGwgUmlnaHRzIFJlc2VydmVkLgotICoKLSAqIENvbnRyaWJ1dG9yKHMpOgotICogICBD
aHJpc3RvcGhlciBCbGl6emFyZCA8YmxpenphcmRAbW96aWxsYS5vcmc+Ci0gKgotICogQWx0ZXJu
YXRpdmVseSwgdGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0aGUg
dGVybXMgb2YKLSAqIGVpdGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lv
biAyIG9yIGxhdGVyICh0aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBWZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBpbiB3
aGljaCBjYXNlIHRoZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFwcGxp
Y2FibGUgaW5zdGVhZAotICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93IHVz
ZSBvZiB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJtcyBv
ZiBlaXRoZXIgdGhlIEdQTCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMgdG8K
LSAqIHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
TVBMLCBpbmRpY2F0ZSB5b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlzaW9u
cyBhYm92ZSBhbmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVyIHBy
b3Zpc2lvbnMgcmVxdWlyZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5vdCBk
ZWxldGUKLSAqIHRoZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlvdXIg
dmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9mIHRo
ZSBNUEwsIHRoZSBHUEwgb3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0UgQkxP
Q0sgKioqKiogKi8KLQotI2lmbmRlZiBfX0VtYmVkUHJpdmF0ZV9oCi0jZGVmaW5lIF9fRW1iZWRQ
cml2YXRlX2gKLQotI2luY2x1ZGUgIm5zQ09NUHRyLmgiCi0jaW5jbHVkZSAibnNTdHJpbmdHbHVl
LmgiCi0jaW5jbHVkZSAibnNJV2ViTmF2aWdhdGlvbi5oIgotI2luY2x1ZGUgIm5zSVNIaXN0b3J5
LmgiCi0vLyBmb3Igb3VyIG9uZSBmdW5jdGlvbiB0aGF0IGdldHMgdGhlIEVtYmVkUHJpdmF0ZSB2
aWEgdGhlIGNocm9tZQotLy8gb2JqZWN0LgotI2luY2x1ZGUgIm5zSVdlYkJyb3dzZXJDaHJvbWUu
aCIKLSNpbmNsdWRlICJuc0lBcHBTaGVsbC5oIgotI2luY2x1ZGUgIm5zUElET01FdmVudFRhcmdl
dC5oIgotI2luY2x1ZGUgIm5zVEFycmF5LmgiCi0KLSNpbmNsdWRlICJndGttb3plbWJlZHByaXZh
dGUuaCIKLQotY2xhc3MgRW1iZWRQcm9ncmVzczsKLWNsYXNzIEVtYmVkV2luZG93OwotY2xhc3Mg
RW1iZWRDb250ZW50TGlzdGVuZXI7Ci1jbGFzcyBFbWJlZEV2ZW50TGlzdGVuZXI7Ci0KLWNsYXNz
IG5zUElET01XaW5kb3c7Ci1jbGFzcyBuc0lEaXJlY3RvcnlTZXJ2aWNlUHJvdmlkZXI7Ci0KLWNs
YXNzIEVtYmVkUHJpdmF0ZSB7Ci0KLSBwdWJsaWM6Ci0KLSAgRW1iZWRQcml2YXRlKCk7Ci0gIH5F
bWJlZFByaXZhdGUoKTsKLQotICBuc3Jlc3VsdCAgICBJbml0ICAgICAgICAgICAgKEd0a01vekVt
YmVkICphT3duaW5nV2lkZ2V0KTsKLSAgbnNyZXN1bHQgICAgUmVhbGl6ZSAgICAgICAgIChQUkJv
b2wgKmFBbHJlYWRSZWFsaXplZCk7Ci0gIHZvaWQgICAgICAgIFVucmVhbGl6ZSAgICAgICAodm9p
ZCk7Ci0gIHZvaWQgICAgICAgIFNob3cgICAgICAgICAgICAodm9pZCk7Ci0gIHZvaWQgICAgICAg
IEhpZGUgICAgICAgICAgICAodm9pZCk7Ci0gIHZvaWQgICAgICAgIFJlc2l6ZSAgICAgICAgICAo
UFJVaW50MzIgYVdpZHRoLCBQUlVpbnQzMiBhSGVpZ2h0KTsKLSAgdm9pZCAgICAgICAgRGVzdHJv
eSAgICAgICAgICh2b2lkKTsKLSAgdm9pZCAgICAgICAgU2V0VVJJICAgICAgICAgIChjb25zdCBj
aGFyICphVVJJKTsKLSAgdm9pZCAgICAgICAgTG9hZEN1cnJlbnRVUkkgICh2b2lkKTsKLSAgdm9p
ZCAgICAgICAgUmVsb2FkICAgICAgICAgIChQUlVpbnQzMiByZWxvYWRGbGFncyk7Ci0KLSAgdm9p
ZCAgICAgICAgU2V0Q2hyb21lTWFzayAgIChQUlVpbnQzMiBjaHJvbWVNYXNrKTsKLSAgdm9pZCAg
ICAgICAgQXBwbHlDaHJvbWVNYXNrICgpOwotCi0gIHN0YXRpYyB2b2lkIFB1c2hTdGFydHVwICAg
ICAodm9pZCk7Ci0gIHN0YXRpYyB2b2lkIFBvcFN0YXJ0dXAgICAgICAodm9pZCk7Ci0gIHN0YXRp
YyB2b2lkIFNldFBhdGggICAgICAgICAoY29uc3QgY2hhciAqYVBhdGgpOwotICBzdGF0aWMgdm9p
ZCBTZXRDb21wUGF0aCAgICAgKGNvbnN0IGNoYXIgKmFQYXRoKTsKLSAgc3RhdGljIHZvaWQgU2V0
UHJvZmlsZVBhdGggIChjb25zdCBjaGFyICphRGlyLCBjb25zdCBjaGFyICphTmFtZSk7Ci0gIHN0
YXRpYyB2b2lkIFNldERpcmVjdG9yeVNlcnZpY2VQcm92aWRlciAobnNJRGlyZWN0b3J5U2Vydmlj
ZVByb3ZpZGVyICogYXBwRmlsZUxvY1Byb3ZpZGVyKTsKLQotICBuc3Jlc3VsdCBPcGVuU3RyZWFt
ICAgICAgICAgKGNvbnN0IGNoYXIgKmFCYXNlVVJJLCBjb25zdCBjaGFyICphQ29udGVudFR5cGUp
OwotICBuc3Jlc3VsdCBBcHBlbmRUb1N0cmVhbSAgICAgKGNvbnN0IFBSVWludDggKmFEYXRhLCBQ
UlVpbnQzMiBhTGVuKTsKLSAgbnNyZXN1bHQgQ2xvc2VTdHJlYW0gICAgICAgICh2b2lkKTsKLQot
ICAvLyBUaGlzIGZ1bmN0aW9uIHdpbGwgZmluZCB0aGUgc3BlY2lmaWMgRW1iZWRQcml2YXRlIG9i
amVjdCBmb3IgYQotICAvLyBnaXZlbiBuc0lXZWJCcm93c2VyQ2hyb21lLgotICBzdGF0aWMgRW1i
ZWRQcml2YXRlICpGaW5kUHJpdmF0ZUZvckJyb3dzZXIobnNJV2ViQnJvd3NlckNocm9tZSAqYUJy
b3dzZXIpOwotCi0gIC8vIFRoaXMgaXMgYW4gdXBjYWxsIHRoYXQgd2lsbCBjb21lIGZyb20gdGhl
IHByb2dyZXNzIGxpc3RlbmVyCi0gIC8vIHdoZW5ldmVyIHRoZXJlIGlzIGEgY29udGVudCBzdGF0
ZSBjaGFuZ2UuICBXZSBuZWVkIHRoaXMgc28gd2UgY2FuCi0gIC8vIGF0dGFjaCBldmVudCBsaXN0
ZW5lcnMuCi0gIHZvaWQgICAgICAgIENvbnRlbnRTdGF0ZUNoYW5nZSAgICAodm9pZCk7Ci0KLSAg
Ly8gVGhpcyBpcyBhbiB1cGNhbGwgZnJvbSB0aGUgcHJvZ3Jlc3MgbGlzdGVuZXIgd2hlbiBjb250
ZW50IGlzCi0gIC8vIGZpbmlzaGVkIGxvYWRpbmcuICBXZSBoYXZlIHRoaXMgc28gdGhhdCBpZiBp
dCdzIGNocm9tZSBjb250ZW50Ci0gIC8vIHRoYXQgd2UgY2FuIHNpemUgdG8gY29udGVudCBwcm9w
ZXJseSBhbmQgc2hvdyBvdXJzZWx2ZXMgaWYKLSAgLy8gdmlzaWJpbGl0eSBpcyBzZXQuCi0gIHZv
aWQgICAgICAgIENvbnRlbnRGaW5pc2hlZExvYWRpbmcodm9pZCk7Ci0KLSAgLy8gdGhlc2UgYXJl
IHdoZW4gdGhlIHdpZGdldCBpdHNlbGYgZ2V0cyBmb2N1cyBpbiBhbmQgZm9jdXMgb3V0Ci0gIC8v
IGV2ZW50cwotICB2b2lkICAgICAgICBDaGlsZEZvY3VzSW4gKHZvaWQpOwotICB2b2lkICAgICAg
ICBDaGlsZEZvY3VzT3V0KHZvaWQpOwotCi0jaWZkZWYgTU9aX0FDQ0VTU0lCSUxJVFlfQVRLCi0g
IHZvaWQgKkdldEF0a09iamVjdEZvckN1cnJlbnREb2N1bWVudCgpOwotI2VuZGlmCi0KLSAgR3Rr
TW96RW1iZWQgICAgICAgICAgICAgICAgICAgKm1Pd25pbmdXaWRnZXQ7Ci0KLSAgLy8gYWxsIG9m
IHRoZSBvYmplY3RzIHRoYXQgd2Ugb3duCi0gIEVtYmVkV2luZG93ICAgICAgICAgICAgICAgICAg
ICptV2luZG93OwotICBuc0NPTVB0cjxuc0lTdXBwb3J0cz4gICAgICAgICAgbVdpbmRvd0d1YXJk
OwotICBFbWJlZFByb2dyZXNzICAgICAgICAgICAgICAgICAqbVByb2dyZXNzOwotICBuc0NPTVB0
cjxuc0lTdXBwb3J0cz4gICAgICAgICAgbVByb2dyZXNzR3VhcmQ7Ci0gIEVtYmVkQ29udGVudExp
c3RlbmVyICAgICAgICAgICptQ29udGVudExpc3RlbmVyOwotICBuc0NPTVB0cjxuc0lTdXBwb3J0
cz4gICAgICAgICAgbUNvbnRlbnRMaXN0ZW5lckd1YXJkOwotICBFbWJlZEV2ZW50TGlzdGVuZXIg
ICAgICAgICAgICAqbUV2ZW50TGlzdGVuZXI7Ci0gIG5zQ09NUHRyPG5zSVN1cHBvcnRzPiAgICAg
ICAgICBtRXZlbnRMaXN0ZW5lckd1YXJkOwotCi0gIG5zQ09NUHRyPG5zSVdlYk5hdmlnYXRpb24+
ICAgICBtTmF2aWdhdGlvbjsKLSAgbnNDT01QdHI8bnNJU0hpc3Rvcnk+ICAgICAgICAgIG1TZXNz
aW9uSGlzdG9yeTsKLQotICAvLyBvdXIgZXZlbnQgcmVjZWl2ZXIKLSAgbnNDT01QdHI8bnNQSURP
TUV2ZW50VGFyZ2V0PiAgIG1FdmVudFRhcmdldDsKLQotICAvLyB0aGUgY3VycmVudGx5IGxvYWRl
ZCB1cmkKLSAgbnNDU3RyaW5nICAgICAgICAgICAgICAgICAgICAgIG1VUkk7Ci0KLSAgLy8gdGhl
IG51bWJlciBvZiB3aWRnZXRzIHRoYXQgaGF2ZSBiZWVuIGNyZWF0ZWQKLSAgc3RhdGljIFBSVWlu
dDMyICAgICAgICAgICAgICAgIHNXaWRnZXRDb3VudDsKLSAgLy8gdGhlIHBhdGggdG8gdGhlIEdS
RQotICBzdGF0aWMgY2hhciAgICAgICAgICAgICAgICAgICAqc1BhdGg7Ci0gIC8vIHRoZSBwYXRo
IHRvIGNvbXBvbmVudHMKLSAgc3RhdGljIGNoYXIgICAgICAgICAgICAgICAgICAgKnNDb21wUGF0
aDsKLSAgLy8gdGhlIGFwcHNoZWxsIHdlIGhhdmUgY3JlYXRlZAotICBzdGF0aWMgbnNJQXBwU2hl
bGwgICAgICAgICAgICAqc0FwcFNoZWxsOwotICAvLyB0aGUgbGlzdCBvZiBhbGwgb3BlbiB3aW5k
b3dzCi0gIHN0YXRpYyBuc1RBcnJheTxFbWJlZFByaXZhdGUqPiAqc1dpbmRvd0xpc3Q7Ci0gIC8v
IHdoYXQgaXMgb3VyIHByb2ZpbGUgcGF0aD8KLSAgc3RhdGljIG5zSUxvY2FsRmlsZSAgICAgICAg
ICAgKnNQcm9maWxlRGlyOwotICBzdGF0aWMgbnNJU3VwcG9ydHMgICAgICAgICAgICAqc1Byb2Zp
bGVMb2NrOwotCi0gIHN0YXRpYyBuc0lEaXJlY3RvcnlTZXJ2aWNlUHJvdmlkZXIgKiBzQXBwRmls
ZUxvY1Byb3ZpZGVyOwotCi0gIC8vIGNocm9tZSBtYXNrCi0gIFBSVWludDMyICAgICAgICAgICAg
ICAgICAgICAgICBtQ2hyb21lTWFzazsKLSAgLy8gaXMgdGhpcyBhIGNocm9tZSB3aW5kb3c/Ci0g
IFBSQm9vbCAgICAgICAgICAgICAgICAgICAgICAgICBtSXNDaHJvbWU7Ci0gIC8vIGhhcyB0aGUg
Y2hyb21lIGZpbmlzaGVkIGxvYWRpbmc/Ci0gIFBSQm9vbCAgICAgICAgICAgICAgICAgICAgICAg
ICBtQ2hyb21lTG9hZGVkOwotICAvLyBzYXZlZCB3aW5kb3cgSUQgZm9yIHJlcGFyZW50aW5nIGxh
dGVyCi0gIEd0a1dpZGdldCAgICAgICAgICAgICAgICAgICAgICptTW96V2luZG93V2lkZ2V0Owot
ICAvLyBoYXMgc29tZW9uZSBjYWxsZWQgRGVzdHJveSgpIG9uIHVzPwotICBQUkJvb2wgICAgICAg
ICAgICAgICAgICAgICAgICAgbUlzRGVzdHJveWVkOwotCi0gcHJpdmF0ZToKLQotICAvLyBpcyB0
aGUgY2hyb21lIGxpc3RlbmVyIGF0dGFjaGVkIHlldD8KLSAgUFJCb29sICAgICAgICAgICAgICAg
ICAgICAgICAgIG1MaXN0ZW5lcnNBdHRhY2hlZDsKLQotICB2b2lkIEdldExpc3RlbmVyICAgICh2
b2lkKTsKLSAgdm9pZCBBdHRhY2hMaXN0ZW5lcnModm9pZCk7Ci0gIHZvaWQgRGV0YWNoTGlzdGVu
ZXJzKHZvaWQpOwotCi0gIC8vIHRoaXMgd2lsbCBnZXQgdGhlIFBJRE9NV2luZG93IGZvciB0aGlz
IHdpZGdldAotICBuc3Jlc3VsdCAgICAgICAgR2V0UElET01XaW5kb3cgICAobnNQSURPTVdpbmRv
dyAqKmFQSVdpbik7Ci0gIAotICBzdGF0aWMgdm9pZCBSZWdpc3RlckFwcENvbXBvbmVudHMoKTsK
LQotICAvLyBvZmZzY3JlZW4gd2luZG93IG1ldGhvZHMgYW5kIHRoZSBvZmZzY3JlZW4gd2lkZ2V0
Ci0gIHN0YXRpYyB2b2lkICAgICAgIEVuc3VyZU9mZnNjcmVlbldpbmRvdyh2b2lkKTsKLSAgc3Rh
dGljIHZvaWQgICAgICAgRGVzdHJveU9mZnNjcmVlbldpbmRvdyh2b2lkKTsKLSAgc3RhdGljIEd0
a1dpZGdldCAqc09mZnNjcmVlbldpbmRvdzsKLSAgc3RhdGljIEd0a1dpZGdldCAqc09mZnNjcmVl
bkZpeGVkOwotIAotfTsKLQotI2VuZGlmIC8qIF9fRW1iZWRQcml2YXRlX2ggKi8KZGlmZiAtLWdp
dCBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRQcm9ncmVzcy5jcHAgYi9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJvZ3Jlc3MuY3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEw
MDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJvZ3Jlc3MuY3BwCisr
KyAvZGV2L251bGwKQEAgLTEsMjE1ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxP
Q0sgKioqKioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRo
ZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGlj
IExpY2Vuc2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNl
IHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91
IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemls
bGEub3JnL01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z
ZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5U
WSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNl
Ci0gKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0
YXRpb25zIHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBp
cyBtb3ppbGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUg
T3JpZ2luYWwgQ29kZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9ucyBj
cmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAxCi0g
KiB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29u
dHJpYnV0b3Iocyk6Ci0gKiAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3ppbGxh
Lm9yZz4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1h
eSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUg
R05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0
aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBv
ciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYg
eW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQot
ICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90
IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRl
bGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90
aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBM
R1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVj
aXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRl
cm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAq
KioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5jbHVkZSAiRW1iZWRQcm9ncmVz
cy5oIgotCi0jaW5jbHVkZSAibnNJQ2hhbm5lbC5oIgotI2luY2x1ZGUgIm5zSVdlYlByb2dyZXNz
LmgiCi0jaW5jbHVkZSAibnNJRE9NV2luZG93LmgiCi0KLSNpbmNsdWRlICJuc0lVUkkuaCIKLQot
RW1iZWRQcm9ncmVzczo6RW1iZWRQcm9ncmVzcyh2b2lkKQotewotICBtT3duZXIgPSBuc251bGw7
Ci19Ci0KLUVtYmVkUHJvZ3Jlc3M6On5FbWJlZFByb2dyZXNzKCkKLXsKLX0KLQotTlNfSU1QTF9J
U1VQUE9SVFMyKEVtYmVkUHJvZ3Jlc3MsCi0JCSAgIG5zSVdlYlByb2dyZXNzTGlzdGVuZXIsCi0J
CSAgIG5zSVN1cHBvcnRzV2Vha1JlZmVyZW5jZSkKLQotbnNyZXN1bHQKLUVtYmVkUHJvZ3Jlc3M6
OkluaXQoRW1iZWRQcml2YXRlICphT3duZXIpCi17Ci0gIG1Pd25lciA9IGFPd25lcjsKLSAgcmV0
dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZFByb2dyZXNzOjpPblN0YXRlQ2hh
bmdlKG5zSVdlYlByb2dyZXNzICphV2ViUHJvZ3Jlc3MsCi0JCQkgICAgIG5zSVJlcXVlc3QgICAg
ICphUmVxdWVzdCwKLQkJCSAgICAgUFJVaW50MzIgICAgICAgIGFTdGF0ZUZsYWdzLAotCQkJICAg
ICBuc3Jlc3VsdCAgICAgICAgYVN0YXR1cykKLXsKLSAgLy8gZ2l2ZSB0aGUgd2lkZ2V0IGEgY2hh
bmNlIHRvIGF0dGFjaCBhbnkgbGlzdGVuZXJzCi0gIG1Pd25lci0+Q29udGVudFN0YXRlQ2hhbmdl
KCk7Ci0gIC8vIGlmIHdlJ3ZlIGdvdCB0aGUgc3RhcnQgZmxhZywgZW1pdCB0aGUgc2lnbmFsCi0g
IGlmICgoYVN0YXRlRmxhZ3MgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfSVNfTkVUV09SSykgJiYgCi0g
ICAgICAoYVN0YXRlRmxhZ3MgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfU1RBUlQpKQotICB7Ci0gICAg
Z19zaWduYWxfZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRnZXQpLAotICAgICAgICAg
ICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNbTkVUX1NUQVJUXSwgMCk7Ci0gIH0KLQotICAvLyBn
ZXQgdGhlIHVyaSBmb3IgdGhpcyByZXF1ZXN0Ci0gIG5zQ0F1dG9TdHJpbmcgdXJpU3RyaW5nOwot
ICBSZXF1ZXN0VG9VUklTdHJpbmcoYVJlcXVlc3QsIHVyaVN0cmluZyk7Ci0KLSAgLy8gaXMgaXQg
dGhlIHNhbWUgYXMgdGhlIGN1cnJlbnQgVVJJPwotICBpZiAobU93bmVyLT5tVVJJLkVxdWFscyh1
cmlTdHJpbmcpKQotICB7Ci0gICAgLy8gZm9yIHBlb3BsZSB3aG8ga25vdyB3aGF0IHRoZXkgYXJl
IGRvaW5nCi0gICAgZ19zaWduYWxfZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRnZXQp
LAotICAgICAgICAgICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNbTkVUX1NUQVRFXSwgMCwKLSAg
ICAgICAgICAgICAgICAgIGFTdGF0ZUZsYWdzLCBhU3RhdHVzKTsKLSAgfQotICBnX3NpZ25hbF9l
bWl0KEdfT0JKRUNUKG1Pd25lci0+bU93bmluZ1dpZGdldCksCi0gICAgICAgICAgICAgICAgbW96
X2VtYmVkX3NpZ25hbHNbTkVUX1NUQVRFX0FMTF0sIDAsCi0gICAgICAgICAgICAgICAgdXJpU3Ry
aW5nLmdldCgpLAotICAgICAgICAgICAgICAgIChnaW50KWFTdGF0ZUZsYWdzLCAoZ2ludClhU3Rh
dHVzKTsKLSAgLy8gYW5kIGZvciBzdG9wLCB0b28KLSAgaWYgKChhU3RhdGVGbGFncyAmIEdUS19N
T1pfRU1CRURfRkxBR19JU19ORVRXT1JLKSAmJgotICAgICAgKGFTdGF0ZUZsYWdzICYgR1RLX01P
Wl9FTUJFRF9GTEFHX1NUT1ApKQotICB7Ci0gICAgZ19zaWduYWxfZW1pdChHX09CSkVDVChtT3du
ZXItPm1Pd25pbmdXaWRnZXQpLAotICAgICAgICAgICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNb
TkVUX1NUT1BdLCAwKTsKLSAgICAvLyBsZXQgb3VyIG93bmVyIGtub3cgdGhhdCB0aGUgbG9hZCBm
aW5pc2hlZAotICAgIG1Pd25lci0+Q29udGVudEZpbmlzaGVkTG9hZGluZygpOwotICB9Ci0KLSAg
cmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZFByb2dyZXNzOjpPblByb2dy
ZXNzQ2hhbmdlKG5zSVdlYlByb2dyZXNzICphV2ViUHJvZ3Jlc3MsCi0JCQkJbnNJUmVxdWVzdCAg
ICAgKmFSZXF1ZXN0LAotCQkJCVBSSW50MzIgICAgICAgICBhQ3VyU2VsZlByb2dyZXNzLAotCQkJ
CVBSSW50MzIgICAgICAgICBhTWF4U2VsZlByb2dyZXNzLAotCQkJCVBSSW50MzIgICAgICAgICBh
Q3VyVG90YWxQcm9ncmVzcywKLQkJCQlQUkludDMyICAgICAgICAgYU1heFRvdGFsUHJvZ3Jlc3Mp
Ci17Ci0KLSAgbnNDQXV0b1N0cmluZyB1cmlTdHJpbmc7Ci0gIFJlcXVlc3RUb1VSSVN0cmluZyhh
UmVxdWVzdCwgdXJpU3RyaW5nKTsKLQotICAvLyBpcyBpdCB0aGUgc2FtZSBhcyB0aGUgY3VycmVu
dCB1cmk/Ci0gIGlmIChtT3duZXItPm1VUkkuRXF1YWxzKHVyaVN0cmluZykpIHsKLSAgICBnX3Np
Z25hbF9lbWl0KEdfT0JKRUNUKG1Pd25lci0+bU93bmluZ1dpZGdldCksCi0gICAgICAgICAgICAg
ICAgICBtb3pfZW1iZWRfc2lnbmFsc1tQUk9HUkVTU10sIDAsCi0gICAgICAgICAgICAgICAgICBh
Q3VyVG90YWxQcm9ncmVzcywgYU1heFRvdGFsUHJvZ3Jlc3MpOwotICB9Ci0KLSAgZ19zaWduYWxf
ZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRnZXQpLAotICAgICAgICAgICAgICAgIG1v
el9lbWJlZF9zaWduYWxzW1BST0dSRVNTX0FMTF0sIDAsCi0gICAgICAgICAgICAgICAgdXJpU3Ry
aW5nLmdldCgpLAotICAgICAgICAgICAgICAgIGFDdXJUb3RhbFByb2dyZXNzLCBhTWF4VG90YWxQ
cm9ncmVzcyk7Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRQcm9n
cmVzczo6T25Mb2NhdGlvbkNoYW5nZShuc0lXZWJQcm9ncmVzcyAqYVdlYlByb2dyZXNzLAotCQkJ
CW5zSVJlcXVlc3QgICAgICphUmVxdWVzdCwKLQkJCQluc0lVUkkgICAgICAgICAqYUxvY2F0aW9u
KQotewotICBuc0NBdXRvU3RyaW5nIG5ld1VSSTsKLSAgTlNfRU5TVVJFX0FSR19QT0lOVEVSKGFM
b2NhdGlvbik7Ci0gIGFMb2NhdGlvbi0+R2V0U3BlYyhuZXdVUkkpOwotCi0gIC8vIE1ha2Ugc3Vy
ZSB0aGF0IHRoaXMgaXMgdGhlIHByaW1hcnkgZnJhbWUgY2hhbmdlIGFuZCBub3QKLSAgLy8ganVz
dCBhIHN1YmZyYW1lLgotICBQUkJvb2wgaXNTdWJGcmFtZUxvYWQgPSBQUl9GQUxTRTsKLSAgaWYg
KGFXZWJQcm9ncmVzcykgewotICAgIG5zQ09NUHRyPG5zSURPTVdpbmRvdz4gZG9tV2luZG93Owot
ICAgIG5zQ09NUHRyPG5zSURPTVdpbmRvdz4gdG9wRG9tV2luZG93OwotCi0gICAgYVdlYlByb2dy
ZXNzLT5HZXRET01XaW5kb3coZ2V0dGVyX0FkZFJlZnMoZG9tV2luZG93KSk7Ci0KLSAgICAvLyBn
ZXQgdGhlIHJvb3QgZG9tIHdpbmRvdwotICAgIGlmIChkb21XaW5kb3cpCi0gICAgICBkb21XaW5k
b3ctPkdldFRvcChnZXR0ZXJfQWRkUmVmcyh0b3BEb21XaW5kb3cpKTsKLQotICAgIGlmIChkb21X
aW5kb3cgIT0gdG9wRG9tV2luZG93KQotICAgICAgaXNTdWJGcmFtZUxvYWQgPSBQUl9UUlVFOwot
ICB9Ci0KLSAgaWYgKCFpc1N1YkZyYW1lTG9hZCkgewotICAgIG1Pd25lci0+U2V0VVJJKG5ld1VS
SS5nZXQoKSk7Ci0gICAgZ19zaWduYWxfZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRn
ZXQpLAotICAgICAgICAgICAgICAgICAgbW96X2VtYmVkX3NpZ25hbHNbTE9DQVRJT05dLCAwKTsK
LSAgfQotCi0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRQcm9ncmVz
czo6T25TdGF0dXNDaGFuZ2UobnNJV2ViUHJvZ3Jlc3MgICphV2ViUHJvZ3Jlc3MsCi0JCQkgICAg
ICBuc0lSZXF1ZXN0ICAgICAgKmFSZXF1ZXN0LAotCQkJICAgICAgbnNyZXN1bHQgICAgICAgICBh
U3RhdHVzLAotCQkJICAgICAgY29uc3QgUFJVbmljaGFyICphTWVzc2FnZSkKLXsKLSAgZ19zaWdu
YWxfZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRnZXQpLAotICAgICAgICAgICAgICAg
IG1vel9lbWJlZF9zaWduYWxzW1NUQVRVU19DSEFOR0VdLCAwLAotICAgICAgICAgICAgICAgIHN0
YXRpY19jYXN0PHZvaWQgKj4oYVJlcXVlc3QpLAotICAgICAgICAgICAgICAgIHN0YXRpY19jYXN0
PGludD4oYVN0YXR1cyksCi0gICAgICAgICAgICAgICAgc3RhdGljX2Nhc3Q8Y29uc3Qgdm9pZCAq
PihhTWVzc2FnZSkpOwotCi0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1i
ZWRQcm9ncmVzczo6T25TZWN1cml0eUNoYW5nZShuc0lXZWJQcm9ncmVzcyAqYVdlYlByb2dyZXNz
LAotCQkJCW5zSVJlcXVlc3QgICAgICphUmVxdWVzdCwKLQkJCQlQUlVpbnQzMiAgICAgICAgIGFT
dGF0ZSkKLXsKLSAgZ19zaWduYWxfZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRnZXQp
LAotICAgICAgICAgICAgICAgIG1vel9lbWJlZF9zaWduYWxzW1NFQ1VSSVRZX0NIQU5HRV0sIDAs
Ci0gICAgICAgICAgICAgICAgc3RhdGljX2Nhc3Q8dm9pZCAqPihhUmVxdWVzdCksCi0gICAgICAg
ICAgICAgICAgYVN0YXRlKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi0vKiBzdGF0aWMgKi8KLXZv
aWQKLUVtYmVkUHJvZ3Jlc3M6OlJlcXVlc3RUb1VSSVN0cmluZyhuc0lSZXF1ZXN0ICphUmVxdWVz
dCwgbnNBQ1N0cmluZyAmYVN0cmluZykKLXsKLSAgLy8gaXMgaXQgYSBjaGFubmVsCi0gIG5zQ09N
UHRyPG5zSUNoYW5uZWw+IGNoYW5uZWw7Ci0gIGNoYW5uZWwgPSBkb19RdWVyeUludGVyZmFjZShh
UmVxdWVzdCk7Ci0gIGlmICghY2hhbm5lbCkKLSAgICByZXR1cm47Ci0gIAotICBuc0NPTVB0cjxu
c0lVUkk+IHVyaTsKLSAgY2hhbm5lbC0+R2V0VVJJKGdldHRlcl9BZGRSZWZzKHVyaSkpOwotICBp
ZiAoIXVyaSkKLSAgICByZXR1cm47Ci0gIAotICB1cmktPkdldFNwZWMoYVN0cmluZyk7Ci19CmRp
ZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJvZ3Jlc3MuaCBiL2Vt
YmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRQcm9ncmVzcy5oCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJvZ3Jlc3MuaAor
KysgL2Rldi9udWxsCkBAIC0xLDY2ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxP
Q0sgKioqKioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRo
ZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGlj
IExpY2Vuc2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNl
IHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91
IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemls
bGEub3JnL01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z
ZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5U
WSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNl
Ci0gKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0
YXRpb25zIHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBp
cyBtb3ppbGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUg
T3JpZ2luYWwgQ29kZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9ucyBj
cmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAxCi0g
KiB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29u
dHJpYnV0b3Iocyk6Ci0gKiAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3ppbGxh
Lm9yZz4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1h
eSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUg
R05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0
aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBv
ciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYg
eW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQot
ICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90
IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRl
bGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90
aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBM
R1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVj
aXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRl
cm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAq
KioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaWZuZGVmIF9fRW1iZWRQcm9ncmVz
c19oCi0jZGVmaW5lIF9fRW1iZWRQcm9ncmVzc19oCi0KLSNpbmNsdWRlICJuc0lXZWJQcm9ncmVz
c0xpc3RlbmVyLmgiCi0jaW5jbHVkZSAibnNXZWFrUmVmZXJlbmNlLmgiCi0jaW5jbHVkZSAiRW1i
ZWRQcml2YXRlLmgiCi0KLWNsYXNzIEVtYmVkUHJvZ3Jlc3MgOiBwdWJsaWMgbnNJV2ViUHJvZ3Jl
c3NMaXN0ZW5lciwKLSAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgbnNTdXBwb3J0c1dlYWtS
ZWZlcmVuY2UKLXsKLSBwdWJsaWM6Ci0gIEVtYmVkUHJvZ3Jlc3MoKTsKLSAgdmlydHVhbCB+RW1i
ZWRQcm9ncmVzcygpOwotCi0gIG5zcmVzdWx0IEluaXQoRW1iZWRQcml2YXRlICphT3duZXIpOwot
Ci0gIE5TX0RFQ0xfSVNVUFBPUlRTCi0KLSAgTlNfREVDTF9OU0lXRUJQUk9HUkVTU0xJU1RFTkVS
Ci0KLSBwcml2YXRlOgotCi0gIHN0YXRpYyB2b2lkIFJlcXVlc3RUb1VSSVN0cmluZyAobnNJUmVx
dWVzdCAqYVJlcXVlc3QsIG5zQUNTdHJpbmcgJmFTdHJpbmcpOwotCi0gIEVtYmVkUHJpdmF0ZSAq
bU93bmVyOwotCi19OwotCi0jZW5kaWYgLyogX19FbWJlZFByb2dyZXNzX2ggKi8KZGlmZiAtLWdp
dCBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRQcm9tcHRlci5jcHAgYi9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJvbXB0ZXIuY3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEw
MDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkUHJvbXB0ZXIuY3BwCisr
KyAvZGV2L251bGwKQEAgLTEsNDExICswLDAgQEAKLS8qIC0qLSBNb2RlOiBDKys7IHRhYi13aWR0
aDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsOyBjLWJhc2ljLW9mZnNldDogNCAtKi0gKi8KLS8q
IHZpbTpleHBhbmR0YWI6c2hpZnR3aWR0aD00OnRhYnN0b3A9NDogKi8KLS8qICoqKioqIEJFR0lO
IExJQ0VOU0UgQkxPQ0sgKioqKioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIu
MQotICoKLSAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1v
emlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91
IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUg
TGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRw
Oi8vd3d3Lm1vemlsbGEub3JnL01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRl
ciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lU
SE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2Vl
IHRoZSBMaWNlbnNlCi0gKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdo
dHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3Jp
Z2luYWwgQ29kZSBpcyBtb3ppbGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVs
b3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBpcwotICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMg
Q29ycG9yYXRpb24uCi0gKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3Bl
ciBhcmUgQ29weXJpZ2h0IChDKSAyMDAzCi0gKiB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBS
aWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0b3Iocyk6Ci0gKiAgQnJpYW4gUnluZXIg
PGJyeW5lckBicmlhbnJ5bmVyLmNvbT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVu
dHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVy
IHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAi
R1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNp
b24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zp
c2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBv
ZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBv
ZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9y
IHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lv
biBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIK
LSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNl
IHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBi
eSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zp
c2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmls
ZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0
aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5j
bHVkZSAiRW1iZWRQcm9tcHRlci5oIgotCi1lbnVtIHsKLSAgICBJTkNMVURFX1VTRVJOQU1FID0g
MSA8PCAwLAotICAgIElOQ0xVREVfUEFTU1dPUkQgPSAxIDw8IDEsCi0gICAgSU5DTFVERV9DSEVD
S0JPWCA9IDEgPDwgMiwKLSAgICBJTkNMVURFX0NBTkNFTCAgID0gMSA8PCAzCi19OwotCi1zdHJ1
Y3QgRGlhbG9nRGVzY3JpcHRpb24gewotICAgIGludCAgICAgICAgICBmbGFnczsKLSAgICBjb25z
dCBnY2hhciogaWNvbjsKLX07Ci0KLS8vIFRoaXMgdGFibGUgY29udGFpbnMgdGhlIG9wdGlvbmFs
IHdpZGdldHMgYW5kIGljb25zIGFzc29jaWF0ZWQgd2l0aAotLy8gZWFjaCB0eXBlIG9mIGRpYWxv
Zy4KLQotc3RhdGljIGNvbnN0IERpYWxvZ0Rlc2NyaXB0aW9uIERpYWxvZ1RhYmxlW10gPSB7Ci0g
ICAgeyAwLCAgICAgICAgICAgICAgICAgICAgICBHVEtfU1RPQ0tfRElBTE9HX1dBUk5JTkcgIH0s
ICAvLyBBTEVSVAotICAgIHsgSU5DTFVERV9DSEVDS0JPWCwgICAgICAgR1RLX1NUT0NLX0RJQUxP
R19XQVJOSU5HICB9LCAgLy8gQUxFUlRfQ0hFQ0sKLSAgICB7IElOQ0xVREVfQ0FOQ0VMLCAgICAg
ICAgIEdUS19TVE9DS19ESUFMT0dfUVVFU1RJT04gfSwgIC8vIENPTkZJUk0KLSAgICB7IElOQ0xV
REVfQ0hFQ0tCT1ggfAotICAgICAgSU5DTFVERV9DQU5DRUwsICAgICAgICAgR1RLX1NUT0NLX0RJ
QUxPR19RVUVTVElPTiB9LCAgLy8gQ09ORklSTV9DSEVDSwotICAgIHsgSU5DTFVERV9DQU5DRUwg
fAotICAgICAgSU5DTFVERV9DSEVDS0JPWCwgICAgICAgR1RLX1NUT0NLX0RJQUxPR19RVUVTVElP
TiB9LCAgLy8gUFJPTVBUCi0gICAgeyBJTkNMVURFX0NBTkNFTCB8Ci0gICAgICBJTkNMVURFX1VT
RVJOQU1FIHwKLSAgICAgIElOQ0xVREVfUEFTU1dPUkQgfAotICAgICAgSU5DTFVERV9DSEVDS0JP
WCwgICAgICAgR1RLX1NUT0NLX0RJQUxPR19RVUVTVElPTiB9LCAgLy8gUFJPTVBUX1VTRVJfUEFT
UwotICAgIHsgSU5DTFVERV9DQU5DRUwgfAotICAgICAgSU5DTFVERV9QQVNTV09SRCB8Ci0gICAg
ICBJTkNMVURFX0NIRUNLQk9YLCAgICAgICBHVEtfU1RPQ0tfRElBTE9HX1FVRVNUSU9OIH0sICAv
LyBQUk9NUFRfUEFTUwotICAgIHsgSU5DTFVERV9DQU5DRUwsICAgICAgICAgR1RLX1NUT0NLX0RJ
QUxPR19RVUVTVElPTiB9LCAgLy8gU0VMRUNUCi0gICAgeyBJTkNMVURFX0NBTkNFTCB8Ci0gICAg
ICBJTkNMVURFX0NIRUNLQk9YLCAgICAgICBHVEtfU1RPQ0tfRElBTE9HX1FVRVNUSU9OIH0gICAv
LyBVTklWRVJTQUwKLX07Ci0KLUVtYmVkUHJvbXB0ZXI6OkVtYmVkUHJvbXB0ZXIodm9pZCkKLSAg
ICA6IG1DaGVja1ZhbHVlKFBSX0ZBTFNFKSwKLSAgICAgIG1JdGVtTGlzdChuc251bGwpLAotICAg
ICAgbUl0ZW1Db3VudCgwKSwKLSAgICAgIG1CdXR0b25QcmVzc2VkKDApLAotICAgICAgbUNvbmZp
cm1SZXN1bHQoUFJfRkFMU0UpLAotICAgICAgbVNlbGVjdGVkSXRlbSgwKSwKLSAgICAgIG1XaW5k
b3coTlVMTCksCi0gICAgICBtVXNlckZpZWxkKE5VTEwpLAotICAgICAgbVBhc3NGaWVsZChOVUxM
KSwKLSAgICAgIG1UZXh0RmllbGQoTlVMTCksCi0gICAgICBtQ29tYm9Cb3goTlVMTCksCi0gICAg
ICBtQ2hlY2tCb3goTlVMTCkKLXsKLX0KLQotRW1iZWRQcm9tcHRlcjo6fkVtYmVkUHJvbXB0ZXIo
dm9pZCkKLXsKLSAgICBpZiAobUl0ZW1MaXN0KQotICAgICAgICBkZWxldGVbXSBtSXRlbUxpc3Q7
Ci19Ci0KLW5zcmVzdWx0Ci1FbWJlZFByb21wdGVyOjpDcmVhdGUoUHJvbXB0VHlwZSBhVHlwZSwg
R3RrV2luZG93KiBhUGFyZW50V2luZG93KQotewotICAgIG1XaW5kb3cgPSBndGtfZGlhbG9nX25l
d193aXRoX2J1dHRvbnMobVRpdGxlLmdldCgpLCBhUGFyZW50V2luZG93LAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKEd0a0RpYWxvZ0ZsYWdzKTAsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKLQotICAgIC8vIG9ubHkg
YWRkIHRoZSBkaWFsb2cgdG8gdGhlIHdpbmRvdyBncm91cCBpZiB0aGUgcGFyZW50IGFscmVhZHkg
aGFzIGEgd2luZG93IGdyb3VwLAotICAgIC8vIHNvIGFzIG5vdCB0byBicmVhayBhcHAncyBleHBl
Y3RhdGlvbnMgYWJvdXQgbW9kYWwgZGlhbG9ncy4KLSAgICBpZiAoYVBhcmVudFdpbmRvdyAmJiBh
UGFyZW50V2luZG93LT5ncm91cCkgewotICAgICAgICBndGtfd2luZG93X2dyb3VwX2FkZF93aW5k
b3cgKGFQYXJlbnRXaW5kb3ctPmdyb3VwLCBHVEtfV0lORE9XIChtV2luZG93KSk7Ci0gICAgfQot
Ci0gICAgLy8gZ3RrIHdpbGwgcmVzaXplIHRoaXMgZm9yIHVzIGFzIG5lY2Vzc2FyeQotICAgIGd0
a193aW5kb3dfc2V0X2RlZmF1bHRfc2l6ZShHVEtfV0lORE9XKG1XaW5kb3cpLCAxMDAsIDUwKTsK
LQotICAgIC8vIHRoaXMgSEJveCB3aWxsIGNvbnRhaW4gdGhlIGljb24sIGFuZCBhIHZib3ggd2hp
Y2ggY29udGFpbnMgdGhlCi0gICAgLy8gZGlhbG9nIHRleHQgYW5kIG90aGVyIHdpZGdldHMuCi0g
ICAgR3RrV2lkZ2V0KiBkaWFsb2dIQm94ID0gZ3RrX2hib3hfbmV3KEZBTFNFLCAxMik7Ci0KLQot
ICAgIC8vIFNldCB1cCBkaWFsb2cgcHJvcGVydGllcyBhY2NvcmRpbmcgdG8gdGhlIEdOT01FIEhJ
RwotICAgIC8vIChodHRwOi8vZGV2ZWxvcGVyLmdub21lLm9yZy9wcm9qZWN0cy9ndXAvaGlnLzEu
MC93aW5kb3dzLmh0bWwjYWxlcnQtd2luZG93cykKLQotICAgIGd0a19jb250YWluZXJfc2V0X2Jv
cmRlcl93aWR0aChHVEtfQ09OVEFJTkVSKG1XaW5kb3cpLCA2KTsKLSAgICBndGtfZGlhbG9nX3Nl
dF9oYXNfc2VwYXJhdG9yKEdUS19ESUFMT0cobVdpbmRvdyksIEZBTFNFKTsKLSAgICBndGtfYm94
X3NldF9zcGFjaW5nKEdUS19CT1goR1RLX0RJQUxPRyhtV2luZG93KS0+dmJveCksIDEyKTsKLSAg
ICBndGtfY29udGFpbmVyX3NldF9ib3JkZXJfd2lkdGgoR1RLX0NPTlRBSU5FUihkaWFsb2dIQm94
KSwgNik7Ci0KLQotICAgIC8vIFRoaXMgaXMgdGhlIFZCb3ggd2hpY2ggd2lsbCBjb250YWluIHRo
ZSBsYWJlbCBhbmQgb3RoZXIgY29udHJvbHMuCi0gICAgR3RrV2lkZ2V0KiBjb250ZW50c1ZCb3gg
PSBndGtfdmJveF9uZXcoRkFMU0UsIDEyKTsKLQotICAgIC8vIGdldCB0aGUgc3RvY2sgaWNvbiBm
b3IgdGhpcyBkaWFsb2cgYW5kIHB1dCBpdCBpbiB0aGUgYm94Ci0gICAgY29uc3QgZ2NoYXIqIGlj
b25EZXNjID0gRGlhbG9nVGFibGVbYVR5cGVdLmljb247Ci0gICAgR3RrV2lkZ2V0KiBpY29uID0g
Z3RrX2ltYWdlX25ld19mcm9tX3N0b2NrKGljb25EZXNjLCBHVEtfSUNPTl9TSVpFX0RJQUxPRyk7
Ci0gICAgZ3RrX21pc2Nfc2V0X2FsaWdubWVudChHVEtfTUlTQyhpY29uKSwgMC41LCAwLjApOwot
ICAgIGd0a19ib3hfcGFja19zdGFydChHVEtfQk9YKGRpYWxvZ0hCb3gpLCBpY29uLCBGQUxTRSwg
RkFMU0UsIDApOwotCi0gICAgLy8gbm93IHBhY2sgdGhlIGxhYmVsIGludG8gdGhlIHZib3gKLSAg
ICBHdGtXaWRnZXQqIGxhYmVsID0gZ3RrX2xhYmVsX25ldyhtTWVzc2FnZVRleHQuZ2V0KCkpOwot
ICAgIGd0a19sYWJlbF9zZXRfbGluZV93cmFwKEdUS19MQUJFTChsYWJlbCksIFRSVUUpOwotICAg
IGd0a19sYWJlbF9zZXRfc2VsZWN0YWJsZShHVEtfTEFCRUwobGFiZWwpLCBUUlVFKTsKLSAgICBn
dGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChjb250ZW50c1ZCb3gpLCBsYWJlbCwgRkFMU0UsIEZB
TFNFLCAwKTsKLQotICAgIGludCB3aWRnZXRGbGFncyA9IERpYWxvZ1RhYmxlW2FUeXBlXS5mbGFn
czsKLQotICAgIGlmICh3aWRnZXRGbGFncyAmIChJTkNMVURFX1VTRVJOQU1FIHwgSU5DTFVERV9Q
QVNTV09SRCkpIHsKLQotICAgICAgICAvLyBJZiB3ZSdyZSBjcmVhdGluZyBhIHVzZXJuYW1lIGFu
ZC9vciBwYXNzd29yZCBmaWVsZCwgbWFrZSBhbiBoYm94Ci0gICAgICAgIC8vIHdoaWNoIHdpbGwg
Y29udGFpbiB0d28gdmJveGVzLCBvbmUgZm9yIHRoZSBsYWJlbHMgYW5kIG9uZSBmb3IgdGhlCi0g
ICAgICAgIC8vIHRleHQgZmllbGRzLiAgVGhpcyB3aWxsIGxldCB1cyBsaW5lIHVwIHRoZSB0ZXh0
ZmllbGRzLgotCi0gICAgICAgIEd0a1dpZGdldCogdXNlclBhc3NIQm94ID0gZ3RrX2hib3hfbmV3
KEZBTFNFLCAxMik7Ci0gICAgICAgIEd0a1dpZGdldCogdXNlclBhc3NMYWJlbHMgPSBndGtfdmJv
eF9uZXcoVFJVRSwgNik7Ci0gICAgICAgIEd0a1dpZGdldCogdXNlclBhc3NGaWVsZHMgPSBndGtf
dmJveF9uZXcoVFJVRSwgNik7Ci0KLSAgICAgICAgaWYgKHdpZGdldEZsYWdzICYgSU5DTFVERV9V
U0VSTkFNRSkgewotICAgICAgICAgICAgR3RrV2lkZ2V0KiB1c2VyTGFiZWwgPSBndGtfbGFiZWxf
bmV3KCJVc2VyIE5hbWU6Iik7Ci0gICAgICAgICAgICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JP
WCh1c2VyUGFzc0xhYmVscyksIHVzZXJMYWJlbCwgRkFMU0UsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgRkFMU0UsIDApOwotCi0gICAgICAgICAgICBtVXNlckZpZWxkID0gZ3RrX2Vu
dHJ5X25ldygpOwotCi0gICAgICAgICAgICBpZiAoIW1Vc2VyLklzRW1wdHkoKSkKLSAgICAgICAg
ICAgICAgICBndGtfZW50cnlfc2V0X3RleHQoR1RLX0VOVFJZKG1Vc2VyRmllbGQpLCBtVXNlci5n
ZXQoKSk7Ci0KLSAgICAgICAgICAgIGd0a19lbnRyeV9zZXRfYWN0aXZhdGVzX2RlZmF1bHQoR1RL
X0VOVFJZKG1Vc2VyRmllbGQpLCBUUlVFKTsKLQotICAgICAgICAgICAgZ3RrX2JveF9wYWNrX3N0
YXJ0KEdUS19CT1godXNlclBhc3NGaWVsZHMpLCBtVXNlckZpZWxkLCBGQUxTRSwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBGQUxTRSwgMCk7Ci0gICAgICAgIH0KLSAgICAgICAgaWYg
KHdpZGdldEZsYWdzICYgSU5DTFVERV9QQVNTV09SRCkgewotICAgICAgICAgICAgR3RrV2lkZ2V0
KiBwYXNzTGFiZWwgPSBndGtfbGFiZWxfbmV3KCJQYXNzd29yZDoiKTsKLSAgICAgICAgICAgIGd0
a19ib3hfcGFja19zdGFydChHVEtfQk9YKHVzZXJQYXNzTGFiZWxzKSwgcGFzc0xhYmVsLCBGQUxT
RSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGQUxTRSwgMCk7Ci0KLSAgICAgICAg
ICAgIG1QYXNzRmllbGQgPSBndGtfZW50cnlfbmV3KCk7Ci0KLSAgICAgICAgICAgIGlmICghbVBh
c3MuSXNFbXB0eSgpKQotICAgICAgICAgICAgICAgIGd0a19lbnRyeV9zZXRfdGV4dChHVEtfRU5U
UlkobVBhc3NGaWVsZCksIG1QYXNzLmdldCgpKTsKLQotICAgICAgICAgICAgZ3RrX2VudHJ5X3Nl
dF92aXNpYmlsaXR5KEdUS19FTlRSWShtUGFzc0ZpZWxkKSwgRkFMU0UpOwotICAgICAgICAgICAg
Z3RrX2VudHJ5X3NldF9hY3RpdmF0ZXNfZGVmYXVsdChHVEtfRU5UUlkobVBhc3NGaWVsZCksIFRS
VUUpOwotCi0gICAgICAgICAgICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWCh1c2VyUGFzc0Zp
ZWxkcyksIG1QYXNzRmllbGQsIEZBTFNFLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IEZBTFNFLCAwKTsKLSAgICAgICAgfQotCi0gICAgICAgIGd0a19ib3hfcGFja19zdGFydChHVEtf
Qk9YKHVzZXJQYXNzSEJveCksIHVzZXJQYXNzTGFiZWxzLCBGQUxTRSwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEZBTFNFLCAwKTsKLSAgICAgICAgZ3RrX2JveF9wYWNrX3N0YXJ0KEdUS19C
T1godXNlclBhc3NIQm94KSwgdXNlclBhc3NGaWVsZHMsIEZBTFNFLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgRkFMU0UsIDApOwotICAgICAgICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JP
WChjb250ZW50c1ZCb3gpLCB1c2VyUGFzc0hCb3gsIEZBTFNFLCBGQUxTRSwgMCk7Ci0gICAgfQot
Ci0gICAgaWYgKGFUeXBlID09IFRZUEVfUFJPTVBUKSB7Ci0gICAgICAgIG1UZXh0RmllbGQgPSBn
dGtfZW50cnlfbmV3KCk7Ci0KLSAgICAgICAgaWYgKCFtVGV4dFZhbHVlLklzRW1wdHkoKSkKLSAg
ICAgICAgICAgIGd0a19lbnRyeV9zZXRfdGV4dChHVEtfRU5UUlkobVRleHRGaWVsZCksIG1UZXh0
VmFsdWUuZ2V0KCkpOwotCi0gICAgICAgIGd0a19lbnRyeV9zZXRfYWN0aXZhdGVzX2RlZmF1bHQo
R1RLX0VOVFJZKG1UZXh0RmllbGQpLCBUUlVFKTsKLQotICAgICAgICBndGtfYm94X3BhY2tfc3Rh
cnQoR1RLX0JPWChjb250ZW50c1ZCb3gpLCBtVGV4dEZpZWxkLCBGQUxTRSwgRkFMU0UsIDApOwot
ICAgIH0KLQotICAgIC8vIEFkZCBhIGNoZWNrYm94Ci0gICAgaWYgKCh3aWRnZXRGbGFncyAmIElO
Q0xVREVfQ0hFQ0tCT1gpICYmICFtQ2hlY2tNZXNzYWdlLklzRW1wdHkoKSkgewotICAgICAgICBt
Q2hlY2tCb3ggPSBndGtfY2hlY2tfYnV0dG9uX25ld193aXRoX2xhYmVsKG1DaGVja01lc3NhZ2Uu
Z2V0KCkpOwotCi0gICAgICAgIGd0a190b2dnbGVfYnV0dG9uX3NldF9hY3RpdmUoR1RLX1RPR0dM
RV9CVVRUT04obUNoZWNrQm94KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBtQ2hlY2tWYWx1ZSk7Ci0gICAgICAgIGd0a19sYWJlbF9zZXRfbGluZV93cmFwKEdUS19MQUJF
TChndGtfYmluX2dldF9jaGlsZChHVEtfQklOKG1DaGVja0JveCkpKSwKLQkJCQlUUlVFKTsKLQot
ICAgICAgICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChjb250ZW50c1ZCb3gpLCBtQ2hlY2tC
b3gsIEZBTFNFLCBGQUxTRSwgMCk7Ci0gICAgfQotCi0gICAgLy8gQWRkIGEgZHJvcGRvd24gbWVu
dQotICAgIGlmIChhVHlwZSA9PSBUWVBFX1NFTEVDVCkgewotICAgICAgICAvLyBCdWlsZCB1cCBh
IEd0a0NvbWJvQm94IGNvbnRhaW5pbmcgdGhlIGl0ZW1zCi0gICAgICAgIEd0a1dpZGdldCogbUNv
bWJvQm94ID0gZ3RrX2NvbWJvX2JveF9uZXdfdGV4dCgpOwotICAgICAgICBmb3IgKFBSVWludDMy
IGkgPSAwOyBpIDwgbUl0ZW1Db3VudDsgKytpKSB7Ci0gICAgICAgICAgICBndGtfY29tYm9fYm94
X2FwcGVuZF90ZXh0KEdUS19DT01CT19CT1gobUNvbWJvQm94KSwgbUl0ZW1MaXN0W2ldLmdldCgp
KTsKLSAgICAgICAgfQotICAgICAgICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChjb250ZW50
c1ZCb3gpLCBtQ29tYm9Cb3gsIEZBTFNFLCBGQUxTRSwgMCk7Ci0gICAgfQotCi0gICAgaWYgKGFU
eXBlID09IFRZUEVfVU5JVkVSU0FMKSB7Ci0gICAgICAgIC8vIENyZWF0ZSBidXR0b25zIGJhc2Vk
IG9uIHRoZSBmbGFncyBwYXNzZWQgaW4uCi0gICAgICAgIGZvciAoUFJVaW50MzIgaSA9IEVNQkVE
X01BWF9CVVRUT05TOyBpLS0gPiAwOyApIHsKLSAgICAgICAgICAgIGlmICghbUJ1dHRvbkxhYmVs
c1tpXS5Jc0VtcHR5KCkpCi0gICAgICAgICAgICAgICAgZ3RrX2RpYWxvZ19hZGRfYnV0dG9uKEdU
S19ESUFMT0cobVdpbmRvdyksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG1CdXR0b25MYWJlbHNbaV0uZ2V0KCksIGkpOwotICAgICAgICB9Ci0gICAgICAgIGd0a19kaWFs
b2dfc2V0X2RlZmF1bHRfcmVzcG9uc2UoR1RLX0RJQUxPRyhtV2luZG93KSwgMCk7Ci0gICAgfSBl
bHNlIHsKLSAgICAgICAgLy8gQ3JlYXRlIHN0YW5kYXJkIG9rIGFuZCBjYW5jZWwgYnV0dG9ucwot
ICAgICAgICBpZiAod2lkZ2V0RmxhZ3MgJiBJTkNMVURFX0NBTkNFTCkKLSAgICAgICAgICAgIGd0
a19kaWFsb2dfYWRkX2J1dHRvbihHVEtfRElBTE9HKG1XaW5kb3cpLCBHVEtfU1RPQ0tfQ0FOQ0VM
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdUS19SRVNQT05TRV9DQU5DRUwp
OwotCi0gICAgICAgIEd0a1dpZGdldCogb2tCdXR0b24gPSBndGtfZGlhbG9nX2FkZF9idXR0b24o
R1RLX0RJQUxPRyhtV2luZG93KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBHVEtfU1RPQ0tfT0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgR1RLX1JFU1BPTlNFX0FDQ0VQVCk7Ci0gICAgICAg
IGd0a193aWRnZXRfZ3JhYl9kZWZhdWx0KG9rQnV0dG9uKTsKLSAgICB9Ci0KLSAgICAvLyBQYWNr
IHRoZSBjb250ZW50c1ZCb3ggaW50byB0aGUgZGlhbG9nSEJveCBhbmQgdGhlIGRpYWxvZy4KLSAg
ICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChkaWFsb2dIQm94KSwgY29udGVudHNWQm94LCBG
QUxTRSwgRkFMU0UsIDApOwotICAgIGd0a19ib3hfcGFja19zdGFydChHVEtfQk9YKEdUS19ESUFM
T0cobVdpbmRvdyktPnZib3gpLCBkaWFsb2dIQm94LCBGQUxTRSwKLSAgICAgICAgICAgICAgICAg
ICAgICAgRkFMU0UsIDApOwotCi0gICAgcmV0dXJuIE5TX09LOwotfQotCi12b2lkCi1FbWJlZFBy
b21wdGVyOjpTZXRUaXRsZShjb25zdCBQUlVuaWNoYXIgKmFUaXRsZSkKLXsKLSAgICBtVGl0bGUu
QXNzaWduKE5TX0NvbnZlcnRVVEYxNnRvVVRGOChhVGl0bGUpKTsKLX0KLQotdm9pZAotRW1iZWRQ
cm9tcHRlcjo6U2V0VGV4dFZhbHVlKGNvbnN0IFBSVW5pY2hhciAqYVRleHRWYWx1ZSkKLXsKLSAg
ICBtVGV4dFZhbHVlLkFzc2lnbihOU19Db252ZXJ0VVRGMTZ0b1VURjgoYVRleHRWYWx1ZSkpOwot
fQotCi12b2lkCi1FbWJlZFByb21wdGVyOjpTZXRDaGVja01lc3NhZ2UoY29uc3QgUFJVbmljaGFy
ICphTWVzc2FnZSkKLXsKLSAgICBtQ2hlY2tNZXNzYWdlLkFzc2lnbihOU19Db252ZXJ0VVRGMTZ0
b1VURjgoYU1lc3NhZ2UpKTsKLX0KLQotdm9pZAotRW1iZWRQcm9tcHRlcjo6U2V0TWVzc2FnZVRl
eHQoY29uc3QgUFJVbmljaGFyICphTWVzc2FnZVRleHQpCi17Ci0gICAgbU1lc3NhZ2VUZXh0LkFz
c2lnbihOU19Db252ZXJ0VVRGMTZ0b1VURjgoYU1lc3NhZ2VUZXh0KSk7Ci19Ci0KLXZvaWQKLUVt
YmVkUHJvbXB0ZXI6OlNldFVzZXIoY29uc3QgUFJVbmljaGFyICphVXNlcikKLXsKLSAgICBtVXNl
ci5Bc3NpZ24oTlNfQ29udmVydFVURjE2dG9VVEY4KGFVc2VyKSk7Ci19Ci0KLXZvaWQKLUVtYmVk
UHJvbXB0ZXI6OlNldFBhc3N3b3JkKGNvbnN0IFBSVW5pY2hhciAqYVBhc3MpCi17Ci0gICAgbVBh
c3MuQXNzaWduKE5TX0NvbnZlcnRVVEYxNnRvVVRGOChhUGFzcykpOwotfQotCi12b2lkCi1FbWJl
ZFByb21wdGVyOjpTZXRDaGVja1ZhbHVlKGNvbnN0IFBSQm9vbCBhVmFsdWUpCi17Ci0gICAgbUNo
ZWNrVmFsdWUgPSBhVmFsdWU7Ci19Ci0KLXZvaWQKLUVtYmVkUHJvbXB0ZXI6OlNldEl0ZW1zKGNv
bnN0IFBSVW5pY2hhcioqIGFJdGVtQXJyYXksIFBSVWludDMyIGFDb3VudCkKLXsKLSAgICBpZiAo
bUl0ZW1MaXN0KQotICAgICAgICBkZWxldGVbXSBtSXRlbUxpc3Q7Ci0KLSAgICBtSXRlbUNvdW50
ID0gYUNvdW50OwotICAgIG1JdGVtTGlzdCA9IG5ldyBuc0NTdHJpbmdbYUNvdW50XTsKLSAgICBm
b3IgKFBSVWludDMyIGkgPSAwOyBpIDwgYUNvdW50OyArK2kpCi0gICAgICAgIG1JdGVtTGlzdFtp
XS5Bc3NpZ24oTlNfQ29udmVydFVURjE2dG9VVEY4KGFJdGVtQXJyYXlbaV0pKTsKLX0KLQotdm9p
ZAotRW1iZWRQcm9tcHRlcjo6U2V0QnV0dG9ucyhjb25zdCBQUlVuaWNoYXIqIGFCdXR0b24wTGFi
ZWwsCi0gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFBSVW5pY2hhciogYUJ1dHRvbjFM
YWJlbCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhQnV0dG9u
MkxhYmVsKQotewotICAgIG1CdXR0b25MYWJlbHNbMF0uQXNzaWduKE5TX0NvbnZlcnRVVEYxNnRv
VVRGOChhQnV0dG9uMExhYmVsKSk7Ci0gICAgbUJ1dHRvbkxhYmVsc1sxXS5Bc3NpZ24oTlNfQ29u
dmVydFVURjE2dG9VVEY4KGFCdXR0b24xTGFiZWwpKTsKLSAgICBtQnV0dG9uTGFiZWxzWzJdLkFz
c2lnbihOU19Db252ZXJ0VVRGMTZ0b1VURjgoYUJ1dHRvbjJMYWJlbCkpOwotfQotCi12b2lkCi1F
bWJlZFByb21wdGVyOjpHZXRDaGVja1ZhbHVlKFBSQm9vbCAqYVZhbHVlKQotewotICAgICphVmFs
dWUgPSBtQ2hlY2tWYWx1ZTsKLX0KLQotdm9pZAotRW1iZWRQcm9tcHRlcjo6R2V0Q29uZmlybVZh
bHVlKFBSQm9vbCAqYUNvbmZpcm1WYWx1ZSkKLXsKLSAgICAqYUNvbmZpcm1WYWx1ZSA9IG1Db25m
aXJtUmVzdWx0OwotfQotIAotdm9pZAotRW1iZWRQcm9tcHRlcjo6R2V0VGV4dFZhbHVlKFBSVW5p
Y2hhciAqKmFUZXh0VmFsdWUpCi17Ci0gICAgKmFUZXh0VmFsdWUgPSBUb05ld1VuaWNvZGUoTlNf
Q29udmVydFVURjh0b1VURjE2KG1UZXh0VmFsdWUpKTsKLX0KLQotdm9pZAotRW1iZWRQcm9tcHRl
cjo6R2V0VXNlcihQUlVuaWNoYXIgKiphVXNlcikKLXsKLSAgICAqYVVzZXIgPSBUb05ld1VuaWNv
ZGUoTlNfQ29udmVydFVURjh0b1VURjE2KG1Vc2VyKSk7Ci19Ci0KLXZvaWQKLUVtYmVkUHJvbXB0
ZXI6OkdldFBhc3N3b3JkKFBSVW5pY2hhciAqKmFQYXNzKQotewotICAgICphUGFzcyA9IFRvTmV3
VW5pY29kZShOU19Db252ZXJ0VVRGOHRvVVRGMTYobVBhc3MpKTsKLX0KLQotdm9pZAotRW1iZWRQ
cm9tcHRlcjo6R2V0U2VsZWN0ZWRJdGVtKFBSSW50MzIgKmFJbmRleCkKLXsKLSAgICAqYUluZGV4
ID0gbVNlbGVjdGVkSXRlbTsKLX0KLQotdm9pZAotRW1iZWRQcm9tcHRlcjo6R2V0QnV0dG9uUHJl
c3NlZChQUkludDMyICphQnV0dG9uKQotewotICAgICphQnV0dG9uID0gbUJ1dHRvblByZXNzZWQ7
Ci19Ci0KLXZvaWQKLUVtYmVkUHJvbXB0ZXI6OlJ1bih2b2lkKQotewotICAgIGd0a193aWRnZXRf
c2hvd19hbGwobVdpbmRvdyk7Ci0gICAgZ2ludCByZXNwb25zZSA9IGd0a19kaWFsb2dfcnVuKEdU
S19ESUFMT0cobVdpbmRvdykpOwotICAgIHN3aXRjaCAocmVzcG9uc2UpIHsKLSAgICBjYXNlIEdU
S19SRVNQT05TRV9OT05FOgotICAgIGNhc2UgR1RLX1JFU1BPTlNFX0NBTkNFTDoKLSAgICBjYXNl
IEdUS19SRVNQT05TRV9ERUxFVEVfRVZFTlQ6Ci0gICAgICAgIG1Db25maXJtUmVzdWx0ID0gUFJf
RkFMU0U7Ci0gICAgICAgIGJyZWFrOwotICAgIGNhc2UgR1RLX1JFU1BPTlNFX0FDQ0VQVDoKLSAg
ICAgICAgbUNvbmZpcm1SZXN1bHQgPSBQUl9UUlVFOwotICAgICAgICBTYXZlRGlhbG9nVmFsdWVz
KCk7Ci0gICAgICAgIGJyZWFrOwotICAgIGRlZmF1bHQ6Ci0gICAgICAgIG1CdXR0b25QcmVzc2Vk
ID0gcmVzcG9uc2U7Ci0gICAgICAgIFNhdmVEaWFsb2dWYWx1ZXMoKTsKLSAgICB9Ci0KLSAgICBn
dGtfd2lkZ2V0X2Rlc3Ryb3kobVdpbmRvdyk7Ci19Ci0KLXZvaWQKLUVtYmVkUHJvbXB0ZXI6OlNh
dmVEaWFsb2dWYWx1ZXMoKQotewotICAgIGlmIChtVXNlckZpZWxkKQotICAgICAgICBtVXNlci5B
c3NpZ24oZ3RrX2VudHJ5X2dldF90ZXh0KEdUS19FTlRSWShtVXNlckZpZWxkKSkpOwotCi0gICAg
aWYgKG1QYXNzRmllbGQpCi0gICAgICAgIG1QYXNzLkFzc2lnbihndGtfZW50cnlfZ2V0X3RleHQo
R1RLX0VOVFJZKG1QYXNzRmllbGQpKSk7Ci0KLSAgICBpZiAobUNoZWNrQm94KQotICAgICAgICBt
Q2hlY2tWYWx1ZSA9IGd0a190b2dnbGVfYnV0dG9uX2dldF9hY3RpdmUoR1RLX1RPR0dMRV9CVVRU
T04obUNoZWNrQm94KSk7Ci0KLSAgICBpZiAobVRleHRGaWVsZCkKLSAgICAgICAgbVRleHRWYWx1
ZS5Bc3NpZ24oZ3RrX2VudHJ5X2dldF90ZXh0KEdUS19FTlRSWShtVGV4dEZpZWxkKSkpOwotCi0g
ICAgaWYgKG1Db21ib0JveCkKLSAgICB7Ci0gICAgICAgIGdjaGFyICpzdHIgPSBndGtfY29tYm9f
Ym94X2dldF9hY3RpdmVfdGV4dChHVEtfQ09NQk9fQk9YKG1Db21ib0JveCkpOwotICAgICAgICBm
b3IgKFBSVWludDMyIGkgPSAwOyBpIDwgbUl0ZW1Db3VudDsgKytpKSB7Ci0gICAgICAgICAgICBp
ZihtSXRlbUxpc3RbaV0uRXF1YWxzKHN0cikpCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAg
ICAgbVNlbGVjdGVkSXRlbSA9IGk7Ci0gICAgICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgICAg
ICB9Ci0gICAgICAgIH0KLSAgICB9Ci19CmRpZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9n
dGsvc3JjL0VtYmVkUHJvbXB0ZXIuaCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRQ
cm9tcHRlci5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nl
ci9ndGsvc3JjL0VtYmVkUHJvbXB0ZXIuaAorKysgL2Rldi9udWxsCkBAIC0xLDExMyArMCwwIEBA
Ci0vKiAtKi0gTW9kZTogQysrOyB0YWItd2lkdGg6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbDsg
Yy1iYXNpYy1vZmZzZXQ6IDQgLSotICovCi0vKiB2aW06ZXhwYW5kdGFiOnNoaWZ0d2lkdGg9NDp0
YWJzdG9wPTQ6ICovCi0vKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0gKiBWZXJz
aW9uOiBNUEwgMS4xL0dQTCAyLjAvTEdQTCAyLjEKLSAqCi0gKiBUaGUgY29udGVudHMgb2YgdGhp
cyBmaWxlIGFyZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24K
LSAqIDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0
IGluIGNvbXBsaWFuY2Ugd2l0aAotICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29w
eSBvZiB0aGUgTGljZW5zZSBhdAotICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCi0gKgot
ICogU29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg
b24gYW4gIkFTIElTIiBiYXNpcywKLSAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVp
dGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZQotICogZm9yIHRoZSBzcGVj
aWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUK
LSAqIExpY2Vuc2UuCi0gKgotICogVGhlIE9yaWdpbmFsIENvZGUgaXMgbW96aWxsYS5vcmcgY29k
ZS4KLSAqCi0gKiBUaGUgSW5pdGlhbCBEZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMK
LSAqIENocmlzdG9waGVyIEJsaXp6YXJkLgotICogUG9ydGlvbnMgY3JlYXRlZCBieSB0aGUgSW5p
dGlhbCBEZXZlbG9wZXIgYXJlIENvcHlyaWdodCAoQykgMjAwMQotICogdGhlIEluaXRpYWwgRGV2
ZWxvcGVyLiBBbGwgUmlnaHRzIFJlc2VydmVkLgotICoKLSAqIENvbnRyaWJ1dG9yKHMpOgotICog
ICBDaHJpc3RvcGhlciBCbGl6emFyZCA8YmxpenphcmRAbW96aWxsYS5vcmc+Ci0gKiAgIEJyaWFu
IFJ5bmVyIDxicnluZXJAYnJpYW5yeW5lci5jb20+Ci0gKgotICogQWx0ZXJuYXRpdmVseSwgdGhl
IGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YKLSAq
IGVpdGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyIG9yIGxhdGVy
ICh0aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBWZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBpbiB3aGljaCBjYXNlIHRo
ZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFwcGxpY2FibGUgaW5zdGVh
ZAotICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93IHVzZSBvZiB5b3VyIHZl
cnNpb24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJtcyBvZiBlaXRoZXIgdGhl
IEdQTCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMgdG8KLSAqIHVzZSB5b3Vy
IHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTVBMLCBpbmRpY2F0
ZSB5b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlzaW9ucyBhYm92ZSBhbmQg
cmVwbGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVyIHByb3Zpc2lvbnMgcmVx
dWlyZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5vdCBkZWxldGUKLSAqIHRo
ZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlvdXIgdmVyc2lvbiBvZiB0
aGlzIGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9mIHRoZSBNUEwsIHRoZSBH
UEwgb3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8K
LQotI2luY2x1ZGUgIm5zU3RyaW5nR2x1ZS5oIgotI2luY2x1ZGUgPGd0ay9ndGsuaD4KLQotI2Rl
ZmluZSBFTUJFRF9NQVhfQlVUVE9OUyAzCi0KLWNsYXNzIEVtYmVkUHJvbXB0ZXIgewotCi1wdWJs
aWM6Ci0KLSAgICBFbWJlZFByb21wdGVyKCk7Ci0gICAgfkVtYmVkUHJvbXB0ZXIoKTsKLQotICAg
IGVudW0gUHJvbXB0VHlwZSB7Ci0gICAgICAgIFRZUEVfQUxFUlQsCi0gICAgICAgIFRZUEVfQUxF
UlRfQ0hFQ0ssCi0gICAgICAgIFRZUEVfQ09ORklSTSwKLSAgICAgICAgVFlQRV9DT05GSVJNX0NI
RUNLLAotICAgICAgICBUWVBFX1BST01QVCwKLSAgICAgICAgVFlQRV9QUk9NUFRfVVNFUl9QQVNT
LAotICAgICAgICBUWVBFX1BST01QVF9QQVNTLAotICAgICAgICBUWVBFX1NFTEVDVCwKLSAgICAg
ICAgVFlQRV9VTklWRVJTQUwKLSAgICB9OwotCi0gICAgbnNyZXN1bHQgQ3JlYXRlKFByb21wdFR5
cGUgYVR5cGUsIEd0a1dpbmRvdyogYVBhcmVudFdpbmRvdyk7Ci0gICAgdm9pZCAgICAgU2V0VGl0
bGUoY29uc3QgUFJVbmljaGFyICphVGl0bGUpOwotICAgIHZvaWQgICAgIFNldFRleHRWYWx1ZSAo
Y29uc3QgUFJVbmljaGFyICphVGV4dFZhbHVlKTsKLSAgICB2b2lkICAgICBTZXRDaGVja01lc3Nh
Z2UoY29uc3QgUFJVbmljaGFyICphQ2hlY2tNZXNzYWdlKTsKLSAgICB2b2lkICAgICBTZXRDaGVj
a1ZhbHVlKGNvbnN0IFBSQm9vbCBhVmFsdWUpOwotICAgIHZvaWQgICAgIFNldE1lc3NhZ2VUZXh0
KGNvbnN0IFBSVW5pY2hhciAqYU1lc3NhZ2VUZXh0KTsKLSAgICB2b2lkICAgICBTZXRVc2VyKGNv
bnN0IFBSVW5pY2hhciAqYVVzZXIpOwotICAgIHZvaWQgICAgIFNldFBhc3N3b3JkKGNvbnN0IFBS
VW5pY2hhciAqYVBhc3MpOwotICAgIHZvaWQgICAgIFNldEJ1dHRvbnMoY29uc3QgUFJVbmljaGFy
KiBhQnV0dG9uMExhYmVsLAotICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgUFJVbmljaGFy
KiBhQnV0dG9uMUxhYmVsLAotICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgUFJVbmljaGFy
KiBhQnV0dG9uMkxhYmVsKTsKLSAgICB2b2lkICAgICBTZXRJdGVtcyhjb25zdCBQUlVuaWNoYXIg
KiphSXRlbUFycmF5LCBQUlVpbnQzMiBhQ291bnQpOwotCi0gICAgdm9pZCAgICAgR2V0Q2hlY2tW
YWx1ZShQUkJvb2wgKmFWYWx1ZSk7Ci0gICAgdm9pZCAgICAgR2V0Q29uZmlybVZhbHVlKFBSQm9v
bCAqYUNvbmZpcm1WYWx1ZSk7Ci0gICAgdm9pZCAgICAgR2V0VGV4dFZhbHVlKFBSVW5pY2hhciAq
KmFUZXh0VmFsdWUpOwotICAgIHZvaWQgICAgIEdldFVzZXIoUFJVbmljaGFyICoqYVVzZXIpOwot
ICAgIHZvaWQgICAgIEdldFBhc3N3b3JkKFBSVW5pY2hhciAqKmFQYXNzKTsKLSAgICB2b2lkICAg
ICBHZXRCdXR0b25QcmVzc2VkKFBSSW50MzIgKmFCdXR0b24pOwotICAgIHZvaWQgICAgIEdldFNl
bGVjdGVkSXRlbShQUkludDMyICphSW5kZXgpOwotCi0gICAgdm9pZCAgICAgUnVuKHZvaWQpOwot
Ci1wcml2YXRlOgotCi0gICAgdm9pZCAgICAgU2F2ZURpYWxvZ1ZhbHVlcygpOwotCi0gICAgbnND
U3RyaW5nICAgIG1UaXRsZTsKLSAgICBuc0NTdHJpbmcgICAgbU1lc3NhZ2VUZXh0OwotICAgIG5z
Q1N0cmluZyAgICBtVGV4dFZhbHVlOwotICAgIG5zQ1N0cmluZyAgICBtQ2hlY2tNZXNzYWdlOwot
ICAgIFBSQm9vbCAgICAgICBtQ2hlY2tWYWx1ZTsKLSAgICBuc0NTdHJpbmcgICAgbVVzZXI7Ci0g
ICAgbnNDU3RyaW5nICAgIG1QYXNzOwotICAgIG5zQ1N0cmluZyAgICBtQnV0dG9uTGFiZWxzW0VN
QkVEX01BWF9CVVRUT05TXTsKLSAgICBuc0NTdHJpbmcgICAqbUl0ZW1MaXN0OwotICAgIFBSVWlu
dDMyICAgICBtSXRlbUNvdW50OwotCi0gICAgUFJJbnQzMiAgICAgIG1CdXR0b25QcmVzc2VkOwot
ICAgIFBSQm9vbCAgICAgICBtQ29uZmlybVJlc3VsdDsKLSAgICBQUkludDMyICAgICAgbVNlbGVj
dGVkSXRlbTsKLQotICAgIEd0a1dpZGdldCAgICptV2luZG93OwotICAgIEd0a1dpZGdldCAgICpt
VXNlckZpZWxkOwotICAgIEd0a1dpZGdldCAgICptUGFzc0ZpZWxkOwotICAgIEd0a1dpZGdldCAg
ICptVGV4dEZpZWxkOwotICAgIEd0a1dpZGdldCAgICptQ29tYm9Cb3g7Ci0gICAgR3RrV2lkZ2V0
ICAgKm1DaGVja0JveDsKLX07CmRpZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3Jj
L0VtYmVkV2luZG93LmNwcCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRXaW5kb3cu
Y3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsv
c3JjL0VtYmVkV2luZG93LmNwcAorKysgL2Rldi9udWxsCkBAIC0xLDQ3NCArMCwwIEBACi0vKgot
ICogdmltOnRzPTI6ZXQ6c3c9MgotICoKLSAqICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioq
KioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250
ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vu
c2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMg
ZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBv
YnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3Jn
L01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk
aXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBB
TlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBm
b3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25z
IHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3pp
bGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2lu
YWwgQ29kZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9ucyBjcmVhdGVk
IGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAxCi0gKiB0aGUg
SW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0
b3Iocyk6Ci0gKiAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3ppbGxhLm9yZz4K
LSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1
c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExl
c3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxH
UEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUg
TEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdp
c2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5k
ZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFs
bG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5n
IHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0g
KiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJ
ZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50
IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9m
IGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBF
TkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5jbHVkZSAibnNDV2ViQnJvd3Nlci5oIgot
I2luY2x1ZGUgIm5zSUNvbXBvbmVudE1hbmFnZXIuaCIKLSNpbmNsdWRlICJuc0NvbXBvbmVudE1h
bmFnZXJVdGlscy5oIgotI2luY2x1ZGUgIm5zSURvY1NoZWxsVHJlZUl0ZW0uaCIKLSNpbmNsdWRl
ICJuc0lXaWRnZXQuaCIKLQotI2luY2x1ZGUgIkVtYmVkV2luZG93LmgiCi0jaW5jbHVkZSAiRW1i
ZWRQcml2YXRlLmgiCi0jaW5jbHVkZSAiRW1iZWRQcm9tcHRlci5oIgotCi1HdGtXaWRnZXQgKkVt
YmVkV2luZG93OjpzVGlwV2luZG93ID0gbnNudWxsOwotCi1FbWJlZFdpbmRvdzo6RW1iZWRXaW5k
b3codm9pZCkKLXsKLSAgbU93bmVyICAgICAgID0gbnNudWxsOwotICBtVmlzaWJpbGl0eSAgPSBQ
Ul9GQUxTRTsKLSAgbUlzTW9kYWwgICAgID0gUFJfRkFMU0U7Ci19Ci0KLUVtYmVkV2luZG93Ojp+
RW1iZWRXaW5kb3codm9pZCkKLXsKLSAgRXhpdE1vZGFsRXZlbnRMb29wKFBSX0ZBTFNFKTsKLX0K
LQotbnNyZXN1bHQKLUVtYmVkV2luZG93OjpJbml0KEVtYmVkUHJpdmF0ZSAqYU93bmVyKQotewot
ICAvLyBzYXZlIG91ciBvd25lciBmb3IgbGF0ZXIKLSAgbU93bmVyID0gYU93bmVyOwotCi0gIC8v
IGNyZWF0ZSBvdXIgbnNJV2ViQnJvd3NlciBvYmplY3QgYW5kIHNldCB1cCBzb21lIGJhc2ljIGRl
ZmF1bHRzLgotICBtV2ViQnJvd3NlciA9IGRvX0NyZWF0ZUluc3RhbmNlKE5TX1dFQkJST1dTRVJf
Q09OVFJBQ1RJRCk7Ci0gIGlmICghbVdlYkJyb3dzZXIpCi0gICAgcmV0dXJuIE5TX0VSUk9SX0ZB
SUxVUkU7Ci0KLSAgbVdlYkJyb3dzZXItPlNldENvbnRhaW5lcldpbmRvdyhzdGF0aWNfY2FzdDxu
c0lXZWJCcm93c2VyQ2hyb21lICo+KHRoaXMpKTsKLSAgCi0gIG5zQ09NUHRyPG5zSURvY1NoZWxs
VHJlZUl0ZW0+IGl0ZW0gPSBkb19RdWVyeUludGVyZmFjZShtV2ViQnJvd3Nlcik7Ci0gIGl0ZW0t
PlNldEl0ZW1UeXBlKG5zSURvY1NoZWxsVHJlZUl0ZW06OnR5cGVDb250ZW50V3JhcHBlcik7Ci0K
LSAgcmV0dXJuIE5TX09LOwotfQotCi1uc3Jlc3VsdAotRW1iZWRXaW5kb3c6OkNyZWF0ZVdpbmRv
dyh2b2lkKQotewotICBuc3Jlc3VsdCBydjsKLSAgR3RrV2lkZ2V0ICpvd25lckFzV2lkZ2V0ID0g
R1RLX1dJREdFVChtT3duZXItPm1Pd25pbmdXaWRnZXQpOwotCi0gIC8vIEdldCB0aGUgYmFzZSB3
aW5kb3cgaW50ZXJmYWNlIGZvciB0aGUgd2ViIGJyb3dzZXIgb2JqZWN0IGFuZAotICAvLyBjcmVh
dGUgdGhlIHdpbmRvdy4KLSAgbUJhc2VXaW5kb3cgPSBkb19RdWVyeUludGVyZmFjZShtV2ViQnJv
d3Nlcik7Ci0gIHJ2ID0gbUJhc2VXaW5kb3ctPkluaXRXaW5kb3coR1RLX1dJREdFVChtT3duZXIt
Pm1Pd25pbmdXaWRnZXQpLAotCQkJICAgICAgIG5zbnVsbCwKLQkJCSAgICAgICAwLCAwLCAKLQkJ
CSAgICAgICBvd25lckFzV2lkZ2V0LT5hbGxvY2F0aW9uLndpZHRoLAotCQkJICAgICAgIG93bmVy
QXNXaWRnZXQtPmFsbG9jYXRpb24uaGVpZ2h0KTsKLSAgaWYgKE5TX0ZBSUxFRChydikpCi0gICAg
cmV0dXJuIHJ2OwotCi0gIHJ2ID0gbUJhc2VXaW5kb3ctPkNyZWF0ZSgpOwotICBpZiAoTlNfRkFJ
TEVEKHJ2KSkKLSAgICByZXR1cm4gcnY7Ci0KLSAgcmV0dXJuIE5TX09LOwotfQotCi12b2lkCi1F
bWJlZFdpbmRvdzo6UmVsZWFzZUNoaWxkcmVuKHZvaWQpCi17Ci0gIEV4aXRNb2RhbEV2ZW50TG9v
cChQUl9GQUxTRSk7Ci0gICAgCi0gIG1CYXNlV2luZG93LT5EZXN0cm95KCk7Ci0gIG1CYXNlV2lu
ZG93ID0gMDsKLSAgbVdlYkJyb3dzZXIgPSAwOwotfQotCi0vLyBuc0lTdXBwb3J0cwotCi1OU19J
TVBMX0FERFJFRihFbWJlZFdpbmRvdykKLU5TX0lNUExfUkVMRUFTRShFbWJlZFdpbmRvdykKLQot
TlNfSU5URVJGQUNFX01BUF9CRUdJTihFbWJlZFdpbmRvdykKLSAgTlNfSU5URVJGQUNFX01BUF9F
TlRSWV9BTUJJR1VPVVMobnNJU3VwcG9ydHMsIG5zSVdlYkJyb3dzZXJDaHJvbWUpCi0gIE5TX0lO
VEVSRkFDRV9NQVBfRU5UUlkobnNJV2ViQnJvd3NlckNocm9tZSkKLSAgTlNfSU5URVJGQUNFX01B
UF9FTlRSWShuc0lXZWJCcm93c2VyQ2hyb21lRm9jdXMpCi0gIE5TX0lOVEVSRkFDRV9NQVBfRU5U
UlkobnNJRW1iZWRkaW5nU2l0ZVdpbmRvdykKLSAgTlNfSU5URVJGQUNFX01BUF9FTlRSWShuc0lU
b29sdGlwTGlzdGVuZXIpCi0gIE5TX0lOVEVSRkFDRV9NQVBfRU5UUlkobnNJSW50ZXJmYWNlUmVx
dWVzdG9yKQotTlNfSU5URVJGQUNFX01BUF9FTkQKLQotLy8gbnNJV2ViQnJvd3NlckNocm9tZQot
Ci1OU19JTUVUSE9ESU1QCi1FbWJlZFdpbmRvdzo6U2V0U3RhdHVzKFBSVWludDMyIGFTdGF0dXNU
eXBlLCBjb25zdCBQUlVuaWNoYXIgKmFTdGF0dXMpCi17Ci0gIHN3aXRjaCAoYVN0YXR1c1R5cGUp
IHsKLSAgY2FzZSBTVEFUVVNfU0NSSVBUOiAKLSAgICB7Ci0gICAgICBtSlNTdGF0dXMgPSBhU3Rh
dHVzOwotICAgICAgZ19zaWduYWxfZW1pdChHX09CSkVDVChtT3duZXItPm1Pd25pbmdXaWRnZXQp
LAotICAgICAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tKU19TVEFUVVNdLCAwKTsK
LSAgICB9Ci0gICAgYnJlYWs7Ci0gIGNhc2UgU1RBVFVTX1NDUklQVF9ERUZBVUxUOgotICAgIC8v
IEdlZSwgdGhhdCdzIG5pY2UuCi0gICAgYnJlYWs7Ci0gIGNhc2UgU1RBVFVTX0xJTks6Ci0gICAg
ewotICAgICAgbUxpbmtNZXNzYWdlID0gYVN0YXR1czsKLSAgICAgIGdfc2lnbmFsX2VtaXQoR19P
QkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAgICAgICAgbW96X2Vt
YmVkX3NpZ25hbHNbTElOS19NRVNTQUdFXSwgMCk7Ci0gICAgfQotICAgIGJyZWFrOwotICB9Ci0g
IHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRXaW5kb3c6OkdldFdlYkJy
b3dzZXIobnNJV2ViQnJvd3NlciAqKmFXZWJCcm93c2VyKQotewotICAqYVdlYkJyb3dzZXIgPSBt
V2ViQnJvd3NlcjsKLSAgTlNfSUZfQUREUkVGKCphV2ViQnJvd3Nlcik7Ci0gIHJldHVybiBOU19P
SzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRXaW5kb3c6OlNldFdlYkJyb3dzZXIobnNJV2Vi
QnJvd3NlciAqYVdlYkJyb3dzZXIpCi17Ci0gIG1XZWJCcm93c2VyID0gYVdlYkJyb3dzZXI7Ci0g
IHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRXaW5kb3c6OkdldENocm9t
ZUZsYWdzKFBSVWludDMyICphQ2hyb21lRmxhZ3MpCi17Ci0gICphQ2hyb21lRmxhZ3MgPSBtT3du
ZXItPm1DaHJvbWVNYXNrOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVt
YmVkV2luZG93OjpTZXRDaHJvbWVGbGFncyhQUlVpbnQzMiBhQ2hyb21lRmxhZ3MpCi17Ci0gIG1P
d25lci0+U2V0Q2hyb21lTWFzayhhQ2hyb21lRmxhZ3MpOwotICByZXR1cm4gTlNfT0s7Ci19Ci0K
LU5TX0lNRVRIT0RJTVAKLUVtYmVkV2luZG93OjpEZXN0cm95QnJvd3NlcldpbmRvdyh2b2lkKQot
ewotICAvLyBtYXJrIHRoZSBvd25lciBhcyBkZXN0cm95ZWQgc28gaXQgd29uJ3QgZW1pdCBldmVu
dHMgYW55bW9yZS4KLSAgbU93bmVyLT5tSXNEZXN0cm95ZWQgPSBQUl9UUlVFOwotCi0gIGdfc2ln
bmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAg
ICBtb3pfZW1iZWRfc2lnbmFsc1tERVNUUk9ZX0JST1dTRVJdLCAwKTsKLSAgcmV0dXJuIE5TX09L
OwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZFdpbmRvdzo6U2l6ZUJyb3dzZXJUbyhQUkludDMy
IGFDWCwgUFJJbnQzMiBhQ1kpCi17Ci0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5t
T3duaW5nV2lkZ2V0KSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tTSVpFX1RP
XSwgMCwgYUNYLCBhQ1kpOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVt
YmVkV2luZG93OjpTaG93QXNNb2RhbCh2b2lkKQotewotICBtSXNNb2RhbCA9IFBSX1RSVUU7Ci0g
IEd0a1dpZGdldCAqdG9wbGV2ZWw7Ci0gIHRvcGxldmVsID0gZ3RrX3dpZGdldF9nZXRfdG9wbGV2
ZWwoR1RLX1dJREdFVChtT3duZXItPm1Pd25pbmdXaWRnZXQpKTsKLSAgZ3RrX2dyYWJfYWRkKHRv
cGxldmVsKTsKLSAgZ3RrX21haW4oKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9E
SU1QCi1FbWJlZFdpbmRvdzo6SXNXaW5kb3dNb2RhbChQUkJvb2wgKl9yZXR2YWwpCi17Ci0gICpf
cmV0dmFsID0gbUlzTW9kYWw7Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAot
RW1iZWRXaW5kb3c6OkV4aXRNb2RhbEV2ZW50TG9vcChuc3Jlc3VsdCBhU3RhdHVzKQotewotICBp
ZiAobUlzTW9kYWwpIHsKLSAgICBHdGtXaWRnZXQgKnRvcGxldmVsOwotICAgIHRvcGxldmVsID0g
Z3RrX3dpZGdldF9nZXRfdG9wbGV2ZWwoR1RLX1dJREdFVChtT3duZXItPm1Pd25pbmdXaWRnZXQp
KTsKLSAgICBndGtfZ3JhYl9yZW1vdmUodG9wbGV2ZWwpOwotICAgIG1Jc01vZGFsID0gUFJfRkFM
U0U7Ci0gICAgZ3RrX21haW5fcXVpdCgpOwotICB9Ci0gIHJldHVybiBOU19PSzsKLX0KLQotLy8g
bnNJV2ViQnJvd3NlckNocm9tZUZvY3VzCi0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkV2luZG93OjpG
b2N1c05leHRFbGVtZW50KCkKLXsKLSAgR3RrV2lkZ2V0ICp0b3BsZXZlbDsKLSAgdG9wbGV2ZWwg
PSBndGtfd2lkZ2V0X2dldF90b3BsZXZlbChHVEtfV0lER0VUKG1Pd25lci0+bU93bmluZ1dpZGdl
dCkpOwotICBpZiAoIUdUS19XSURHRVRfVE9QTEVWRUwodG9wbGV2ZWwpKQotICAgIHJldHVybiBO
U19PSzsKLQotICBnX3NpZ25hbF9lbWl0X2J5X25hbWUoR19PQkpFQ1QodG9wbGV2ZWwpLCAibW92
ZV9mb2N1cyIsCi0JCQlHVEtfRElSX1RBQl9GT1JXQVJEKTsKLSAgcmV0dXJuIE5TX09LOwotfQot
Ci1OU19JTUVUSE9ESU1QCi1FbWJlZFdpbmRvdzo6Rm9jdXNQcmV2RWxlbWVudCgpCi17Ci0gIEd0
a1dpZGdldCAqdG9wbGV2ZWw7Ci0gIHRvcGxldmVsID0gZ3RrX3dpZGdldF9nZXRfdG9wbGV2ZWwo
R1RLX1dJREdFVChtT3duZXItPm1Pd25pbmdXaWRnZXQpKTsKLSAgaWYgKCFHVEtfV0lER0VUX1RP
UExFVkVMKHRvcGxldmVsKSkKLSAgICByZXR1cm4gTlNfT0s7Ci0KLSAgZ19zaWduYWxfZW1pdF9i
eV9uYW1lKEdfT0JKRUNUKHRvcGxldmVsKSwgIm1vdmVfZm9jdXMiLAotCQkJR1RLX0RJUl9UQUJf
QkFDS1dBUkQpOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLS8vIG5zSUVtYmVkZGluZ1NpdGVXaW5k
b3cKLQotTlNfSU1FVEhPRElNUAotRW1iZWRXaW5kb3c6OlNldERpbWVuc2lvbnMoUFJVaW50MzIg
YUZsYWdzLCBQUkludDMyIGFYLCBQUkludDMyIGFZLAotCQkJICAgUFJJbnQzMiBhQ1gsIFBSSW50
MzIgYUNZKQotewotICBpZiAoYUZsYWdzICYgbnNJRW1iZWRkaW5nU2l0ZVdpbmRvdzo6RElNX0ZM
QUdTX1BPU0lUSU9OICYmCi0gICAgICAoYUZsYWdzICYgKG5zSUVtYmVkZGluZ1NpdGVXaW5kb3c6
OkRJTV9GTEFHU19TSVpFX0lOTkVSIHwKLQkJIG5zSUVtYmVkZGluZ1NpdGVXaW5kb3c6OkRJTV9G
TEFHU19TSVpFX09VVEVSKSkpIHsKLSAgICByZXR1cm4gbUJhc2VXaW5kb3ctPlNldFBvc2l0aW9u
QW5kU2l6ZShhWCwgYVksIGFDWCwgYUNZLCBQUl9UUlVFKTsKLSAgfQotICBlbHNlIGlmIChhRmxh
Z3MgJiBuc0lFbWJlZGRpbmdTaXRlV2luZG93OjpESU1fRkxBR1NfUE9TSVRJT04pIHsKLSAgICBy
ZXR1cm4gbUJhc2VXaW5kb3ctPlNldFBvc2l0aW9uKGFYLCBhWSk7Ci0gIH0KLSAgZWxzZSBpZiAo
YUZsYWdzICYgKG5zSUVtYmVkZGluZ1NpdGVXaW5kb3c6OkRJTV9GTEFHU19TSVpFX0lOTkVSIHwK
LQkJICAgICBuc0lFbWJlZGRpbmdTaXRlV2luZG93OjpESU1fRkxBR1NfU0laRV9PVVRFUikpIHsK
LSAgICByZXR1cm4gbUJhc2VXaW5kb3ctPlNldFNpemUoYUNYLCBhQ1ksIFBSX1RSVUUpOwotICB9
Ci0gIHJldHVybiBOU19FUlJPUl9JTlZBTElEX0FSRzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1i
ZWRXaW5kb3c6OkdldERpbWVuc2lvbnMoUFJVaW50MzIgYUZsYWdzLCBQUkludDMyICphWCwKLQkJ
CSAgIFBSSW50MzIgKmFZLCBQUkludDMyICphQ1gsIFBSSW50MzIgKmFDWSkKLXsKLSAgaWYgKGFG
bGFncyAmIG5zSUVtYmVkZGluZ1NpdGVXaW5kb3c6OkRJTV9GTEFHU19QT1NJVElPTiAmJgotICAg
ICAgKGFGbGFncyAmIChuc0lFbWJlZGRpbmdTaXRlV2luZG93OjpESU1fRkxBR1NfU0laRV9JTk5F
UiB8Ci0JCSBuc0lFbWJlZGRpbmdTaXRlV2luZG93OjpESU1fRkxBR1NfU0laRV9PVVRFUikpKSB7
Ci0gICAgcmV0dXJuIG1CYXNlV2luZG93LT5HZXRQb3NpdGlvbkFuZFNpemUoYVgsIGFZLCBhQ1gs
IGFDWSk7Ci0gIH0KLSAgZWxzZSBpZiAoYUZsYWdzICYgbnNJRW1iZWRkaW5nU2l0ZVdpbmRvdzo6
RElNX0ZMQUdTX1BPU0lUSU9OKSB7Ci0gICAgcmV0dXJuIG1CYXNlV2luZG93LT5HZXRQb3NpdGlv
bihhWCwgYVkpOwotICB9Ci0gIGVsc2UgaWYgKGFGbGFncyAmIChuc0lFbWJlZGRpbmdTaXRlV2lu
ZG93OjpESU1fRkxBR1NfU0laRV9JTk5FUiB8Ci0JCSAgICAgbnNJRW1iZWRkaW5nU2l0ZVdpbmRv
dzo6RElNX0ZMQUdTX1NJWkVfT1VURVIpKSB7Ci0gICAgcmV0dXJuIG1CYXNlV2luZG93LT5HZXRT
aXplKGFDWCwgYUNZKTsKLSAgfQotICByZXR1cm4gTlNfRVJST1JfSU5WQUxJRF9BUkc7Ci19Ci0K
LU5TX0lNRVRIT0RJTVAKLUVtYmVkV2luZG93OjpTZXRGb2N1cyh2b2lkKQotewotICAvLyBYWFgg
bWlnaHQgaGF2ZSB0byBkbyBtb3JlIGhlcmUuCi0gIHJldHVybiBtQmFzZVdpbmRvdy0+U2V0Rm9j
dXMoKTsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRXaW5kb3c6OkdldFRpdGxlKFBSVW5pY2hh
ciAqKmFUaXRsZSkKLXsKLSAgKmFUaXRsZSA9IFRvTmV3VW5pY29kZShtVGl0bGUpOwotICByZXR1
cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkV2luZG93OjpTZXRUaXRsZShjb25z
dCBQUlVuaWNoYXIgKmFUaXRsZSkKLXsKLSAgbVRpdGxlID0gYVRpdGxlOwotICBnX3NpZ25hbF9l
bWl0KEdfT0JKRUNUKG1Pd25lci0+bU93bmluZ1dpZGdldCksCi0gICAgICAgICAgICAgICAgbW96
X2VtYmVkX3NpZ25hbHNbVElUTEVdLCAwKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVU
SE9ESU1QCi1FbWJlZFdpbmRvdzo6R2V0U2l0ZVdpbmRvdyh2b2lkICoqYVNpdGVXaW5kb3cpCi17
Ci0gIEd0a1dpZGdldCAqb3duZXJBc1dpZGdldCAoR1RLX1dJREdFVChtT3duZXItPm1Pd25pbmdX
aWRnZXQpKTsKLSAgKmFTaXRlV2luZG93ID0gc3RhdGljX2Nhc3Q8dm9pZCAqPihvd25lckFzV2lk
Z2V0KTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1FbWJlZFdpbmRvdzo6
R2V0VmlzaWJpbGl0eShQUkJvb2wgKmFWaXNpYmlsaXR5KQotewotICAvLyBYWFggU2VlIGJ1ZyAz
MTI5OTgKLSAgLy8gV29yayBhcm91bmQgdGhlIHByb2JsZW0gdGhhdCBzb21ldGltZXMgdGhlIHdp
bmRvdwotICAvLyBpcyBhbHJlYWR5IHZpc2libGUgZXZlbiB0aG91Z2ggbVZpc2liaWxpdHkgaXNu
J3QgdHJ1ZQotICAvLyB5ZXQuCi0gICphVmlzaWJpbGl0eSA9IG1WaXNpYmlsaXR5IHx8Ci0gICAg
ICAgICAgICAgICAgICghbU93bmVyLT5tSXNDaHJvbWUgJiYKLSAgICAgICAgICAgICAgICAgIG1P
d25lci0+bU93bmluZ1dpZGdldCAmJgotICAgICAgICAgICAgICAgICAgR1RLX1dJREdFVF9NQVBQ
RUQobU93bmVyLT5tT3duaW5nV2lkZ2V0KSk7Ci0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1F
VEhPRElNUAotRW1iZWRXaW5kb3c6OlNldFZpc2liaWxpdHkoUFJCb29sIGFWaXNpYmlsaXR5KQot
ewotICAvLyBXZSBhbHdheXMgc2V0IHRoZSB2aXNpYmlsaXR5IHNvIHRoYXQgaWYgaXQncyBjaHJv
bWUgYW5kIHdlIGZpbmlzaAotICAvLyB0aGUgbG9hZCB3ZSBrbm93IHRoYXQgd2UgaGF2ZSB0byBz
aG93IHRoZSB3aW5kb3cuCi0gIG1WaXNpYmlsaXR5ID0gYVZpc2liaWxpdHk7Ci0KLSAgLy8gaWYg
dGhpcyBpcyBhIGNocm9tZSB3aW5kb3cgYW5kIHRoZSBjaHJvbWUgaGFzbid0IGZpbmlzaGVkIGxv
YWRpbmcKLSAgLy8geWV0IHRoZW4gZG9uJ3Qgc2hvdyB0aGUgd2luZG93IHlldC4KLSAgaWYgKG1P
d25lci0+bUlzQ2hyb21lICYmICFtT3duZXItPm1DaHJvbWVMb2FkZWQpCi0gICAgcmV0dXJuIE5T
X09LOwotCi0gIGdfc2lnbmFsX2VtaXQoR19PQkpFQ1QobU93bmVyLT5tT3duaW5nV2lkZ2V0KSwK
LSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tWSVNJQklMSVRZXSwgMCwKLSAgICAg
ICAgICAgICAgICBhVmlzaWJpbGl0eSk7Ci0gIHJldHVybiBOU19PSzsKLX0KLQotLy8gbnNJVG9v
bHRpcExpc3RlbmVyCi0KLXN0YXRpYyBnaW50Ci10b29sdGlwc19wYWludF93aW5kb3coR3RrV2lk
Z2V0ICp3aW5kb3cpCi17Ci0gIC8vIGRyYXcgdG9vbHRpcCBzdHlsZSBib3JkZXIgYXJvdW5kIHRo
ZSB0ZXh0Ci0gIGd0a19wYWludF9mbGF0X2JveCh3aW5kb3ctPnN0eWxlLCB3aW5kb3ctPndpbmRv
dywKLSAgICAgICAgICAgICAgICAgICAgIEdUS19TVEFURV9OT1JNQUwsIEdUS19TSEFET1dfT1VU
LAotICAgICAgICAgICAgICAgICAgICAgTlVMTCwgd2luZG93LCAidG9vbHRpcCIsCi0gICAgICAg
ICAgICAgICAgICAgICAwLCAwLAotICAgICAgICAgICAgICAgICAgICAgd2luZG93LT5hbGxvY2F0
aW9uLndpZHRoLCB3aW5kb3ctPmFsbG9jYXRpb24uaGVpZ2h0KTsKLQotICByZXR1cm4gRkFMU0U7
Ci19Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi1OU19JTUVUSE9ESU1Q
Ci1FbWJlZFdpbmRvdzo6T25TaG93VG9vbHRpcChQUkludDMyIGFYQ29vcmRzLCBQUkludDMyIGFZ
Q29vcmRzLAotCQkJICAgY29uc3QgUFJVbmljaGFyICphVGlwVGV4dCkKLXsKLSAgbnNBdXRvU3Ry
aW5nIHRpcFRleHQgKCBhVGlwVGV4dCApOwotCi0gIGNvbnN0IGNoYXIqIHRpcFN0cmluZyA9IFRv
TmV3VVRGOFN0cmluZyh0aXBUZXh0KTsKLQotICBpZiAoc1RpcFdpbmRvdykKLSAgICBndGtfd2lk
Z2V0X2Rlc3Ryb3koc1RpcFdpbmRvdyk7Ci0gIAotICAvLyBnZXQgdGhlIHJvb3Qgb3JpZ2luIGZv
ciB0aGlzIGNvbnRlbnQgd2luZG93Ci0gIG5zQ09NUHRyPG5zSVdpZGdldD4gbWFpbldpZGdldDsK
LSAgbUJhc2VXaW5kb3ctPkdldE1haW5XaWRnZXQoZ2V0dGVyX0FkZFJlZnMobWFpbldpZGdldCkp
OwotICBHZGtXaW5kb3cgKndpbmRvdzsKLSAgd2luZG93ID0gc3RhdGljX2Nhc3Q8R2RrV2luZG93
ICo+KG1haW5XaWRnZXQtPkdldE5hdGl2ZURhdGEoTlNfTkFUSVZFX1dJTkRPVykpOwotICBnaW50
IHJvb3RfeCwgcm9vdF95OwotICBnZGtfd2luZG93X2dldF9vcmlnaW4od2luZG93LCAmcm9vdF94
LCAmcm9vdF95KTsKLQotICAvLyBYWFggd29yayBhcm91bmQgdW50aWwgSSBjYW4gZ2V0IHBpbmsg
dG8gZmlndXJlIG91dCB3aHkKLSAgLy8gdG9vbHRpcHMgdmFuaXNoIGlmIHRoZXkgc2hvdyB1cCBy
aWdodCBhdCB0aGUgb3JpZ2luIG9mIHRoZQotICAvLyBjdXJzb3IuCi0gIHJvb3RfeSArPSAxMDsK
LSAgCi0gIHNUaXBXaW5kb3cgPSBndGtfd2luZG93X25ldyhHVEtfV0lORE9XX1BPUFVQKTsKLSAg
Z3RrX3dpZGdldF9zZXRfYXBwX3BhaW50YWJsZShzVGlwV2luZG93LCBUUlVFKTsKLSAgZ3RrX3dp
bmRvd19zZXRfcmVzaXphYmxlKEdUS19XSU5ET1coc1RpcFdpbmRvdyksIFRSVUUpOwotICAvLyBu
ZWVkZWQgdG8gZ2V0IGNvbG9ycyArIGZvbnRzIGV0YyBjb3JyZWN0bHkKLSAgZ3RrX3dpZGdldF9z
ZXRfbmFtZShzVGlwV2luZG93LCAiZ3RrLXRvb2x0aXBzIik7Ci0gIGd0a193aW5kb3dfc2V0X3R5
cGVfaGludChHVEtfV0lORE9XKHNUaXBXaW5kb3cpLCBHREtfV0lORE9XX1RZUEVfSElOVF9UT09M
VElQKTsKLSAgCi0gIC8vIHNldCB1cCB0aGUgcG9wdXAgd2luZG93IGFzIGEgdHJhbnNpZW50IG9m
IHRoZSB3aWRnZXQuCi0gIEd0a1dpZGdldCAqdG9wbGV2ZWxfd2luZG93OwotICB0b3BsZXZlbF93
aW5kb3cgPSBndGtfd2lkZ2V0X2dldF90b3BsZXZlbChHVEtfV0lER0VUKG1Pd25lci0+bU93bmlu
Z1dpZGdldCkpOwotICBpZiAoIUdUS19XSU5ET1codG9wbGV2ZWxfd2luZG93KSkgewotICAgIE5T
X0VSUk9SKCJubyBndGsgd2luZG93IGluIGhpZXJhcmNoeSEiKTsKLSAgICByZXR1cm4gTlNfRVJS
T1JfRkFJTFVSRTsKLSAgfQotICBndGtfd2luZG93X3NldF90cmFuc2llbnRfZm9yKEdUS19XSU5E
T1coc1RpcFdpbmRvdyksCi0JCQkgICAgICAgR1RLX1dJTkRPVyh0b3BsZXZlbF93aW5kb3cpKTsK
LSAgCi0gIC8vIHJlYWxpemUgdGhlIHdpZGdldAotICBndGtfd2lkZ2V0X3JlYWxpemUoc1RpcFdp
bmRvdyk7Ci0KLSAgZ19zaWduYWxfY29ubmVjdChHX09CSkVDVChzVGlwV2luZG93KSwgImV4cG9z
ZV9ldmVudCIsCi0gICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyh0b29sdGlwc19wYWludF93
aW5kb3cpLCBOVUxMKTsKLQotICAvLyBzZXQgdXAgdGhlIGxhYmVsIGZvciB0aGUgdG9vbHRpcAot
ICBHdGtXaWRnZXQgKmxhYmVsID0gZ3RrX2xhYmVsX25ldyh0aXBTdHJpbmcpOwotICAvLyB3cmFw
IGF1dG9tYXRpY2FsbHkKLSAgZ3RrX2xhYmVsX3NldF9saW5lX3dyYXAoR1RLX0xBQkVMKGxhYmVs
KSwgVFJVRSk7Ci0gIGd0a19jb250YWluZXJfYWRkKEdUS19DT05UQUlORVIoc1RpcFdpbmRvdyks
IGxhYmVsKTsKLSAgZ3RrX2NvbnRhaW5lcl9zZXRfYm9yZGVyX3dpZHRoKEdUS19DT05UQUlORVIo
c1RpcFdpbmRvdyksIDQpOwotICAvLyBzZXQgdGhlIGNvb3JkcyBmb3IgdGhlIHdpZGdldAotICBn
dGtfd2lkZ2V0X3NldF91cG9zaXRpb24oc1RpcFdpbmRvdywgYVhDb29yZHMgKyByb290X3gsCi0J
CQkgICBhWUNvb3JkcyArIHJvb3RfeSk7Ci0KLSAgLy8gYW5kIHNob3cgaXQuCi0gIGd0a193aWRn
ZXRfc2hvd19hbGwoc1RpcFdpbmRvdyk7Ci0KLSAgTlNfRnJlZSggKHZvaWQqKXRpcFN0cmluZyAp
OwotCi0gIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotRW1iZWRXaW5kb3c6Ok9u
SGlkZVRvb2x0aXAodm9pZCkKLXsKLSAgaWYgKHNUaXBXaW5kb3cpCi0gICAgZ3RrX3dpZGdldF9k
ZXN0cm95KHNUaXBXaW5kb3cpOwotICBzVGlwV2luZG93ID0gTlVMTDsKLSAgcmV0dXJuIE5TX09L
OwotfQotCi0vLyBuc0lJbnRlcmZhY2VSZXF1ZXN0b3IKLQotTlNfSU1FVEhPRElNUAotRW1iZWRX
aW5kb3c6OkdldEludGVyZmFjZShjb25zdCBuc0lJRCAmYUlJRCwgdm9pZCoqIGFJbnN0YW5jZVB0
cikKLXsKLSAgbnNyZXN1bHQgcnY7Ci0gIAotICBydiA9IFF1ZXJ5SW50ZXJmYWNlKGFJSUQsIGFJ
bnN0YW5jZVB0cik7Ci0KLSAgLy8gcGFzcyBpdCB1cCB0byB0aGUgd2ViIGJyb3dzZXIgb2JqZWN0
Ci0gIGlmIChOU19GQUlMRUQocnYpIHx8ICEqYUluc3RhbmNlUHRyKSB7Ci0gICAgbnNDT01QdHI8
bnNJSW50ZXJmYWNlUmVxdWVzdG9yPiBpciA9IGRvX1F1ZXJ5SW50ZXJmYWNlKG1XZWJCcm93c2Vy
KTsKLSAgICByZXR1cm4gaXItPkdldEludGVyZmFjZShhSUlELCBhSW5zdGFuY2VQdHIpOwotICB9
Ci0KLSAgcmV0dXJuIHJ2OwotfQpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Ny
Yy9FbWJlZFdpbmRvdy5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZFdpbmRvdy5o
CmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3Jj
L0VtYmVkV2luZG93LmgKKysrIC9kZXYvbnVsbApAQCAtMSwxMDEgKzAsMCBAQAotLyogKioqKiog
QkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4wL0xH
UEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0byB0
aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGljZW5zZSIp
OyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgKLSAq
IHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLSAq
IGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3RyaWJ1dGVk
IHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMsCi0g
KiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVk
LiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5n
IHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoKLSAqIFRo
ZSBPcmlnaW5hbCBDb2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIEluaXRpYWwg
RGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBDaHJpc3RvcGhlciBCbGl6emFy
ZC4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5
cmlnaHQgKEMpIDIwMDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNl
cnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIgQmxpenphcmQg
PGJsaXp6YXJkQG1vemlsbGEub3JnPgotICoKLSAqIEFsdGVybmF0aXZlbHksIHRoZSBjb250ZW50
cyBvZiB0aGlzIGZpbGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0gKiBlaXRoZXIg
dGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAodGhlICJH
UEwiKSwgb3IKLSAqIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lv
biAyLjEgb3IgbGF0ZXIgKHRoZSAiTEdQTCIpLAotICogaW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlz
aW9ucyBvZiB0aGUgR1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQKLSAqIG9m
IHRob3NlIGFib3ZlLiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJzaW9uIG9m
IHRoaXMgZmlsZSBvbmx5Ci0gKiB1bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBHUEwgb3Ig
dGhlIExHUEwsIGFuZCBub3QgdG8gYWxsb3cgb3RoZXJzIHRvCi0gKiB1c2UgeW91ciB2ZXJzaW9u
IG9mIHRoaXMgZmlsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUgeW91cgot
ICogZGVjaXNpb24gYnkgZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJlcGxhY2Ug
dGhlbSB3aXRoIHRoZSBub3RpY2UKLSAqIGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVpcmVkIGJ5
IHRoZSBHUEwgb3IgdGhlIExHUEwuIElmIHlvdSBkbyBub3QgZGVsZXRlCi0gKiB0aGUgcHJvdmlz
aW9ucyBhYm92ZSwgYSByZWNpcGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxl
IHVuZGVyCi0gKiB0aGUgdGVybXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BMIG9yIHRo
ZSBMR1BMLgotICoKLSAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCi0KLSNpZm5k
ZWYgX19FbWJlZFdpbmRvd19oCi0jZGVmaW5lIF9fRW1iZWRXaW5kb3dfaAotCi0jaW5jbHVkZSAi
bnNJV2ViQnJvd3NlckNocm9tZS5oIgotI2luY2x1ZGUgIm5zSVdlYkJyb3dzZXJDaHJvbWVGb2N1
cy5oIgotI2luY2x1ZGUgIm5zSUVtYmVkZGluZ1NpdGVXaW5kb3cuaCIKLSNpbmNsdWRlICJuc0lU
b29sdGlwTGlzdGVuZXIuaCIKLSNpbmNsdWRlICJuc0lTdXBwb3J0cy5oIgotI2luY2x1ZGUgIm5z
SVdlYkJyb3dzZXIuaCIKLSNpbmNsdWRlICJuc0lCYXNlV2luZG93LmgiCi0jaW5jbHVkZSAibnNJ
SW50ZXJmYWNlUmVxdWVzdG9yLmgiCi0jaW5jbHVkZSAibnNDT01QdHIuaCIKLSNpbmNsdWRlICJu
c1N0cmluZ0dsdWUuaCIKLQotI2luY2x1ZGUgPGd0ay9ndGsuaD4KLQotY2xhc3MgRW1iZWRQcml2
YXRlOwotCi1jbGFzcyBFbWJlZFdpbmRvdyA6IHB1YmxpYyBuc0lXZWJCcm93c2VyQ2hyb21lLAot
CQkgICAgcHVibGljIG5zSVdlYkJyb3dzZXJDaHJvbWVGb2N1cywKLSAgICAgICAgICAgICAgICAg
ICAgcHVibGljIG5zSUVtYmVkZGluZ1NpdGVXaW5kb3csCi0gICAgICAgICAgICAgICAgICAgIHB1
YmxpYyBuc0lUb29sdGlwTGlzdGVuZXIsCi0JCSAgICBwdWJsaWMgbnNJSW50ZXJmYWNlUmVxdWVz
dG9yCi17Ci0KLSBwdWJsaWM6Ci0KLSAgRW1iZWRXaW5kb3coKTsKLSAgdmlydHVhbCB+RW1iZWRX
aW5kb3coKTsKLQotICBuc3Jlc3VsdCBJbml0ICAgICAgICAgICAgKEVtYmVkUHJpdmF0ZSAqYU93
bmVyKTsKLSAgbnNyZXN1bHQgQ3JlYXRlV2luZG93ICAgICh2b2lkKTsKLSAgdm9pZCAgICAgUmVs
ZWFzZUNoaWxkcmVuICh2b2lkKTsKLQotICBOU19ERUNMX0lTVVBQT1JUUwotCi0gIE5TX0RFQ0xf
TlNJV0VCQlJPV1NFUkNIUk9NRQotCi0gIE5TX0RFQ0xfTlNJV0VCQlJPV1NFUkNIUk9NRUZPQ1VT
Ci0KLSAgTlNfREVDTF9OU0lFTUJFRERJTkdTSVRFV0lORE9XCi0KLSAgTlNfREVDTF9OU0lUT09M
VElQTElTVEVORVIKLQotICBOU19ERUNMX05TSUlOVEVSRkFDRVJFUVVFU1RPUgotCi0gIG5zU3Ry
aW5nICAgICAgICAgICAgICAgICBtVGl0bGU7Ci0gIG5zU3RyaW5nICAgICAgICAgICAgICAgICBt
SlNTdGF0dXM7Ci0gIG5zU3RyaW5nICAgICAgICAgICAgICAgICBtTGlua01lc3NhZ2U7Ci0KLSAg
bnNDT01QdHI8bnNJQmFzZVdpbmRvdz4gIG1CYXNlV2luZG93OyAvLyBbT1dORVJdCi0KLXByaXZh
dGU6Ci0KLSAgRW1iZWRQcml2YXRlICAgICAgICAgICAgKm1Pd25lcjsKLSAgbnNDT01QdHI8bnNJ
V2ViQnJvd3Nlcj4gIG1XZWJCcm93c2VyOyAvLyBbT1dORVJdCi0gIHN0YXRpYyBHdGtXaWRnZXQg
ICAgICAgICpzVGlwV2luZG93OwotICBQUkJvb2wgICAgICAgICAgICAgICAgICAgbVZpc2liaWxp
dHk7Ci0gIFBSQm9vbCAgICAgICAgICAgICAgICAgICBtSXNNb2RhbDsKLQotfTsKLSAgCi0KLSNl
bmRpZiAvKiBfX0VtYmVkV2luZG93X2ggKi8KZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9icm93c2Vy
L2d0ay9zcmMvRW1iZWRXaW5kb3dDcmVhdG9yLmNwcCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9z
cmMvRW1iZWRXaW5kb3dDcmVhdG9yLmNwcApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEv
ZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9FbWJlZFdpbmRvd0NyZWF0b3IuY3BwCisrKyAvZGV2
L251bGwKQEAgLTEsMTA2ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioq
KioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250
ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vu
c2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMg
ZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBv
YnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3Jn
L01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk
aXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBB
TlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBm
b3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25z
IHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3pp
bGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2lu
YWwgQ29kZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuIFBvcnRpb25zIGNyZWF0ZWQgYnkg
Q2hyaXN0b3BoZXIgQmxpenphcmQgYXJlIENvcHlyaWdodCAoQykgQ2hyaXN0b3BoZXIgQmxpenph
cmQuICBBbGwgUmlnaHRzIFJlc2VydmVkLgotICogUG9ydGlvbnMgY3JlYXRlZCBieSB0aGUgSW5p
dGlhbCBEZXZlbG9wZXIgYXJlIENvcHlyaWdodCAoQykgMjAwMQotICogdGhlIEluaXRpYWwgRGV2
ZWxvcGVyLiBBbGwgUmlnaHRzIFJlc2VydmVkLgotICoKLSAqIENvbnRyaWJ1dG9yKHMpOgotICog
ICBDaHJpc3RvcGhlciBCbGl6emFyZCA8YmxpenphcmRAbW96aWxsYS5vcmc+Ci0gKgotICogQWx0
ZXJuYXRpdmVseSwgdGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0
aGUgdGVybXMgb2YKLSAqIGVpdGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVy
c2lvbiAyIG9yIGxhdGVyICh0aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBp
biB3aGljaCBjYXNlIHRoZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFw
cGxpY2FibGUgaW5zdGVhZAotICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93
IHVzZSBvZiB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJt
cyBvZiBlaXRoZXIgdGhlIEdQTCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMg
dG8KLSAqIHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgTVBMLCBpbmRpY2F0ZSB5b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlz
aW9ucyBhYm92ZSBhbmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVy
IHByb3Zpc2lvbnMgcmVxdWlyZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5v
dCBkZWxldGUKLSAqIHRoZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlv
dXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9m
IHRoZSBNUEwsIHRoZSBHUEwgb3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0Ug
QkxPQ0sgKioqKiogKi8KLQotI2luY2x1ZGUgIkVtYmVkV2luZG93Q3JlYXRvci5oIgotI2luY2x1
ZGUgIkVtYmVkUHJpdmF0ZS5oIgotI2luY2x1ZGUgIkVtYmVkV2luZG93LmgiCi0KLS8vIGluIG9y
ZGVyIHRvIGNyZWF0ZSBvcnBoYW5lZCB3aW5kb3dzCi0jaW5jbHVkZSAiZ3RrbW96ZW1iZWRwcml2
YXRlLmgiCi0KLUVtYmVkV2luZG93Q3JlYXRvcjo6RW1iZWRXaW5kb3dDcmVhdG9yKHZvaWQpCi17
Ci19Ci0KLUVtYmVkV2luZG93Q3JlYXRvcjo6fkVtYmVkV2luZG93Q3JlYXRvcigpCi17Ci19Ci0K
LU5TX0lNUExfSVNVUFBPUlRTMShFbWJlZFdpbmRvd0NyZWF0b3IsIG5zSVdpbmRvd0NyZWF0b3Ip
Ci0KLU5TX0lNRVRIT0RJTVAKLUVtYmVkV2luZG93Q3JlYXRvcjo6Q3JlYXRlQ2hyb21lV2luZG93
KG5zSVdlYkJyb3dzZXJDaHJvbWUgKmFQYXJlbnQsCi0JCQkJICAgICAgIFBSVWludDMyIGFDaHJv
bWVGbGFncywKLQkJCQkgICAgICAgbnNJV2ViQnJvd3NlckNocm9tZSAqKl9yZXR2YWwpCi17Ci0g
IE5TX0VOU1VSRV9BUkdfUE9JTlRFUihfcmV0dmFsKTsKLQotICBHdGtNb3pFbWJlZCAqbmV3RW1i
ZWQgPSBuc251bGw7Ci0KLSAgLy8gTm8gcGFyZW50PyAgQXNrIHZpYSB0aGUgc2luZ2xldG9uIG9i
amVjdCBpbnN0ZWFkLgotICBpZiAoIWFQYXJlbnQpIHsKLSAgICBndGtfbW96X2VtYmVkX3Npbmds
ZV9jcmVhdGVfd2luZG93KCZuZXdFbWJlZCwKLQkJCQkgICAgICAgKGd1aW50KWFDaHJvbWVGbGFn
cyk7Ci0gIH0KLSAgZWxzZSB7Ci0gICAgLy8gRmluZCB0aGUgRW1iZWRQcml2YXRlIG9iamVjdCBm
b3IgdGhpcyB3ZWIgYnJvd3NlciBjaHJvbWUgb2JqZWN0LgotICAgIEVtYmVkUHJpdmF0ZSAqZW1i
ZWRQcml2YXRlID0gRW1iZWRQcml2YXRlOjpGaW5kUHJpdmF0ZUZvckJyb3dzZXIoYVBhcmVudCk7
Ci0gICAgCi0gICAgaWYgKCFlbWJlZFByaXZhdGUpCi0gICAgICByZXR1cm4gTlNfRVJST1JfRkFJ
TFVSRTsKLSAgICAKLSAgICBnX3NpZ25hbF9lbWl0KEdfT0JKRUNUKGVtYmVkUHJpdmF0ZS0+bU93
bmluZ1dpZGdldCksCi0gICAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2lnbmFsc1tORVdfV0lO
RE9XXSwgMCwKLSAgICAgICAgICAgICAgICAgICZuZXdFbWJlZCwgKGd1aW50KWFDaHJvbWVGbGFn
cyk7Ci0gICAgCi0gIH0KLQotICAvLyBjaGVjayB0byBtYWtlIHN1cmUgdGhhdCB3ZSBtYWRlIGEg
bmV3IHdpbmRvdwotICBpZiAoIW5ld0VtYmVkKQotICAgIHJldHVybiBOU19FUlJPUl9GQUlMVVJF
OwotCi0gIC8vIFRoZSB3aW5kb3cgX211c3RfIGJlIHJlYWxpemVkIGJlZm9yZSB3ZSBwYXNzIGl0
IGJhY2sgdG8gdGhlCi0gIC8vIGZ1bmN0aW9uIHRoYXQgY3JlYXRlZCBpdC4gRnVuY3Rpb25zIHRo
YXQgY3JlYXRlIG5ldyB3aW5kb3dzCi0gIC8vIHdpbGwgZG8gdGhpbmdzIGxpa2UgR2V0RG9jU2hl
bGwoKSBhbmQgdGhlIHdpZGdldCBoYXMgdG8gYmUKLSAgLy8gcmVhbGl6ZWQgYmVmb3JlIHRoYXQg
Y2FuIGhhcHBlbi4KLSAgZ3RrX3dpZGdldF9yZWFsaXplKEdUS19XSURHRVQobmV3RW1iZWQpKTsK
LSAgCi0gIEVtYmVkUHJpdmF0ZSAqbmV3RW1iZWRQcml2YXRlID0gc3RhdGljX2Nhc3Q8RW1iZWRQ
cml2YXRlICo+KG5ld0VtYmVkLT5kYXRhKTsKLQotICAvLyBzZXQgdGhlIGNocm9tZSBmbGFnIG9u
IHRoZSBuZXcgd2luZG93IGlmIGl0J3MgYSBjaHJvbWUgb3BlbgotICBpZiAoYUNocm9tZUZsYWdz
ICYgbnNJV2ViQnJvd3NlckNocm9tZTo6Q0hST01FX09QRU5BU19DSFJPTUUpCi0gICAgbmV3RW1i
ZWRQcml2YXRlLT5tSXNDaHJvbWUgPSBQUl9UUlVFOwotCi0gICpfcmV0dmFsID0gc3RhdGljX2Nh
c3Q8bnNJV2ViQnJvd3NlckNocm9tZSAqPihuZXdFbWJlZFByaXZhdGUtPm1XaW5kb3cpOwotICAK
LSAgaWYgKCpfcmV0dmFsKSB7Ci0gICAgTlNfQUREUkVGKCpfcmV0dmFsKTsKLSAgICByZXR1cm4g
TlNfT0s7Ci0gIH0KLQotICByZXR1cm4gTlNfRVJST1JfRkFJTFVSRTsKLX0KZGlmZiAtLWdpdCBh
L2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvRW1iZWRXaW5kb3dDcmVhdG9yLmggYi9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkV2luZG93Q3JlYXRvci5oCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0VtYmVkV2luZG93Q3JlYXRv
ci5oCisrKyAvZGV2L251bGwKQEAgLTEsNTQgKzAsMCBAQAotLyogKioqKiogQkVHSU4gTElDRU5T
RSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4wL0xHUEwgMi4xCi0gKgot
ICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0byB0aGUgTW96aWxsYSBQ
dWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5IG5v
dCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgKLSAqIHRoZSBMaWNlbnNl
LiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLSAqIGh0dHA6Ly93d3cu
bW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBM
aWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMsCi0gKiBXSVRIT1VUIFdB
UlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExp
Y2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHJpZ2h0cyBhbmQg
bGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoKLSAqIFRoZSBPcmlnaW5hbCBD
b2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9m
IHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBDaHJpc3RvcGhlciBCbGl6emFyZC4KLSAqIFBvcnRp
b25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIw
MDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0g
KiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIgQmxpenphcmQgPGJsaXp6YXJkQG1v
emlsbGEub3JnPgotICoKLSAqIEFsdGVybmF0aXZlbHksIHRoZSBjb250ZW50cyBvZiB0aGlzIGZp
bGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0gKiBlaXRoZXIgdGhlIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAodGhlICJHUEwiKSwgb3IKLSAq
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyLjEgb3IgbGF0
ZXIgKHRoZSAiTEdQTCIpLAotICogaW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlzaW9ucyBvZiB0aGUg
R1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQKLSAqIG9mIHRob3NlIGFib3Zl
LiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSBv
bmx5Ci0gKiB1bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBHUEwgb3IgdGhlIExHUEwsIGFu
ZCBub3QgdG8gYWxsb3cgb3RoZXJzIHRvCi0gKiB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmls
ZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUgeW91cgotICogZGVjaXNpb24g
YnkgZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJlcGxhY2UgdGhlbSB3aXRoIHRo
ZSBub3RpY2UKLSAqIGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVpcmVkIGJ5IHRoZSBHUEwgb3Ig
dGhlIExHUEwuIElmIHlvdSBkbyBub3QgZGVsZXRlCi0gKiB0aGUgcHJvdmlzaW9ucyBhYm92ZSwg
YSByZWNpcGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyCi0gKiB0
aGUgdGVybXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BMIG9yIHRoZSBMR1BMLgotICoK
LSAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCi0KLSNpZm5kZWYgX19FbWJlZFdp
bmRvd0NyZWF0b3JfaAotI2RlZmluZSBfX0VtYmVkV2luZG93Q3JlYXRvcl9oCi0KLSNpbmNsdWRl
IDxuc0lXaW5kb3dDcmVhdG9yLmg+Ci0KLWNsYXNzIEVtYmVkV2luZG93Q3JlYXRvciA6IHB1Ymxp
YyBuc0lXaW5kb3dDcmVhdG9yCi17Ci0gcHVibGljOgotICBFbWJlZFdpbmRvd0NyZWF0b3IoKTsK
LSAgdmlydHVhbCB+RW1iZWRXaW5kb3dDcmVhdG9yKCk7Ci0KLSAgTlNfREVDTF9JU1VQUE9SVFMK
LSAgTlNfREVDTF9OU0lXSU5ET1dDUkVBVE9SCi0gIAotfTsKLQotI2VuZGlmIC8qIF9fRW1iZWRX
aW5kb3dDcmVhdG9yX2ggKi8KZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMv
R3RrUHJvbXB0U2VydmljZS5jcHAgYi9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL0d0a1Byb21w
dFNlcnZpY2UuY3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJv
d3Nlci9ndGsvc3JjL0d0a1Byb21wdFNlcnZpY2UuY3BwCisrKyAvZGV2L251bGwKQEAgLTEsMzQ5
ICswLDAgQEAKLS8qIC0qLSBNb2RlOiBDKys7IHRhYi13aWR0aDogNDsgaW5kZW50LXRhYnMtbW9k
ZTogbmlsOyBjLWJhc2ljLW9mZnNldDogNCAtKi0gKi8KLS8qIHZpbTpleHBhbmR0YWI6c2hpZnR3
aWR0aD00OnRhYnN0b3A9NDogKi8KLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioK
LSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250ZW50
cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2Ug
VmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmls
ZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRh
aW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01Q
TC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0
cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkg
S0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBmb3Ig
dGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVu
ZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3ppbGxh
Lm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwg
Q29kZSBpcwotICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uCi0gKiBQb3J0
aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAy
MDAzCi0gKiB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgot
ICogQ29udHJpYnV0b3Iocyk6Ci0gKiAgQnJpYW4gUnluZXIgPGJyeW5lckBicmlhbnJ5bmVyLmNv
bT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBi
ZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUg
IkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0
aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91
IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICog
dW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRv
IGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0
aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNl
Ci0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BM
LiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBp
ZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1z
IG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioq
KiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5jbHVkZSAiR3RrUHJvbXB0U2Vydmlj
ZS5oIgotI2luY2x1ZGUgIkVtYmVkUHJvbXB0ZXIuaCIKLSNpbmNsdWRlICJuc1N0cmluZ0dsdWUu
aCIKLSNpbmNsdWRlICJuc0lXaW5kb3dXYXRjaGVyLmgiCi0jaW5jbHVkZSAibnNJV2ViQnJvd3Nl
ckNocm9tZS5oIgotI2luY2x1ZGUgIm5zSUVtYmVkZGluZ1NpdGVXaW5kb3cuaCIKLSNpbmNsdWRl
ICJuc0NPTVB0ci5oIgotI2luY2x1ZGUgIm5zSVNlcnZpY2VNYW5hZ2VyLmgiCi0jaW5jbHVkZSAi
bnNTZXJ2aWNlTWFuYWdlclV0aWxzLmgiCi0KLUd0a1Byb21wdFNlcnZpY2U6Okd0a1Byb21wdFNl
cnZpY2UoKQotewotfQotCi1HdGtQcm9tcHRTZXJ2aWNlOjp+R3RrUHJvbXB0U2VydmljZSgpCi17
Ci19Ci0KLU5TX0lNUExfSVNVUFBPUlRTMShHdGtQcm9tcHRTZXJ2aWNlLCBuc0lQcm9tcHRTZXJ2
aWNlKQotCi1OU19JTUVUSE9ESU1QCi1HdGtQcm9tcHRTZXJ2aWNlOjpBbGVydChuc0lET01XaW5k
b3cqIGFQYXJlbnQsIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RpdGxlLCAKLSAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RleHQpCi17Ci0gICAgRW1iZWRQ
cm9tcHRlciBwcm9tcHRlcjsKLSAgICBwcm9tcHRlci5TZXRUaXRsZShhRGlhbG9nVGl0bGUgPyBh
RGlhbG9nVGl0bGUgOiBOU19MSVRFUkFMX1NUUklORygiQWxlcnQiKS5nZXQoKSk7Ci0gICAgcHJv
bXB0ZXIuU2V0TWVzc2FnZVRleHQoYURpYWxvZ1RleHQpOwotICAgIHByb21wdGVyLkNyZWF0ZShF
bWJlZFByb21wdGVyOjpUWVBFX0FMRVJULCAKLSAgICAgICAgICAgICAgICAgICAgR2V0R3RrV2lu
ZG93Rm9yRE9NV2luZG93KGFQYXJlbnQpKTsKLSAgICBwcm9tcHRlci5SdW4oKTsKLSAgICByZXR1
cm4gTlNfT0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUd0a1Byb21wdFNlcnZpY2U6OkFsZXJ0Q2hl
Y2sobnNJRE9NV2luZG93KiBhUGFyZW50LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBQUlVuaWNoYXIqIGFEaWFsb2dUaXRsZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29uc3QgUFJVbmljaGFyKiBhRGlhbG9nVGV4dCwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3QgUFJVbmljaGFyKiBhQ2hlY2tNc2csIFBSQm9vbCogYUNoZWNrVmFsdWUpCi17
Ci0gICAgTlNfRU5TVVJFX0FSR19QT0lOVEVSKGFDaGVja1ZhbHVlKTsKLQotICAgIEVtYmVkUHJv
bXB0ZXIgcHJvbXB0ZXI7Ci0gICAgcHJvbXB0ZXIuU2V0VGl0bGUoYURpYWxvZ1RpdGxlID8gYURp
YWxvZ1RpdGxlIDogTlNfTElURVJBTF9TVFJJTkcoIkFsZXJ0IikuZ2V0KCkpOwotICAgIHByb21w
dGVyLlNldE1lc3NhZ2VUZXh0KGFEaWFsb2dUZXh0KTsKLSAgICBwcm9tcHRlci5TZXRDaGVja01l
c3NhZ2UoYUNoZWNrTXNnKTsKLSAgICBwcm9tcHRlci5TZXRDaGVja1ZhbHVlKCphQ2hlY2tWYWx1
ZSk7Ci0gICAgcHJvbXB0ZXIuQ3JlYXRlKEVtYmVkUHJvbXB0ZXI6OlRZUEVfQUxFUlRfQ0hFQ0ss
Ci0gICAgICAgICAgICAgICAgICAgIEdldEd0a1dpbmRvd0ZvckRPTVdpbmRvdyhhUGFyZW50KSk7
Ci0gICAgcHJvbXB0ZXIuUnVuKCk7Ci0gICAgcHJvbXB0ZXIuR2V0Q2hlY2tWYWx1ZShhQ2hlY2tW
YWx1ZSk7Ci0gICAgcmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1HdGtQcm9tcHRT
ZXJ2aWNlOjpDb25maXJtKG5zSURPTVdpbmRvdyogYVBhcmVudCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhRGlhbG9nVGl0bGUsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RleHQsIFBSQm9vbCogYUNvbmZpcm0p
Ci17Ci0gICAgRW1iZWRQcm9tcHRlciBwcm9tcHRlcjsKLSAgICBwcm9tcHRlci5TZXRUaXRsZShh
RGlhbG9nVGl0bGUgPyBhRGlhbG9nVGl0bGUgOiBOU19MSVRFUkFMX1NUUklORygiQ29uZmlybSIp
LmdldCgpKTsKLSAgICBwcm9tcHRlci5TZXRNZXNzYWdlVGV4dChhRGlhbG9nVGV4dCk7Ci0gICAg
cHJvbXB0ZXIuQ3JlYXRlKEVtYmVkUHJvbXB0ZXI6OlRZUEVfQ09ORklSTSwKLSAgICAgICAgICAg
ICAgICAgICAgR2V0R3RrV2luZG93Rm9yRE9NV2luZG93KGFQYXJlbnQpKTsKLSAgICBwcm9tcHRl
ci5SdW4oKTsKLSAgICBwcm9tcHRlci5HZXRDb25maXJtVmFsdWUoYUNvbmZpcm0pOwotICAgIHJl
dHVybiBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotR3RrUHJvbXB0U2VydmljZTo6Q29uZmly
bUNoZWNrKG5zSURPTVdpbmRvdyogYVBhcmVudCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBQUlVuaWNoYXIqIGFEaWFsb2dUaXRsZSwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBQUlVuaWNoYXIqIGFEaWFsb2dUZXh0LAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IFBSVW5pY2hhciogYUNoZWNrTXNnLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFBSQm9vbCogYUNoZWNrVmFsdWUsIFBSQm9vbCogYUNvbmZpcm0p
Ci17Ci0gICAgTlNfRU5TVVJFX0FSR19QT0lOVEVSKGFDaGVja1ZhbHVlKTsKLQotICAgIEVtYmVk
UHJvbXB0ZXIgcHJvbXB0ZXI7Ci0gICAgcHJvbXB0ZXIuU2V0VGl0bGUoYURpYWxvZ1RpdGxlID8g
YURpYWxvZ1RpdGxlIDogTlNfTElURVJBTF9TVFJJTkcoIkNvbmZpcm0iKS5nZXQoKSk7Ci0gICAg
cHJvbXB0ZXIuU2V0TWVzc2FnZVRleHQoYURpYWxvZ1RleHQpOwotICAgIHByb21wdGVyLlNldENo
ZWNrTWVzc2FnZShhQ2hlY2tNc2cpOwotICAgIHByb21wdGVyLlNldENoZWNrVmFsdWUoKmFDaGVj
a1ZhbHVlKTsKLSAgICBwcm9tcHRlci5DcmVhdGUoRW1iZWRQcm9tcHRlcjo6VFlQRV9DT05GSVJN
X0NIRUNLLAotICAgICAgICAgICAgICAgICAgICBHZXRHdGtXaW5kb3dGb3JET01XaW5kb3coYVBh
cmVudCkpOwotICAgIHByb21wdGVyLlJ1bigpOwotICAgIHByb21wdGVyLkdldENoZWNrVmFsdWUo
YUNoZWNrVmFsdWUpOwotICAgIHByb21wdGVyLkdldENvbmZpcm1WYWx1ZShhQ29uZmlybSk7Ci0g
ICAgcmV0dXJuIE5TX09LOwotfQotCi1OU19JTUVUSE9ESU1QCi1HdGtQcm9tcHRTZXJ2aWNlOjpD
b25maXJtRXgobnNJRE9NV2luZG93KiBhUGFyZW50LAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RpdGxlLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RleHQsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgUFJVaW50MzIgYUJ1dHRvbkZsYWdzLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNvbnN0IFBSVW5pY2hhciogYUJ1dHRvbjBUaXRsZSwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBQUlVuaWNoYXIqIGFCdXR0b24xVGl0bGUsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhQnV0dG9uMlRpdGxlLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IFBSVW5pY2hhciogYUNoZWNrTXNnLCBQUkJvb2wqIGFDaGVj
a1ZhbHVlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSW50MzIqIGFSZXRWYWwpCi17
Ci0gICAgRW1iZWRQcm9tcHRlciBwcm9tcHRlcjsKLSAgICBwcm9tcHRlci5TZXRUaXRsZShhRGlh
bG9nVGl0bGUgPyBhRGlhbG9nVGl0bGUgOiBOU19MSVRFUkFMX1NUUklORygiQ29uZmlybSIpLmdl
dCgpKTsKLSAgICBwcm9tcHRlci5TZXRNZXNzYWdlVGV4dChhRGlhbG9nVGV4dCk7Ci0KLSAgICBu
c0F1dG9TdHJpbmcgYnV0dG9uMExhYmVsLCBidXR0b24xTGFiZWwsIGJ1dHRvbjJMYWJlbDsKLSAg
ICBHZXRCdXR0b25MYWJlbChhQnV0dG9uRmxhZ3MsIEJVVFRPTl9QT1NfMCwgYUJ1dHRvbjBUaXRs
ZSwgYnV0dG9uMExhYmVsKTsKLSAgICBHZXRCdXR0b25MYWJlbChhQnV0dG9uRmxhZ3MsIEJVVFRP
Tl9QT1NfMSwgYUJ1dHRvbjFUaXRsZSwgYnV0dG9uMUxhYmVsKTsKLSAgICBHZXRCdXR0b25MYWJl
bChhQnV0dG9uRmxhZ3MsIEJVVFRPTl9QT1NfMiwgYUJ1dHRvbjJUaXRsZSwgYnV0dG9uMkxhYmVs
KTsKLSAgICBwcm9tcHRlci5TZXRCdXR0b25zKGJ1dHRvbjBMYWJlbC5nZXQoKSwgYnV0dG9uMUxh
YmVsLmdldCgpLAotICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uMkxhYmVsLmdldCgpKTsK
LQotICAgIGlmIChhQ2hlY2tNc2cpCi0gICAgICAgIHByb21wdGVyLlNldENoZWNrTWVzc2FnZShh
Q2hlY2tNc2cpOwotICAgIGlmIChhQ2hlY2tWYWx1ZSkKLSAgICAgICAgcHJvbXB0ZXIuU2V0Q2hl
Y2tWYWx1ZSgqYUNoZWNrVmFsdWUpOwotCi0gICAgcHJvbXB0ZXIuQ3JlYXRlKEVtYmVkUHJvbXB0
ZXI6OlRZUEVfVU5JVkVSU0FMLAotICAgICAgICAgICAgICAgICAgICBHZXRHdGtXaW5kb3dGb3JE
T01XaW5kb3coYVBhcmVudCkpOwotICAgIHByb21wdGVyLlJ1bigpOwotCi0gICAgaWYgKGFDaGVj
a1ZhbHVlKQotICAgICAgICBwcm9tcHRlci5HZXRDaGVja1ZhbHVlKGFDaGVja1ZhbHVlKTsKLQot
ICAgIHByb21wdGVyLkdldEJ1dHRvblByZXNzZWQoYVJldFZhbCk7Ci0KLSAgICByZXR1cm4gTlNf
T0s7Ci19Ci0KLU5TX0lNRVRIT0RJTVAKLUd0a1Byb21wdFNlcnZpY2U6OlByb21wdChuc0lET01X
aW5kb3cqIGFQYXJlbnQsIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RpdGxlLAotICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RleHQsIFBSVW5pY2hhcioq
IGFWYWx1ZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBQUlVuaWNoYXIqIGFDaGVj
a01zZywgUFJCb29sKiBhQ2hlY2tWYWx1ZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICBQUkJv
b2wqIGFDb25maXJtKQotewotICAgIEVtYmVkUHJvbXB0ZXIgcHJvbXB0ZXI7Ci0gICAgcHJvbXB0
ZXIuU2V0VGl0bGUoYURpYWxvZ1RpdGxlID8gYURpYWxvZ1RpdGxlIDogTlNfTElURVJBTF9TVFJJ
TkcoIlByb21wdCIpLmdldCgpKTsKLSAgICBwcm9tcHRlci5TZXRNZXNzYWdlVGV4dChhRGlhbG9n
VGV4dCk7Ci0gICAgcHJvbXB0ZXIuU2V0VGV4dFZhbHVlKCphVmFsdWUpOwotICAgIGlmIChhQ2hl
Y2tNc2cpCi0gICAgICAgIHByb21wdGVyLlNldENoZWNrTWVzc2FnZShhQ2hlY2tNc2cpOwotICAg
IGlmIChhQ2hlY2tWYWx1ZSkKLSAgICAgICAgcHJvbXB0ZXIuU2V0Q2hlY2tWYWx1ZSgqYUNoZWNr
VmFsdWUpOwotCi0gICAgcHJvbXB0ZXIuQ3JlYXRlKEVtYmVkUHJvbXB0ZXI6OlRZUEVfUFJPTVBU
LAotICAgICAgICAgICAgICAgICAgICBHZXRHdGtXaW5kb3dGb3JET01XaW5kb3coYVBhcmVudCkp
OwotICAgIHByb21wdGVyLlJ1bigpOwotICAgIGlmIChhQ2hlY2tWYWx1ZSkKLSAgICAgICAgcHJv
bXB0ZXIuR2V0Q2hlY2tWYWx1ZShhQ2hlY2tWYWx1ZSk7Ci0gICAgcHJvbXB0ZXIuR2V0Q29uZmly
bVZhbHVlKGFDb25maXJtKTsKLSAgICBpZiAoKmFDb25maXJtKSB7Ci0gICAgICAgIGlmICgqYVZh
bHVlKQotICAgICAgICAgICAgTlNfRnJlZSgqYVZhbHVlKTsKLSAgICAgICAgcHJvbXB0ZXIuR2V0
VGV4dFZhbHVlKGFWYWx1ZSk7Ci0gICAgfQotICAgIHJldHVybiBOU19PSzsKLX0KLQotTlNfSU1F
VEhPRElNUAotR3RrUHJvbXB0U2VydmljZTo6UHJvbXB0VXNlcm5hbWVBbmRQYXNzd29yZChuc0lE
T01XaW5kb3cqIGFQYXJlbnQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IFBSVW5pY2hhciogYURpYWxvZ1RpdGxlLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBQUlVuaWNoYXIqIGFEaWFsb2dUZXh0LAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUlVuaWNoYXIqKiBh
VXNlcm5hbWUsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBS
VW5pY2hhcioqIGFQYXNzd29yZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhQ2hlY2tNc2csCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFBSQm9vbCogYUNoZWNrVmFsdWUsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSQm9vbCogYUNvbmZpcm0pCi17Ci0g
ICAgRW1iZWRQcm9tcHRlciBwcm9tcHRlcjsKLSAgICBwcm9tcHRlci5TZXRUaXRsZShhRGlhbG9n
VGl0bGUgPyBhRGlhbG9nVGl0bGUgOiBOU19MSVRFUkFMX1NUUklORygiUHJvbXB0IikuZ2V0KCkp
OwotICAgIHByb21wdGVyLlNldE1lc3NhZ2VUZXh0KGFEaWFsb2dUZXh0KTsKLSAgICBwcm9tcHRl
ci5TZXRVc2VyKCphVXNlcm5hbWUpOwotICAgIHByb21wdGVyLlNldFBhc3N3b3JkKCphUGFzc3dv
cmQpOwotICAgIGlmIChhQ2hlY2tNc2cpCi0gICAgICAgIHByb21wdGVyLlNldENoZWNrTWVzc2Fn
ZShhQ2hlY2tNc2cpOwotICAgIGlmIChhQ2hlY2tWYWx1ZSkKLSAgICAgICAgcHJvbXB0ZXIuU2V0
Q2hlY2tWYWx1ZSgqYUNoZWNrVmFsdWUpOwotCi0gICAgcHJvbXB0ZXIuQ3JlYXRlKEVtYmVkUHJv
bXB0ZXI6OlRZUEVfUFJPTVBUX1VTRVJfUEFTUywKLSAgICAgICAgICAgICAgICAgICAgR2V0R3Rr
V2luZG93Rm9yRE9NV2luZG93KGFQYXJlbnQpKTsKLSAgICBwcm9tcHRlci5SdW4oKTsKLSAgICBp
ZiAoYUNoZWNrVmFsdWUpCi0gICAgICAgIHByb21wdGVyLkdldENoZWNrVmFsdWUoYUNoZWNrVmFs
dWUpOwotICAgIHByb21wdGVyLkdldENvbmZpcm1WYWx1ZShhQ29uZmlybSk7Ci0gICAgaWYgKCph
Q29uZmlybSkgewotICAgICAgICBpZiAoKmFVc2VybmFtZSkKLSAgICAgICAgICAgIE5TX0ZyZWUo
KmFVc2VybmFtZSk7Ci0gICAgICAgIHByb21wdGVyLkdldFVzZXIoYVVzZXJuYW1lKTsKLQotICAg
ICAgICBpZiAoKmFQYXNzd29yZCkKLSAgICAgICAgICAgIE5TX0ZyZWUoKmFQYXNzd29yZCk7Ci0g
ICAgICAgIHByb21wdGVyLkdldFBhc3N3b3JkKGFQYXNzd29yZCk7Ci0gICAgfQotICAgIHJldHVy
biBOU19PSzsKLX0KLQotTlNfSU1FVEhPRElNUAotR3RrUHJvbXB0U2VydmljZTo6UHJvbXB0UGFz
c3dvcmQobnNJRE9NV2luZG93KiBhUGFyZW50LAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3QgUFJVbmljaGFyKiBhRGlhbG9nVGl0bGUsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBQUlVuaWNoYXIqIGFEaWFsb2dUZXh0LAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgUFJVbmljaGFyKiogYVBhc3N3b3JkLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhQ2hlY2tNc2csCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBQUkJvb2wqIGFDaGVja1ZhbHVlLCBQUkJvb2wqIGFD
b25maXJtKQotewotICAgIEVtYmVkUHJvbXB0ZXIgcHJvbXB0ZXI7Ci0gICAgcHJvbXB0ZXIuU2V0
VGl0bGUoYURpYWxvZ1RpdGxlID8gYURpYWxvZ1RpdGxlIDogTlNfTElURVJBTF9TVFJJTkcoIlBy
b21wdCIpLmdldCgpKTsKLSAgICBwcm9tcHRlci5TZXRNZXNzYWdlVGV4dChhRGlhbG9nVGV4dCk7
Ci0gICAgcHJvbXB0ZXIuU2V0UGFzc3dvcmQoKmFQYXNzd29yZCk7Ci0gICAgaWYgKGFDaGVja01z
ZykKLSAgICAgICAgcHJvbXB0ZXIuU2V0Q2hlY2tNZXNzYWdlKGFDaGVja01zZyk7Ci0gICAgaWYg
KGFDaGVja1ZhbHVlKQotICAgICAgICBwcm9tcHRlci5TZXRDaGVja1ZhbHVlKCphQ2hlY2tWYWx1
ZSk7Ci0KLSAgICBwcm9tcHRlci5DcmVhdGUoRW1iZWRQcm9tcHRlcjo6VFlQRV9QUk9NUFRfUEFT
UywKLSAgICAgICAgICAgICAgICAgICAgR2V0R3RrV2luZG93Rm9yRE9NV2luZG93KGFQYXJlbnQp
KTsKLSAgICBwcm9tcHRlci5SdW4oKTsKLSAgICBpZiAoYUNoZWNrVmFsdWUpCi0gICAgICAgIHBy
b21wdGVyLkdldENoZWNrVmFsdWUoYUNoZWNrVmFsdWUpOwotICAgIHByb21wdGVyLkdldENvbmZp
cm1WYWx1ZShhQ29uZmlybSk7Ci0gICAgaWYgKCphQ29uZmlybSkgewotICAgICAgICBpZiAoKmFQ
YXNzd29yZCkKLSAgICAgICAgICAgIE5TX0ZyZWUoKmFQYXNzd29yZCk7Ci0gICAgICAgIHByb21w
dGVyLkdldFBhc3N3b3JkKGFQYXNzd29yZCk7Ci0gICAgfQotICAgIHJldHVybiBOU19PSzsKLX0K
LQotTlNfSU1FVEhPRElNUAotR3RrUHJvbXB0U2VydmljZTo6U2VsZWN0KG5zSURPTVdpbmRvdyog
YVBhcmVudCwgY29uc3QgUFJVbmljaGFyKiBhRGlhbG9nVGl0bGUsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhRGlhbG9nVGV4dCwgUFJVaW50MzIgYUNvdW50LAot
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFBSVW5pY2hhcioqIGFTZWxlY3RMaXN0LCBQ
UkludDMyKiBvdXRTZWxlY3Rpb24sCi0gICAgICAgICAgICAgICAgICAgICAgICAgUFJCb29sKiBh
Q29uZmlybSkKLXsKLSAgICBFbWJlZFByb21wdGVyIHByb21wdGVyOwotICAgIHByb21wdGVyLlNl
dFRpdGxlKGFEaWFsb2dUaXRsZSA/IGFEaWFsb2dUaXRsZSA6IE5TX0xJVEVSQUxfU1RSSU5HKCJT
ZWxlY3QiKS5nZXQoKSk7Ci0gICAgcHJvbXB0ZXIuU2V0TWVzc2FnZVRleHQoYURpYWxvZ1RleHQp
OwotICAgIHByb21wdGVyLlNldEl0ZW1zKGFTZWxlY3RMaXN0LCBhQ291bnQpOwotICAgIHByb21w
dGVyLkNyZWF0ZShFbWJlZFByb21wdGVyOjpUWVBFX1NFTEVDVCwKLSAgICAgICAgICAgICAgICAg
ICAgR2V0R3RrV2luZG93Rm9yRE9NV2luZG93KGFQYXJlbnQpKTsKLSAgICBwcm9tcHRlci5SdW4o
KTsKLSAgICBwcm9tcHRlci5HZXRTZWxlY3RlZEl0ZW0ob3V0U2VsZWN0aW9uKTsKLSAgICBwcm9t
cHRlci5HZXRDb25maXJtVmFsdWUoYUNvbmZpcm0pOwotICAgIHJldHVybiBOU19PSzsKLX0KLQot
R3RrV2luZG93KgotR3RrUHJvbXB0U2VydmljZTo6R2V0R3RrV2luZG93Rm9yRE9NV2luZG93KG5z
SURPTVdpbmRvdyogYURPTVdpbmRvdykKLXsKLSAgICBuc0NPTVB0cjxuc0lXaW5kb3dXYXRjaGVy
PiB3d2F0Y2ggPSBkb19HZXRTZXJ2aWNlKCJAbW96aWxsYS5vcmcvZW1iZWRjb21wL3dpbmRvdy13
YXRjaGVyOzEiKTsKLQotICAgIGlmICghYURPTVdpbmRvdykKLSAgICAgICAgcmV0dXJuIE5VTEw7
Ci0KLSAgICBuc0NPTVB0cjxuc0lXZWJCcm93c2VyQ2hyb21lPiBjaHJvbWU7Ci0gICAgd3dhdGNo
LT5HZXRDaHJvbWVGb3JXaW5kb3coYURPTVdpbmRvdywgZ2V0dGVyX0FkZFJlZnMoY2hyb21lKSk7
Ci0gICAgbnNDT01QdHI8bnNJRW1iZWRkaW5nU2l0ZVdpbmRvdz4gc2l0ZVdpbmRvdyA9IGRvX1F1
ZXJ5SW50ZXJmYWNlKGNocm9tZSk7Ci0KLSAgICBpZiAoIXNpdGVXaW5kb3cpCi0gICAgICAgIHJl
dHVybiBOVUxMOwotCi0gICAgR3RrV2lkZ2V0KiBwYXJlbnRXaWRnZXQ7Ci0gICAgc2l0ZVdpbmRv
dy0+R2V0U2l0ZVdpbmRvdygodm9pZCoqKSZwYXJlbnRXaWRnZXQpOwotCi0gICAgaWYgKCFwYXJl
bnRXaWRnZXQpCi0gICAgICAgIHJldHVybiBOVUxMOwotCi0gICAgR3RrV2lkZ2V0KiBndGtXaW4g
PSBndGtfd2lkZ2V0X2dldF90b3BsZXZlbChwYXJlbnRXaWRnZXQpOwotICAgIGlmIChHVEtfV0lE
R0VUX1RPUExFVkVMKGd0a1dpbikpCi0gICAgICAgIHJldHVybiBHVEtfV0lORE9XKGd0a1dpbik7
Ci0KLSAgICByZXR1cm4gTlVMTDsKLX0KLQotdm9pZAotR3RrUHJvbXB0U2VydmljZTo6R2V0QnV0
dG9uTGFiZWwoUFJVaW50MzIgYUZsYWdzLCBQUlVpbnQzMiBhUG9zLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgUFJVbmljaGFyKiBhU3RyaW5nVmFsdWUsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBuc0FTdHJpbmcmIGFMYWJlbCkKLXsKLSAgICBQUlVp
bnQzMiBwb3NGbGFnID0gKGFGbGFncyAmICgyNTUgKiBhUG9zKSkgLyBhUG9zOwotICAgIHN3aXRj
aCAocG9zRmxhZykgewotICAgIGNhc2UgMDoKLSAgICAgICAgYnJlYWs7Ci0gICAgY2FzZSBCVVRU
T05fVElUTEVfT0s6Ci0gICAgICAgIGFMYWJlbC5Bc3NpZ25MaXRlcmFsKEdUS19TVE9DS19PSyk7
Ci0gICAgICAgIGJyZWFrOwotICAgIGNhc2UgQlVUVE9OX1RJVExFX0NBTkNFTDoKLSAgICAgICAg
YUxhYmVsLkFzc2lnbkxpdGVyYWwoR1RLX1NUT0NLX0NBTkNFTCk7Ci0gICAgICAgIGJyZWFrOwot
ICAgIGNhc2UgQlVUVE9OX1RJVExFX1lFUzoKLSAgICAgICAgYUxhYmVsLkFzc2lnbkxpdGVyYWwo
R1RLX1NUT0NLX1lFUyk7Ci0gICAgICAgIGJyZWFrOwotICAgIGNhc2UgQlVUVE9OX1RJVExFX05P
OgotICAgICAgICBhTGFiZWwuQXNzaWduTGl0ZXJhbChHVEtfU1RPQ0tfTk8pOwotICAgICAgICBi
cmVhazsKLSAgICBjYXNlIEJVVFRPTl9USVRMRV9TQVZFOgotICAgICAgICBhTGFiZWwuQXNzaWdu
TGl0ZXJhbChHVEtfU1RPQ0tfU0FWRSk7Ci0gICAgICAgIGJyZWFrOwotICAgIGNhc2UgQlVUVE9O
X1RJVExFX0RPTlRfU0FWRToKLSAgICAgICAgYUxhYmVsLkFzc2lnbkxpdGVyYWwoIkRvbid0IFNh
dmUiKTsKLSAgICAgICAgYnJlYWs7Ci0gICAgY2FzZSBCVVRUT05fVElUTEVfUkVWRVJUOgotICAg
ICAgICBhTGFiZWwuQXNzaWduTGl0ZXJhbCgiUmV2ZXJ0Iik7Ci0gICAgICAgIGJyZWFrOwotICAg
IGNhc2UgQlVUVE9OX1RJVExFX0lTX1NUUklORzoKLSAgICAgICAgYUxhYmVsID0gYVN0cmluZ1Zh
bHVlOwotICAgICAgICBicmVhazsKLSAgICBkZWZhdWx0OgotICAgICAgICBOU19XQVJOSU5HKCJV
bmV4cGVjdGVkIGJ1dHRvbiBmbGFncyIpOwotICAgIH0KLX0KZGlmZiAtLWdpdCBhL2VtYmVkZGlu
Zy9icm93c2VyL2d0ay9zcmMvR3RrUHJvbXB0U2VydmljZS5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIv
Z3RrL3NyYy9HdGtQcm9tcHRTZXJ2aWNlLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Ci0tLSBh
L2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvR3RrUHJvbXB0U2VydmljZS5oCisrKyAvZGV2L251
bGwKQEAgLTEsNTkgKzAsMCBAQAotLyogLSotIE1vZGU6IEMrKzsgdGFiLXdpZHRoOiA0OyBpbmRl
bnQtdGFicy1tb2RlOiBuaWw7IGMtYmFzaWMtb2Zmc2V0OiA0IC0qLSAqLwotLyogdmltOmV4cGFu
ZHRhYjpzaGlmdHdpZHRoPTQ6dGFic3RvcD00OiAqLwotLyogKioqKiogQkVHSU4gTElDRU5TRSBC
TE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4wL0xHUEwgMi4xCi0gKgotICog
VGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0byB0aGUgTW96aWxsYSBQdWJs
aWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1
c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgKLSAqIHRoZSBMaWNlbnNlLiBZ
b3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLSAqIGh0dHA6Ly93d3cubW96
aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNl
bnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMsCi0gKiBXSVRIT1VUIFdBUlJB
TlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vu
c2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHJpZ2h0cyBhbmQgbGlt
aXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoKLSAqIFRoZSBPcmlnaW5hbCBDb2Rl
IGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRo
ZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlv
bi4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5
cmlnaHQgKEMpIDIwMDMKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNl
cnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICBCcmlhbiBSeW5lciA8YnJ5bmVyQGJy
aWFucnluZXIuY29tPgotICoKLSAqIEFsdGVybmF0aXZlbHksIHRoZSBjb250ZW50cyBvZiB0aGlz
IGZpbGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0gKiBlaXRoZXIgdGhlIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAodGhlICJHUEwiKSwgb3IK
LSAqIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyLjEgb3Ig
bGF0ZXIgKHRoZSAiTEdQTCIpLAotICogaW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlzaW9ucyBvZiB0
aGUgR1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQKLSAqIG9mIHRob3NlIGFi
b3ZlLiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmls
ZSBvbmx5Ci0gKiB1bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBHUEwgb3IgdGhlIExHUEws
IGFuZCBub3QgdG8gYWxsb3cgb3RoZXJzIHRvCi0gKiB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMg
ZmlsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUgeW91cgotICogZGVjaXNp
b24gYnkgZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJlcGxhY2UgdGhlbSB3aXRo
IHRoZSBub3RpY2UKLSAqIGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVpcmVkIGJ5IHRoZSBHUEwg
b3IgdGhlIExHUEwuIElmIHlvdSBkbyBub3QgZGVsZXRlCi0gKiB0aGUgcHJvdmlzaW9ucyBhYm92
ZSwgYSByZWNpcGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyCi0g
KiB0aGUgdGVybXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BMIG9yIHRoZSBMR1BMLgot
ICoKLSAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCi0KLSNpbmNsdWRlICJuc0lQ
cm9tcHRTZXJ2aWNlLmgiCi0jaW5jbHVkZSAibnNTdHJpbmdHbHVlLmgiCi0jaW5jbHVkZSA8Z3Rr
L2d0ay5oPgotCi1jbGFzcyBuc0lET01XaW5kb3c7Ci0KLWNsYXNzIEd0a1Byb21wdFNlcnZpY2Ug
OiBwdWJsaWMgbnNJUHJvbXB0U2VydmljZQotewotcHVibGljOgotICAgIEd0a1Byb21wdFNlcnZp
Y2UoKTsKLSAgICB2aXJ0dWFsIH5HdGtQcm9tcHRTZXJ2aWNlKCk7Ci0KLSAgICBOU19ERUNMX0lT
VVBQT1JUUwotICAgIE5TX0RFQ0xfTlNJUFJPTVBUU0VSVklDRQotCi1wcml2YXRlOgotICAgIEd0
a1dpbmRvdyogR2V0R3RrV2luZG93Rm9yRE9NV2luZG93KG5zSURPTVdpbmRvdyogYURPTVdpbmRv
dyk7Ci0gICAgdm9pZCBHZXRCdXR0b25MYWJlbChQUlVpbnQzMiBhRmxhZ3MsIFBSVWludDMyIGFQ
b3MsCi0gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBQUlVuaWNoYXIqIGFTdHJpbmdWYWx1
ZSwgbnNBU3RyaW5nICZhTGFiZWwpOwotfTsKZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9icm93c2Vy
L2d0ay9zcmMvTWFrZWZpbGUuaW4gYi9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL01ha2VmaWxl
LmluCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsv
c3JjL01ha2VmaWxlLmluCisrKyAvZGV2L251bGwKQEAgLTEsMTEyICswLDAgQEAKLSMgCi0jICoq
KioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKLSMgVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4w
L0xHUEwgMi4xCi0jCi0jIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8g
dGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbgotIyAxLjEgKHRoZSAiTGljZW5zZSIp
OyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgKLSMg
dGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAotIyBo
dHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8KLSMKLSMgU29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5k
ZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNpcywKLSMgV0lU
SE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2Vl
IHRoZSBMaWNlbnNlCi0jIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHJpZ2h0
cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0jIExpY2Vuc2UuCi0jCi0jIFRoZSBPcmlnaW5h
bCBDb2RlIGlzIHRoZSBNb3ppbGxhIGJyb3dzZXIuCi0jCi0jIFRoZSBJbml0aWFsIERldmVsb3Bl
ciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBpcwotIyBDaHJpc3RvcGhlciBCbGl6emFyZC4KLSMgUG9y
dGlvbnMgY3JlYXRlZCBieSB0aGUgSW5pdGlhbCBEZXZlbG9wZXIgYXJlIENvcHlyaWdodCAoQykg
MTk5OQotIyB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0jCi0j
IENvbnRyaWJ1dG9yKHMpOgotIyAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3pp
bGxhLm9yZz4KLSMKLSMgQWx0ZXJuYXRpdmVseSwgdGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBt
YXkgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMgb2YKLSMgZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0jIHRoZSBH
TlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyLjEgb3IgbGF0ZXIgKHRo
ZSAiTEdQTCIpLAotIyBpbiB3aGljaCBjYXNlIHRoZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3Ig
dGhlIExHUEwgYXJlIGFwcGxpY2FibGUgaW5zdGVhZAotIyBvZiB0aG9zZSBhYm92ZS4gSWYgeW91
IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotIyB1
bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBHUEwgb3IgdGhlIExHUEwsIGFuZCBub3QgdG8g
YWxsb3cgb3RoZXJzIHRvCi0jIHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRo
ZSB0ZXJtcyBvZiB0aGUgTVBMLCBpbmRpY2F0ZSB5b3VyCi0jIGRlY2lzaW9uIGJ5IGRlbGV0aW5n
IHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0j
IGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVpcmVkIGJ5IHRoZSBHUEwgb3IgdGhlIExHUEwuIElm
IHlvdSBkbyBub3QgZGVsZXRlCi0jIHRoZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBt
YXkgdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIKLSMgdGhlIHRlcm1zIG9mIGFu
eSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSMKLSMgKioqKiogRU5EIExJ
Q0VOU0UgQkxPQ0sgKioqKioKLQotREVQVEgJCT0gLi4vLi4vLi4vLi4KLXRvcHNyY2Rpcgk9IEB0
b3Bfc3JjZGlyQAotc3JjZGlyCQk9IEBzcmNkaXJACi1WUEFUSAkJPSBAc3JjZGlyQAotCi1pbmNs
dWRlICQoREVQVEgpL2NvbmZpZy9hdXRvY29uZi5tawotCi1NT0RVTEUJCT0gZ3RrZW1iZWRtb3oK
LUxJQlJBUllfTkFNRQk9IGd0a2VtYmVkbW96Ci1MSUJYVUxfTElCUkFSWQk9IDEKLUZPUkNFX1NU
QVRJQ19MSUIgPSAxCi1ERUZJTkVTICs9IC1ESU1QTF9YUkVBUEkKLQotCi0KLUNQUFNSQ1MJCT0g
XAotCQlndGttb3plbWJlZDIuY3BwIFwKLQkJRW1iZWRQcml2YXRlLmNwcCBcCi0JCUVtYmVkV2lu
ZG93LmNwcCBcCi0JCUVtYmVkUHJvZ3Jlc3MuY3BwIFwKLQkJRW1iZWRDb250ZW50TGlzdGVuZXIu
Y3BwIFwKLQkJRW1iZWRFdmVudExpc3RlbmVyLmNwcCBcCi0JCUVtYmVkV2luZG93Q3JlYXRvci5j
cHAgXAotCQkkKE5VTEwpCi0KLWlmZGVmIE1PWl9FTkFCTEVfR1RLMgotQ1NSQ1MgICAgICAgICAg
ID0gXAotCQlndGttb3plbWJlZG1hcnNoYWwuYwotQ1BQU1JDUyAgICAgICAgICs9IFwKLQkJRW1i
ZWRQcm9tcHRlci5jcHAgXAotCQlHdGtQcm9tcHRTZXJ2aWNlLmNwcAotZW5kaWYKLQotTE9DQUxf
SU5DTFVERVMgKz0gXAotCQkgIC1JLiBcCi0JCSAgJChOVUxMKQotCi1pbmNsdWRlICQodG9wc3Jj
ZGlyKS9jb25maWcvY29uZmlnLm1rCi0KLUVYUE9SVFMJCT0gXAotCQlndGttb3plbWJlZC5oIFwK
LQkJZ3RrbW96ZW1iZWRfZ2x1ZS5jcHAgXAotCQlndGttb3plbWJlZF9pbnRlcm5hbC5oCi0KLWlu
Y2x1ZGUgJCh0b3BzcmNkaXIpL2NvbmZpZy9ydWxlcy5tawotCi1pZmVxICgkKE9TX0FSQ0gpLCBT
dW5PUykKLWlmbmRlZiBHTlVfQ0MKLSMgV2hlbiB1c2luZyBTdW4ncyBXb3JrU2hvcCBjb21waWxl
ciwgaW5jbHVkaW5nCi0jIC93aGVyZXZlci93b3Jrc2hvcC01LjAvU0M1LjAvaW5jbHVkZS9DQy9z
dGQvdGltZS5oCi0jIGNhdXNlcyBtb3N0IG9mIHRoZXNlIGNvbXBpbGVzIHRvIGZhaWwgd2l0aDoK
LSMgbGluZSAyOTogRXJyb3I6IE11bHRpcGxlIGRlY2xhcmF0aW9uIGZvciBzdGQ6OnRtLgotIyBT
bywgdGhpcyBnZXRzIGFyb3VuZCB0aGUgcHJvYmxlbS4KLURFRklORVMgICAgICAgICArPSAtRF9U
SU1FX0g9MQotZW5kaWYKLWVuZGlmCi0KLUNYWEZMQUdTICAgICAgICArPSAkKE1PWl9HVEtfQ0ZM
QUdTKSAkKE1PWl9HVEsyX0NGTEFHUykKLUNGTEFHUyAgICAgICAgICArPSAkKE1PWl9HVEtfQ0ZM
QUdTKSAkKE1PWl9HVEsyX0NGTEFHUykKLURFRklORVMgICAgICAgICArPSAtRF9JTVBMX0dUS01P
WkVNQkVECi0KLU1BUlNIQUxfRklMRSA9IGd0a21vemVtYmVkbWFyc2hhbAotTUFSU0hBTF9QUkVG
SVggPSBndGttb3plbWJlZAotCi0kKE1BUlNIQUxfRklMRSkuaDogJChNQVJTSEFMX0ZJTEUpLmxp
c3QKLQlnbGliLWdlbm1hcnNoYWwgLS1wcmVmaXg9JChNQVJTSEFMX1BSRUZJWCkgJChzcmNkaXIp
LyQoTUFSU0hBTF9GSUxFKS5saXN0IC0tc2tpcC1zb3VyY2UgLS1oZWFkZXIgPiAkQAotCi0kKE1B
UlNIQUxfRklMRSkuYzogJChNQVJTSEFMX0ZJTEUpLmxpc3QgJChNQVJTSEFMX0ZJTEUpLmgKLQln
bGliLWdlbm1hcnNoYWwgLS1wcmVmaXg9JChNQVJTSEFMX1BSRUZJWCkgJChzcmNkaXIpLyQoTUFS
U0hBTF9GSUxFKS5saXN0IC0tc2tpcC1zb3VyY2UgLS1ib2R5ID4gJEAKLQotZ3RrbW96ZW1iZWQy
LiQoT0JKX1NVRkZJWCk6ICQoTUFSU0hBTF9GSUxFKS5oCi0KLUdBUkJBR0UgKz0gJChNQVJTSEFM
X0ZJTEUpLmggJChNQVJTSEFMX0ZJTEUpLmMKLQpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dz
ZXIvZ3RrL3NyYy9ndGttb3plbWJlZC5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9ndGtt
b3plbWJlZC5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nl
ci9ndGsvc3JjL2d0a21vemVtYmVkLmgKKysrIC9kZXYvbnVsbApAQCAtMSwyODcgKzAsMCBAQAot
LyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9H
UEwgMi4wL0xHUEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3Vi
amVjdCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAi
TGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNl
IHdpdGgKLSAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vu
c2UgYXQKLSAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRp
c3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIg
YmFzaXMsCi0gKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBv
ciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2Ug
Z292ZXJuaW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgot
ICoKLSAqIFRoZSBPcmlnaW5hbCBDb2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhl
IEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBDaHJpc3RvcGhl
ciBCbGl6emFyZC4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVy
IGFyZSBDb3B5cmlnaHQgKEMpIDIwMDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJp
Z2h0cyBSZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIg
QmxpenphcmQgPGJsaXp6YXJkQG1vemlsbGEub3JnPgotICogICBSYW1pcm8gRXN0cnVnbyA8cmFt
aXJvQGVhemVsLmNvbT4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhp
cyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUg
R2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9y
Ci0gKiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9y
IGxhdGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2Yg
dGhlIEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBh
Ym92ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZp
bGUgb25seQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BM
LCBhbmQgbm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlz
IGZpbGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lz
aW9uIGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0
aCB0aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BM
IG9yIHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJv
dmUsIGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgot
ICogdGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4K
LSAqCi0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaWZuZGVmIGd0a21v
emVtYmVkX2gKLSNkZWZpbmUgZ3RrbW96ZW1iZWRfaAotCi0jaW5jbHVkZSA8c3RkZGVmLmg+Ci0j
aW5jbHVkZSA8Z3RrL2d0ay5oPgotCi0jaWZkZWYgTU9aSUxMQV9DTElFTlQKLSNpbmNsdWRlICJu
c2NvcmUuaCIKLSNlbHNlIC8qIE1PWklMTEFfQ0xJRU5UICovCi0jaWZuZGVmIG5zY29yZV9oX18K
LS8qIEJlY2F1c2UgdGhpcyBoZWFkZXIgbWF5IGJlIGluY2x1ZGVkIGZyb20gZmlsZXMgd2hpY2gg
bm90IHBhcnQgb2YgdGhlIG1vemlsbGEKLSAgIGJ1aWxkIHN5c3RlbSwgZGVmaW5lIG1hY3JvcyBm
cm9tIG5zY29yZS5oICovCi0KLSNpZiAoX19HTlVDX18gPj0gNCkgfHwgKF9fR05VQ19fID09IDMg
JiYgX19HTlVDX01JTk9SX18gPj0gMykKLSNkZWZpbmUgTlNfSElEREVOIF9fYXR0cmlidXRlX18o
KHZpc2liaWxpdHkoImhpZGRlbiIpKSkKLSNlbHNlCi0jZGVmaW5lIE5TX0hJRERFTgotI2VuZGlm
Ci0KLSNkZWZpbmUgTlNfRlJPWkVOQ0FMTAotI2RlZmluZSBOU19FWFBPUlRfKHR5cGUpIHR5cGUK
LSNkZWZpbmUgTlNfSU1QT1JUXyh0eXBlKSB0eXBlCi0jZW5kaWYgLyogbnNjb3JlX2hfXyAqLwot
I2VuZGlmIC8qIE1PWklMTEFfQ0xJRU5UICovCi0KLSNpZmRlZiBYUENPTV9HTFVFCi0KLSNkZWZp
bmUgR1RLTU9aRU1CRURfQVBJKHR5cGUsIG5hbWUsIHBhcmFtcykgXAotICB0eXBlZGVmIHR5cGUg
KE5TX0ZST1pFTkNBTEwgKiBuYW1lIyNUeXBlKSBwYXJhbXM7IFwKLSAgZXh0ZXJuIG5hbWUjI1R5
cGUgbmFtZSBOU19ISURERU47Ci0KLSNlbHNlIC8qIFhQQ09NX0dMVUUgKi8KLQotI2lmZGVmIF9J
TVBMX0dUS01PWkVNQkVECi0jZGVmaW5lIEdUS01PWkVNQkVEX0FQSSh0eXBlLCBuYW1lLCBwYXJh
bXMpIE5TX0VYUE9SVF8odHlwZSkgbmFtZSBwYXJhbXM7Ci0jZWxzZQotI2RlZmluZSBHVEtNT1pF
TUJFRF9BUEkodHlwZSxuYW1lLCBwYXJhbXMpIE5TX0lNUE9SVF8odHlwZSkgbmFtZSBwYXJhbXM7
Ci0jZW5kaWYKLQotI2VuZGlmIC8qIFhQQ09NX0dMVUUgKi8KLQotI2lmZGVmIF9fY3BsdXNwbHVz
Ci1leHRlcm4gIkMiIHsKLSNlbmRpZiAvKiBfX2NwbHVzcGx1cyAqLwotCi0jZGVmaW5lIEdUS19U
WVBFX01PWl9FTUJFRCAgICAgICAgICAgICAoZ3RrX21vel9lbWJlZF9nZXRfdHlwZSgpKQotI2Rl
ZmluZSBHVEtfTU9aX0VNQkVEKG9iaikgICAgICAgICAgICAgR19UWVBFX0NIRUNLX0lOU1RBTkNF
X0NBU1QoKG9iaiksIEdUS19UWVBFX01PWl9FTUJFRCwgR3RrTW96RW1iZWQpCi0jZGVmaW5lIEdU
S19NT1pfRU1CRURfQ0xBU1Moa2xhc3MpICAgICBHX1RZUEVfQ0hFQ0tfQ0xBU1NfQ0FTVCgoa2xh
c3MpLCBHVEtfVFlQRV9NT1pfRU1CRUQsIEd0a01vekVtYmVkQ2xhc3MpCi0jZGVmaW5lIEdUS19J
U19NT1pfRU1CRUQob2JqKSAgICAgICAgICBHX1RZUEVfQ0hFQ0tfSU5TVEFOQ0VfVFlQRSgob2Jq
KSwgR1RLX1RZUEVfTU9aX0VNQkVEKQotI2RlZmluZSBHVEtfSVNfTU9aX0VNQkVEX0NMQVNTKGts
YXNzKSAgR19UWVBFX0NIRUNLX0NMQVNTX1RZUEUoKGtsYXNzKSwgR1RLX1RZUEVfTU9aX0VNQkVE
KQotCi10eXBlZGVmIHN0cnVjdCBfR3RrTW96RW1iZWQgICAgICBHdGtNb3pFbWJlZDsKLXR5cGVk
ZWYgc3RydWN0IF9HdGtNb3pFbWJlZENsYXNzIEd0a01vekVtYmVkQ2xhc3M7Ci0KLXN0cnVjdCBf
R3RrTW96RW1iZWQKLXsKLSAgR3RrQmluICAgIGJpbjsKLSAgdm9pZCAgICAgKmRhdGE7Ci19Owot
Ci1zdHJ1Y3QgX0d0a01vekVtYmVkQ2xhc3MKLXsKLSAgR3RrQmluQ2xhc3MgcGFyZW50X2NsYXNz
OwotCi0gIHZvaWQgKCogbGlua19tZXNzYWdlKSAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCk7
Ci0gIHZvaWQgKCoganNfc3RhdHVzKSAgICAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCk7Ci0g
IHZvaWQgKCogbG9jYXRpb24pICAgICAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCk7Ci0gIHZv
aWQgKCogdGl0bGUpICAgICAgICAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCk7Ci0gIHZvaWQg
KCogcHJvZ3Jlc3MpICAgICAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgZ2ludCBjdXJwcm9n
cmVzcywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ludCBtYXhwcm9ncmVzcyk7
Ci0gIHZvaWQgKCogcHJvZ3Jlc3NfYWxsKSAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgY29u
c3QgY2hhciAqYVVSSSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ludCBjdXJw
cm9ncmVzcywgZ2ludCBtYXhwcm9ncmVzcyk7Ci0gIHZvaWQgKCogbmV0X3N0YXRlKSAgICAgICAg
ICAgKEd0a01vekVtYmVkICplbWJlZCwgZ2ludCBzdGF0ZSwgZ3VpbnQgc3RhdHVzKTsKLSAgdm9p
ZCAoKiBuZXRfc3RhdGVfYWxsKSAgICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBjb25zdCBjaGFy
ICphVVJJLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaW50IHN0YXRlLCBndWlu
dCBzdGF0dXMpOwotICB2b2lkICgqIG5ldF9zdGFydCkgICAgICAgICAgIChHdGtNb3pFbWJlZCAq
ZW1iZWQpOwotICB2b2lkICgqIG5ldF9zdG9wKSAgICAgICAgICAgIChHdGtNb3pFbWJlZCAqZW1i
ZWQpOwotICB2b2lkICgqIG5ld193aW5kb3cpICAgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQs
IEd0a01vekVtYmVkICoqbmV3RW1iZWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGd1aW50IGNocm9tZW1hc2spOwotICB2b2lkICgqIHZpc2liaWxpdHkpICAgICAgICAgIChHdGtN
b3pFbWJlZCAqZW1iZWQsIGdib29sZWFuIHZpc2liaWxpdHkpOwotICB2b2lkICgqIGRlc3Ryb3lf
YnJzcikgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQpOwotICBnaW50ICgqIG9wZW5fdXJpKSAg
ICAgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIGNvbnN0IGNoYXIgKmFVUkkpOwotICB2b2lk
ICgqIHNpemVfdG8pICAgICAgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIGdpbnQgd2lkdGgs
IGdpbnQgaGVpZ2h0KTsKLSAgZ2ludCAoKiBkb21fa2V5X2Rvd24pICAgICAgICAoR3RrTW96RW1i
ZWQgKmVtYmVkLCBncG9pbnRlciBkb21fZXZlbnQpOwotICBnaW50ICgqIGRvbV9rZXlfcHJlc3Mp
ICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIGdwb2ludGVyIGRvbV9ldmVudCk7Ci0gIGdpbnQg
KCogZG9tX2tleV91cCkgICAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgZ3BvaW50ZXIgZG9t
X2V2ZW50KTsKLSAgZ2ludCAoKiBkb21fbW91c2VfZG93bikgICAgICAoR3RrTW96RW1iZWQgKmVt
YmVkLCBncG9pbnRlciBkb21fZXZlbnQpOwotICBnaW50ICgqIGRvbV9tb3VzZV91cCkgICAgICAg
IChHdGtNb3pFbWJlZCAqZW1iZWQsIGdwb2ludGVyIGRvbV9ldmVudCk7Ci0gIGdpbnQgKCogZG9t
X21vdXNlX2NsaWNrKSAgICAgKEd0a01vekVtYmVkICplbWJlZCwgZ3BvaW50ZXIgZG9tX2V2ZW50
KTsKLSAgZ2ludCAoKiBkb21fbW91c2VfZGJsX2NsaWNrKSAoR3RrTW96RW1iZWQgKmVtYmVkLCBn
cG9pbnRlciBkb21fZXZlbnQpOwotICBnaW50ICgqIGRvbV9tb3VzZV9vdmVyKSAgICAgIChHdGtN
b3pFbWJlZCAqZW1iZWQsIGdwb2ludGVyIGRvbV9ldmVudCk7Ci0gIGdpbnQgKCogZG9tX21vdXNl
X291dCkgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgZ3BvaW50ZXIgZG9tX2V2ZW50KTsKLSAg
dm9pZCAoKiBzZWN1cml0eV9jaGFuZ2UpICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBncG9pbnRl
ciByZXF1ZXN0LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWludCBzdGF0ZSk7
Ci0gIHZvaWQgKCogc3RhdHVzX2NoYW5nZSkgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgZ3Bv
aW50ZXIgcmVxdWVzdCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ludCBzdGF0
dXMsIGdwb2ludGVyIG1lc3NhZ2UpOwotICBnaW50ICgqIGRvbV9hY3RpdmF0ZSkgICAgICAgIChH
dGtNb3pFbWJlZCAqZW1iZWQsIGdwb2ludGVyIGRvbV9ldmVudCk7Ci0gIGdpbnQgKCogZG9tX2Zv
Y3VzX2luKSAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgZ3BvaW50ZXIgZG9tX2V2ZW50KTsK
LSAgZ2ludCAoKiBkb21fZm9jdXNfb3V0KSAgICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBncG9p
bnRlciBkb21fZXZlbnQpOwotfTsKLQotR1RLTU9aRU1CRURfQVBJKEdUeXBlLCAgICAgIGd0a19t
b3pfZW1iZWRfZ2V0X3R5cGUsICAgICAgICAodm9pZCkpCi1HVEtNT1pFTUJFRF9BUEkoR3RrV2lk
Z2V0KiwgZ3RrX21vel9lbWJlZF9uZXcsICAgICAgICAgICAgICh2b2lkKSkKLUdUS01PWkVNQkVE
X0FQSSh2b2lkLCAgICAgICBndGtfbW96X2VtYmVkX3B1c2hfc3RhcnR1cCwgICAgKHZvaWQpKQot
R1RLTU9aRU1CRURfQVBJKHZvaWQsICAgICAgIGd0a19tb3pfZW1iZWRfcG9wX3N0YXJ0dXAsICAg
ICAodm9pZCkpCi0KLS8qIFRlbGwgZ3RrbW96ZW1iZWQgd2hlcmUgdGhlIGd0a21vemVtYmVkIGxp
YnMgbGl2ZS4gSWYgdGhpcyBpcyBub3Qgc3BlY2lmaWVkLAotICAgVGhlIE1PWklMTEFfRklWRV9I
T01FIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIGNoZWNrZWQuICovCi1HVEtNT1pFTUJFRF9BUEko
dm9pZCwgICAgICAgZ3RrX21vel9lbWJlZF9zZXRfcGF0aCwgICAgICAgIChjb25zdCBjaGFyICph
UGF0aCkpCi0KLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgICAgICBndGtfbW96X2VtYmVkX3NldF9j
b21wX3BhdGgsICAgKGNvbnN0IGNoYXIgKmFQYXRoKSkKLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAg
ICAgIGd0a19tb3pfZW1iZWRfc2V0X3Byb2ZpbGVfcGF0aCwgKGNvbnN0IGNoYXIgKmFEaXIsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICphTmFtZSkpCi1HVEtNT1pFTUJFRF9BUEkodm9pZCwgICAgICBndGtfbW96
X2VtYmVkX2xvYWRfdXJsLCAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hh
ciAqdXJsKSkKLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgICAgIGd0a19tb3pfZW1iZWRfc3RvcF9s
b2FkLCAgICAgICAoR3RrTW96RW1iZWQgKmVtYmVkKSkKLUdUS01PWkVNQkVEX0FQSShnYm9vbGVh
biwgIGd0a19tb3pfZW1iZWRfY2FuX2dvX2JhY2ssICAgICAoR3RrTW96RW1iZWQgKmVtYmVkKSkK
LUdUS01PWkVNQkVEX0FQSShnYm9vbGVhbiwgIGd0a19tb3pfZW1iZWRfY2FuX2dvX2ZvcndhcmQs
ICAoR3RrTW96RW1iZWQgKmVtYmVkKSkKLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgICAgIGd0a19t
b3pfZW1iZWRfZ29fYmFjaywgICAgICAgICAoR3RrTW96RW1iZWQgKmVtYmVkKSkKLUdUS01PWkVN
QkVEX0FQSSh2b2lkLCAgICAgIGd0a19tb3pfZW1iZWRfZ29fZm9yd2FyZCwgICAgICAoR3RrTW96
RW1iZWQgKmVtYmVkKSkKLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgIGd0a19tb3pfZW1iZWRfcmVu
ZGVyX2RhdGEsICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCAKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Vp
bnQzMiBsZW4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IGNoYXIgKmJhc2VfdXJpLCAKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqbWltZV90eXBlKSkK
LUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgIGd0a19tb3pfZW1iZWRfb3Blbl9zdHJlYW0sICAgICAo
R3RrTW96RW1iZWQgKmVtYmVkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpiYXNlX3VyaSwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqbWlt
ZV90eXBlKSkKLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgIGd0a19tb3pfZW1iZWRfYXBwZW5kX2Rh
dGEsICAgICAgKEd0a01vekVtYmVkICplbWJlZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWludDMy
IGxlbikpCi1HVEtNT1pFTUJFRF9BUEkodm9pZCwgICBndGtfbW96X2VtYmVkX2Nsb3NlX3N0cmVh
bSwgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQpKQotR1RLTU9aRU1CRURfQVBJKGNoYXIqLCAgZ3Rr
X21vel9lbWJlZF9nZXRfbGlua19tZXNzYWdlLCAoR3RrTW96RW1iZWQgKmVtYmVkKSkKLUdUS01P
WkVNQkVEX0FQSShjaGFyKiwgIGd0a19tb3pfZW1iZWRfZ2V0X2pzX3N0YXR1cywgICAgKEd0a01v
ekVtYmVkICplbWJlZCkpCi1HVEtNT1pFTUJFRF9BUEkoY2hhciosICBndGtfbW96X2VtYmVkX2dl
dF90aXRsZSwgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQpKQotR1RLTU9aRU1CRURfQVBJKGNo
YXIqLCAgZ3RrX21vel9lbWJlZF9nZXRfbG9jYXRpb24sICAgICAoR3RrTW96RW1iZWQgKmVtYmVk
KSkKLUdUS01PWkVNQkVEX0FQSSh2b2lkLCAgIGd0a19tb3pfZW1iZWRfcmVsb2FkLCAgICAgICAg
ICAgKEd0a01vekVtYmVkICplbWJlZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGdpbnQzMiBmbGFncykpCi1HVEtNT1pFTUJFRF9BUEko
dm9pZCwgICBndGtfbW96X2VtYmVkX3NldF9jaHJvbWVfbWFzaywgIChHdGtNb3pFbWJlZCAqZW1i
ZWQsIAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ3VpbnQzMiBmbGFncykpCi1HVEtNT1pFTUJFRF9BUEkoZ3VpbnQzMiwgZ3RrX21vel9l
bWJlZF9nZXRfY2hyb21lX21hc2ssIChHdGtNb3pFbWJlZCAqZW1iZWQpKQotCi0vKiBUaGVzZSBh
cmUgc3RyYWlnaHQgb3V0IG9mIG5zSVdlYlByb2dyZXNzTGlzdGVuZXIuaCAqLwotCi10eXBlZGVm
IGVudW0KLXsKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1NUQVJUID0gMSwKLSAgR1RLX01PWl9FTUJF
RF9GTEFHX1JFRElSRUNUSU5HID0gMiwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1RSQU5TRkVSUklO
RyA9IDQsCi0gIEdUS19NT1pfRU1CRURfRkxBR19ORUdPVElBVElORyA9IDgsCi0gIEdUS19NT1pf
RU1CRURfRkxBR19TVE9QID0gMTYsCi0gIAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfSVNfUkVRVUVT
VCA9IDY1NTM2LAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfSVNfRE9DVU1FTlQgPSAxMzEwNzIsCi0g
IEdUS19NT1pfRU1CRURfRkxBR19JU19ORVRXT1JLID0gMjYyMTQ0LAotICBHVEtfTU9aX0VNQkVE
X0ZMQUdfSVNfV0lORE9XID0gNTI0Mjg4LAotCi0gIEdUS19NT1pfRU1CRURfRkxBR19SRVNUT1JJ
TkcgPSAxNjc3NzIxNgotfSBHdGtNb3pFbWJlZFByb2dyZXNzRmxhZ3M7Ci0KLS8qIFRoZXNlIGFy
ZSBmcm9tIHZhcmlvdXMgbmV0d29ya2luZyBoZWFkZXJzICovCi0KLXR5cGVkZWYgZW51bQotewot
ICAvKiBOU19FUlJPUl9VTktOT1dOX0hPU1QgKi8KLSAgR1RLX01PWl9FTUJFRF9TVEFUVVNfRkFJ
TEVEX0ROUyAgICAgPSAyMTUyMzk4ODc4VSwKLSAvKiBOU19FUlJPUl9DT05ORUNUSU9OX1JFRlVT
RUQgKi8KLSAgR1RLX01PWl9FTUJFRF9TVEFUVVNfRkFJTEVEX0NPTk5FQ1QgPSAyMTUyMzk4ODYx
VSwKLSAvKiBOU19FUlJPUl9ORVRfVElNRU9VVCAqLwotICBHVEtfTU9aX0VNQkVEX1NUQVRVU19G
QUlMRURfVElNRU9VVCA9IDIxNTIzOTg4NjJVLAotIC8qIE5TX0JJTkRJTkdfQUJPUlRFRCAqLwot
ICBHVEtfTU9aX0VNQkVEX1NUQVRVU19GQUlMRURfVVNFUkNBTkNFTEVEID0gMjE1MjM5ODg1MFUK
LX0gR3RrTW96RW1iZWRTdGF0dXNGbGFnczsKLQotLyogVGhlc2UgdXNlZCB0byBiZSBzdHJhaWdo
dCBvdXQgb2YgbnNJV2ViTmF2aWdhdGlvbi5oIHVudGlsIHRoZSBBUEkKLSAgIGNoYW5nZWQuICBO
b3cgdGhlcmUncyBhIG1hcHBpbmcgdGFibGUgdGhhdCBtYXBzIHRoZXNlIHZhbHVlcyB0byB0aGUK
LSAgIGludGVybmFsIHZhbHVlcy4gKi8KLQotdHlwZWRlZiBlbnVtIAotewotICBHVEtfTU9aX0VN
QkVEX0ZMQUdfUkVMT0FETk9STUFMID0gMCwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1JFTE9BREJZ
UEFTU0NBQ0hFID0gMSwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1JFTE9BREJZUEFTU1BST1hZID0g
MiwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1JFTE9BREJZUEFTU1BST1hZQU5EQ0FDSEUgPSAzLAot
ICBHVEtfTU9aX0VNQkVEX0ZMQUdfUkVMT0FEQ0hBUlNFVENIQU5HRSA9IDQKLX0gR3RrTW96RW1i
ZWRSZWxvYWRGbGFnczsKLQotLyogVGhlc2UgYXJlIHN0cmFpZ2h0IG91dCBvZiBuc0lXZWJCcm93
c2VyQ2hyb21lLmggKi8KLQotdHlwZWRlZiBlbnVtCi17Ci0gIEdUS19NT1pfRU1CRURfRkxBR19E
RUZBVUxUQ0hST01FID0gMVUsCi0gIEdUS19NT1pfRU1CRURfRkxBR19XSU5ET1dCT1JERVJTT04g
PSAyVSwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1dJTkRPV0NMT1NFT04gPSA0VSwKLSAgR1RLX01P
Wl9FTUJFRF9GTEFHX1dJTkRPV1JFU0laRU9OID0gOFUsCi0gIEdUS19NT1pfRU1CRURfRkxBR19N
RU5VQkFST04gPSAxNlUsCi0gIEdUS19NT1pfRU1CRURfRkxBR19UT09MQkFST04gPSAzMlUsCi0g
IEdUS19NT1pfRU1CRURfRkxBR19MT0NBVElPTkJBUk9OID0gNjRVLAotICBHVEtfTU9aX0VNQkVE
X0ZMQUdfU1RBVFVTQkFST04gPSAxMjhVLAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfUEVSU09OQUxU
T09MQkFST04gPSAyNTZVLAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfU0NST0xMQkFSU09OID0gNTEy
VSwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX1RJVExFQkFST04gPSAxMDI0VSwKLSAgR1RLX01PWl9F
TUJFRF9GTEFHX0VYVFJBQ0hST01FT04gPSAyMDQ4VSwKLSAgR1RLX01PWl9FTUJFRF9GTEFHX0FM
TENIUk9NRSA9IDQwOTRVLAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfV0lORE9XUkFJU0VEID0gMzM1
NTQ0MzJVLAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfV0lORE9XTE9XRVJFRCA9IDY3MTA4ODY0VSwK
LSAgR1RLX01PWl9FTUJFRF9GTEFHX0NFTlRFUlNDUkVFTiA9IDEzNDIxNzcyOFUsCi0gIEdUS19N
T1pfRU1CRURfRkxBR19ERVBFTkRFTlQgPSAyNjg0MzU0NTZVLAotICBHVEtfTU9aX0VNQkVEX0ZM
QUdfTU9EQUwgPSA1MzY4NzA5MTJVLAotICBHVEtfTU9aX0VNQkVEX0ZMQUdfT1BFTkFTRElBTE9H
ID0gMTA3Mzc0MTgyNFUsCi0gIEdUS19NT1pfRU1CRURfRkxBR19PUEVOQVNDSFJPTUUgPSAyMTQ3
NDgzNjQ4VSAKLX0gR3RrTW96RW1iZWRDaHJvbWVGbGFnczsKLQotLyogdGhpcyBpcyBhIHNpbmds
ZXRvbiBvYmplY3QgdGhhdCB5b3UgY2FuIGhvb2sgdXAgdG8gdG8gZ2V0IHNpZ25hbHMKLSAgIHRo
YXQgYXJlIG5vdCBoYW5kZWQgb3V0IG9uIGEgcGVyIHdpZGdldCBiYXNpcy4gKi8KLQotI2RlZmlu
ZSBHVEtfVFlQRV9NT1pfRU1CRURfU0lOR0xFICAgICAgICAgICAgKGd0a19tb3pfZW1iZWRfc2lu
Z2xlX2dldF90eXBlKCkpCi0jZGVmaW5lIEdUS19NT1pfRU1CRURfU0lOR0xFKG9iaikgICAgICAg
ICAgICBHVEtfQ0hFQ0tfQ0FTVCgob2JqKSwgR1RLX1RZUEVfTU9aX0VNQkVEX1NJTkdMRSwgR3Rr
TW96RW1iZWRTaW5nbGUpCi0jZGVmaW5lIEdUS19NT1pfRU1CRURfU0lOR0xFX0NMQVNTKGtsYXNz
KSAgICBHVEtfQ0hFS19DTEFTU19DQVNUKChrbGFzcyksIEdUS19UWVBFX01PWl9FTUJFRF9TSU5H
TEUsIEd0a01vekVtYmVkU2luZ2xlQ2xhc3MpCi0jZGVmaW5lIEdUS19JU19NT1pfRU1CRURfU0lO
R0xFKG9iaikgICAgICAgICBHVEtfQ0hFQ0tfVFlQRSgob2JqKSwgR1RLX1RZUEVfTU9aX0VNQkVE
X1NJTkdMRSkKLSNkZWZpbmUgR1RLX0lTX01PWl9FTUJFRF9TSU5HTEVfQ0xBU1Moa2xhc3MpIEdU
S19DSEVDS19DTEFTU19UWVBFKChrbGFzcyksIEdUS19UWVBFX01PWl9FTUJFRCkKLSNkZWZpbmUg
R1RLX01PWl9FTUJFRF9TSU5HTEVfR0VUX0NMQVNTKG9iaikgIChHX1RZUEVfSU5TVEFOQ0VfR0VU
X0NMQVNTICgob2JqKSwgR1RLX1RZUEVfTU9aX0VNQkVEX1NJTkdMRSwgR3RrTW96RW1iZWRTaW5n
bGVDbGFzcykpCi0KLXR5cGVkZWYgc3RydWN0IF9HdGtNb3pFbWJlZFNpbmdsZSAgICAgIEd0a01v
ekVtYmVkU2luZ2xlOwotdHlwZWRlZiBzdHJ1Y3QgX0d0a01vekVtYmVkU2luZ2xlQ2xhc3MgR3Rr
TW96RW1iZWRTaW5nbGVDbGFzczsKLQotc3RydWN0IF9HdGtNb3pFbWJlZFNpbmdsZQotewotICBH
dGtPYmplY3QgIG9iamVjdDsKLSAgdm9pZCAgICAgICpkYXRhOwotfTsKLQotc3RydWN0IF9HdGtN
b3pFbWJlZFNpbmdsZUNsYXNzCi17Ci0gIEd0a09iamVjdENsYXNzIHBhcmVudF9jbGFzczsKLQot
ICB2b2lkICgqIG5ld193aW5kb3dfb3JwaGFuKSAgIChHdGtNb3pFbWJlZFNpbmdsZSAqZW1iZWQs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEd0a01vekVtYmVkICoqbmV3RW1iZWQs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGd1aW50IGNocm9tZW1hc2spOwotfTsK
LQotR1RLTU9aRU1CRURfQVBJKEdUeXBlLCAgICAgICAgICAgICAgIGd0a19tb3pfZW1iZWRfc2lu
Z2xlX2dldF90eXBlLCAodm9pZCkpCi1HVEtNT1pFTUJFRF9BUEkoR3RrTW96RW1iZWRTaW5nbGUg
KiwgZ3RrX21vel9lbWJlZF9zaW5nbGVfZ2V0LCAgICAgICh2b2lkKSkKLQotI2lmZGVmIF9fY3Bs
dXNwbHVzCi19Ci0jZW5kaWYgLyogX19jcGx1c3BsdXMgKi8KLQotI2VuZGlmIC8qIGd0a21vemVt
YmVkX2ggKi8KZGlmZiAtLWdpdCBhL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvZ3RrbW96ZW1i
ZWQyLmNwcCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvZ3RrbW96ZW1iZWQyLmNwcApkZWxl
dGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9ndGtt
b3plbWJlZDIuY3BwCisrKyAvZGV2L251bGwKQEAgLTEsMTEzMiArMCwwIEBACi0vKiAqKioqKiBC
RUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0gKiBWZXJzaW9uOiBNUEwgMS4xL0dQTCAyLjAvTEdQ
TCAyLjEKLSAqCi0gKiBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0IHRvIHRo
ZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KLSAqIDEuMSAodGhlICJMaWNlbnNlIik7
IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aAotICog
dGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAotICog
aHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCi0gKgotICogU29mdHdhcmUgZGlzdHJpYnV0ZWQg
dW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNpcywKLSAq
IFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQu
IFNlZSB0aGUgTGljZW5zZQotICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcg
cmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKLSAqIExpY2Vuc2UuCi0gKgotICogVGhl
IE9yaWdpbmFsIENvZGUgaXMgbW96aWxsYS5vcmcgY29kZS4KLSAqCi0gKiBUaGUgSW5pdGlhbCBE
ZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMKLSAqIENocmlzdG9waGVyIEJsaXp6YXJk
LiBQb3J0aW9ucyBjcmVhdGVkIGJ5IENocmlzdG9waGVyIEJsaXp6YXJkIGFyZSBDb3B5cmlnaHQg
KEMpIENocmlzdG9waGVyIEJsaXp6YXJkLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqIFBvcnRp
b25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIw
MDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0g
KiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIgQmxpenphcmQgPGJsaXp6YXJkQG1v
emlsbGEub3JnPgotICogICBSYW1pcm8gRXN0cnVnbyA8cmFtaXJvQGVhemVsLmNvbT4KLSAqCi0g
KiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVu
ZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwK
LSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBh
cmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8g
YWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhl
IHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90
aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBw
cm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQg
b3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3Ug
ZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1
c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBv
bmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElD
RU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5jbHVkZSA8c3RkaW8uaD4KLQotI2luY2x1ZGUgImd0
a21vemVtYmVkLmgiCi0jaW5jbHVkZSAiZ3RrbW96ZW1iZWRwcml2YXRlLmgiCi0jaW5jbHVkZSAi
Z3RrbW96ZW1iZWRfaW50ZXJuYWwuaCIKLQotI2luY2x1ZGUgIkVtYmVkUHJpdmF0ZS5oIgotI2lu
Y2x1ZGUgIkVtYmVkV2luZG93LmgiCi0KLS8vIHNvIHdlIGNhbiBkbyBvdXIgZ2V0X25zSVdlYkJy
b3dzZXIgbGF0ZXIuLi4KLSNpbmNsdWRlICJuc0lXZWJCcm93c2VyLmgiCi0KLSNpbmNsdWRlICJn
dGttb3plbWJlZG1hcnNoYWwuaCIKLQotI2RlZmluZSBORVdfVE9PTEtJVF9TVFJJTkcoeCkgZ19z
dHJkdXAoTlNfQ29udmVydFVURjE2dG9VVEY4KHgpLmdldCgpKQotI2RlZmluZSBHRVRfT0JKRUNU
X0NMQVNTX1RZUEUoeCkgR19PQkpFQ1RfQ0xBU1NfVFlQRSh4KQotCi1jbGFzcyBuc0lEaXJlY3Rv
cnlTZXJ2aWNlUHJvdmlkZXI7Ci0KLS8vIGNsYXNzIGFuZCBpbnN0YW5jZSBpbml0aWFsaXphdGlv
bgotCi1zdGF0aWMgdm9pZAotZ3RrX21vel9lbWJlZF9jbGFzc19pbml0KEd0a01vekVtYmVkQ2xh
c3MgKmtsYXNzKTsKLQotc3RhdGljIHZvaWQKLWd0a19tb3pfZW1iZWRfaW5pdChHdGtNb3pFbWJl
ZCAqZW1iZWQpOwotCi0vLyBHdGtPYmplY3QgbWV0aG9kcwotCi1zdGF0aWMgdm9pZAotZ3RrX21v
el9lbWJlZF9kZXN0cm95KEd0a09iamVjdCAqb2JqZWN0KTsKLQotLy8gR3RrV2lkZ2V0IG1ldGhv
ZHMKLQotc3RhdGljIHZvaWQKLWd0a19tb3pfZW1iZWRfcmVhbGl6ZShHdGtXaWRnZXQgKndpZGdl
dCk7Ci0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX3VucmVhbGl6ZShHdGtXaWRnZXQgKndp
ZGdldCk7Ci0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX3NpemVfYWxsb2NhdGUoR3RrV2lk
Z2V0ICp3aWRnZXQsIEd0a0FsbG9jYXRpb24gKmFsbG9jYXRpb24pOwotCi1zdGF0aWMgdm9pZAot
Z3RrX21vel9lbWJlZF9tYXAoR3RrV2lkZ2V0ICp3aWRnZXQpOwotCi1zdGF0aWMgdm9pZAotZ3Rr
X21vel9lbWJlZF91bm1hcChHdGtXaWRnZXQgKndpZGdldCk7Ci0KLSNpZmRlZiBNT1pfQUNDRVNT
SUJJTElUWV9BVEsKLXN0YXRpYyBBdGtPYmplY3QqIGd0a19tb3pfZW1iZWRfZ2V0X2FjY2Vzc2li
bGUgKEd0a1dpZGdldCAqd2lkZ2V0KTsKLSNlbmRpZgotCi1zdGF0aWMgZ2ludAotaGFuZGxlX2No
aWxkX2ZvY3VzX2luKEd0a1dpZGdldCAgICAgKmFXaWRnZXQsCi0JCSAgICAgIEdka0V2ZW50Rm9j
dXMgKmFHZGtGb2N1c0V2ZW50LAotCQkgICAgICBHdGtNb3pFbWJlZCAgICphRW1iZWQpOwotCi1z
dGF0aWMgZ2ludAotaGFuZGxlX2NoaWxkX2ZvY3VzX291dChHdGtXaWRnZXQgICAgICphV2lkZ2V0
LAotCQkgICAgICAgR2RrRXZlbnRGb2N1cyAqYUdka0ZvY3VzRXZlbnQsCi0JCSAgICAgICBHdGtN
b3pFbWJlZCAgICphRW1iZWQpOwotCi0vLyBnbG9iYWxzIGZvciB0aGlzIHR5cGUgb2Ygd2lkZ2V0
Ci0KLXN0YXRpYyBHdGtCaW5DbGFzcyAqZW1iZWRfcGFyZW50X2NsYXNzOwotCi1ndWludCBtb3pf
ZW1iZWRfc2lnbmFsc1tFTUJFRF9MQVNUX1NJR05BTF0gPSB7IDAgfTsKLQotLy8gR3RrT2JqZWN0
ICsgY2xhc3MtcmVsYXRlZCBmdW5jdGlvbnMKLQotR1R5cGUKLWd0a19tb3pfZW1iZWRfZ2V0X3R5
cGUodm9pZCkKLXsKLSAgc3RhdGljIEdUeXBlIG1vel9lbWJlZF90eXBlID0gMDsKLSAgaWYgKG1v
el9lbWJlZF90eXBlID09IDApCi0gIHsKLSAgICBjb25zdCBHVHlwZUluZm8gb3VyX2luZm8gPQot
ICAgIHsKLSAgICAgIHNpemVvZihHdGtNb3pFbWJlZENsYXNzKSwKLSAgICAgIE5VTEwsIC8qIGJh
c2VfaW5pdCAqLwotICAgICAgTlVMTCwgLyogYmFzZV9maW5hbGl6ZSAqLwotICAgICAgKEdDbGFz
c0luaXRGdW5jKWd0a19tb3pfZW1iZWRfY2xhc3NfaW5pdCwKLSAgICAgIE5VTEwsCi0gICAgICBO
VUxMLCAvKiBjbGFzc19kYXRhICovCi0gICAgICBzaXplb2YoR3RrTW96RW1iZWQpLAotICAgICAg
MCwgLyogbl9wcmVhbGxvY3MgKi8KLSAgICAgIChHSW5zdGFuY2VJbml0RnVuYylndGtfbW96X2Vt
YmVkX2luaXQsCi0gICAgfTsKLQotICAgIG1vel9lbWJlZF90eXBlID0gZ190eXBlX3JlZ2lzdGVy
X3N0YXRpYyhHVEtfVFlQRV9CSU4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICJHdGtNb3pFbWJlZCIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZvdXJfaW5mbywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKEdUeXBlRmxhZ3MpMCk7Ci0gIH0KLQotICByZXR1cm4gbW96X2VtYmVkX3R5
cGU7Ci19Ci0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX2NsYXNzX2luaXQoR3RrTW96RW1i
ZWRDbGFzcyAqa2xhc3MpCi17Ci0gIEd0a0NvbnRhaW5lckNsYXNzICAqY29udGFpbmVyX2NsYXNz
OwotICBHdGtXaWRnZXRDbGFzcyAgICAgKndpZGdldF9jbGFzczsKLSAgR3RrT2JqZWN0Q2xhc3Mg
ICAgICpvYmplY3RfY2xhc3M7Ci0KLSAgY29udGFpbmVyX2NsYXNzID0gR1RLX0NPTlRBSU5FUl9D
TEFTUyhrbGFzcyk7Ci0gIHdpZGdldF9jbGFzcyAgICA9IEdUS19XSURHRVRfQ0xBU1Moa2xhc3Mp
OwotICBvYmplY3RfY2xhc3MgICAgPSBHVEtfT0JKRUNUX0NMQVNTKGtsYXNzKTsKLQotICBlbWJl
ZF9wYXJlbnRfY2xhc3MgPSAoR3RrQmluQ2xhc3MgKilnX3R5cGVfY2xhc3NfcGVlayhndGtfYmlu
X2dldF90eXBlKCkpOwotCi0gIHdpZGdldF9jbGFzcy0+cmVhbGl6ZSA9IGd0a19tb3pfZW1iZWRf
cmVhbGl6ZTsKLSAgd2lkZ2V0X2NsYXNzLT51bnJlYWxpemUgPSBndGtfbW96X2VtYmVkX3VucmVh
bGl6ZTsKLSAgd2lkZ2V0X2NsYXNzLT5zaXplX2FsbG9jYXRlID0gZ3RrX21vel9lbWJlZF9zaXpl
X2FsbG9jYXRlOwotICB3aWRnZXRfY2xhc3MtPm1hcCA9IGd0a19tb3pfZW1iZWRfbWFwOwotICB3
aWRnZXRfY2xhc3MtPnVubWFwID0gZ3RrX21vel9lbWJlZF91bm1hcDsKLQotI2lmZGVmIE1PWl9B
Q0NFU1NJQklMSVRZX0FUSwotICB3aWRnZXRfY2xhc3MtPmdldF9hY2Nlc3NpYmxlID0gZ3RrX21v
el9lbWJlZF9nZXRfYWNjZXNzaWJsZTsKLSNlbmRpZgotCi0gIG9iamVjdF9jbGFzcy0+ZGVzdHJv
eSA9IGd0a19tb3pfZW1iZWRfZGVzdHJveTsKLQotICAvLyBzZXQgdXAgb3VyIHNpZ25hbHMKLQot
ICBtb3pfZW1iZWRfc2lnbmFsc1tMSU5LX01FU1NBR0VdID0KLSAgICBnX3NpZ25hbF9uZXcoImxp
bmtfbWVzc2FnZSIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwK
LSAgICAgICAgICAgICAgICAgR19TSUdOQUxfUlVOX0ZJUlNULAotICAgICAgICAgICAgICAgICBH
X1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRDbGFzcywgbGlua19tZXNzYWdlKSwKLSAgICAgICAg
ICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ19jY2xvc3VyZV9tYXJzaGFs
X1ZPSURfX1ZPSUQsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9OT05FLCAwKTsKLSAgbW96X2Vt
YmVkX3NpZ25hbHNbSlNfU1RBVFVTXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJqc19zdGF0dXMiLAot
ICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAg
ICAgIEdfU0lHTkFMX1JVTl9GSVJTVCwKLSAgICAgICAgICAgICAgICAgR19TVFJVQ1RfT0ZGU0VU
KEd0a01vekVtYmVkQ2xhc3MsIGpzX3N0YXR1cyksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5V
TEwsCi0gICAgICAgICAgICAgICAgIGdfY2Nsb3N1cmVfbWFyc2hhbF9WT0lEX19WT0lELAotICAg
ICAgICAgICAgICAgICBHX1RZUEVfTk9ORSwgMCk7Ci0gIG1vel9lbWJlZF9zaWduYWxzW0xPQ0FU
SU9OXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJsb2NhdGlvbiIsCi0gICAgICAgICAgICAgICAgIEdf
VFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAgICAgICAgICAgICAgR19TSUdOQUxfUlVOX0ZJ
UlNULAotICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRDbGFzcywg
bG9jYXRpb24pLAotICAgICAgICAgICAgICAgICBOVUxMLCBOVUxMLAotICAgICAgICAgICAgICAg
ICBnX2NjbG9zdXJlX21hcnNoYWxfVk9JRF9fVk9JRCwKLSAgICAgICAgICAgICAgICAgR19UWVBF
X05PTkUsIDApOwotICBtb3pfZW1iZWRfc2lnbmFsc1tUSVRMRV0gPQotICAgIGdfc2lnbmFsX25l
dygidGl0bGUiLAotICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0g
ICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9GSVJTVCwKLSAgICAgICAgICAgICAgICAgR19T
VFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIHRpdGxlKSwKLSAgICAgICAgICAgICAgICAg
TlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ19jY2xvc3VyZV9tYXJzaGFsX1ZPSURfX1ZP
SUQsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9OT05FLCAwKTsKLSAgbW96X2VtYmVkX3NpZ25h
bHNbUFJPR1JFU1NdID0KLSAgICBnX3NpZ25hbF9uZXcoInByb2dyZXNzIiwKLSAgICAgICAgICAg
ICAgICAgR19UWVBFX0ZST01fQ0xBU1Moa2xhc3MpLAotICAgICAgICAgICAgICAgICBHX1NJR05B
TF9SVU5fRklSU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNUX09GRlNFVChHdGtNb3pFbWJl
ZENsYXNzLCBwcm9ncmVzcyksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAg
ICAgICAgICAgIGd0a21vemVtYmVkX1ZPSURfX0lOVF9JTlQsCi0gICAgICAgICAgICAgICAgIEdf
VFlQRV9OT05FLCAyLCBHX1RZUEVfSU5ULCBHX1RZUEVfSU5UKTsKLSAgbW96X2VtYmVkX3NpZ25h
bHNbUFJPR1JFU1NfQUxMXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJwcm9ncmVzc19hbGwiLAotICAg
ICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAg
IEdfU0lHTkFMX1JVTl9GSVJTVCwKLSAgICAgICAgICAgICAgICAgR19TVFJVQ1RfT0ZGU0VUKEd0
a01vekVtYmVkQ2xhc3MsIHByb2dyZXNzX2FsbCksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5V
TEwsCi0gICAgICAgICAgICAgICAgIGd0a21vemVtYmVkX1ZPSURfX1NUUklOR19JTlRfSU5ULAot
ICAgICAgICAgICAgICAgICBHX1RZUEVfTk9ORSwgMywKLSAgICAgICAgICAgICAgICAgR19UWVBF
X1NUUklORyB8IEdfU0lHTkFMX1RZUEVfU1RBVElDX1NDT1BFLAotICAgICAgICAgICAgICAgICBH
X1RZUEVfSU5ULCBHX1RZUEVfSU5UKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbTkVUX1NUQVRFXSA9
Ci0gICAgZ19zaWduYWxfbmV3KCJuZXRfc3RhdGUiLAotICAgICAgICAgICAgICAgICBHX1RZUEVf
RlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9GSVJTVCwK
LSAgICAgICAgICAgICAgICAgR19TVFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIG5ldF9z
dGF0ZSksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAgICAgICAgICAgIGd0
a21vemVtYmVkX1ZPSURfX0lOVF9VSU5ULAotICAgICAgICAgICAgICAgICBHX1RZUEVfTk9ORSwg
MiwgR19UWVBFX0lOVCwgR19UWVBFX1VJTlQpOwotICBtb3pfZW1iZWRfc2lnbmFsc1tORVRfU1RB
VEVfQUxMXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJuZXRfc3RhdGVfYWxsIiwKLSAgICAgICAgICAg
ICAgICAgR19UWVBFX0ZST01fQ0xBU1Moa2xhc3MpLAotICAgICAgICAgICAgICAgICBHX1NJR05B
TF9SVU5fRklSU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNUX09GRlNFVChHdGtNb3pFbWJl
ZENsYXNzLCBuZXRfc3RhdGVfYWxsKSwKLSAgICAgICAgICAgICAgICAgTlVMTCwgTlVMTCwKLSAg
ICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfVk9JRF9fU1RSSU5HX0lOVF9VSU5ULAotICAgICAg
ICAgICAgICAgICBHX1RZUEVfTk9ORSwgMywKLSAgICAgICAgICAgICAgICAgR19UWVBFX1NUUklO
RyB8IEdfU0lHTkFMX1RZUEVfU1RBVElDX1NDT1BFLAotICAgICAgICAgICAgICAgICBHX1RZUEVf
SU5ULCBHX1RZUEVfVUlOVCk7Ci0gIG1vel9lbWJlZF9zaWduYWxzW05FVF9TVEFSVF0gPQotICAg
IGdfc2lnbmFsX25ldygibmV0X3N0YXJ0IiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0ZST01f
Q0xBU1Moa2xhc3MpLAotICAgICAgICAgICAgICAgICBHX1NJR05BTF9SVU5fRklSU1QsCi0gICAg
ICAgICAgICAgICAgIEdfU1RSVUNUX09GRlNFVChHdGtNb3pFbWJlZENsYXNzLCBuZXRfc3RhcnQp
LAotICAgICAgICAgICAgICAgICBOVUxMLCBOVUxMLAotICAgICAgICAgICAgICAgICBnX2NjbG9z
dXJlX21hcnNoYWxfVk9JRF9fVk9JRCwKLSAgICAgICAgICAgICAgICAgR19UWVBFX05PTkUsIDAp
OwotICBtb3pfZW1iZWRfc2lnbmFsc1tORVRfU1RPUF0gPQotICAgIGdfc2lnbmFsX25ldygibmV0
X3N0b3AiLAotICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAg
ICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9GSVJTVCwKLSAgICAgICAgICAgICAgICAgR19TVFJV
Q1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIG5ldF9zdG9wKSwKLSAgICAgICAgICAgICAgICAg
TlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ19jY2xvc3VyZV9tYXJzaGFsX1ZPSURfX1ZP
SUQsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9OT05FLCAwKTsKLSAgbW96X2VtYmVkX3NpZ25h
bHNbTkVXX1dJTkRPV10gPQotICAgIGdfc2lnbmFsX25ldygibmV3X3dpbmRvdyIsCi0gICAgICAg
ICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAgICAgICAgICAgICAgR19T
SUdOQUxfUlVOX0ZJUlNULAotICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96
RW1iZWRDbGFzcywgbmV3X3dpbmRvdyksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0g
ICAgICAgICAgICAgICAgIGd0a21vemVtYmVkX1ZPSURfX1BPSU5URVJfVUlOVCwKLSAgICAgICAg
ICAgICAgICAgR19UWVBFX05PTkUsIDIsIEdfVFlQRV9QT0lOVEVSLCBHX1RZUEVfVUlOVCk7Ci0g
IG1vel9lbWJlZF9zaWduYWxzW1ZJU0lCSUxJVFldID0KLSAgICBnX3NpZ25hbF9uZXcoInZpc2li
aWxpdHkiLAotICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAg
ICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9GSVJTVCwKLSAgICAgICAgICAgICAgICAgR19TVFJV
Q1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIHZpc2liaWxpdHkpLAotICAgICAgICAgICAgICAg
ICBOVUxMLCBOVUxMLAotICAgICAgICAgICAgICAgICBnX2NjbG9zdXJlX21hcnNoYWxfVk9JRF9f
Qk9PTEVBTiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX05PTkUsIDEsIEdfVFlQRV9CT09MRUFO
KTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbREVTVFJPWV9CUk9XU0VSXSA9Ci0gICAgZ19zaWduYWxf
bmV3KCJkZXN0cm95X2Jyb3dzZXIiLAotICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFT
UyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9GSVJTVCwKLSAgICAgICAg
ICAgICAgICAgR19TVFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIGRlc3Ryb3lfYnJzciks
Ci0gICAgICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAgICAgICAgICAgIGdfY2Nsb3N1
cmVfbWFyc2hhbF9WT0lEX19WT0lELAotICAgICAgICAgICAgICAgICBHX1RZUEVfTk9ORSwgMCk7
Ci0gIG1vel9lbWJlZF9zaWduYWxzW09QRU5fVVJJXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJvcGVu
X3VyaSIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAg
ICAgICAgICAgICAgR19TSUdOQUxfUlVOX0xBU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNU
X09GRlNFVChHdGtNb3pFbWJlZENsYXNzLCBvcGVuX3VyaSksCi0gICAgICAgICAgICAgICAgIE5V
TEwsIE5VTEwsCi0gICAgICAgICAgICAgICAgIGd0a21vemVtYmVkX0JPT0xfX1NUUklORywKLSAg
ICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9TVFJJTkcgfAotICAgICAg
ICAgICAgICAgICBHX1NJR05BTF9UWVBFX1NUQVRJQ19TQ09QRSk7Ci0gIG1vel9lbWJlZF9zaWdu
YWxzW1NJWkVfVE9dID0KLSAgICBnX3NpZ25hbF9uZXcoInNpemVfdG8iLAotICAgICAgICAgICAg
ICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFM
X1JVTl9MQVNULAotICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRD
bGFzcywgc2l6ZV90byksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAgICAg
ICAgICAgIGd0a21vemVtYmVkX1ZPSURfX0lOVF9JTlQsCi0gICAgICAgICAgICAgICAgIEdfVFlQ
RV9OT05FLCAyLCBHX1RZUEVfSU5ULCBHX1RZUEVfSU5UKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNb
RE9NX0tFWV9ET1dOXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJkb21fa2V5X2Rvd24iLAotICAgICAg
ICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdf
U0lHTkFMX1JVTl9MQVNULAotICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96
RW1iZWRDbGFzcywgZG9tX2tleV9kb3duKSwKLSAgICAgICAgICAgICAgICAgTlVMTCwgTlVMTCwK
LSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfQk9PTF9fUE9JTlRFUiwKLSAgICAgICAgICAg
ICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9QT0lOVEVSKTsKLSAgbW96X2VtYmVkX3Np
Z25hbHNbRE9NX0tFWV9QUkVTU10gPQotICAgIGdfc2lnbmFsX25ldygiZG9tX2tleV9wcmVzcyIs
Ci0gICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAgICAgICAg
ICAgICAgR19TSUdOQUxfUlVOX0xBU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNUX09GRlNF
VChHdGtNb3pFbWJlZENsYXNzLCBkb21fa2V5X3ByZXNzKSwKLSAgICAgICAgICAgICAgICAgTlVM
TCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfQk9PTF9fUE9JTlRFUiwKLSAg
ICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9QT0lOVEVSKTsKLSAgbW96
X2VtYmVkX3NpZ25hbHNbRE9NX0tFWV9VUF0gPQotICAgIGdfc2lnbmFsX25ldygiZG9tX2tleV91
cCIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAgICAg
ICAgICAgICAgR19TSUdOQUxfUlVOX0xBU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNUX09G
RlNFVChHdGtNb3pFbWJlZENsYXNzLCBkb21fa2V5X3VwKSwKLSAgICAgICAgICAgICAgICAgTlVM
TCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfQk9PTF9fUE9JTlRFUiwKLSAg
ICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9QT0lOVEVSKTsKLSAgbW96
X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX0RPV05dID0KLSAgICBnX3NpZ25hbF9uZXcoImRvbV9t
b3VzZV9kb3duIiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0ZST01fQ0xBU1Moa2xhc3MpLAot
ICAgICAgICAgICAgICAgICBHX1NJR05BTF9SVU5fTEFTVCwKLSAgICAgICAgICAgICAgICAgR19T
VFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIGRvbV9tb3VzZV9kb3duKSwKLSAgICAgICAg
ICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfQk9PTF9f
UE9JTlRFUiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9QT0lO
VEVSKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX1VQXSA9Ci0gICAgZ19zaWduYWxf
bmV3KCJkb21fbW91c2VfdXAiLAotICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9DTEFTUyhr
bGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9MQVNULAotICAgICAgICAgICAg
ICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRDbGFzcywgZG9tX21vdXNlX3VwKSwKLSAg
ICAgICAgICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRf
Qk9PTF9fUE9JTlRFUiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQ
RV9QT0lOVEVSKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX0NMSUNLXSA9Ci0gICAg
Z19zaWduYWxfbmV3KCJkb21fbW91c2VfY2xpY2siLAotICAgICAgICAgICAgICAgICBHX1RZUEVf
RlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9MQVNULAot
ICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRDbGFzcywgZG9tX21v
dXNlX2NsaWNrKSwKLSAgICAgICAgICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAg
ICAgZ3RrbW96ZW1iZWRfQk9PTF9fUE9JTlRFUiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0JP
T0xFQU4sIDEsIEdfVFlQRV9QT0lOVEVSKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNF
X0RCTF9DTElDS10gPQotICAgIGdfc2lnbmFsX25ldygiZG9tX21vdXNlX2RibF9jbGljayIsCi0g
ICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAgICAgICAgICAg
ICAgR19TSUdOQUxfUlVOX0xBU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNUX09GRlNFVChH
dGtNb3pFbWJlZENsYXNzLCBkb21fbW91c2VfZGJsX2NsaWNrKSwKLSAgICAgICAgICAgICAgICAg
TlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfQk9PTF9fUE9JTlRFUiwK
LSAgICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9QT0lOVEVSKTsKLSAg
bW96X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX09WRVJdID0KLSAgICBnX3NpZ25hbF9uZXcoImRv
bV9tb3VzZV9vdmVyIiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0ZST01fQ0xBU1Moa2xhc3Mp
LAotICAgICAgICAgICAgICAgICBHX1NJR05BTF9SVU5fTEFTVCwKLSAgICAgICAgICAgICAgICAg
R19TVFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIGRvbV9tb3VzZV9vdmVyKSwKLSAgICAg
ICAgICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfQk9P
TF9fUE9JTlRFUiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEsIEdfVFlQRV9Q
T0lOVEVSKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbRE9NX01PVVNFX09VVF0gPQotICAgIGdfc2ln
bmFsX25ldygiZG9tX21vdXNlX291dCIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NM
QVNTKGtsYXNzKSwKLSAgICAgICAgICAgICAgICAgR19TSUdOQUxfUlVOX0xBU1QsCi0gICAgICAg
ICAgICAgICAgIEdfU1RSVUNUX09GRlNFVChHdGtNb3pFbWJlZENsYXNzLCBkb21fbW91c2Vfb3V0
KSwKLSAgICAgICAgICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96
ZW1iZWRfQk9PTF9fUE9JTlRFUiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0JPT0xFQU4sIDEs
IEdfVFlQRV9QT0lOVEVSKTsKLSAgbW96X2VtYmVkX3NpZ25hbHNbU0VDVVJJVFlfQ0hBTkdFXSA9
Ci0gICAgZ19zaWduYWxfbmV3KCJzZWN1cml0eV9jaGFuZ2UiLAotICAgICAgICAgICAgICAgICBH
X1RZUEVfRlJPTV9DTEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9M
QVNULAotICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRDbGFzcywg
c2VjdXJpdHlfY2hhbmdlKSwKLSAgICAgICAgICAgICAgICAgTlVMTCwgTlVMTCwKLSAgICAgICAg
ICAgICAgICAgZ3RrbW96ZW1iZWRfVk9JRF9fUE9JTlRFUl9VSU5ULAotICAgICAgICAgICAgICAg
ICBHX1RZUEVfTk9ORSwgMiwgR19UWVBFX1BPSU5URVIsIEdfVFlQRV9VSU5UKTsKLSAgbW96X2Vt
YmVkX3NpZ25hbHNbU1RBVFVTX0NIQU5HRV0gPQotICAgIGdfc2lnbmFsX25ldygic3RhdHVzX2No
YW5nZSIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAg
ICAgICAgICAgICAgR19TSUdOQUxfUlVOX0xBU1QsCi0gICAgICAgICAgICAgICAgIEdfU1RSVUNU
X09GRlNFVChHdGtNb3pFbWJlZENsYXNzLCBzdGF0dXNfY2hhbmdlKSwKLSAgICAgICAgICAgICAg
ICAgTlVMTCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgZ3RrbW96ZW1iZWRfVk9JRF9fUE9JTlRF
Ul9JTlRfUE9JTlRFUiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX05PTkUsIDMsCi0gICAgICAg
ICAgICAgICAgIEdfVFlQRV9QT0lOVEVSLCBHX1RZUEVfSU5ULCBHX1RZUEVfUE9JTlRFUik7Ci0g
IG1vel9lbWJlZF9zaWduYWxzW0RPTV9BQ1RJVkFURV0gPQotICAgIGdfc2lnbmFsX25ldygiZG9t
X2FjdGl2YXRlIiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0ZST01fQ0xBU1Moa2xhc3MpLAot
ICAgICAgICAgICAgICAgICBHX1NJR05BTF9SVU5fTEFTVCwKLSAgICAgICAgICAgICAgICAgR19T
VFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIGRvbV9hY3RpdmF0ZSksCi0gICAgICAgICAg
ICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAgICAgICAgICAgIGd0a21vemVtYmVkX0JPT0xfX1BP
SU5URVIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9CT09MRUFOLCAxLCBHX1RZUEVfUE9JTlRF
Uik7Ci0gIG1vel9lbWJlZF9zaWduYWxzW0RPTV9GT0NVU19JTl0gPQotICAgIGdfc2lnbmFsX25l
dygiZG9tX2ZvY3VzX2luIiwKLSAgICAgICAgICAgICAgICAgR19UWVBFX0ZST01fQ0xBU1Moa2xh
c3MpLAotICAgICAgICAgICAgICAgICBHX1NJR05BTF9SVU5fTEFTVCwKLSAgICAgICAgICAgICAg
ICAgR19TVFJVQ1RfT0ZGU0VUKEd0a01vekVtYmVkQ2xhc3MsIGRvbV9mb2N1c19pbiksCi0gICAg
ICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAgICAgICAgICAgIGd0a21vemVtYmVkX0JP
T0xfX1BPSU5URVIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9CT09MRUFOLCAxLCBHX1RZUEVf
UE9JTlRFUik7Ci0gIG1vel9lbWJlZF9zaWduYWxzW0RPTV9GT0NVU19PVVRdID0KLSAgICBnX3Np
Z25hbF9uZXcoImRvbV9mb2N1c19vdXQiLAotICAgICAgICAgICAgICAgICBHX1RZUEVfRlJPTV9D
TEFTUyhrbGFzcyksCi0gICAgICAgICAgICAgICAgIEdfU0lHTkFMX1JVTl9MQVNULAotICAgICAg
ICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQoR3RrTW96RW1iZWRDbGFzcywgZG9tX2ZvY3VzX291
dCksCi0gICAgICAgICAgICAgICAgIE5VTEwsIE5VTEwsCi0gICAgICAgICAgICAgICAgIGd0a21v
emVtYmVkX0JPT0xfX1BPSU5URVIsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9CT09MRUFOLCAx
LCBHX1RZUEVfUE9JTlRFUik7Ci19Ci0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX2luaXQo
R3RrTW96RW1iZWQgKmVtYmVkKQotewotICBFbWJlZFByaXZhdGUgKnByaXYgPSBuZXcgRW1iZWRQ
cml2YXRlKCk7Ci0gIGVtYmVkLT5kYXRhID0gcHJpdjsKLSAgZ3RrX3dpZGdldF9zZXRfbmFtZShH
VEtfV0lER0VUKGVtYmVkKSwgImd0a21vemVtYmVkIik7Ci0KLSAgR1RLX1dJREdFVF9VTlNFVF9G
TEFHUyhHVEtfV0lER0VUKGVtYmVkKSwgR1RLX05PX1dJTkRPVyk7Ci19Ci0KLUd0a1dpZGdldCAq
Ci1ndGtfbW96X2VtYmVkX25ldyh2b2lkKQotewotICByZXR1cm4gR1RLX1dJREdFVChnX29iamVj
dF9uZXcoR1RLX1RZUEVfTU9aX0VNQkVELCBOVUxMKSk7Ci19Ci0KLS8vIEd0a09iamVjdCBtZXRo
b2RzCi0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX2Rlc3Ryb3koR3RrT2JqZWN0ICpvYmpl
Y3QpCi17Ci0gIEd0a01vekVtYmVkICAqZW1iZWQ7Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2
YXRlOwotICAKLSAgZ19yZXR1cm5faWZfZmFpbChvYmplY3QgIT0gTlVMTCk7Ci0gIGdfcmV0dXJu
X2lmX2ZhaWwoR1RLX0lTX01PWl9FTUJFRChvYmplY3QpKTsKLQotICBlbWJlZCA9IEdUS19NT1pf
RU1CRUQob2JqZWN0KTsKLSAgZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5k
YXRhOwotCi0gIGlmIChlbWJlZFByaXZhdGUpIHsKLQotICAgIC8vIERlc3Ryb3kgdGhlIHdpZGdl
dCBvbmx5IGlmIGl0J3MgYmVlbiBJbml0KCllZC4KLSAgICBpZihlbWJlZFByaXZhdGUtPm1Nb3pX
aW5kb3dXaWRnZXQgIT0gMCkgewotICAgICAgZW1iZWRQcml2YXRlLT5EZXN0cm95KCk7Ci0gICAg
fQotCi0gICAgZGVsZXRlIGVtYmVkUHJpdmF0ZTsKLSAgICBlbWJlZC0+ZGF0YSA9IE5VTEw7Ci0g
IH0KLX0KLQotLy8gR3RrV2lkZ2V0IG1ldGhvZHMKLQotc3RhdGljIHZvaWQKLWd0a19tb3pfZW1i
ZWRfcmVhbGl6ZShHdGtXaWRnZXQgKndpZGdldCkKLXsKLSAgR3RrTW96RW1iZWQgICAgKmVtYmVk
OwotICBFbWJlZFByaXZhdGUgICAqZW1iZWRQcml2YXRlOwotICBHZGtXaW5kb3dBdHRyICAgYXR0
cmlidXRlczsKLSAgZ2ludCAgICAgICAgICAgIGF0dHJpYnV0ZXNfbWFzazsKLSAgCi0gIGdfcmV0
dXJuX2lmX2ZhaWwod2lkZ2V0ICE9IE5VTEwpOwotICBnX3JldHVybl9pZl9mYWlsKEdUS19JU19N
T1pfRU1CRUQod2lkZ2V0KSk7Ci0KLSAgZW1iZWQgPSBHVEtfTU9aX0VNQkVEKHdpZGdldCk7Ci0g
IGVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsKLQotICBHVEtfV0lE
R0VUX1NFVF9GTEFHUyh3aWRnZXQsIEdUS19SRUFMSVpFRCk7Ci0KLSAgYXR0cmlidXRlcy53aW5k
b3dfdHlwZSA9IEdES19XSU5ET1dfQ0hJTEQ7Ci0gIGF0dHJpYnV0ZXMueCA9IHdpZGdldC0+YWxs
b2NhdGlvbi54OwotICBhdHRyaWJ1dGVzLnkgPSB3aWRnZXQtPmFsbG9jYXRpb24ueTsKLSAgYXR0
cmlidXRlcy53aWR0aCA9IHdpZGdldC0+YWxsb2NhdGlvbi53aWR0aDsKLSAgYXR0cmlidXRlcy5o
ZWlnaHQgPSB3aWRnZXQtPmFsbG9jYXRpb24uaGVpZ2h0OwotICBhdHRyaWJ1dGVzLndjbGFzcyA9
IEdES19JTlBVVF9PVVRQVVQ7Ci0gIGF0dHJpYnV0ZXMudmlzdWFsID0gZ3RrX3dpZGdldF9nZXRf
dmlzdWFsICh3aWRnZXQpOwotICBhdHRyaWJ1dGVzLmNvbG9ybWFwID0gZ3RrX3dpZGdldF9nZXRf
Y29sb3JtYXAgKHdpZGdldCk7Ci0gIGF0dHJpYnV0ZXMuZXZlbnRfbWFzayA9IGd0a193aWRnZXRf
Z2V0X2V2ZW50cyAod2lkZ2V0KSB8IEdES19FWFBPU1VSRV9NQVNLOwotCi0gIGF0dHJpYnV0ZXNf
bWFzayA9IEdES19XQV9YIHwgR0RLX1dBX1kgfCBHREtfV0FfVklTVUFMIHwgR0RLX1dBX0NPTE9S
TUFQOwotCi0gIHdpZGdldC0+d2luZG93ID0gZ2RrX3dpbmRvd19uZXcgKGd0a193aWRnZXRfZ2V0
X3BhcmVudF93aW5kb3cgKHdpZGdldCksCi0JCQkJICAgJmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXNf
bWFzayk7Ci0gIGdka193aW5kb3dfc2V0X3VzZXJfZGF0YSAod2lkZ2V0LT53aW5kb3csIGVtYmVk
KTsKLQotICB3aWRnZXQtPnN0eWxlID0gZ3RrX3N0eWxlX2F0dGFjaCAod2lkZ2V0LT5zdHlsZSwg
d2lkZ2V0LT53aW5kb3cpOwotICBndGtfc3R5bGVfc2V0X2JhY2tncm91bmQgKHdpZGdldC0+c3R5
bGUsIHdpZGdldC0+d2luZG93LCBHVEtfU1RBVEVfTk9STUFMKTsKLQotICAvLyBpbml0aWFsaXpl
IHRoZSB3aW5kb3cKLSAgbnNyZXN1bHQgcnY7Ci0gIHJ2ID0gZW1iZWRQcml2YXRlLT5Jbml0KGVt
YmVkKTsKLSAgZ19yZXR1cm5faWZfZmFpbChOU19TVUNDRUVERUQocnYpKTsKLSAgCi0gIFBSQm9v
bCBhbHJlYWR5UmVhbGl6ZWQgPSBQUl9GQUxTRTsKLSAgcnYgPSBlbWJlZFByaXZhdGUtPlJlYWxp
emUoJmFscmVhZHlSZWFsaXplZCk7Ci0gIGdfcmV0dXJuX2lmX2ZhaWwoTlNfU1VDQ0VFREVEKHJ2
KSk7Ci0KLSAgLy8gaWYgd2UncmUgYWxyZWFkeSByZWFsaXplZCB3ZSBkb24ndCBuZWVkIHRvIGhv
b2sgdXAgdG8gYW55dGhpbmcgYmVsb3cKLSAgaWYgKGFscmVhZHlSZWFsaXplZCkKLSAgICByZXR1
cm47Ci0KLSAgaWYgKGVtYmVkUHJpdmF0ZS0+bVVSSS5MZW5ndGgoKSkKLSAgICBlbWJlZFByaXZh
dGUtPkxvYWRDdXJyZW50VVJJKCk7Ci0KLSAgLy8gY29ubmVjdCB0byB0aGUgZm9jdXMgb3V0IGV2
ZW50IGZvciB0aGUgY2hpbGQKLSAgR3RrV2lkZ2V0ICpjaGlsZF93aWRnZXQgPSBHVEtfQklOKHdp
ZGdldCktPmNoaWxkOwotICBnX3NpZ25hbF9jb25uZWN0X29iamVjdChHX09CSkVDVChjaGlsZF93
aWRnZXQpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAiZm9jdXNfb3V0X2V2ZW50IiwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhoYW5kbGVfY2hpbGRfZm9jdXNfb3V0
KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgZW1iZWQsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgIEdfQ09OTkVDVF9BRlRFUik7Ci0gIGdfc2lnbmFsX2Nvbm5lY3Rfb2JqZWN0KEdfT0JK
RUNUKGNoaWxkX3dpZGdldCksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICJmb2N1c19pbl9l
dmVudCIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soaGFuZGxlX2NoaWxk
X2ZvY3VzX2luKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgZW1iZWQsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgIEdfQ09OTkVDVF9BRlRFUik7Ci19Ci0KLXN0YXRpYyB2b2lkCi1ndGtf
bW96X2VtYmVkX3VucmVhbGl6ZShHdGtXaWRnZXQgKndpZGdldCkKLXsKLSAgR3RrTW96RW1iZWQg
ICplbWJlZDsKLSAgRW1iZWRQcml2YXRlICplbWJlZFByaXZhdGU7Ci0gIAotICBnX3JldHVybl9p
Zl9mYWlsKHdpZGdldCAhPSBOVUxMKTsKLSAgZ19yZXR1cm5faWZfZmFpbChHVEtfSVNfTU9aX0VN
QkVEKHdpZGdldCkpOwotCi0gIGVtYmVkID0gR1RLX01PWl9FTUJFRCh3aWRnZXQpOwotICBlbWJl
ZFByaXZhdGUgPSAoRW1iZWRQcml2YXRlICopZW1iZWQtPmRhdGE7Ci0KLSAgaWYgKGVtYmVkUHJp
dmF0ZSkgewotICAgIGVtYmVkUHJpdmF0ZS0+VW5yZWFsaXplKCk7Ci0gIH0KLQotICBpZiAoR1RL
X1dJREdFVF9DTEFTUyhlbWJlZF9wYXJlbnRfY2xhc3MpLT51bnJlYWxpemUpCi0gICAgKCogR1RL
X1dJREdFVF9DTEFTUyhlbWJlZF9wYXJlbnRfY2xhc3MpLT51bnJlYWxpemUpKHdpZGdldCk7Ci19
Ci0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX3NpemVfYWxsb2NhdGUoR3RrV2lkZ2V0ICp3
aWRnZXQsIEd0a0FsbG9jYXRpb24gKmFsbG9jYXRpb24pCi17Ci0gIEd0a01vekVtYmVkICAqZW1i
ZWQ7Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRlOwotICAKLSAgZ19yZXR1cm5faWZfZmFp
bCh3aWRnZXQgIT0gTlVMTCk7Ci0gIGdfcmV0dXJuX2lmX2ZhaWwoR1RLX0lTX01PWl9FTUJFRCh3
aWRnZXQpKTsKLQotICBlbWJlZCA9IEdUS19NT1pfRU1CRUQod2lkZ2V0KTsKLSAgZW1iZWRQcml2
YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotICAKLSAgd2lkZ2V0LT5hbGxvY2F0
aW9uID0gKmFsbG9jYXRpb247Ci0KLSAgaWYgKEdUS19XSURHRVRfUkVBTElaRUQod2lkZ2V0KSkK
LSAgewotICAgIGdka193aW5kb3dfbW92ZV9yZXNpemUod2lkZ2V0LT53aW5kb3csCi0JCQkgICBh
bGxvY2F0aW9uLT54LCBhbGxvY2F0aW9uLT55LAotCQkJICAgYWxsb2NhdGlvbi0+d2lkdGgsIGFs
bG9jYXRpb24tPmhlaWdodCk7Ci0gICAgZW1iZWRQcml2YXRlLT5SZXNpemUoYWxsb2NhdGlvbi0+
d2lkdGgsIGFsbG9jYXRpb24tPmhlaWdodCk7Ci0gIH0KLX0KLQotc3RhdGljIHZvaWQKLWd0a19t
b3pfZW1iZWRfbWFwKEd0a1dpZGdldCAqd2lkZ2V0KQotewotICBHdGtNb3pFbWJlZCAgKmVtYmVk
OwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLSAgCi0gIGdfcmV0dXJuX2lmX2ZhaWwo
d2lkZ2V0ICE9IE5VTEwpOwotICBnX3JldHVybl9pZl9mYWlsKEdUS19JU19NT1pfRU1CRUQod2lk
Z2V0KSk7Ci0KLSAgZW1iZWQgPSBHVEtfTU9aX0VNQkVEKHdpZGdldCk7Ci0gIGVtYmVkUHJpdmF0
ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsKLQotICBHVEtfV0lER0VUX1NFVF9GTEFH
Uyh3aWRnZXQsIEdUS19NQVBQRUQpOwotCi0gIGVtYmVkUHJpdmF0ZS0+U2hvdygpOwotCi0gIGdk
a193aW5kb3dfc2hvdyh3aWRnZXQtPndpbmRvdyk7Ci0gIAotfQotCi1zdGF0aWMgdm9pZAotZ3Rr
X21vel9lbWJlZF91bm1hcChHdGtXaWRnZXQgKndpZGdldCkKLXsKLSAgR3RrTW96RW1iZWQgICpl
bWJlZDsKLSAgRW1iZWRQcml2YXRlICplbWJlZFByaXZhdGU7Ci0gIAotICBnX3JldHVybl9pZl9m
YWlsKHdpZGdldCAhPSBOVUxMKTsKLSAgZ19yZXR1cm5faWZfZmFpbChHVEtfSVNfTU9aX0VNQkVE
KHdpZGdldCkpOwotCi0gIGVtYmVkID0gR1RLX01PWl9FTUJFRCh3aWRnZXQpOwotICBlbWJlZFBy
aXZhdGUgPSAoRW1iZWRQcml2YXRlICopZW1iZWQtPmRhdGE7Ci0KLSAgR1RLX1dJREdFVF9VTlNF
VF9GTEFHUyh3aWRnZXQsIEdUS19NQVBQRUQpOwotCi0gIGdka193aW5kb3dfaGlkZSh3aWRnZXQt
PndpbmRvdyk7Ci0KLSAgZW1iZWRQcml2YXRlLT5IaWRlKCk7Ci19Ci0KLSNpZmRlZiBNT1pfQUND
RVNTSUJJTElUWV9BVEsKLXN0YXRpYyBBdGtPYmplY3QqCi1ndGtfbW96X2VtYmVkX2dldF9hY2Nl
c3NpYmxlIChHdGtXaWRnZXQgKndpZGdldCkKLXsKLSAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwod2lk
Z2V0ICE9IE5VTEwsIE5VTEwpOwotICBnX3JldHVybl92YWxfaWZfZmFpbChHVEtfSVNfTU9aX0VN
QkVEKHdpZGdldCksIE5VTEwpOwotCi0gIEd0a01vekVtYmVkICAqZW1iZWQgPSBHVEtfTU9aX0VN
QkVEKHdpZGdldCk7OwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZh
dGUgKillbWJlZC0+ZGF0YTsKLSAgcmV0dXJuIHN0YXRpY19jYXN0PEF0a09iamVjdCAqPigKLSAg
ICAgICAgICAgICAgICAgICAgICAgIGVtYmVkUHJpdmF0ZS0+R2V0QXRrT2JqZWN0Rm9yQ3VycmVu
dERvY3VtZW50KCkpOwotfQotI2VuZGlmIC8qIE1PWl9BQ0NFU1NJQklMSVRZX0FUSyAqLwotCi1z
dGF0aWMgZ2ludAotaGFuZGxlX2NoaWxkX2ZvY3VzX2luKEd0a1dpZGdldCAgICAgKmFXaWRnZXQs
Ci0JCSAgICAgIEdka0V2ZW50Rm9jdXMgKmFHZGtGb2N1c0V2ZW50LAotCQkgICAgICBHdGtNb3pF
bWJlZCAgICphRW1iZWQpCi17Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRlOwotCi0gIGVt
YmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKilhRW1iZWQtPmRhdGE7Ci0KLSAgZW1iZWRQcml2
YXRlLT5DaGlsZEZvY3VzSW4oKTsKLQotICByZXR1cm4gRkFMU0U7Ci19Ci0KLXN0YXRpYyBnaW50
Ci1oYW5kbGVfY2hpbGRfZm9jdXNfb3V0KEd0a1dpZGdldCAgICAgKmFXaWRnZXQsCi0JCSAgICAg
ICBHZGtFdmVudEZvY3VzICphR2RrRm9jdXNFdmVudCwKLQkJICAgICAgIEd0a01vekVtYmVkICAg
KmFFbWJlZCkKLXsKLSAgRW1iZWRQcml2YXRlICplbWJlZFByaXZhdGU7Ci0KLSAgZW1iZWRQcml2
YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWFFbWJlZC0+ZGF0YTsKLQotICBlbWJlZFByaXZhdGUtPkNo
aWxkRm9jdXNPdXQoKTsKLSAKLSAgcmV0dXJuIEZBTFNFOwotfQotCi0vLyBXaWRnZXQgbWV0aG9k
cwotCi12b2lkCi1ndGtfbW96X2VtYmVkX3B1c2hfc3RhcnR1cCh2b2lkKQotewotICBFbWJlZFBy
aXZhdGU6OlB1c2hTdGFydHVwKCk7Ci19Ci0KLXZvaWQKLWd0a19tb3pfZW1iZWRfcG9wX3N0YXJ0
dXAodm9pZCkKLXsKLSAgRW1iZWRQcml2YXRlOjpQb3BTdGFydHVwKCk7Ci19Ci0KLXZvaWQKLWd0
a19tb3pfZW1iZWRfc2V0X3BhdGgoY29uc3QgY2hhciAqYVBhdGgpCi17Ci0gIEVtYmVkUHJpdmF0
ZTo6U2V0UGF0aChhUGF0aCk7Ci19Ci0KLXZvaWQKLWd0a19tb3pfZW1iZWRfc2V0X2NvbXBfcGF0
aChjb25zdCBjaGFyICphUGF0aCkKLXsKLSAgRW1iZWRQcml2YXRlOjpTZXRDb21wUGF0aChhUGF0
aCk7Ci19Ci0KLXZvaWQKLWd0a19tb3pfZW1iZWRfc2V0X3Byb2ZpbGVfcGF0aChjb25zdCBjaGFy
ICphRGlyLCBjb25zdCBjaGFyICphTmFtZSkKLXsKLSAgRW1iZWRQcml2YXRlOjpTZXRQcm9maWxl
UGF0aChhRGlyLCBhTmFtZSk7Ci19Ci0KLXZvaWQKLWd0a19tb3pfZW1iZWRfc2V0X2RpcmVjdG9y
eV9zZXJ2aWNlX3Byb3ZpZGVyKG5zSURpcmVjdG9yeVNlcnZpY2VQcm92aWRlciAqYXBwRmlsZUxv
Y1Byb3ZpZGVyKSB7Ci0gIEVtYmVkUHJpdmF0ZTo6U2V0RGlyZWN0b3J5U2VydmljZVByb3ZpZGVy
KGFwcEZpbGVMb2NQcm92aWRlcik7Ci19Ci0KLXZvaWQKLWd0a19tb3pfZW1iZWRfbG9hZF91cmwo
R3RrTW96RW1iZWQgKmVtYmVkLCBjb25zdCBjaGFyICp1cmwpCi17Ci0gIEVtYmVkUHJpdmF0ZSAq
ZW1iZWRQcml2YXRlOwotICAKLSAgZ19yZXR1cm5faWZfZmFpbChlbWJlZCAhPSBOVUxMKTsKLSAg
Z19yZXR1cm5faWZfZmFpbChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSk7Ci0KLSAgZW1iZWRQcml2
YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0gIGVtYmVkUHJpdmF0ZS0+U2V0
VVJJKHVybCk7Ci0KLSAgLy8gSWYgdGhlIHdpZGdldCBpcyByZWFsaXplZCwgbG9hZCB0aGUgVVJJ
LiAgSWYgaXQgaXNuJ3QgdGhlbiB3ZQotICAvLyB3aWxsIGxvYWQgaXQgbGF0ZXIuCi0gIGlmIChH
VEtfV0lER0VUX1JFQUxJWkVEKGVtYmVkKSkKLSAgICBlbWJlZFByaXZhdGUtPkxvYWRDdXJyZW50
VVJJKCk7Ci19Ci0KLXZvaWQKLWd0a19tb3pfZW1iZWRfc3RvcF9sb2FkKEd0a01vekVtYmVkICpl
bWJlZCkKLXsKLSAgRW1iZWRQcml2YXRlICplbWJlZFByaXZhdGU7Ci0gIAotICBnX3JldHVybl9p
Zl9mYWlsKGVtYmVkICE9IE5VTEwpOwotICBnX3JldHVybl9pZl9mYWlsKEdUS19JU19NT1pfRU1C
RUQoZW1iZWQpKTsKLQotICBlbWJlZFByaXZhdGUgPSAoRW1iZWRQcml2YXRlICopZW1iZWQtPmRh
dGE7Ci0KLSAgaWYgKGVtYmVkUHJpdmF0ZS0+bU5hdmlnYXRpb24pCi0gICAgZW1iZWRQcml2YXRl
LT5tTmF2aWdhdGlvbi0+U3RvcChuc0lXZWJOYXZpZ2F0aW9uOjpTVE9QX0FMTCk7Ci19Ci0KLWdi
b29sZWFuCi1ndGtfbW96X2VtYmVkX2Nhbl9nb19iYWNrKEd0a01vekVtYmVkICplbWJlZCkKLXsK
LSAgUFJCb29sIHJldHZhbCA9IFBSX0ZBTFNFOwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0
ZTsKLQotICBnX3JldHVybl92YWxfaWZfZmFpbCAoKGVtYmVkICE9IE5VTEwpLCBGQUxTRSk7Ci0g
IGdfcmV0dXJuX3ZhbF9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSwgRkFMU0UpOwot
Ci0gIGVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsKLQotICBpZiAo
ZW1iZWRQcml2YXRlLT5tTmF2aWdhdGlvbikKLSAgICBlbWJlZFByaXZhdGUtPm1OYXZpZ2F0aW9u
LT5HZXRDYW5Hb0JhY2soJnJldHZhbCk7Ci0gIHJldHVybiByZXR2YWw7Ci19Ci0KLWdib29sZWFu
Ci1ndGtfbW96X2VtYmVkX2Nhbl9nb19mb3J3YXJkKEd0a01vekVtYmVkICplbWJlZCkKLXsKLSAg
UFJCb29sIHJldHZhbCA9IFBSX0ZBTFNFOwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsK
LQotICBnX3JldHVybl92YWxfaWZfZmFpbCAoKGVtYmVkICE9IE5VTEwpLCBGQUxTRSk7Ci0gIGdf
cmV0dXJuX3ZhbF9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSwgRkFMU0UpOwotCi0g
IGVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsKLQotICBpZiAoZW1i
ZWRQcml2YXRlLT5tTmF2aWdhdGlvbikKLSAgICBlbWJlZFByaXZhdGUtPm1OYXZpZ2F0aW9uLT5H
ZXRDYW5Hb0ZvcndhcmQoJnJldHZhbCk7Ci0gIHJldHVybiByZXR2YWw7Ci19Ci0KLXZvaWQKLWd0
a19tb3pfZW1iZWRfZ29fYmFjayhHdGtNb3pFbWJlZCAqZW1iZWQpCi17Ci0gIEVtYmVkUHJpdmF0
ZSAqZW1iZWRQcml2YXRlOwotCi0gIGdfcmV0dXJuX2lmX2ZhaWwgKGVtYmVkICE9IE5VTEwpOwot
ICBnX3JldHVybl9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSk7Ci0KLSAgZW1iZWRQ
cml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0gIGlmIChlbWJlZFByaXZh
dGUtPm1OYXZpZ2F0aW9uKQotICAgIGVtYmVkUHJpdmF0ZS0+bU5hdmlnYXRpb24tPkdvQmFjaygp
OwotfQotCi12b2lkCi1ndGtfbW96X2VtYmVkX2dvX2ZvcndhcmQoR3RrTW96RW1iZWQgKmVtYmVk
KQotewotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVybl9pZl9mYWls
IChlbWJlZCAhPSBOVUxMKTsKLSAgZ19yZXR1cm5faWZfZmFpbCAoR1RLX0lTX01PWl9FTUJFRChl
bWJlZCkpOwotCi0gIGVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsK
LQotICBpZiAoZW1iZWRQcml2YXRlLT5tTmF2aWdhdGlvbikKLSAgICBlbWJlZFByaXZhdGUtPm1O
YXZpZ2F0aW9uLT5Hb0ZvcndhcmQoKTsKLX0KLQotdm9pZAotZ3RrX21vel9lbWJlZF9yZW5kZXJf
ZGF0YShHdGtNb3pFbWJlZCAqZW1iZWQsIGNvbnN0IGNoYXIgKmRhdGEsCi0JCQkgIGd1aW50MzIg
bGVuLCBjb25zdCBjaGFyICpiYXNlX3VyaSwKLQkJCSAgY29uc3QgY2hhciAqbWltZV90eXBlKQot
ewotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVybl9pZl9mYWlsIChl
bWJlZCAhPSBOVUxMKTsKLSAgZ19yZXR1cm5faWZfZmFpbCAoR1RLX0lTX01PWl9FTUJFRChlbWJl
ZCkpOwotCi0gIGVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsKLQot
ICBlbWJlZFByaXZhdGUtPk9wZW5TdHJlYW0oYmFzZV91cmksIG1pbWVfdHlwZSk7Ci0gIGVtYmVk
UHJpdmF0ZS0+QXBwZW5kVG9TdHJlYW0oKGNvbnN0IFBSVWludDgqKWRhdGEsIGxlbik7Ci0gIGVt
YmVkUHJpdmF0ZS0+Q2xvc2VTdHJlYW0oKTsKLX0KLQotdm9pZAotZ3RrX21vel9lbWJlZF9vcGVu
X3N0cmVhbShHdGtNb3pFbWJlZCAqZW1iZWQsIGNvbnN0IGNoYXIgKmJhc2VfdXJpLAotCQkJICBj
b25zdCBjaGFyICptaW1lX3R5cGUpCi17Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRlOwot
Ci0gIGdfcmV0dXJuX2lmX2ZhaWwgKGVtYmVkICE9IE5VTEwpOwotICBnX3JldHVybl9pZl9mYWls
IChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSk7Ci0gIGdfcmV0dXJuX2lmX2ZhaWwgKEdUS19XSURH
RVRfUkVBTElaRUQoR1RLX1dJREdFVChlbWJlZCkpKTsKLQotICBlbWJlZFByaXZhdGUgPSAoRW1i
ZWRQcml2YXRlICopZW1iZWQtPmRhdGE7Ci0KLSAgZW1iZWRQcml2YXRlLT5PcGVuU3RyZWFtKGJh
c2VfdXJpLCBtaW1lX3R5cGUpOwotfQotCi12b2lkIGd0a19tb3pfZW1iZWRfYXBwZW5kX2RhdGEo
R3RrTW96RW1iZWQgKmVtYmVkLCBjb25zdCBjaGFyICpkYXRhLAotCQkJICAgICAgIGd1aW50MzIg
bGVuKQotewotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVybl9pZl9m
YWlsIChlbWJlZCAhPSBOVUxMKTsKLSAgZ19yZXR1cm5faWZfZmFpbCAoR1RLX0lTX01PWl9FTUJF
RChlbWJlZCkpOwotICBnX3JldHVybl9pZl9mYWlsIChHVEtfV0lER0VUX1JFQUxJWkVEKEdUS19X
SURHRVQoZW1iZWQpKSk7Ci0KLSAgZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVk
LT5kYXRhOwotICBlbWJlZFByaXZhdGUtPkFwcGVuZFRvU3RyZWFtKChjb25zdCBQUlVpbnQ4Kilk
YXRhLCBsZW4pOwotfQotCi12b2lkCi1ndGtfbW96X2VtYmVkX2Nsb3NlX3N0cmVhbShHdGtNb3pF
bWJlZCAqZW1iZWQpCi17Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRlOwotCi0gIGdfcmV0
dXJuX2lmX2ZhaWwgKGVtYmVkICE9IE5VTEwpOwotICBnX3JldHVybl9pZl9mYWlsIChHVEtfSVNf
TU9aX0VNQkVEKGVtYmVkKSk7Ci0gIGdfcmV0dXJuX2lmX2ZhaWwgKEdUS19XSURHRVRfUkVBTEla
RUQoR1RLX1dJREdFVChlbWJlZCkpKTsKLQotICBlbWJlZFByaXZhdGUgPSAoRW1iZWRQcml2YXRl
ICopZW1iZWQtPmRhdGE7Ci0gIGVtYmVkUHJpdmF0ZS0+Q2xvc2VTdHJlYW0oKTsKLX0KLQotY2hh
ciAqCi1ndGtfbW96X2VtYmVkX2dldF9saW5rX21lc3NhZ2UoR3RrTW96RW1iZWQgKmVtYmVkKQot
ewotICBjaGFyICpyZXR2YWwgPSBuc251bGw7Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRl
OwotCi0gIGdfcmV0dXJuX3ZhbF9pZl9mYWlsICgoZW1iZWQgIT0gTlVMTCksIChjaGFyICopTlVM
TCk7Ci0gIGdfcmV0dXJuX3ZhbF9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSwgKGNo
YXIgKilOVUxMKTsKLQotICBlbWJlZFByaXZhdGUgPSAoRW1iZWRQcml2YXRlICopZW1iZWQtPmRh
dGE7Ci0KLSAgaWYgKGVtYmVkUHJpdmF0ZS0+bVdpbmRvdykKLSAgICByZXR2YWwgPSBORVdfVE9P
TEtJVF9TVFJJTkcoZW1iZWRQcml2YXRlLT5tV2luZG93LT5tTGlua01lc3NhZ2UpOwotCi0gIHJl
dHVybiByZXR2YWw7Ci19Ci0KLWNoYXIgKgotZ3RrX21vel9lbWJlZF9nZXRfanNfc3RhdHVzKEd0
a01vekVtYmVkICplbWJlZCkKLXsKLSAgY2hhciAqcmV0dmFsID0gbnNudWxsOwotICBFbWJlZFBy
aXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVybl92YWxfaWZfZmFpbCAoKGVtYmVkICE9
IE5VTEwpLCAoY2hhciAqKU5VTEwpOwotICBnX3JldHVybl92YWxfaWZfZmFpbCAoR1RLX0lTX01P
Wl9FTUJFRChlbWJlZCksIChjaGFyICopTlVMTCk7Ci0KLSAgZW1iZWRQcml2YXRlID0gKEVtYmVk
UHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0gIGlmIChlbWJlZFByaXZhdGUtPm1XaW5kb3cpCi0g
ICAgcmV0dmFsID0gTkVXX1RPT0xLSVRfU1RSSU5HKGVtYmVkUHJpdmF0ZS0+bVdpbmRvdy0+bUpT
U3RhdHVzKTsKLQotICByZXR1cm4gcmV0dmFsOwotfQotCi1jaGFyICoKLWd0a19tb3pfZW1iZWRf
Z2V0X3RpdGxlKEd0a01vekVtYmVkICplbWJlZCkKLXsKLSAgY2hhciAqcmV0dmFsID0gbnNudWxs
OwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVybl92YWxfaWZfZmFp
bCAoKGVtYmVkICE9IE5VTEwpLCAoY2hhciAqKU5VTEwpOwotICBnX3JldHVybl92YWxfaWZfZmFp
bCAoR1RLX0lTX01PWl9FTUJFRChlbWJlZCksIChjaGFyICopTlVMTCk7Ci0KLSAgZW1iZWRQcml2
YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0gIGlmIChlbWJlZFByaXZhdGUt
Pm1XaW5kb3cpCi0gICAgcmV0dmFsID0gTkVXX1RPT0xLSVRfU1RSSU5HKGVtYmVkUHJpdmF0ZS0+
bVdpbmRvdy0+bVRpdGxlKTsKLQotICByZXR1cm4gcmV0dmFsOwotfQotCi1jaGFyICoKLWd0a19t
b3pfZW1iZWRfZ2V0X2xvY2F0aW9uKEd0a01vekVtYmVkICplbWJlZCkKLXsKLSAgY2hhciAqcmV0
dmFsID0gbnNudWxsOwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVy
bl92YWxfaWZfZmFpbCAoKGVtYmVkICE9IE5VTEwpLCAoY2hhciAqKU5VTEwpOwotICBnX3JldHVy
bl92YWxfaWZfZmFpbCAoR1RLX0lTX01PWl9FTUJFRChlbWJlZCksIChjaGFyICopTlVMTCk7Ci0K
LSAgZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotICAKLSAgaWYg
KCFlbWJlZFByaXZhdGUtPm1VUkkuSXNFbXB0eSgpKQotICAgIHJldHZhbCA9IGdfc3RyZHVwKGVt
YmVkUHJpdmF0ZS0+bVVSSS5nZXQoKSk7Ci0KLSAgcmV0dXJuIHJldHZhbDsKLX0KLQotdm9pZAot
Z3RrX21vel9lbWJlZF9yZWxvYWQoR3RrTW96RW1iZWQgKmVtYmVkLCBnaW50MzIgZmxhZ3MpCi17
Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRlOwotCi0gIGdfcmV0dXJuX2lmX2ZhaWwgKGVt
YmVkICE9IE5VTEwpOwotICBnX3JldHVybl9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVk
KSk7Ci0KLSAgZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0g
IFBSVWludDMyIHJlbG9hZEZsYWdzID0gMDsKLSAgCi0gIC8vIG1hcCB0aGUgZXh0ZXJuYWwgQVBJ
IHRvIHRoZSBpbnRlcm5hbCB3ZWIgbmF2aWdhdGlvbiBBUEkuCi0gIHN3aXRjaCAoZmxhZ3MpIHsK
LSAgY2FzZSBHVEtfTU9aX0VNQkVEX0ZMQUdfUkVMT0FETk9STUFMOgotICAgIHJlbG9hZEZsYWdz
ID0gMDsKLSAgICBicmVhazsKLSAgY2FzZSBHVEtfTU9aX0VNQkVEX0ZMQUdfUkVMT0FEQllQQVNT
Q0FDSEU6Ci0gICAgcmVsb2FkRmxhZ3MgPSBuc0lXZWJOYXZpZ2F0aW9uOjpMT0FEX0ZMQUdTX0JZ
UEFTU19DQUNIRTsKLSAgICBicmVhazsKLSAgY2FzZSBHVEtfTU9aX0VNQkVEX0ZMQUdfUkVMT0FE
QllQQVNTUFJPWFk6Ci0gICAgcmVsb2FkRmxhZ3MgPSBuc0lXZWJOYXZpZ2F0aW9uOjpMT0FEX0ZM
QUdTX0JZUEFTU19QUk9YWTsKLSAgICBicmVhazsKLSAgY2FzZSBHVEtfTU9aX0VNQkVEX0ZMQUdf
UkVMT0FEQllQQVNTUFJPWFlBTkRDQUNIRToKLSAgICByZWxvYWRGbGFncyA9IChuc0lXZWJOYXZp
Z2F0aW9uOjpMT0FEX0ZMQUdTX0JZUEFTU19QUk9YWSB8Ci0JCSAgIG5zSVdlYk5hdmlnYXRpb246
OkxPQURfRkxBR1NfQllQQVNTX0NBQ0hFKTsKLSAgICBicmVhazsKLSAgY2FzZSBHVEtfTU9aX0VN
QkVEX0ZMQUdfUkVMT0FEQ0hBUlNFVENIQU5HRToKLSAgICByZWxvYWRGbGFncyA9IG5zSVdlYk5h
dmlnYXRpb246OkxPQURfRkxBR1NfQ0hBUlNFVF9DSEFOR0U7Ci0gICAgYnJlYWs7Ci0gIGRlZmF1
bHQ6Ci0gICAgcmVsb2FkRmxhZ3MgPSAwOwotICAgIGJyZWFrOwotICB9Ci0KLSAgZW1iZWRQcml2
YXRlLT5SZWxvYWQocmVsb2FkRmxhZ3MpOwotfQotCi12b2lkCi1ndGtfbW96X2VtYmVkX3NldF9j
aHJvbWVfbWFzayhHdGtNb3pFbWJlZCAqZW1iZWQsIGd1aW50MzIgZmxhZ3MpCi17Ci0gIEVtYmVk
UHJpdmF0ZSAqZW1iZWRQcml2YXRlOwotCi0gIGdfcmV0dXJuX2lmX2ZhaWwgKGVtYmVkICE9IE5V
TEwpOwotICBnX3JldHVybl9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSk7Ci0KLSAg
ZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0gIGVtYmVkUHJp
dmF0ZS0+U2V0Q2hyb21lTWFzayhmbGFncyk7Ci19Ci0KLWd1aW50MzIKLWd0a19tb3pfZW1iZWRf
Z2V0X2Nocm9tZV9tYXNrKEd0a01vekVtYmVkICplbWJlZCkKLXsKLSAgRW1iZWRQcml2YXRlICpl
bWJlZFByaXZhdGU7Ci0KLSAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwgKChlbWJlZCAhPSBOVUxMKSwg
MCk7Ci0gIGdfcmV0dXJuX3ZhbF9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSwgMCk7
Ci0KLSAgZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAqKWVtYmVkLT5kYXRhOwotCi0gIHJl
dHVybiBlbWJlZFByaXZhdGUtPm1DaHJvbWVNYXNrOwotfQotCi12b2lkCi1ndGtfbW96X2VtYmVk
X2dldF9uc0lXZWJCcm93c2VyICAoR3RrTW96RW1iZWQgKmVtYmVkLCBuc0lXZWJCcm93c2VyICoq
cmV0dmFsKQotewotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsKLQotICBnX3JldHVybl9p
Zl9mYWlsIChlbWJlZCAhPSBOVUxMKTsKLSAgZ19yZXR1cm5faWZfZmFpbCAoR1RLX0lTX01PWl9F
TUJFRChlbWJlZCkpOwotCi0gIGVtYmVkUHJpdmF0ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+
ZGF0YTsKLSAgCi0gIGlmIChlbWJlZFByaXZhdGUtPm1XaW5kb3cpCi0gICAgZW1iZWRQcml2YXRl
LT5tV2luZG93LT5HZXRXZWJCcm93c2VyKHJldHZhbCk7Ci19Ci0KLVBSVW5pY2hhciAqCi1ndGtf
bW96X2VtYmVkX2dldF90aXRsZV91bmljaGFyIChHdGtNb3pFbWJlZCAqZW1iZWQpCi17Ci0gIFBS
VW5pY2hhciAqcmV0dmFsID0gbnNudWxsOwotICBFbWJlZFByaXZhdGUgKmVtYmVkUHJpdmF0ZTsK
LSAgICAgICAgICAgICAgICAgICAKLSAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwgKChlbWJlZCAhPSBO
VUxMKSwgKFBSVW5pY2hhciAqKU5VTEwpOwotICBnX3JldHVybl92YWxfaWZfZmFpbCAoR1RLX0lT
X01PWl9FTUJFRChlbWJlZCksIChQUlVuaWNoYXIgKilOVUxMKTsKLSAgCi0gIGVtYmVkUHJpdmF0
ZSA9IChFbWJlZFByaXZhdGUgKillbWJlZC0+ZGF0YTsKLSAgICAgICAgICAgICAgICAgICAKLSAg
aWYgKGVtYmVkUHJpdmF0ZS0+bVdpbmRvdykKLSAgICByZXR2YWwgPSBUb05ld1VuaWNvZGUoZW1i
ZWRQcml2YXRlLT5tV2luZG93LT5tVGl0bGUpOwotICAgICAgICAgICAgICAgICAgIAotICByZXR1
cm4gcmV0dmFsOwotfQotCi1QUlVuaWNoYXIgKgotZ3RrX21vel9lbWJlZF9nZXRfanNfc3RhdHVz
X3VuaWNoYXIgKEd0a01vekVtYmVkICplbWJlZCkKLXsKLSAgUFJVbmljaGFyICpyZXR2YWwgPSBu
c251bGw7Ci0gIEVtYmVkUHJpdmF0ZSAqZW1iZWRQcml2YXRlOwotICAgICAgICAgICAgICAgICAg
IAotICBnX3JldHVybl92YWxfaWZfZmFpbCAoKGVtYmVkICE9IE5VTEwpLCAoUFJVbmljaGFyICop
TlVMTCk7Ci0gIGdfcmV0dXJuX3ZhbF9pZl9mYWlsIChHVEtfSVNfTU9aX0VNQkVEKGVtYmVkKSwg
KFBSVW5pY2hhciAqKU5VTEwpOwotICAKLSAgZW1iZWRQcml2YXRlID0gKEVtYmVkUHJpdmF0ZSAq
KWVtYmVkLT5kYXRhOwotICAgICAgICAgICAgICAgICAgIAotICBpZiAoZW1iZWRQcml2YXRlLT5t
V2luZG93KQotICAgIHJldHZhbCA9IFRvTmV3VW5pY29kZShlbWJlZFByaXZhdGUtPm1XaW5kb3ct
Pm1KU1N0YXR1cyk7Ci0gICAgICAgICAgICAgICAgICAgCi0gIHJldHVybiByZXR2YWw7Ci19Ci0K
LVBSVW5pY2hhciAqCi1ndGtfbW96X2VtYmVkX2dldF9saW5rX21lc3NhZ2VfdW5pY2hhciAoR3Rr
TW96RW1iZWQgKmVtYmVkKQotewotICBQUlVuaWNoYXIgKnJldHZhbCA9IG5zbnVsbDsKLSAgRW1i
ZWRQcml2YXRlICplbWJlZFByaXZhdGU7Ci0gICAgICAgICAgICAgICAgICAgCi0gIGdfcmV0dXJu
X3ZhbF9pZl9mYWlsICgoZW1iZWQgIT0gTlVMTCksIChQUlVuaWNoYXIgKilOVUxMKTsKLSAgZ19y
ZXR1cm5fdmFsX2lmX2ZhaWwgKEdUS19JU19NT1pfRU1CRUQoZW1iZWQpLCAoUFJVbmljaGFyICop
TlVMTCk7Ci0gIAotICBlbWJlZFByaXZhdGUgPSAoRW1iZWRQcml2YXRlICopZW1iZWQtPmRhdGE7
Ci0gICAgICAgICAgICAgICAgICAgCi0gIGlmIChlbWJlZFByaXZhdGUtPm1XaW5kb3cpCi0gICAg
cmV0dmFsID0gVG9OZXdVbmljb2RlKGVtYmVkUHJpdmF0ZS0+bVdpbmRvdy0+bUxpbmtNZXNzYWdl
KTsKLSAgICAgICAgICAgICAgICAgICAKLSAgcmV0dXJuIHJldHZhbDsKLX0KLQotLy8gY2xhc3Mg
YW5kIGluc3RhbmNlIGluaXRpYWxpemF0aW9uCi0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVk
X3NpbmdsZV9jbGFzc19pbml0KEd0a01vekVtYmVkU2luZ2xlQ2xhc3MgKmtsYXNzKTsKLQotc3Rh
dGljIHZvaWQKLWd0a19tb3pfZW1iZWRfc2luZ2xlX2luaXQoR3RrTW96RW1iZWRTaW5nbGUgKmVt
YmVkKTsKLQotR3RrTW96RW1iZWRTaW5nbGUgKgotZ3RrX21vel9lbWJlZF9zaW5nbGVfbmV3KHZv
aWQpOwotCi1lbnVtIHsKLSAgTkVXX1dJTkRPV19PUlBIQU4sCi0gIFNJTkdMRV9MQVNUX1NJR05B
TAotfTsKLQotZ3VpbnQgbW96X2VtYmVkX3NpbmdsZV9zaWduYWxzW1NJTkdMRV9MQVNUX1NJR05B
TF0gPSB7IDAgfTsKLQotLy8gR3RrT2JqZWN0ICsgY2xhc3MtcmVsYXRlZCBmdW5jdGlvbnMKLQot
R1R5cGUKLWd0a19tb3pfZW1iZWRfc2luZ2xlX2dldF90eXBlKHZvaWQpCi17Ci0gIHN0YXRpYyBH
VHlwZSBtb3pfZW1iZWRfc2luZ2xlX3R5cGUgPSAwOwotICBpZiAobW96X2VtYmVkX3NpbmdsZV90
eXBlID09IDApCi0gIHsKLSAgICBjb25zdCBHVHlwZUluZm8gb3VyX2luZm8gPQotICAgIHsKLSAg
ICAgIHNpemVvZihHdGtNb3pFbWJlZENsYXNzKSwKLSAgICAgIE5VTEwsIC8qIGJhc2VfaW5pdCAq
LwotICAgICAgTlVMTCwgLyogYmFzZV9maW5hbGl6ZSAqLwotICAgICAgKEdDbGFzc0luaXRGdW5j
KWd0a19tb3pfZW1iZWRfc2luZ2xlX2NsYXNzX2luaXQsCi0gICAgICBOVUxMLAotICAgICAgTlVM
TCwgLyogY2xhc3NfZGF0YSAqLwotICAgICAgc2l6ZW9mKEd0a01vekVtYmVkKSwKLSAgICAgIDAs
IC8qIG5fcHJlYWxsb2NzICovCi0gICAgICAoR0luc3RhbmNlSW5pdEZ1bmMpZ3RrX21vel9lbWJl
ZF9zaW5nbGVfaW5pdCwKLSAgICB9OwotCi0gICAgbW96X2VtYmVkX3NpbmdsZV90eXBlID0gZ190
eXBlX3JlZ2lzdGVyX3N0YXRpYyhHVEtfVFlQRV9PQkpFQ1QsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiR3RrTW96RW1iZWRTaW5nbGUiLAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm91cl9pbmZv
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKEdU
eXBlRmxhZ3MpMCk7Ci0gIH0KLQotICByZXR1cm4gbW96X2VtYmVkX3NpbmdsZV90eXBlOwotfQot
Ci1zdGF0aWMgdm9pZAotZ3RrX21vel9lbWJlZF9zaW5nbGVfY2xhc3NfaW5pdChHdGtNb3pFbWJl
ZFNpbmdsZUNsYXNzICprbGFzcykKLXsKLSAgR3RrT2JqZWN0Q2xhc3MgICAgICpvYmplY3RfY2xh
c3M7Ci0KLSAgb2JqZWN0X2NsYXNzICAgID0gR1RLX09CSkVDVF9DTEFTUyhrbGFzcyk7Ci0KLSAg
Ly8gc2V0IHVwIG91ciBzaWduYWxzCi0KLSAgbW96X2VtYmVkX3NpbmdsZV9zaWduYWxzW05FV19X
SU5ET1dfT1JQSEFOXSA9Ci0gICAgZ19zaWduYWxfbmV3KCJuZXdfd2luZG93X29ycGhhbiIsCi0g
ICAgICAgICAgICAgICAgIEdfVFlQRV9GUk9NX0NMQVNTKGtsYXNzKSwKLSAgICAgICAgICAgICAg
ICAgR19TSUdOQUxfUlVOX0ZJUlNULAotICAgICAgICAgICAgICAgICBHX1NUUlVDVF9PRkZTRVQo
R3RrTW96RW1iZWRTaW5nbGVDbGFzcywgbmV3X3dpbmRvd19vcnBoYW4pLAotICAgICAgICAgICAg
ICAgICBOVUxMLCBOVUxMLAotICAgICAgICAgICAgICAgICBndGttb3plbWJlZF9WT0lEX19QT0lO
VEVSX1VJTlQsCi0gICAgICAgICAgICAgICAgIEdfVFlQRV9OT05FLCAyLCBHX1RZUEVfUE9JTlRF
UiwgR19UWVBFX1VJTlQpOwotCi19Ci0KLXN0YXRpYyB2b2lkCi1ndGtfbW96X2VtYmVkX3Npbmds
ZV9pbml0KEd0a01vekVtYmVkU2luZ2xlICplbWJlZCkKLXsKLSAgLy8gdGhpcyBpcyBhIHBsYWNl
aG9sZGVyIGZvciBsYXRlciBpbiBjYXNlIHdlIG5lZWQgdG8gc3Rhc2ggZGF0YSBhdAotICAvLyBh
IGxhdGVyIGRhdGEgYW5kIG1haW50YWluIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LgotICBlbWJl
ZC0+ZGF0YSA9IG5zbnVsbDsKLX0KLQotR3RrTW96RW1iZWRTaW5nbGUgKgotZ3RrX21vel9lbWJl
ZF9zaW5nbGVfbmV3KHZvaWQpCi17Ci0gIHJldHVybiAoR3RrTW96RW1iZWRTaW5nbGUgKilnX29i
amVjdF9uZXcoR1RLX1RZUEVfTU9aX0VNQkVEX1NJTkdMRSwgTlVMTCk7Ci19Ci0KLUd0a01vekVt
YmVkU2luZ2xlICoKLWd0a19tb3pfZW1iZWRfc2luZ2xlX2dldCh2b2lkKQotewotICBzdGF0aWMg
R3RrTW96RW1iZWRTaW5nbGUgKnNpbmdsZXRvbl9vYmplY3QgPSBuc251bGw7Ci0gIGlmICghc2lu
Z2xldG9uX29iamVjdCkKLSAgewotICAgIHNpbmdsZXRvbl9vYmplY3QgPSBndGtfbW96X2VtYmVk
X3NpbmdsZV9uZXcoKTsKLSAgfQotCi0gIHJldHVybiBzaW5nbGV0b25fb2JqZWN0OwotfQotCi0v
LyBvdXIgY2FsbGJhY2sgZnJvbSB0aGUgd2luZG93IGNyZWF0b3Igc2VydmljZQotdm9pZAotZ3Rr
X21vel9lbWJlZF9zaW5nbGVfY3JlYXRlX3dpbmRvdyhHdGtNb3pFbWJlZCAqKmFOZXdFbWJlZCwK
LQkJCQkgICBndWludCAgICAgICAgIGFDaHJvbWVGbGFncykKLXsKLSAgR3RrTW96RW1iZWRTaW5n
bGUgKnNpbmdsZSA9IGd0a19tb3pfZW1iZWRfc2luZ2xlX2dldCgpOwotCi0gICphTmV3RW1iZWQg
PSBuc251bGw7Ci0KLSAgaWYgKCFzaW5nbGUpCi0gICAgcmV0dXJuOwotCi0gIGdfc2lnbmFsX2Vt
aXQoR19PQkpFQ1Qoc2luZ2xlKSwKLSAgICAgICAgICAgICAgICBtb3pfZW1iZWRfc2luZ2xlX3Np
Z25hbHNbTkVXX1dJTkRPV19PUlBIQU5dLCAwLAotICAgICAgICAgICAgICAgIGFOZXdFbWJlZCwg
YUNocm9tZUZsYWdzKTsKLQotfQpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Ny
Yy9ndGttb3plbWJlZF9nbHVlLmNwcCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay9zcmMvZ3RrbW96
ZW1iZWRfZ2x1ZS5jcHAKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Ci0tLSBhL2VtYmVkZGluZy9i
cm93c2VyL2d0ay9zcmMvZ3RrbW96ZW1iZWRfZ2x1ZS5jcHAKKysrIC9kZXYvbnVsbApAQCAtMSwx
MTYgKzAsMCBAQAotLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lv
bjogTVBMIDEuMS9HUEwgMi4wL0xHUEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMg
ZmlsZSBhcmUgc3ViamVjdCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0g
KiAxLjEgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBp
biBjb21wbGlhbmNlIHdpdGgKLSAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkg
b2YgdGhlIExpY2Vuc2UgYXQKLSAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAq
IFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9u
IGFuICJBUyBJUyIgYmFzaXMsCi0gKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRo
ZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lm
aWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0g
KiBMaWNlbnNlLgotICoKLSAqIFRoZSBPcmlnaW5hbCBDb2RlIGlzIE1vemlsbGEgZW1iZWRkaW5n
LgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBpcwot
ICogQmVuamFtaW4gU21lZGJlcmcgPGJlbmphbWluQHNtZWRiZXJncy51cz4uCi0gKgotICogUG9y
dGlvbnMgY3JlYXRlZCBieSB0aGUgSW5pdGlhbCBEZXZlbG9wZXIgYXJlIENvcHlyaWdodCAoQykg
MjAwNQotICogdGhlIE1vemlsbGEgRm91bmRhdGlvbiA8aHR0cDovL3d3dy5tb3ppbGxhLm9yZy8+
LiBBbGwgUmlnaHRzIFJlc2VydmVkLgotICoKLSAqIENvbnRyaWJ1dG9yKHMpOgotICoKLSAqIEFs
dGVybmF0aXZlbHksIHRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgbWF5IGJlIHVzZWQgdW5kZXIg
dGhlIHRlcm1zIG9mCi0gKiBlaXRoZXIgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZl
cnNpb24gMiBvciBsYXRlciAodGhlICJHUEwiKSwgb3IKLSAqIHRoZSBHTlUgTGVzc2VyIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyLjEgb3IgbGF0ZXIgKHRoZSAiTEdQTCIpLAotICog
aW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlzaW9ucyBvZiB0aGUgR1BMIG9yIHRoZSBMR1BMIGFyZSBh
cHBsaWNhYmxlIGluc3RlYWQKLSAqIG9mIHRob3NlIGFib3ZlLiBJZiB5b3Ugd2lzaCB0byBhbGxv
dyB1c2Ugb2YgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSBvbmx5Ci0gKiB1bmRlciB0aGUgdGVy
bXMgb2YgZWl0aGVyIHRoZSBHUEwgb3IgdGhlIExHUEwsIGFuZCBub3QgdG8gYWxsb3cgb3RoZXJz
IHRvCi0gKiB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlciB0aGUgdGVybXMgb2Yg
dGhlIE1QTCwgaW5kaWNhdGUgeW91cgotICogZGVjaXNpb24gYnkgZGVsZXRpbmcgdGhlIHByb3Zp
c2lvbnMgYWJvdmUgYW5kIHJlcGxhY2UgdGhlbSB3aXRoIHRoZSBub3RpY2UKLSAqIGFuZCBvdGhl
ciBwcm92aXNpb25zIHJlcXVpcmVkIGJ5IHRoZSBHUEwgb3IgdGhlIExHUEwuIElmIHlvdSBkbyBu
b3QgZGVsZXRlCi0gKiB0aGUgcHJvdmlzaW9ucyBhYm92ZSwgYSByZWNpcGllbnQgbWF5IHVzZSB5
b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyCi0gKiB0aGUgdGVybXMgb2YgYW55IG9uZSBv
ZiB0aGUgTVBMLCB0aGUgR1BMIG9yIHRoZSBMR1BMLgotICoKLSAqICoqKioqIEVORCBMSUNFTlNF
IEJMT0NLICoqKioqICovCi0KLS8vIFRoaXMgZmlsZSBpcyBhbiBpbXBsZW1lbnRhdGlvbiBmaWxl
LCBtZWFudCB0byBiZSAjaW5jbHVkZWQgaW4gYQotLy8gc2luZ2xlIEMrKyBmaWxlIG9mIGFuIGVt
YmVkZGluZyBhcHBsaWNhdGlvbi4gSXQgaXMgY2FsbGVkIGFmdGVyCi0vLyBYUENPTUdsdWVTdGFy
dHVwIHRvIGdsdWUgdGhlIGd0a21vemVtYmVkIGZ1bmN0aW9ucy4KLQotI2luY2x1ZGUgImd0a21v
emVtYmVkLmgiCi0jaW5jbHVkZSAiZ3RrbW96ZW1iZWRfaW50ZXJuYWwuaCIKLSNpbmNsdWRlICJu
c1hQQ09NR2x1ZS5oIgotCi0jaWZuZGVmIFhQQ09NX0dMVUUKLSNlcnJvciBUaGlzIGZpbGUgb25s
eSBtYWtlcyBzZW5zZSB3aGVuIFhQQ09NX0dMVUUgaXMgZGVmaW5lZC4KLSNlbmRpZgotCi0jZGVm
aW5lIEdUS01PWkVNQkVEX0ZVTkNUSU9OUyBcCi0gIEdUS0YoZ3RrX21vel9lbWJlZF9nZXRfdHlw
ZSkgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfbmV3KSBcCi0gIEdUS0YoZ3RrX21vel9lbWJlZF9w
dXNoX3N0YXJ0dXApIFwKLSAgR1RLRihndGtfbW96X2VtYmVkX3BvcF9zdGFydHVwKSBcCi0gIEdU
S0YoZ3RrX21vel9lbWJlZF9zZXRfcGF0aCkgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfc2V0X2Nv
bXBfcGF0aCkgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfc2V0X3Byb2ZpbGVfcGF0aCkgXAotICBH
VEtGKGd0a19tb3pfZW1iZWRfbG9hZF91cmwpIFwKLSAgR1RLRihndGtfbW96X2VtYmVkX3N0b3Bf
bG9hZCkgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfY2FuX2dvX2JhY2spIFwKLSAgR1RLRihndGtf
bW96X2VtYmVkX2Nhbl9nb19mb3J3YXJkKSBcCi0gIEdUS0YoZ3RrX21vel9lbWJlZF9nb19iYWNr
KSBcCi0gIEdUS0YoZ3RrX21vel9lbWJlZF9nb19mb3J3YXJkKSBcCi0gIEdUS0YoZ3RrX21vel9l
bWJlZF9yZW5kZXJfZGF0YSkgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfb3Blbl9zdHJlYW0pIFwK
LSAgR1RLRihndGtfbW96X2VtYmVkX2FwcGVuZF9kYXRhKSBcCi0gIEdUS0YoZ3RrX21vel9lbWJl
ZF9jbG9zZV9zdHJlYW0pIFwKLSAgR1RLRihndGtfbW96X2VtYmVkX2dldF9saW5rX21lc3NhZ2Up
IFwKLSAgR1RLRihndGtfbW96X2VtYmVkX2dldF9qc19zdGF0dXMpIFwKLSAgR1RLRihndGtfbW96
X2VtYmVkX2dldF90aXRsZSkgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfZ2V0X2xvY2F0aW9uKSBc
Ci0gIEdUS0YoZ3RrX21vel9lbWJlZF9yZWxvYWQpIFwKLSAgR1RLRihndGtfbW96X2VtYmVkX3Nl
dF9jaHJvbWVfbWFzaykgXAotICBHVEtGKGd0a19tb3pfZW1iZWRfZ2V0X2Nocm9tZV9tYXNrKSBc
Ci0gIEdUS0YoZ3RrX21vel9lbWJlZF9zaW5nbGVfZ2V0X3R5cGUpIFwKLSAgR1RLRihndGtfbW96
X2VtYmVkX3NpbmdsZV9nZXQpCi0KLSNkZWZpbmUgR1RLTU9aRU1CRURfRlVOQ1RJT05TX0lOVEVS
TkFMIFwKLSAgR1RLRihndGtfbW96X2VtYmVkX2dldF9uc0lXZWJCcm93c2VyKSBcCi0gIEdUS0Yo
Z3RrX21vel9lbWJlZF9nZXRfdGl0bGVfdW5pY2hhcikgXAotICBHVEtGKGd0a19tb3pfZW1iZWRf
Z2V0X2pzX3N0YXR1c191bmljaGFyKSBcCi0gIEdUS0YoZ3RrX21vel9lbWJlZF9nZXRfbGlua19t
ZXNzYWdlX3VuaWNoYXIpIFwKLSAgR1RLRihndGtfbW96X2VtYmVkX3NldF9kaXJlY3Rvcnlfc2Vy
dmljZV9wcm92aWRlcikKLQotI2RlZmluZSBHVEtGKGZuYW1lKSBmbmFtZSMjVHlwZSBmbmFtZTsK
LQotR1RLTU9aRU1CRURfRlVOQ1RJT05TCi1HVEtNT1pFTUJFRF9GVU5DVElPTlNfSU5URVJOQUwK
LQotI3VuZGVmIEdUS0YKLQotI2RlZmluZSBHVEtGKGZuYW1lKSB7ICNmbmFtZSwgKE5TRnVuY1B0
ciopICZmbmFtZSB9LAotCi1zdGF0aWMgY29uc3QgbnNEeW5hbWljRnVuY3Rpb25Mb2FkIEd0a1N5
bWJvbHNbXSA9IHsKLUdUS01PWkVNQkVEX0ZVTkNUSU9OUwotICB7IG5zbnVsbCwgbnNudWxsIH0K
LX07Ci0KLXN0YXRpYyBjb25zdCBuc0R5bmFtaWNGdW5jdGlvbkxvYWQgR3RrU3ltYm9sc0ludGVy
bmFsW10gPSB7Ci1HVEtNT1pFTUJFRF9GVU5DVElPTlNfSU5URVJOQUwKLSAgeyBuc251bGwsIG5z
bnVsbCB9Ci19OwotI3VuZGVmIEdUS0YKLQotc3RhdGljIG5zcmVzdWx0Ci1HVEtFbWJlZEdsdWVT
dGFydHVwKCkKLXsKLSAgcmV0dXJuIFhQQ09NR2x1ZUxvYWRYVUxGdW5jdGlvbnMoR3RrU3ltYm9s
cyk7Ci19Ci0KLXN0YXRpYyBuc3Jlc3VsdAotR1RLRW1iZWRHbHVlU3RhcnR1cEludGVybmFsKCkK
LXsKLSAgcmV0dXJuIFhQQ09NR2x1ZUxvYWRYVUxGdW5jdGlvbnMoR3RrU3ltYm9sc0ludGVybmFs
KTsKLX0KLQpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9ndGttb3plbWJl
ZF9pbnRlcm5hbC5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9ndGttb3plbWJlZF9pbnRl
cm5hbC5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9n
dGsvc3JjL2d0a21vemVtYmVkX2ludGVybmFsLmgKKysrIC9kZXYvbnVsbApAQCAtMSw3MCArMCww
IEBACi0vKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCi0gKiBWZXJzaW9uOiBNUEwg
MS4xL0dQTCAyLjAvTEdQTCAyLjEKLSAqCi0gKiBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFy
ZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KLSAqIDEuMSAo
dGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs
aWFuY2Ugd2l0aAotICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUg
TGljZW5zZSBhdAotICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCi0gKgotICogU29mdHdh
cmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFT
IElTIiBiYXNpcywKLSAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHBy
ZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZQotICogZm9yIHRoZSBzcGVjaWZpYyBsYW5n
dWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKLSAqIExpY2Vu
c2UuCi0gKgotICogVGhlIE9yaWdpbmFsIENvZGUgaXMgbW96aWxsYS5vcmcgY29kZS4KLSAqCi0g
KiBUaGUgSW5pdGlhbCBEZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMKLSAqIENocmlz
dG9waGVyIEJsaXp6YXJkLgotICogUG9ydGlvbnMgY3JlYXRlZCBieSB0aGUgSW5pdGlhbCBEZXZl
bG9wZXIgYXJlIENvcHlyaWdodCAoQykgMjAwMQotICogdGhlIEluaXRpYWwgRGV2ZWxvcGVyLiBB
bGwgUmlnaHRzIFJlc2VydmVkLgotICoKLSAqIENvbnRyaWJ1dG9yKHMpOgotICogICBDaHJpc3Rv
cGhlciBCbGl6emFyZCA8YmxpenphcmRAbW96aWxsYS5vcmc+Ci0gKgotICogQWx0ZXJuYXRpdmVs
eSwgdGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBtYXkgYmUgdXNlZCB1bmRlciB0aGUgdGVybXMg
b2YKLSAqIGVpdGhlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyIG9y
IGxhdGVyICh0aGUgIkdQTCIpLCBvcgotICogdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBWZXJzaW9uIDIuMSBvciBsYXRlciAodGhlICJMR1BMIiksCi0gKiBpbiB3aGljaCBj
YXNlIHRoZSBwcm92aXNpb25zIG9mIHRoZSBHUEwgb3IgdGhlIExHUEwgYXJlIGFwcGxpY2FibGUg
aW5zdGVhZAotICogb2YgdGhvc2UgYWJvdmUuIElmIHlvdSB3aXNoIHRvIGFsbG93IHVzZSBvZiB5
b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIG9ubHkKLSAqIHVuZGVyIHRoZSB0ZXJtcyBvZiBlaXRo
ZXIgdGhlIEdQTCBvciB0aGUgTEdQTCwgYW5kIG5vdCB0byBhbGxvdyBvdGhlcnMgdG8KLSAqIHVz
ZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgTVBMLCBp
bmRpY2F0ZSB5b3VyCi0gKiBkZWNpc2lvbiBieSBkZWxldGluZyB0aGUgcHJvdmlzaW9ucyBhYm92
ZSBhbmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIG5vdGljZQotICogYW5kIG90aGVyIHByb3Zpc2lv
bnMgcmVxdWlyZWQgYnkgdGhlIEdQTCBvciB0aGUgTEdQTC4gSWYgeW91IGRvIG5vdCBkZWxldGUK
LSAqIHRoZSBwcm92aXNpb25zIGFib3ZlLCBhIHJlY2lwaWVudCBtYXkgdXNlIHlvdXIgdmVyc2lv
biBvZiB0aGlzIGZpbGUgdW5kZXIKLSAqIHRoZSB0ZXJtcyBvZiBhbnkgb25lIG9mIHRoZSBNUEws
IHRoZSBHUEwgb3IgdGhlIExHUEwuCi0gKgotICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioq
KiogKi8KLQotI2lmbmRlZiBndGttb3plbWJlZF9pbnRlcm5hbF9oCi0jZGVmaW5lIGd0a21vemVt
YmVkX2ludGVybmFsX2gKLQotI2luY2x1ZGUgIm5zSVdlYkJyb3dzZXIuaCIKLSNpbmNsdWRlICJu
c1hQQ09NLmgiCi0KLXN0cnVjdCBuc01vZHVsZUNvbXBvbmVudEluZm87Ci0KLSNpZmRlZiBfX2Nw
bHVzcGx1cwotZXh0ZXJuICJDIiB7Ci0jZW5kaWYgLyogX19jcGx1c3BsdXMgKi8KLQotR1RLTU9a
RU1CRURfQVBJKHZvaWQsCi0gIGd0a19tb3pfZW1iZWRfZ2V0X25zSVdlYkJyb3dzZXIsIChHdGtN
b3pFbWJlZCAqZW1iZWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuc0lX
ZWJCcm93c2VyICoqcmV0dmFsKSkKLUdUS01PWkVNQkVEX0FQSShQUlVuaWNoYXIqLAotICBndGtf
bW96X2VtYmVkX2dldF90aXRsZV91bmljaGFyLCAoR3RrTW96RW1iZWQgKmVtYmVkKSkKLQotR1RL
TU9aRU1CRURfQVBJKFBSVW5pY2hhciosCi0gIGd0a19tb3pfZW1iZWRfZ2V0X2pzX3N0YXR1c191
bmljaGFyLCAoR3RrTW96RW1iZWQgKmVtYmVkKSkKLQotR1RLTU9aRU1CRURfQVBJKFBSVW5pY2hh
ciosCi0gIGd0a19tb3pfZW1iZWRfZ2V0X2xpbmtfbWVzc2FnZV91bmljaGFyLCAoR3RrTW96RW1i
ZWQgKmVtYmVkKSkKLQotR1RLTU9aRU1CRURfQVBJKHZvaWQsCi0gIGd0a19tb3pfZW1iZWRfc2V0
X2RpcmVjdG9yeV9zZXJ2aWNlX3Byb3ZpZGVyLCAobnNJRGlyZWN0b3J5U2VydmljZVByb3ZpZGVy
ICphcHBGaWxlTG9jUHJvdmlkZXIpKQotCi0jaWZkZWYgX19jcGx1c3BsdXMKLX0KLSNlbmRpZiAv
KiBfX2NwbHVzcGx1cyAqLwotCi0jZW5kaWYgLyogZ3RrbW96ZW1iZWRfaW50ZXJuYWxfaCAqLwot
CmRpZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3JjL2d0a21vemVtYmVkbWFyc2hh
bC5saXN0IGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9ndGttb3plbWJlZG1hcnNoYWwubGlz
dApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Ny
Yy9ndGttb3plbWJlZG1hcnNoYWwubGlzdAorKysgL2Rldi9udWxsCkBAIC0xLDM0ICswLDAgQEAK
LUJPT0w6U1RSSU5HCi1CT09MOlNUUklORyxTVFJJTkcKLUJPT0w6U1RSSU5HLFNUUklORyxQT0lO
VEVSCi1CT09MOlNUUklORyxTVFJJTkcsUE9JTlRFUixJTlQKLUJPT0w6U1RSSU5HLFNUUklORyxQ
T0lOVEVSLFBPSU5URVIsU1RSSU5HLFBPSU5URVIKLUJPT0w6U1RSSU5HLFNUUklORyxQT0lOVEVS
LFNUUklORyxQT0lOVEVSCi1CT09MOlNUUklORyxTVFJJTkcsU1RSSU5HLFBPSU5URVIKLUlOVDpT
VFJJTkcsSU5ULElOVCxJTlQsSU5ULElOVAotSU5UOlNUUklORyxTVFJJTkcsSU5ULElOVCxJTlQs
SU5UCi1JTlQ6U1RSSU5HLFNUUklORyxVSU5ULFNUUklORyxTVFJJTkcsU1RSSU5HLFNUUklORyxQ
T0lOVEVSCi1JTlQ6Vk9JRAotU1RSSU5HOlNUUklORyxTVFJJTkcKLVZPSUQ6Qk9PTAotVk9JRDpJ
TlQsSU5UCi1WT0lEOklOVCxJTlQsQk9PTAotVk9JRDpJTlQsU1RSSU5HCi1WT0lEOklOVCxTVFJJ
TkcsU1RSSU5HCi1WT0lEOklOVCxVSU5UCi1WT0lEOlBPSU5URVIsSU5ULFBPSU5URVIKLVZPSUQ6
UE9JTlRFUixJTlQsU1RSSU5HLFNUUklORyxTVFJJTkcsU1RSSU5HLFNUUklORyxCT09MRUFOLElO
VAotVk9JRDpQT0lOVEVSLFNUUklORyxCT09MLEJPT0wKLVZPSUQ6U1RSSU5HLElOVCxJTlQKLVZP
SUQ6U1RSSU5HLElOVCxVSU5UCi1WT0lEOlNUUklORyxTVFJJTkcKLVZPSUQ6U1RSSU5HLFNUUklO
RyxQT0lOVEVSCi1WT0lEOlNUUklORyxTVFJJTkcsU1RSSU5HLFVMT05HLElOVAotVk9JRDpTVFJJ
TkcsU1RSSU5HLFNUUklORyxQT0lOVEVSCi1WT0lEOlVJTlQsSU5ULElOVCxTVFJJTkcsU1RSSU5H
LFNUUklORyxTVFJJTkcKLVZPSUQ6VUxPTkcsVUxPTkcsVUxPTkcKLVZPSUQ6UE9JTlRFUixVSU5U
Ci1CT09MOlBPSU5URVIsVUlOVAotQk9PTDpQT0lOVEVSCi1WT0lEOlBPSU5URVIKLUJPT0w6U1RS
SU5HLFNUUklORyxQT0lOVEVSCmRpZmYgLS1naXQgYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvc3Jj
L2d0a21vemVtYmVkcHJpdmF0ZS5oIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9ndGttb3pl
bWJlZHByaXZhdGUuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jy
b3dzZXIvZ3RrL3NyYy9ndGttb3plbWJlZHByaXZhdGUuaAorKysgL2Rldi9udWxsCkBAIC0xLDkx
ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKLSAqIFZlcnNpb246
IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZp
bGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbgotICog
MS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4g
Y29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9m
IHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8KLSAqCi0gKiBT
b2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBh
biAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVy
IGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCi0gKiBmb3IgdGhlIHNwZWNpZmlj
IGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQotICog
TGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBtb3ppbGxhLm9yZyBjb2RlLgot
ICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBpcwotICog
Q2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFs
IERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAxCi0gKiB0aGUgSW5pdGlhbCBEZXZlbG9w
ZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICogQ29udHJpYnV0b3Iocyk6Ci0gKiAgIENo
cmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3ppbGxhLm9yZz4KLSAqCi0gKiBBbHRlcm5h
dGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0
ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9u
IDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVyICh0aGUgIkxHUEwiKSwKLSAqIGluIHdo
aWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGlj
YWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4gSWYgeW91IHdpc2ggdG8gYWxsb3cgdXNl
IG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25seQotICogdW5kZXIgdGhlIHRlcm1zIG9m
IGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQgbm90IHRvIGFsbG93IG90aGVycyB0bwot
ICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBN
UEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5IGRlbGV0aW5nIHRoZSBwcm92aXNpb25z
IGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUgbm90aWNlCi0gKiBhbmQgb3RoZXIgcHJv
dmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRoZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRl
bGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVjaXBpZW50IG1heSB1c2UgeW91ciB2
ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhlIHRlcm1zIG9mIGFueSBvbmUgb2YgdGhl
IE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9D
SyAqKioqKiAqLwotCi0jaWZuZGVmIGd0a21vemVtYmVkcHJpdmF0ZV9oCi0jZGVmaW5lIGd0a21v
emVtYmVkcHJpdmF0ZV9oCi0KLSNpZmRlZiBfX2NwbHVzcGx1cwotZXh0ZXJuICJDIiB7Ci0jZW5k
aWYgLyogX19jcGx1c3BsdXMgKi8KLQotI2luY2x1ZGUgImd0a21vemVtYmVkLmgiCi0KLS8qIHNp
Z25hbHMgKi8KLQotZW51bSB7Ci0gIExJTktfTUVTU0FHRSwKLSAgSlNfU1RBVFVTLAotICBMT0NB
VElPTiwKLSAgVElUTEUsCi0gIFBST0dSRVNTLAotICBQUk9HUkVTU19BTEwsCi0gIE5FVF9TVEFU
RSwKLSAgTkVUX1NUQVRFX0FMTCwKLSAgTkVUX1NUQVJULAotICBORVRfU1RPUCwKLSAgTkVXX1dJ
TkRPVywKLSAgVklTSUJJTElUWSwKLSAgREVTVFJPWV9CUk9XU0VSLAotICBPUEVOX1VSSSwKLSAg
U0laRV9UTywKLSAgRE9NX0tFWV9ET1dOLAotICBET01fS0VZX1BSRVNTLAotICBET01fS0VZX1VQ
LAotICBET01fTU9VU0VfRE9XTiwKLSAgRE9NX01PVVNFX1VQLAotICBET01fTU9VU0VfQ0xJQ0ss
Ci0gIERPTV9NT1VTRV9EQkxfQ0xJQ0ssCi0gIERPTV9NT1VTRV9PVkVSLAotICBET01fTU9VU0Vf
T1VULAotICBTRUNVUklUWV9DSEFOR0UsCi0gIFNUQVRVU19DSEFOR0UsCi0gIERPTV9BQ1RJVkFU
RSwKLSAgRE9NX0ZPQ1VTX0lOLAotICBET01fRk9DVVNfT1VULAotICBFTUJFRF9MQVNUX1NJR05B
TAotfTsKLQotZXh0ZXJuIGd1aW50IG1vel9lbWJlZF9zaWduYWxzW0VNQkVEX0xBU1RfU0lHTkFM
XTsKLQotZXh0ZXJuIHZvaWQgZ3RrX21vel9lbWJlZF9zaW5nbGVfY3JlYXRlX3dpbmRvdyhHdGtN
b3pFbWJlZCAqKmFOZXdFbWJlZCwKLQkJCQkJICAgICAgIGd1aW50IGFDaHJvbWVGbGFncyk7Ci0K
LSNpZmRlZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmIC8qIF9fY3BsdXNwbHVzICovCi0KLSNlbmRp
ZiAvKiBndGttb3plbWJlZHByaXZhdGVfaCAqLwpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dz
ZXIvZ3RrL3Rlc3RzL01ha2VmaWxlLmluIGIvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Rlc3RzL01h
a2VmaWxlLmluCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nl
ci9ndGsvdGVzdHMvTWFrZWZpbGUuaW4KKysrIC9kZXYvbnVsbApAQCAtMSwxMDEgKzAsMCBAQAot
IyAKLSMgKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotIyBWZXJzaW9uOiBNUEwgMS4x
L0dQTCAyLjAvTEdQTCAyLjEKLSMKLSMgVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3Vi
amVjdCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0jIDEuMSAodGhlICJM
aWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug
d2l0aAotIyB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNl
IGF0Ci0jIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotIwotIyBTb2Z0d2FyZSBkaXN0cmli
dXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lz
LAotIyBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBs
aWVkLiBTZWUgdGhlIExpY2Vuc2UKLSMgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5p
bmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKLSMgTGljZW5zZS4KLSMKLSMgVGhl
IE9yaWdpbmFsIENvZGUgaXMgdGhlIE1vemlsbGEgYnJvd3Nlci4KLSMKLSMgVGhlIEluaXRpYWwg
RGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0jIENocmlzdG9waGVyIEJsaXp6YXJk
LgotIyBQb3J0aW9ucyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJp
Z2h0IChDKSAxOTk5Ci0jIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZl
ZC4KLSMKLSMgQ29udHJpYnV0b3Iocyk6Ci0jICAgQ2hyaXN0b3BoZXIgQmxpenphcmQgPGJsaXp6
YXJkQG1vemlsbGEub3JnPgotIwotIyBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhp
cyBmaWxlIG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotIyBlaXRoZXIgdGhlIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAodGhlICJHUEwiKSwgb3IK
LSMgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIuMSBvciBs
YXRlciAodGhlICJMR1BMIiksCi0jIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhl
IEdQTCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0jIG9mIHRob3NlIGFib3Zl
LiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSBv
bmx5Ci0jIHVuZGVyIHRoZSB0ZXJtcyBvZiBlaXRoZXIgdGhlIEdQTCBvciB0aGUgTEdQTCwgYW5k
IG5vdCB0byBhbGxvdyBvdGhlcnMgdG8KLSMgdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSMgZGVjaXNpb24gYnkg
ZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJlcGxhY2UgdGhlbSB3aXRoIHRoZSBu
b3RpY2UKLSMgYW5kIG90aGVyIHByb3Zpc2lvbnMgcmVxdWlyZWQgYnkgdGhlIEdQTCBvciB0aGUg
TEdQTC4gSWYgeW91IGRvIG5vdCBkZWxldGUKLSMgdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEgcmVj
aXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotIyB0aGUgdGVy
bXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BMIG9yIHRoZSBMR1BMLgotIwotIyAqKioq
KiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKgotCi1ERVBUSAkJPSAuLi8uLi8uLi8uLgotdG9wc3Jj
ZGlyCT0gQHRvcF9zcmNkaXJACi1zcmNkaXIJCT0gQHNyY2RpckAKLVZQQVRICQk9IEBzcmNkaXJA
Ci0KLWluY2x1ZGUgJChERVBUSCkvY29uZmlnL2F1dG9jb25mLm1rCi0KLU1PRFVMRQkJPSBndGtl
bWJlZG1vegotCi1DUFBTUkNTICAgICAgICAgPSBcCi0JCVRlc3RHdGtFbWJlZC5jcHAgXAotCQlU
ZXN0R3RrRW1iZWROb3RlYm9vay5jcHAKLQotaWZkZWYgTU9aX1gxMQotQ1BQU1JDUyArPQlUZXN0
R3RrRW1iZWRTb2NrZXQuY3BwIFwKLQkJVGVzdEd0a0VtYmVkQ2hpbGQuY3BwCi1lbmRpZgotCi1T
SU1QTEVfUFJPR1JBTVMgPSAkKENQUFNSQ1M6LmNwcD0pCi0KLSMgRU5BQkxFX0dOT01FPTEKLQot
aWZkZWYgRU5BQkxFX0dOT01FCi1DUFBTUkNTCSAgICAgICArPSBUZXN0R3RrRW1iZWRNREkuY3Bw
Ci1lbmRpZgotCi1pZmRlZiBNT1pfRU5BQkxFX0dUSzIKLUxJQlMJCSs9IFwKLQkJJChYTERGTEFH
UykgXAotCQkkKFhMSUJTKSBcCi0JCSQoTlVMTCkKLWVuZGlmCi0KLWluY2x1ZGUgJCh0b3BzcmNk
aXIpL2NvbmZpZy9jb25maWcubWsKLQotaW5jbHVkZSAkKHRvcHNyY2RpcikvY29uZmlnL3J1bGVz
Lm1rCi0KLUxJQlMgKz0gJChYUENPTV9TVEFOREFMT05FX0dMVUVfTERPUFRTKQotCi1ERUZJTkVT
ICs9IC1EWFBDT01fR0xVRQotU1RMX0ZMQUdTID0KLQotQ1hYRkxBR1MJKz0gJChNT1pfR1RLMl9D
RkxBR1MpCi0KLWlmZGVmIEVOQUJMRV9HTk9NRQotQ1hYRkxBR1MJKz0gYGdub21lLWNvbmZpZyAt
LWNmbGFncyBnbm9tZXVpYAotRVhUUkFfTElCUwkrPSBgZ25vbWUtY29uZmlnIC0tbGlicyBnbm9t
ZXVpYAotZW5kaWYKLQotRVhUUkFfTElCUwkrPSBcCi0JCSQoVEtfTElCUykgXAotCQkkKE5VTEwp
Ci0KLWlmZXEgKCQoT1NfQVJDSCksIFN1bk9TKQotaWZuZGVmIEdOVV9DQwotIyBXaGVuIHVzaW5n
IFN1bidzIFdvcmtTaG9wIGNvbXBpbGVyLCBpbmNsdWRpbmcKLSMgL3doZXJldmVyL3dvcmtzaG9w
LTUuMC9TQzUuMC9pbmNsdWRlL0NDL3N0ZC90aW1lLmgKLSMgY2F1c2VzIG1vc3Qgb2YgdGhlc2Ug
Y29tcGlsZXMgdG8gZmFpbCB3aXRoOgotIyBsaW5lIDI5OiBFcnJvcjogTXVsdGlwbGUgZGVjbGFy
YXRpb24gZm9yIHN0ZDo6dG0uCi0jIFNvLCB0aGlzIGdldHMgYXJvdW5kIHRoZSBwcm9ibGVtLgot
REVGSU5FUyAgICAgICAgICAgKz0gLURfVElNRV9IPTEKLWVuZGlmCi1lbmRpZgpkaWZmIC0tZ2l0
IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Rlc3RzL1Rlc3RHdGtFbWJlZC5jcHAgYi9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvdGVzdHMvVGVzdEd0a0VtYmVkLmNwcApkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Rlc3RzL1Rlc3RHdGtFbWJlZC5jcHAK
KysrIC9kZXYvbnVsbApAQCAtMSwxMTQ1ICswLDAgQEAKLS8qICoqKioqIEJFR0lOIExJQ0VOU0Ug
QkxPQ0sgKioqKioKLSAqIFZlcnNpb246IE1QTCAxLjEvR1BMIDIuMC9MR1BMIDIuMQotICoKLSAq
IFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVi
bGljIExpY2Vuc2UgVmVyc2lvbgotICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3Qg
dXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCi0gKiB0aGUgTGljZW5zZS4g
WW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0Ci0gKiBodHRwOi8vd3d3Lm1v
emlsbGEub3JnL01QTC8KLSAqCi0gKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGlj
ZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAotICogV0lUSE9VVCBXQVJS
QU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNl
bnNlCi0gKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxp
bWl0YXRpb25zIHVuZGVyIHRoZQotICogTGljZW5zZS4KLSAqCi0gKiBUaGUgT3JpZ2luYWwgQ29k
ZSBpcyBtb3ppbGxhLm9yZyBjb2RlLgotICoKLSAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0
aGUgT3JpZ2luYWwgQ29kZSBpcwotICogQ2hyaXN0b3BoZXIgQmxpenphcmQuCi0gKiBQb3J0aW9u
cyBjcmVhdGVkIGJ5IHRoZSBJbml0aWFsIERldmVsb3BlciBhcmUgQ29weXJpZ2h0IChDKSAyMDAx
Ci0gKiB0aGUgSW5pdGlhbCBEZXZlbG9wZXIuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi0gKgotICog
Q29udHJpYnV0b3Iocyk6Ci0gKiAgIENocmlzdG9waGVyIEJsaXp6YXJkIDxibGl6emFyZEBtb3pp
bGxhLm9yZz4KLSAqCi0gKiBBbHRlcm5hdGl2ZWx5LCB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxl
IG1heSBiZSB1c2VkIHVuZGVyIHRoZSB0ZXJtcyBvZgotICogZWl0aGVyIHRoZSBHTlUgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBWZXJzaW9uIDIgb3IgbGF0ZXIgKHRoZSAiR1BMIiksIG9yCi0gKiB0
aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMi4xIG9yIGxhdGVy
ICh0aGUgIkxHUEwiKSwKLSAqIGluIHdoaWNoIGNhc2UgdGhlIHByb3Zpc2lvbnMgb2YgdGhlIEdQ
TCBvciB0aGUgTEdQTCBhcmUgYXBwbGljYWJsZSBpbnN0ZWFkCi0gKiBvZiB0aG9zZSBhYm92ZS4g
SWYgeW91IHdpc2ggdG8gYWxsb3cgdXNlIG9mIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUgb25s
eQotICogdW5kZXIgdGhlIHRlcm1zIG9mIGVpdGhlciB0aGUgR1BMIG9yIHRoZSBMR1BMLCBhbmQg
bm90IHRvIGFsbG93IG90aGVycyB0bwotICogdXNlIHlvdXIgdmVyc2lvbiBvZiB0aGlzIGZpbGUg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNUEwsIGluZGljYXRlIHlvdXIKLSAqIGRlY2lzaW9uIGJ5
IGRlbGV0aW5nIHRoZSBwcm92aXNpb25zIGFib3ZlIGFuZCByZXBsYWNlIHRoZW0gd2l0aCB0aGUg
bm90aWNlCi0gKiBhbmQgb3RoZXIgcHJvdmlzaW9ucyByZXF1aXJlZCBieSB0aGUgR1BMIG9yIHRo
ZSBMR1BMLiBJZiB5b3UgZG8gbm90IGRlbGV0ZQotICogdGhlIHByb3Zpc2lvbnMgYWJvdmUsIGEg
cmVjaXBpZW50IG1heSB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSB1bmRlcgotICogdGhl
IHRlcm1zIG9mIGFueSBvbmUgb2YgdGhlIE1QTCwgdGhlIEdQTCBvciB0aGUgTEdQTC4KLSAqCi0g
KiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLwotCi0jaW5jbHVkZSAiZ3RrbW96ZW1i
ZWQuaCIKLSNpbmNsdWRlIDxndGsvZ3RrLmg+Ci0jaW5jbHVkZSA8c3RkaW8uaD4KLSNpbmNsdWRl
IDxzdHJpbmcuaD4KLSNpbmNsdWRlIDxzdGRsaWIuaD4KLQotLy8gbW96aWxsYSBzcGVjaWZpYyBo
ZWFkZXJzCi0jaW5jbHVkZSAibnNJRE9NS2V5RXZlbnQuaCIKLSNpbmNsdWRlICJuc0lET01Nb3Vz
ZUV2ZW50LmgiCi0jaW5jbHVkZSAibnNJRE9NVUlFdmVudC5oIgotCi0jaW5jbHVkZSAibnNDT01Q
dHIuaCIKLSNpbmNsdWRlICJuc0lTdXBwb3J0c1V0aWxzLmgiCi0jaW5jbHVkZSAibnNTZXJ2aWNl
TWFuYWdlclV0aWxzLmgiCi0jaW5jbHVkZSAibnNJT2JzZXJ2ZXJTZXJ2aWNlLmgiCi0KLSNpbmNs
dWRlICJuc1N0cmluZ0FQSS5oIgotI2luY2x1ZGUgImd0a21vemVtYmVkX2dsdWUuY3BwIgotCi10
eXBlZGVmIHN0cnVjdCBfVGVzdEd0a0Jyb3dzZXIgewotICBHdGtXaWRnZXQgICp0b3BMZXZlbFdp
bmRvdzsKLSAgR3RrV2lkZ2V0ICAqdG9wTGV2ZWxWQm94OwotICBHdGtXaWRnZXQgICptZW51QmFy
OwotICBHdGtXaWRnZXQgICpmaWxlTWVudUl0ZW07Ci0gIEd0a1dpZGdldCAgKmZpbGVNZW51Owot
ICBHdGtXaWRnZXQgICpmaWxlT3Blbk5ld0Jyb3dzZXI7Ci0gIEd0a1dpZGdldCAgKmZpbGVTdHJl
YW07Ci0gIEd0a1dpZGdldCAgKmZpbGVNZW1vcnk7Ci0gIEd0a1dpZGdldCAgKmZpbGVDbG9zZTsK
LSAgR3RrV2lkZ2V0ICAqZmlsZVF1aXQ7Ci0gIEd0a1dpZGdldCAgKnRvb2xiYXJIQm94OwotICBH
dGtXaWRnZXQgICp0b29sYmFyOwotICBHdGtXaWRnZXQgICpiYWNrQnV0dG9uOwotICBHdGtXaWRn
ZXQgICpzdG9wQnV0dG9uOwotICBHdGtXaWRnZXQgICpmb3J3YXJkQnV0dG9uOwotICBHdGtXaWRn
ZXQgICpyZWxvYWRCdXR0b247Ci0gIEd0a1dpZGdldCAgKnVybEVudHJ5OwotICBHdGtXaWRnZXQg
ICptb3pFbWJlZDsKLSAgR3RrV2lkZ2V0ICAqcHJvZ3Jlc3NBcmVhSEJveDsKLSAgR3RrV2lkZ2V0
ICAqcHJvZ3Jlc3NCYXI7Ci0gIEd0a1dpZGdldCAgKnN0YXR1c0FsaWduOwotICBHdGtXaWRnZXQg
ICpzdGF0dXNCYXI7Ci0gIGNvbnN0IGNoYXIgKnN0YXR1c01lc3NhZ2U7Ci0gIGludCAgICAgICAg
IGxvYWRQZXJjZW50OwotICBpbnQgICAgICAgICBieXRlc0xvYWRlZDsKLSAgaW50ICAgICAgICAg
bWF4Qnl0ZXNMb2FkZWQ7Ci0gIGNoYXIgICAgICAgKnRlbXBNZXNzYWdlOwotICBnYm9vbGVhbiBt
ZW51QmFyT247Ci0gIGdib29sZWFuIHRvb2xCYXJPbjsKLSAgZ2Jvb2xlYW4gbG9jYXRpb25CYXJP
bjsKLSAgZ2Jvb2xlYW4gc3RhdHVzQmFyT247Ci0KLX0gVGVzdEd0a0Jyb3dzZXI7Ci0KLS8vIHRo
ZSBsaXN0IG9mIGJyb3dzZXIgd2luZG93cyBjdXJyZW50bHkgb3BlbgotR0xpc3QgKmJyb3dzZXJf
bGlzdCA9IGdfbGlzdF9hbGxvYygpOwotCi1zdGF0aWMgVGVzdEd0a0Jyb3dzZXIgKm5ld19ndGtf
YnJvd3NlciAgICAoZ3VpbnQzMiBjaHJvbWVNYXNrKTsKLXN0YXRpYyB2b2lkICAgICAgICAgICAg
c2V0X2Jyb3dzZXJfdmlzaWJpbGl0eSAoVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIsCi0JCQkJCSAg
ICAgICBnYm9vbGVhbiB2aXNpYmlsaXR5KTsKLQotc3RhdGljIGludCBudW1fYnJvd3NlcnMgPSAw
OwotCi0vLyBjYWxsYmFja3MgZnJvbSB0aGUgVUkKLXN0YXRpYyB2b2lkICAgICBiYWNrX2NsaWNr
ZWRfY2IgICAgKEd0a0J1dHRvbiAgICpidXR0b24sIAotCQkJCSAgICBUZXN0R3RrQnJvd3NlciAq
YnJvd3Nlcik7Ci1zdGF0aWMgdm9pZCAgICAgc3RvcF9jbGlja2VkX2NiICAgIChHdGtCdXR0b24g
ICAqYnV0dG9uLAotCQkJCSAgICBUZXN0R3RrQnJvd3NlciAqYnJvd3Nlcik7Ci1zdGF0aWMgdm9p
ZCAgICAgZm9yd2FyZF9jbGlja2VkX2NiIChHdGtCdXR0b24gICAqYnV0dG9uLAotCQkJCSAgICBU
ZXN0R3RrQnJvd3NlciAqYnJvd3Nlcik7Ci1zdGF0aWMgdm9pZCAgICAgcmVsb2FkX2NsaWNrZWRf
Y2IgIChHdGtCdXR0b24gICAqYnV0dG9uLAotCQkJCSAgICBUZXN0R3RrQnJvd3NlciAqYnJvd3Nl
cik7Ci1zdGF0aWMgdm9pZCAgICAgdXJsX2FjdGl2YXRlX2NiICAgIChHdGtFZGl0YWJsZSAqd2lk
Z2V0LCAKLQkJCQkgICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpOwotc3RhdGljIHZvaWQgICAg
IG1lbnVfb3Blbl9uZXdfY2IgICAoR3RrTWVudUl0ZW0gKm1lbnVpdGVtLAotCQkJCSAgICBUZXN0
R3RrQnJvd3NlciAqYnJvd3Nlcik7Ci1zdGF0aWMgdm9pZCAgICAgbWVudV9zdHJlYW1fY2IgICAg
IChHdGtNZW51SXRlbSAqbWVudWl0ZW0sCi0JCQkJICAgIFRlc3RHdGtCcm93c2VyICpicm93c2Vy
KTsKLXN0YXRpYyB2b2lkICAgICBtZW51X21lbW9yeV9jYiAgICAgKEd0a01lbnVJdGVtICptZW51
aXRlbSwKLQkJCQkgICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpOwotc3RhdGljIHZvaWQgICAg
IG1lbnVfY2xvc2VfY2IgICAgICAoR3RrTWVudUl0ZW0gKm1lbnVpdGVtLAotCQkJCSAgICBUZXN0
R3RrQnJvd3NlciAqYnJvd3Nlcik7Ci1zdGF0aWMgdm9pZCAgICAgbWVudV9xdWl0X2NiICAgICAg
IChHdGtNZW51SXRlbSAqbWVudWl0ZW0sCi0JCQkJICAgIFRlc3RHdGtCcm93c2VyICpicm93c2Vy
KTsKLXN0YXRpYyBnYm9vbGVhbiBkZWxldGVfY2IgICAgICAgICAgKEd0a1dpZGdldCAqd2lkZ2V0
LCBHZGtFdmVudEFueSAqZXZlbnQsCi0JCQkJICAgIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsK
LXN0YXRpYyB2b2lkICAgICBkZXN0cm95X2NiICAgICAgICAgKEd0a1dpZGdldCAqd2lkZ2V0LAot
CQkJCSAgICBUZXN0R3RrQnJvd3NlciAqYnJvd3Nlcik7Ci0KLS8vIGNhbGxiYWNrcyBmcm9tIHRo
ZSB3aWRnZXQKLXN0YXRpYyB2b2lkIGxvY2F0aW9uX2NoYW5nZWRfY2IgIChHdGtNb3pFbWJlZCAq
ZW1iZWQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIHRpdGxlX2NoYW5n
ZWRfY2IgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsK
LXN0YXRpYyB2b2lkIGxvYWRfc3RhcnRlZF9jYiAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIFRl
c3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIGxvYWRfZmluaXNoZWRfY2IgICAg
IChHdGtNb3pFbWJlZCAqZW1iZWQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2
b2lkIG5ldF9zdGF0ZV9jaGFuZ2VfY2IgIChHdGtNb3pFbWJlZCAqZW1iZWQsIGdpbnQgZmxhZ3Ms
Ci0JCQkJICBndWludCBzdGF0dXMsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2
b2lkIG5ldF9zdGF0ZV9jaGFuZ2VfYWxsX2NiIChHdGtNb3pFbWJlZCAqZW1iZWQsIGNvbnN0IGNo
YXIgKnVyaSwKLQkJCQkgICAgIGdpbnQgZmxhZ3MsIGd1aW50IHN0YXR1cywKLQkJCQkgICAgIFRl
c3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIHByb2dyZXNzX2NoYW5nZV9jYiAg
IChHdGtNb3pFbWJlZCAqZW1iZWQsIGdpbnQgY3VyLCBnaW50IG1heCwKLQkJCQkgIFRlc3RHdGtC
cm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIHByb2dyZXNzX2NoYW5nZV9hbGxfY2IgKEd0
a01vekVtYmVkICplbWJlZCwgY29uc3QgY2hhciAqdXJpLAotCQkJCSAgICBnaW50IGN1ciwgZ2lu
dCBtYXgsCi0JCQkJICAgIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIGxp
bmtfbWVzc2FnZV9jYiAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIFRlc3RHdGtCcm93c2VyICpi
cm93c2VyKTsKLXN0YXRpYyB2b2lkIGpzX3N0YXR1c19jYiAgICAgICAgIChHdGtNb3pFbWJlZCAq
ZW1iZWQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIG5ld193aW5kb3df
Y2IgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsCi0JCQkJICBHdGtNb3pFbWJlZCAqKnJldHZh
bCwgZ3VpbnQgY2hyb21lbWFzaywKLQkJCQkgIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0
YXRpYyB2b2lkIHZpc2liaWxpdHlfY2IgICAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIAotCQkJ
CSAgZ2Jvb2xlYW4gdmlzaWJpbGl0eSwKLQkJCQkgIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsK
LXN0YXRpYyB2b2lkIGRlc3Ryb3lfYnJzcl9jYiAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIFRl
c3RHdGtCcm93c2VyICpicm93c2VyKTsKLXN0YXRpYyBnaW50IG9wZW5fdXJpX2NiICAgICAgICAg
IChHdGtNb3pFbWJlZCAqZW1iZWQsIGNvbnN0IGNoYXIgKnVyaSwKLQkJCQkgIFRlc3RHdGtCcm93
c2VyICpicm93c2VyKTsKLXN0YXRpYyB2b2lkIHNpemVfdG9fY2IgICAgICAgICAgIChHdGtNb3pF
bWJlZCAqZW1iZWQsIGdpbnQgd2lkdGgsCi0JCQkJICBnaW50IGhlaWdodCwgVGVzdEd0a0Jyb3dz
ZXIgKmJyb3dzZXIpOwotc3RhdGljIGdpbnQgZG9tX2tleV9kb3duX2NiICAgICAgKEd0a01vekVt
YmVkICplbWJlZCwgbnNJRE9NS2V5RXZlbnQgKmV2ZW50LAotCQkJCSAgVGVzdEd0a0Jyb3dzZXIg
KmJyb3dzZXIpOwotc3RhdGljIGdpbnQgZG9tX2tleV9wcmVzc19jYiAgICAgKEd0a01vekVtYmVk
ICplbWJlZCwgbnNJRE9NS2V5RXZlbnQgKmV2ZW50LAotCQkJCSAgVGVzdEd0a0Jyb3dzZXIgKmJy
b3dzZXIpOwotc3RhdGljIGdpbnQgZG9tX2tleV91cF9jYiAgICAgICAgKEd0a01vekVtYmVkICpl
bWJlZCwgbnNJRE9NS2V5RXZlbnQgKmV2ZW50LAotCQkJCSAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dz
ZXIpOwotc3RhdGljIGdpbnQgZG9tX21vdXNlX2Rvd25fY2IgICAgKEd0a01vekVtYmVkICplbWJl
ZCwgbnNJRE9NTW91c2VFdmVudCAqZXZlbnQsCi0JCQkJICBUZXN0R3RrQnJvd3NlciAqYnJvd3Nl
cik7Ci1zdGF0aWMgZ2ludCBkb21fbW91c2VfdXBfY2IgICAgICAoR3RrTW96RW1iZWQgKmVtYmVk
LCBuc0lET01Nb3VzZUV2ZW50ICpldmVudCwKLQkJCQkgIFRlc3RHdGtCcm93c2VyICpicm93c2Vy
KTsKLXN0YXRpYyBnaW50IGRvbV9tb3VzZV9jbGlja19jYiAgIChHdGtNb3pFbWJlZCAqZW1iZWQs
IG5zSURPTU1vdXNlRXZlbnQgKmV2ZW50LAotCQkJCSAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIp
Owotc3RhdGljIGdpbnQgZG9tX21vdXNlX2RibF9jbGlja19jYiAoR3RrTW96RW1iZWQgKmVtYmVk
LCAKLQkJCQkgIG5zSURPTU1vdXNlRXZlbnQgKmV2ZW50LAotCQkJCSAgVGVzdEd0a0Jyb3dzZXIg
KmJyb3dzZXIpOwotc3RhdGljIGdpbnQgZG9tX21vdXNlX292ZXJfY2IgICAgKEd0a01vekVtYmVk
ICplbWJlZCwgbnNJRE9NTW91c2VFdmVudCAqZXZlbnQsCi0JCQkJICBUZXN0R3RrQnJvd3NlciAq
YnJvd3Nlcik7Ci1zdGF0aWMgZ2ludCBkb21fbW91c2Vfb3V0X2NiICAgICAoR3RrTW96RW1iZWQg
KmVtYmVkLCBuc0lET01Nb3VzZUV2ZW50ICpldmVudCwKLQkJCQkgIFRlc3RHdGtCcm93c2VyICpi
cm93c2VyKTsKLXN0YXRpYyBnaW50IGRvbV9hY3RpdmF0ZV9jYiAgICAgIChHdGtNb3pFbWJlZCAq
ZW1iZWQsIG5zSURPTVVJRXZlbnQgKmV2ZW50LAotCQkJCSAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dz
ZXIpOwotc3RhdGljIGdpbnQgZG9tX2ZvY3VzX2luX2NiICAgICAgKEd0a01vekVtYmVkICplbWJl
ZCwgbnNJRE9NVUlFdmVudCAqZXZlbnQsCi0JCQkJICBUZXN0R3RrQnJvd3NlciAqYnJvd3Nlcik7
Ci1zdGF0aWMgZ2ludCBkb21fZm9jdXNfb3V0X2NiICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBu
c0lET01VSUV2ZW50ICpldmVudCwKLQkJCQkgIFRlc3RHdGtCcm93c2VyICpicm93c2VyKTsKLQot
Ly8gY2FsbGJhY2tzIGZyb20gdGhlIHNpbmdsZXRvbiBvYmplY3QKLXN0YXRpYyB2b2lkIG5ld193
aW5kb3dfb3JwaGFuX2NiIChHdGtNb3pFbWJlZFNpbmdsZSAqZW1iZWQsCi0JCQkJICBHdGtNb3pF
bWJlZCAqKnJldHZhbCwgZ3VpbnQgY2hyb21lbWFzaywKLQkJCQkgIGdwb2ludGVyIGRhdGEpOwot
Ci0vLyBzb21lIHV0aWxpdHkgZnVuY3Rpb25zCi1zdGF0aWMgdm9pZCB1cGRhdGVfc3RhdHVzX2Jh
cl90ZXh0ICAoVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpOwotc3RhdGljIHZvaWQgdXBkYXRlX3Rl
bXBfbWVzc2FnZSAgICAgKFRlc3RHdGtCcm93c2VyICpicm93c2VyLAotCQkJCSAgICAgY29uc3Qg
Y2hhciAqbWVzc2FnZSk7Ci1zdGF0aWMgdm9pZCB1cGRhdGVfbmF2X2J1dHRvbnMgICAgICAoVGVz
dEd0a0Jyb3dzZXIgKmJyb3dzZXIpOwotCi1pbnQKLW1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2
KQotewotICBndGtfc2V0X2xvY2FsZSgpOwotICBndGtfaW5pdCgmYXJnYywgJmFyZ3YpOwotCi0g
IHN0YXRpYyBjb25zdCBHUkVWZXJzaW9uUmFuZ2UgZ3JlVmVyc2lvbiA9IHsKLSAgICAiMS45YSIs
IFBSX1RSVUUsCi0gICAgIjIiLCBQUl9UUlVFCi0gIH07Ci0KLSAgY2hhciB4cGNvbVBhdGhbUEFU
SF9NQVhdOwotCi0gIG5zcmVzdWx0IHJ2ID0gR1JFX0dldEdSRVBhdGhXaXRoUHJvcGVydGllcygm
Z3JlVmVyc2lvbiwgMSwgbnNudWxsLCAwLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgeHBjb21QYXRoLCBzaXplb2YoeHBjb21QYXRoKSk7Ci0gIGlmIChOU19G
QUlMRUQocnYpKSB7Ci0gICAgZnByaW50ZihzdGRlcnIsICJDb3VsZG4ndCBmaW5kIGEgY29tcGF0
aWJsZSBHUkUuXG4iKTsKLSAgICByZXR1cm4gMTsKLSAgfQotCi0gIHJ2ID0gWFBDT01HbHVlU3Rh
cnR1cCh4cGNvbVBhdGgpOwotICBpZiAoTlNfRkFJTEVEKHJ2KSkgewotICAgIGZwcmludGYoc3Rk
ZXJyLCAiQ291bGRuJ3Qgc3RhcnQgWFBDT00uIik7Ci0gICAgcmV0dXJuIDE7Ci0gIH0KLQotICBy
diA9IEdUS0VtYmVkR2x1ZVN0YXJ0dXAoKTsKLSAgaWYgKE5TX0ZBSUxFRChydikpIHsKLSAgICBm
cHJpbnRmKHN0ZGVyciwgIkNvdWxkbid0IGZpbmQgR1RLTW96RW1iZWQgc3ltYm9scy4iKTsKLSAg
ICByZXR1cm4gMTsKLSAgfQotCi0gIGNoYXIgKmxhc3RTbGFzaCA9IHN0cnJjaHIoeHBjb21QYXRo
LCAnLycpOwotICBpZiAobGFzdFNsYXNoKQotICAgICpsYXN0U2xhc2ggPSAnXDAnOwotCi0gIGd0
a19tb3pfZW1iZWRfc2V0X3BhdGgoeHBjb21QYXRoKTsKLQotICBjaGFyICpob21lX3BhdGg7Ci0g
IGNoYXIgKmZ1bGxfcGF0aDsKLSAgaG9tZV9wYXRoID0gZ2V0ZW52KCJIT01FIik7Ci0gIGlmICgh
aG9tZV9wYXRoKSB7Ci0gICAgZnByaW50ZihzdGRlcnIsICJGYWlsZWQgdG8gZ2V0IEhPTUVcbiIp
OwotICAgIGV4aXQoMSk7Ci0gIH0KLSAgCi0gIGZ1bGxfcGF0aCA9IGdfc3RyZHVwX3ByaW50Zigi
JXMvJXMiLCBob21lX3BhdGgsICIuVGVzdEd0a0VtYmVkIik7Ci0gIAotICBndGtfbW96X2VtYmVk
X3NldF9wcm9maWxlX3BhdGgoZnVsbF9wYXRoLCAiVGVzdEd0a0VtYmVkIik7Ci0KLSAgVGVzdEd0
a0Jyb3dzZXIgKmJyb3dzZXIgPSBuZXdfZ3RrX2Jyb3dzZXIoR1RLX01PWl9FTUJFRF9GTEFHX0RF
RkFVTFRDSFJPTUUpOwotCi0gIC8vIHNldCBvdXIgbWluaW11bSBzaXplCi0gIGd0a193aWRnZXRf
c2V0X3NpemVfcmVxdWVzdChicm93c2VyLT5tb3pFbWJlZCwgNDAwLCA0MDApOwotCi0gIHNldF9i
cm93c2VyX3Zpc2liaWxpdHkoYnJvd3NlciwgVFJVRSk7Ci0KLSAgaWYgKGFyZ2MgPiAxKQotICAg
IGd0a19tb3pfZW1iZWRfbG9hZF91cmwoR1RLX01PWl9FTUJFRChicm93c2VyLT5tb3pFbWJlZCks
IGFyZ3ZbMV0pOwotCi0gIC8vIGdldCB0aGUgc2luZ2xldG9uIG9iamVjdCBhbmQgaG9vayB1cCB0
byBpdHMgbmV3IHdpbmRvdyBjYWxsYmFjawotICAvLyBzbyB3ZSBjYW4gY3JlYXRlIG9ycGhhbmVk
IHdpbmRvd3MuCi0KLSAgR3RrTW96RW1iZWRTaW5nbGUgKnNpbmdsZTsKLQotICBzaW5nbGUgPSBn
dGtfbW96X2VtYmVkX3NpbmdsZV9nZXQoKTsKLSAgaWYgKCFzaW5nbGUpIHsKLSAgICBmcHJpbnRm
KHN0ZGVyciwgIkZhaWxlZCB0byBnZXQgc2luZ2xldG9uIGVtYmVkIG9iamVjdCFcbiIpOwotICAg
IGV4aXQoMSk7Ci0gIH0KLQotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1Qoc2luZ2xlKSwg
Im5ld193aW5kb3dfb3JwaGFuIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKG5ld193
aW5kb3dfb3JwaGFuX2NiKSwgTlVMTCk7Ci0KLSAgZ3RrX21vel9lbWJlZF9wdXNoX3N0YXJ0dXAo
KTsKLSAgZ3RrX21haW4oKTsKLSAgZ3RrX21vel9lbWJlZF9wb3Bfc3RhcnR1cCgpOwotfQotCi1z
dGF0aWMgVGVzdEd0a0Jyb3dzZXIgKgotbmV3X2d0a19icm93c2VyKGd1aW50MzIgY2hyb21lTWFz
aykKLXsKLSAgZ3VpbnQzMiAgICAgICAgIGFjdHVhbENocm9tZU1hc2sgPSBjaHJvbWVNYXNrOwot
ICBUZXN0R3RrQnJvd3NlciAqYnJvd3NlciA9IDA7Ci0KLSAgbnVtX2Jyb3dzZXJzKys7Ci0KLSAg
YnJvd3NlciA9IGdfbmV3MChUZXN0R3RrQnJvd3NlciwgMSk7Ci0KLSAgYnJvd3Nlcl9saXN0ID0g
Z19saXN0X3ByZXBlbmQoYnJvd3Nlcl9saXN0LCBicm93c2VyKTsKLQotICBicm93c2VyLT5tZW51
QmFyT24gPSBGQUxTRTsKLSAgYnJvd3Nlci0+dG9vbEJhck9uID0gRkFMU0U7Ci0gIGJyb3dzZXIt
PmxvY2F0aW9uQmFyT24gPSBGQUxTRTsKLSAgYnJvd3Nlci0+c3RhdHVzQmFyT24gPSBGQUxTRTsK
LQotICBnX3ByaW50KCJuZXdfZ3RrX2Jyb3dzZXJcbiIpOwotCi0gIGlmIChjaHJvbWVNYXNrID09
IEdUS19NT1pfRU1CRURfRkxBR19ERUZBVUxUQ0hST01FKQotICAgIGFjdHVhbENocm9tZU1hc2sg
PSBHVEtfTU9aX0VNQkVEX0ZMQUdfQUxMQ0hST01FOwotCi0gIGlmIChhY3R1YWxDaHJvbWVNYXNr
ICYgR1RLX01PWl9FTUJFRF9GTEFHX01FTlVCQVJPTikKLSAgewotICAgIGJyb3dzZXItPm1lbnVC
YXJPbiA9IFRSVUU7Ci0gICAgZ19wcmludCgiXHRtZW51IGJhclxuIik7Ci0gIH0KLSAgaWYgKGFj
dHVhbENocm9tZU1hc2sgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfVE9PTEJBUk9OKQotICB7Ci0gICAg
YnJvd3Nlci0+dG9vbEJhck9uID0gVFJVRTsKLSAgICBnX3ByaW50KCJcdHRvb2wgYmFyXG4iKTsK
LSAgfQotICBpZiAoYWN0dWFsQ2hyb21lTWFzayAmIEdUS19NT1pfRU1CRURfRkxBR19MT0NBVElP
TkJBUk9OKQotICB7Ci0gICAgYnJvd3Nlci0+bG9jYXRpb25CYXJPbiA9IFRSVUU7Ci0gICAgZ19w
cmludCgiXHRsb2NhdGlvbiBiYXJcbiIpOwotICB9Ci0gIGlmIChhY3R1YWxDaHJvbWVNYXNrICYg
R1RLX01PWl9FTUJFRF9GTEFHX1NUQVRVU0JBUk9OKQotICB7Ci0gICAgYnJvd3Nlci0+c3RhdHVz
QmFyT24gPSBUUlVFOwotICAgIGdfcHJpbnQoIlx0c3RhdHVzIGJhclxuIik7Ci0gIH0KLQotICAv
LyBjcmVhdGUgb3VyIG5ldyB0b3BsZXZlbCB3aW5kb3cKLSAgYnJvd3Nlci0+dG9wTGV2ZWxXaW5k
b3cgPSBndGtfd2luZG93X25ldyhHVEtfV0lORE9XX1RPUExFVkVMKTsKLSAgLy8gbmV3IHZib3gK
LSAgYnJvd3Nlci0+dG9wTGV2ZWxWQm94ID0gZ3RrX3Zib3hfbmV3KEZBTFNFLCAwKTsKLSAgLy8g
YWRkIGl0IHRvIHRoZSB0b3BsZXZlbCB3aW5kb3cKLSAgZ3RrX2NvbnRhaW5lcl9hZGQoR1RLX0NP
TlRBSU5FUihicm93c2VyLT50b3BMZXZlbFdpbmRvdyksCi0JCSAgICBicm93c2VyLT50b3BMZXZl
bFZCb3gpOwotICAvLyBjcmVhdGUgb3VyIG1lbnUgYmFyCi0gIGJyb3dzZXItPm1lbnVCYXIgPSBn
dGtfbWVudV9iYXJfbmV3KCk7Ci0gIC8vIGNyZWF0ZSB0aGUgZmlsZSBtZW51Ci0gIGJyb3dzZXIt
PmZpbGVNZW51SXRlbSA9IGd0a19tZW51X2l0ZW1fbmV3X3dpdGhfbGFiZWwoIkZpbGUiKTsKLSAg
YnJvd3Nlci0+ZmlsZU1lbnUgPSBndGtfbWVudV9uZXcoKTsKLSAgZ3RrX21lbnVfaXRlbV9zZXRf
c3VibWVudSAoR1RLX01FTlVfSVRFTShicm93c2VyLT5maWxlTWVudUl0ZW0pLAotCQkJICAgICBi
cm93c2VyLT5maWxlTWVudSk7Ci0KLSAgYnJvd3Nlci0+ZmlsZU9wZW5OZXdCcm93c2VyID0gCi0g
ICAgZ3RrX21lbnVfaXRlbV9uZXdfd2l0aF9sYWJlbCgiT3BlbiBOZXcgQnJvd3NlciIpOwotICBn
dGtfbWVudV9zaGVsbF9hcHBlbmQoKEd0a01lbnVTaGVsbCAqKUdUS19NRU5VKGJyb3dzZXItPmZp
bGVNZW51KSwKLSAgICAgICAgICAgICAgICAgICAgICAgIGJyb3dzZXItPmZpbGVPcGVuTmV3QnJv
d3Nlcik7Ci0gIAotICBicm93c2VyLT5maWxlU3RyZWFtID0KLSAgICBndGtfbWVudV9pdGVtX25l
d193aXRoX2xhYmVsKCJUZXN0IFN0cmVhbSIpOwotICBndGtfbWVudV9zaGVsbF9hcHBlbmQoKEd0
a01lbnVTaGVsbCAqKUdUS19NRU5VKGJyb3dzZXItPmZpbGVNZW51KSwKLSAgICAgICAgICAgICAg
ICAgICAgICAgIGJyb3dzZXItPmZpbGVTdHJlYW0pOwotCi0gIGJyb3dzZXItPmZpbGVNZW1vcnkg
PQotICAgIGd0a19tZW51X2l0ZW1fbmV3X3dpdGhfbGFiZWwoIlJlbGVhc2UgTWVtb3J5Iik7Ci0g
IGd0a19tZW51X3NoZWxsX2FwcGVuZCgoR3RrTWVudVNoZWxsICopR1RLX01FTlUoYnJvd3Nlci0+
ZmlsZU1lbnUpLAotICAgICAgICAgICAgICAgICAgICAgICAgYnJvd3Nlci0+ZmlsZU1lbW9yeSk7
Ci0KLSAgYnJvd3Nlci0+ZmlsZUNsb3NlID0KLSAgICBndGtfbWVudV9pdGVtX25ld193aXRoX2xh
YmVsKCJDbG9zZSIpOwotICBndGtfbWVudV9zaGVsbF9hcHBlbmQoKEd0a01lbnVTaGVsbCAqKUdU
S19NRU5VKGJyb3dzZXItPmZpbGVNZW51KSwKLSAgICAgICAgICAgICAgICAgICAgICAgIGJyb3dz
ZXItPmZpbGVDbG9zZSk7Ci0KLSAgYnJvd3Nlci0+ZmlsZVF1aXQgPQotICAgIGd0a19tZW51X2l0
ZW1fbmV3X3dpdGhfbGFiZWwoIlF1aXQiKTsKLSAgZ3RrX21lbnVfc2hlbGxfYXBwZW5kKChHdGtN
ZW51U2hlbGwgKilHVEtfTUVOVShicm93c2VyLT5maWxlTWVudSksCi0gICAgICAgICAgICAgICAg
ICAgICAgICBicm93c2VyLT5maWxlUXVpdCk7Ci0gIAotICAvLyBhcHBlbmQgaXQKLSAgZ3RrX21l
bnVfc2hlbGxfYXBwZW5kKChHdGtNZW51U2hlbGwgKilHVEtfTUVOVV9CQVIoYnJvd3Nlci0+bWVu
dUJhciksCi0gICAgICAgICAgICAgICAgICAgICAgICBicm93c2VyLT5maWxlTWVudUl0ZW0pOwot
Ci0gIC8vIGFkZCBpdCB0byB0aGUgdmJveAotICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChi
cm93c2VyLT50b3BMZXZlbFZCb3gpLAotCQkgICAgIGJyb3dzZXItPm1lbnVCYXIsCi0JCSAgICAg
RkFMU0UsIC8vIGV4cGFuZAotCQkgICAgIEZBTFNFLCAvLyBmaWxsCi0JCSAgICAgMCk7ICAgIC8v
IHBhZGRpbmcKLSAgLy8gY3JlYXRlIHRoZSBoYm94IHRoYXQgd2lsbCBjb250YWluIHRoZSB0b29s
YmFyIGFuZCB0aGUgdXJsIHRleHQgZW50cnkgYmFyCi0gIGJyb3dzZXItPnRvb2xiYXJIQm94ID0g
Z3RrX2hib3hfbmV3KEZBTFNFLCAwKTsKLSAgLy8gYWRkIHRoYXQgaGJveCB0byB0aGUgdmJveAot
ICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChicm93c2VyLT50b3BMZXZlbFZCb3gpLCAKLQkJ
ICAgICBicm93c2VyLT50b29sYmFySEJveCwKLQkJICAgICBGQUxTRSwgLy8gZXhwYW5kCi0JCSAg
ICAgRkFMU0UsIC8vIGZpbGwKLQkJICAgICAwKTsgICAgLy8gcGFkZGluZwotICAvLyBuZXcgaG9y
aXogdG9vbGJhciB3aXRoIGJ1dHRvbnMgKyBpY29ucwotICBicm93c2VyLT50b29sYmFyID0gZ3Rr
X3Rvb2xiYXJfbmV3KCk7Ci0gIGd0a190b29sYmFyX3NldF9vcmllbnRhdGlvbihHVEtfVE9PTEJB
Uihicm93c2VyLT50b29sYmFyKSwKLQkJCSAgICAgIEdUS19PUklFTlRBVElPTl9IT1JJWk9OVEFM
KTsKLSAgZ3RrX3Rvb2xiYXJfc2V0X3N0eWxlKEdUS19UT09MQkFSKGJyb3dzZXItPnRvb2xiYXIp
LAotCQkJR1RLX1RPT0xCQVJfQk9USCk7Ci0KLSAgLy8gYWRkIGl0IHRvIHRoZSBoYm94Ci0gIGd0
a19ib3hfcGFja19zdGFydChHVEtfQk9YKGJyb3dzZXItPnRvb2xiYXJIQm94KSwgYnJvd3Nlci0+
dG9vbGJhciwKLQkJICAgRkFMU0UsIC8vIGV4cGFuZAotCQkgICBGQUxTRSwgLy8gZmlsbAotCQkg
ICAwKTsgICAgLy8gcGFkZGluZwotICAvLyBuZXcgYmFjayBidXR0b24KLSAgYnJvd3Nlci0+YmFj
a0J1dHRvbiA9Ci0gICAgZ3RrX3Rvb2xiYXJfYXBwZW5kX2l0ZW0oR1RLX1RPT0xCQVIoYnJvd3Nl
ci0+dG9vbGJhciksCi0JCQkgICAgIkJhY2siLAotCQkJICAgICJHbyBCYWNrIiwKLQkJCSAgICAi
R28gQmFjayIsCi0JCQkgICAgMCwgLy8gWFhYIHJlcGxhY2Ugd2l0aCBpY29uCi0JCQkgICAgR19D
QUxMQkFDSyhiYWNrX2NsaWNrZWRfY2IpLAotCQkJICAgIGJyb3dzZXIpOwotICAvLyBuZXcgc3Rv
cCBidXR0b24KLSAgYnJvd3Nlci0+c3RvcEJ1dHRvbiA9IAotICAgIGd0a190b29sYmFyX2FwcGVu
ZF9pdGVtKEdUS19UT09MQkFSKGJyb3dzZXItPnRvb2xiYXIpLAotCQkJICAgICJTdG9wIiwKLQkJ
CSAgICAiU3RvcCIsCi0JCQkgICAgIlN0b3AiLAotCQkJICAgIDAsIC8vIFhYWCByZXBsYWNlIHdp
dGggaWNvbgotCQkJICAgIEdfQ0FMTEJBQ0soc3RvcF9jbGlja2VkX2NiKSwKLQkJCSAgICBicm93
c2VyKTsKLSAgLy8gbmV3IGZvcndhcmQgYnV0dG9uCi0gIGJyb3dzZXItPmZvcndhcmRCdXR0b24g
PQotICAgIGd0a190b29sYmFyX2FwcGVuZF9pdGVtKEdUS19UT09MQkFSKGJyb3dzZXItPnRvb2xi
YXIpLAotCQkJICAgICJGb3J3YXJkIiwKLQkJCSAgICAiRm9yd2FyZCIsCi0JCQkgICAgIkZvcndh
cmQiLAotCQkJICAgIDAsIC8vIFhYWCByZXBsYWNlIHdpdGggaWNvbgotCQkJICAgIEdfQ0FMTEJB
Q0soZm9yd2FyZF9jbGlja2VkX2NiKSwKLQkJCSAgICBicm93c2VyKTsKLSAgLy8gbmV3IHJlbG9h
ZCBidXR0b24KLSAgYnJvd3Nlci0+cmVsb2FkQnV0dG9uID0gCi0gICAgZ3RrX3Rvb2xiYXJfYXBw
ZW5kX2l0ZW0oR1RLX1RPT0xCQVIoYnJvd3Nlci0+dG9vbGJhciksCi0JCQkgICAgIlJlbG9hZCIs
Ci0JCQkgICAgIlJlbG9hZCIsCi0JCQkgICAgIlJlbG9hZCIsCi0JCQkgICAgMCwgLy8gWFhYIHJl
cGxhY2Ugd2l0aCBpY29uCi0JCQkgICAgR19DQUxMQkFDSyhyZWxvYWRfY2xpY2tlZF9jYiksCi0J
CQkgICAgYnJvd3Nlcik7Ci0gIC8vIGNyZWF0ZSB0aGUgdXJsIHRleHQgZW50cnkKLSAgYnJvd3Nl
ci0+dXJsRW50cnkgPSBndGtfZW50cnlfbmV3KCk7Ci0gIC8vIGFkZCBpdCB0byB0aGUgaGJveAot
ICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChicm93c2VyLT50b29sYmFySEJveCksIGJyb3dz
ZXItPnVybEVudHJ5LAotCQkgICAgIFRSVUUsIC8vIGV4cGFuZAotCQkgICAgIFRSVUUsIC8vIGZp
bGwKLQkJICAgICAwKTsgICAgLy8gcGFkZGluZwotICAvLyBjcmVhdGUgb3VyIG5ldyBndGsgbW96
IGVtYmVkIHdpZGdldAotICBicm93c2VyLT5tb3pFbWJlZCA9IGd0a19tb3pfZW1iZWRfbmV3KCk7
Ci0gIGd0a19tb3pfZW1iZWRfcHVzaF9zdGFydHVwKCk7Ci0gIC8vIGFkZCBpdCB0byB0aGUgdG9w
bGV2ZWwgdmJveAotICBndGtfYm94X3BhY2tfc3RhcnQoR1RLX0JPWChicm93c2VyLT50b3BMZXZl
bFZCb3gpLCBicm93c2VyLT5tb3pFbWJlZCwKLQkJICAgICBUUlVFLCAvLyBleHBhbmQKLQkJICAg
ICBUUlVFLCAvLyBmaWxsCi0JCSAgICAgMCk7ICAgLy8gcGFkZGluZwotICAvLyBjcmVhdGUgdGhl
IG5ldyBoYm94IGZvciB0aGUgcHJvZ3Jlc3MgYXJlYQotICBicm93c2VyLT5wcm9ncmVzc0FyZWFI
Qm94ID0gZ3RrX2hib3hfbmV3KEZBTFNFLCAwKTsKLSAgLy8gYWRkIGl0IHRvIHRoZSB2Ym94Ci0g
IGd0a19ib3hfcGFja19zdGFydChHVEtfQk9YKGJyb3dzZXItPnRvcExldmVsVkJveCksIGJyb3dz
ZXItPnByb2dyZXNzQXJlYUhCb3gsCi0JCSAgICAgRkFMU0UsIC8vIGV4cGFuZAotCQkgICAgIEZB
TFNFLCAvLyBmaWxsCi0JCSAgICAgMCk7ICAgLy8gcGFkZGluZwotICAvLyBjcmVhdGUgb3VyIG5l
dyBwcm9ncmVzcyBiYXIKLSAgYnJvd3Nlci0+cHJvZ3Jlc3NCYXIgPSBndGtfcHJvZ3Jlc3NfYmFy
X25ldygpOwotICAvLyBhZGQgaXQgdG8gdGhlIGhib3gKLSAgZ3RrX2JveF9wYWNrX3N0YXJ0KEdU
S19CT1goYnJvd3Nlci0+cHJvZ3Jlc3NBcmVhSEJveCksIGJyb3dzZXItPnByb2dyZXNzQmFyLAot
CQkgICAgIEZBTFNFLCAvLyBleHBhbmQKLQkJICAgICBGQUxTRSwgLy8gZmlsbAotCQkgICAgIDAp
OyAvLyBwYWRkaW5nCi0gIAotICAvLyBjcmVhdGUgb3VyIHN0YXR1cyBhcmVhIGFuZCB0aGUgYWxp
Z25tZW50IG9iamVjdCB0aGF0IHdpbGwga2VlcCBpdAotICAvLyBmcm9tIGV4cGFuZGluZwotICBi
cm93c2VyLT5zdGF0dXNBbGlnbiA9IGd0a19hbGlnbm1lbnRfbmV3KDAsIDAsIDEsIDEpOwotICBn
dGtfd2lkZ2V0X3NldF9zaXplX3JlcXVlc3QoYnJvd3Nlci0+c3RhdHVzQWxpZ24sIDEsIC0xKTsK
LSAgLy8gY3JlYXRlIHRoZSBzdGF0dXMgYmFyCi0gIGJyb3dzZXItPnN0YXR1c0JhciA9IGd0a19z
dGF0dXNiYXJfbmV3KCk7Ci0gIGd0a19jb250YWluZXJfYWRkKEdUS19DT05UQUlORVIoYnJvd3Nl
ci0+c3RhdHVzQWxpZ24pLCBicm93c2VyLT5zdGF0dXNCYXIpOwotICAvLyBhZGQgaXQgdG8gdGhl
IGhib3gKLSAgZ3RrX2JveF9wYWNrX3N0YXJ0KEdUS19CT1goYnJvd3Nlci0+cHJvZ3Jlc3NBcmVh
SEJveCksIGJyb3dzZXItPnN0YXR1c0FsaWduLAotCQkgICAgIFRSVUUsIC8vIGV4cGFuZAotCQkg
ICAgIFRSVUUsIC8vIGZpbGwKLQkJICAgICAwKTsgICAvLyBwYWRkaW5nCi0gIC8vIGJ5IGRlZmF1
bHQgbm9uZSBvZiB0aGUgYnV0dG9ucyBhcmUgbWFya2VkIGFzIHNlbnNpdGl2ZS4KLSAgZ3RrX3dp
ZGdldF9zZXRfc2Vuc2l0aXZlKGJyb3dzZXItPmJhY2tCdXR0b24sIEZBTFNFKTsKLSAgZ3RrX3dp
ZGdldF9zZXRfc2Vuc2l0aXZlKGJyb3dzZXItPnN0b3BCdXR0b24sIEZBTFNFKTsKLSAgZ3RrX3dp
ZGdldF9zZXRfc2Vuc2l0aXZlKGJyb3dzZXItPmZvcndhcmRCdXR0b24sIEZBTFNFKTsKLSAgZ3Rr
X3dpZGdldF9zZXRfc2Vuc2l0aXZlKGJyb3dzZXItPnJlbG9hZEJ1dHRvbiwgRkFMU0UpOwotICAK
LSAgLy8gY2F0Y2ggdGhlIGRlc3RydWN0aW9uIG9mIHRoZSB0b3BsZXZlbCB3aW5kb3cKLSAgZ19z
aWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPnRvcExldmVsV2luZG93KSwgImRlbGV0
ZV9ldmVudCIsCi0gICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhkZWxldGVfY2IpLCBicm93
c2VyKTsKLQotICAvLyBob29rIHVwIHRoZSBhY3RpdmF0ZSBzaWduYWwgdG8gdGhlIHJpZ2h0IGNh
bGxiYWNrCi0gIGdfc2lnbmFsX2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT51cmxFbnRyeSks
ICJhY3RpdmF0ZSIsCi0gICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyh1cmxfYWN0aXZhdGVf
Y2IpLCBicm93c2VyKTsKLQotICAvLyBob29rIHVwIHRvIHRoZSBvcGVuIG5ldyBicm93c2VyIGFj
dGl2YXRpb24KLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPmZpbGVPcGVu
TmV3QnJvd3NlciksICJhY3RpdmF0ZSIsCi0gICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyht
ZW51X29wZW5fbmV3X2NiKSwgYnJvd3Nlcik7Ci0gIC8vIGhvb2sgdXAgdG8gdGhlIHN0cmVhbSB0
ZXN0Ci0gIGdfc2lnbmFsX2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT5maWxlU3RyZWFtKSwg
ImFjdGl2YXRlIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKG1lbnVfc3RyZWFtX2Ni
KSwgYnJvd3Nlcik7Ci0gIC8vIGhvb2sgdXAgdGhlIG1lbW9yeSBwcmVzc3VyZSByZWxlYXNlIGZ1
bmN0aW9uCi0gIGdfc2lnbmFsX2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT5maWxlTWVtb3J5
KSwgImFjdGl2YXRlIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKG1lbnVfbWVtb3J5
X2NiKSwgYnJvd3Nlcik7Ci0gIC8vIGNsb3NlIHRoaXMgd2luZG93Ci0gIGdfc2lnbmFsX2Nvbm5l
Y3QoR1RLX09CSkVDVChicm93c2VyLT5maWxlQ2xvc2UpLCAiYWN0aXZhdGUiLAotICAgICAgICAg
ICAgICAgICAgIEdfQ0FMTEJBQ0sobWVudV9jbG9zZV9jYiksIGJyb3dzZXIpOwotICAvLyBxdWl0
IHRoZSBhcHBsaWNhdGlvbgotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+
ZmlsZVF1aXQpLCAiYWN0aXZhdGUiLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0sobWVu
dV9xdWl0X2NiKSwgYnJvd3Nlcik7Ci0KLSAgLy8gaG9vayB1cCB0aGUgbG9jYXRpb24gY2hhbmdl
IHRvIHVwZGF0ZSB0aGUgdXJsRW50cnkKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJy
b3dzZXItPm1vekVtYmVkKSwgImxvY2F0aW9uIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExC
QUNLKGxvY2F0aW9uX2NoYW5nZWRfY2IpLCBicm93c2VyKTsKLSAgLy8gaG9vayB1cCB0aGUgdGl0
bGUgY2hhbmdlIHRvIHVwZGF0ZSB0aGUgd2luZG93IHRpdGxlCi0gIGdfc2lnbmFsX2Nvbm5lY3Qo
R1RLX09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJ0aXRsZSIsCi0gICAgICAgICAgICAgICAg
ICAgR19DQUxMQkFDSyh0aXRsZV9jaGFuZ2VkX2NiKSwgYnJvd3Nlcik7Ci0gIC8vIGhvb2sgdXAg
dGhlIHN0YXJ0IGFuZCBzdG9wIHNpZ25hbHMKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNU
KGJyb3dzZXItPm1vekVtYmVkKSwgIm5ldF9zdGFydCIsCi0gICAgICAgICAgICAgICAgICAgR19D
QUxMQkFDSyhsb2FkX3N0YXJ0ZWRfY2IpLCBicm93c2VyKTsKLSAgZ19zaWduYWxfY29ubmVjdChH
VEtfT0JKRUNUKGJyb3dzZXItPm1vekVtYmVkKSwgIm5ldF9zdG9wIiwKLSAgICAgICAgICAgICAg
ICAgICBHX0NBTExCQUNLKGxvYWRfZmluaXNoZWRfY2IpLCBicm93c2VyKTsKLSAgLy8gaG9vayB1
cCB0byB0aGUgY2hhbmdlIGluIG5ldHdvcmsgc3RhdHVzCi0gIGdfc2lnbmFsX2Nvbm5lY3QoR1RL
X09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJuZXRfc3RhdGUiLAotICAgICAgICAgICAgICAg
ICAgIEdfQ0FMTEJBQ0sobmV0X3N0YXRlX2NoYW5nZV9jYiksIGJyb3dzZXIpOwotICBnX3NpZ25h
bF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96RW1iZWQpLCAibmV0X3N0YXRlX2FsbCIs
Ci0gICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhuZXRfc3RhdGVfY2hhbmdlX2FsbF9jYiks
IGJyb3dzZXIpOwotICAvLyBob29rdXAgdG8gY2hhbmdlcyBpbiBwcm9ncmVzcwotICBnX3NpZ25h
bF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96RW1iZWQpLCAicHJvZ3Jlc3MiLAotICAg
ICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0socHJvZ3Jlc3NfY2hhbmdlX2NiKSwgYnJvd3Nlcik7
Ci0gIGdfc2lnbmFsX2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJwcm9n
cmVzc19hbGwiLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0socHJvZ3Jlc3NfY2hhbmdl
X2FsbF9jYiksIGJyb3dzZXIpOwotICAvLyBob29rdXAgdG8gY2hhbmdlcyBpbiBvdmVyLWxpbmsg
bWVzc2FnZQotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96RW1iZWQp
LCAibGlua19tZXNzYWdlIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKGxpbmtfbWVz
c2FnZV9jYiksIGJyb3dzZXIpOwotICAvLyBob29rdXAgdG8gY2hhbmdlcyBpbiBqcyBzdGF0dXMg
bWVzc2FnZQotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96RW1iZWQp
LCAianNfc3RhdHVzIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKGpzX3N0YXR1c19j
YiksIGJyb3dzZXIpOwotICAvLyBob29rdXAgdG8gc2VlIHdoZW5ldmVyIGEgbmV3IHdpbmRvdyBp
cyByZXF1ZXN0ZWQKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPm1vekVt
YmVkKSwgIm5ld193aW5kb3ciLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0sobmV3X3dp
bmRvd19jYiksIGJyb3dzZXIpOwotICAvLyBob29rdXAgdG8gYW55IHJlcXVlc3RlZCB2aXNpYmls
aXR5IGNoYW5nZXMKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPm1vekVt
YmVkKSwgInZpc2liaWxpdHkiLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0sodmlzaWJp
bGl0eV9jYiksIGJyb3dzZXIpOwotICAvLyBob29rdXAgdG8gdGhlIHNpZ25hbCB0aGF0IHNheXMg
dGhhdCB0aGUgYnJvd3NlciByZXF1ZXN0ZWQgdG8gYmUKLSAgLy8gZGVzdHJveWVkCi0gIGdfc2ln
bmFsX2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJkZXN0cm95X2Jyb3dz
ZXIiLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soZGVzdHJveV9icnNyX2NiKSwgYnJv
d3Nlcik7Ci0gIC8vIGhvb2t1cCB0byB0aGUgc2lnbmFsIHRoYXQgaXMgY2FsbGVkIHdoZW4gc29t
ZW9uZSBjbGlja3Mgb24gYSBsaW5rCi0gIC8vIHRvIGxvYWQgYSBuZXcgdXJpCi0gIGdfc2lnbmFs
X2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJvcGVuX3VyaSIsCi0gICAg
ICAgICAgICAgICAgICAgR19DQUxMQkFDSyhvcGVuX3VyaV9jYiksIGJyb3dzZXIpOwotICAvLyB0
aGlzIHNpZ25hbCBpcyBlbWl0dGVkIHdoZW4gdGhlcmUncyBhIHJlcXVlc3QgdG8gY2hhbmdlIHRo
ZQotICAvLyBjb250YWluaW5nIGJyb3dzZXIgd2luZG93IHRvIGEgY2VydGFpbiBoZWlnaHQsIGxp
a2Ugd2l0aCB3aWR0aAotICAvLyBhbmQgaGVpZ2h0IGFyZ3MgZm9yIGEgd2luZG93Lm9wZW4gaW4g
amF2YXNjcmlwdAotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96RW1i
ZWQpLCAic2l6ZV90byIsCi0gICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhzaXplX3RvX2Ni
KSwgYnJvd3Nlcik7Ci0gIC8vIGtleSBldmVudCBzaWduYWxzCi0gIGdfc2lnbmFsX2Nvbm5lY3Qo
R1RLX09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJkb21fa2V5X2Rvd24iLAotICAgICAgICAg
ICAgICAgICAgIEdfQ0FMTEJBQ0soZG9tX2tleV9kb3duX2NiKSwgYnJvd3Nlcik7Ci0gIGdfc2ln
bmFsX2Nvbm5lY3QoR1RLX09CSkVDVChicm93c2VyLT5tb3pFbWJlZCksICJkb21fa2V5X3ByZXNz
IiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKGRvbV9rZXlfcHJlc3NfY2IpLCBicm93
c2VyKTsKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPm1vekVtYmVkKSwg
ImRvbV9rZXlfdXAiLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soZG9tX2tleV91cF9j
YiksIGJyb3dzZXIpOwotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96
RW1iZWQpLCAiZG9tX21vdXNlX2Rvd24iLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0so
ZG9tX21vdXNlX2Rvd25fY2IpLCBicm93c2VyKTsKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JK
RUNUKGJyb3dzZXItPm1vekVtYmVkKSwgImRvbV9tb3VzZV91cCIsCi0gICAgICAgICAgICAgICAg
ICAgR19DQUxMQkFDSyhkb21fbW91c2VfdXBfY2IpLCBicm93c2VyKTsKLSAgZ19zaWduYWxfY29u
bmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPm1vekVtYmVkKSwgImRvbV9tb3VzZV9jbGljayIsCi0g
ICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhkb21fbW91c2VfY2xpY2tfY2IpLCBicm93c2Vy
KTsKLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPm1vekVtYmVkKSwgImRv
bV9tb3VzZV9kYmxfY2xpY2siLAotICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soZG9tX21v
dXNlX2RibF9jbGlja19jYiksIGJyb3dzZXIpOwotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpF
Q1QoYnJvd3Nlci0+bW96RW1iZWQpLCAiZG9tX21vdXNlX292ZXIiLAotICAgICAgICAgICAgICAg
ICAgIEdfQ0FMTEJBQ0soZG9tX21vdXNlX292ZXJfY2IpLCBicm93c2VyKTsKLSAgZ19zaWduYWxf
Y29ubmVjdChHVEtfT0JKRUNUKGJyb3dzZXItPm1vekVtYmVkKSwgImRvbV9tb3VzZV9vdXQiLAot
ICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soZG9tX21vdXNlX291dF9jYiksIGJyb3dzZXIp
OwotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96RW1iZWQpLCAiZG9t
X2FjdGl2YXRlIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKGRvbV9hY3RpdmF0ZV9j
YiksIGJyb3dzZXIpOwotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoYnJvd3Nlci0+bW96
RW1iZWQpLCAiZG9tX2ZvY3VzX2luIiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKGRv
bV9mb2N1c19pbl9jYiksIGJyb3dzZXIpOwotICBnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1Qo
YnJvd3Nlci0+bW96RW1iZWQpLCAiZG9tX2ZvY3VzX291dCIsCi0gICAgICAgICAgICAgICAgICAg
R19DQUxMQkFDSyhkb21fZm9jdXNfb3V0X2NiKSwgYnJvd3Nlcik7Ci0gIC8vIGhvb2t1cCB0byB3
aGVuIHRoZSB3aW5kb3cgaXMgZGVzdHJveWVkCi0gIGdfc2lnbmFsX2Nvbm5lY3QoR1RLX09CSkVD
VChicm93c2VyLT5tb3pFbWJlZCksICJkZXN0cm95IiwKLSAgICAgICAgICAgICAgICAgICBHX0NB
TExCQUNLKGRlc3Ryb3lfY2IpLCBicm93c2VyKTsKLSAgCi0gIC8vIHNldCB0aGUgY2hyb21lIHR5
cGUgc28gaXQncyBzdG9yZWQgaW4gdGhlIG9iamVjdAotICBndGtfbW96X2VtYmVkX3NldF9jaHJv
bWVfbWFzayhHVEtfTU9aX0VNQkVEKGJyb3dzZXItPm1vekVtYmVkKSwKLQkJCQlhY3R1YWxDaHJv
bWVNYXNrKTsKLQotICByZXR1cm4gYnJvd3NlcjsKLX0KLQotdm9pZAotc2V0X2Jyb3dzZXJfdmlz
aWJpbGl0eSAoVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIsIGdib29sZWFuIHZpc2liaWxpdHkpCi17
Ci0gIGlmICghdmlzaWJpbGl0eSkKLSAgewotICAgIGd0a193aWRnZXRfaGlkZShicm93c2VyLT50
b3BMZXZlbFdpbmRvdyk7Ci0gICAgcmV0dXJuOwotICB9Ci0gIAotICBpZiAoYnJvd3Nlci0+bWVu
dUJhck9uKQotICAgIGd0a193aWRnZXRfc2hvd19hbGwoYnJvd3Nlci0+bWVudUJhcik7Ci0gIGVs
c2UKLSAgICBndGtfd2lkZ2V0X2hpZGVfYWxsKGJyb3dzZXItPm1lbnVCYXIpOwotCi0gIC8vIHNp
bmNlIHRoZXkgYXJlIG9uIHRoZSBzYW1lIGxpbmUgaGVyZS4uLgotICBpZiAoYnJvd3Nlci0+dG9v
bEJhck9uIHx8IGJyb3dzZXItPmxvY2F0aW9uQmFyT24pCi0gICAgZ3RrX3dpZGdldF9zaG93X2Fs
bChicm93c2VyLT50b29sYmFySEJveCk7Ci0gIGVsc2UgCi0gICAgZ3RrX3dpZGdldF9oaWRlX2Fs
bChicm93c2VyLT50b29sYmFySEJveCk7Ci0KLSAgaWYgKGJyb3dzZXItPnN0YXR1c0Jhck9uKQot
ICAgIGd0a193aWRnZXRfc2hvd19hbGwoYnJvd3Nlci0+cHJvZ3Jlc3NBcmVhSEJveCk7Ci0gIGVs
c2UKLSAgICBndGtfd2lkZ2V0X2hpZGVfYWxsKGJyb3dzZXItPnByb2dyZXNzQXJlYUhCb3gpOwot
Ci0gIGd0a193aWRnZXRfc2hvdyhicm93c2VyLT5tb3pFbWJlZCk7Ci0gIGd0a193aWRnZXRfc2hv
dyhicm93c2VyLT50b3BMZXZlbFZCb3gpOwotICBndGtfd2lkZ2V0X3Nob3coYnJvd3Nlci0+dG9w
TGV2ZWxXaW5kb3cpOwotfQotCi12b2lkCi1iYWNrX2NsaWNrZWRfY2IgKEd0a0J1dHRvbiAqYnV0
dG9uLCBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgZ3RrX21vel9lbWJlZF9nb19iYWNr
KEdUS19NT1pfRU1CRUQoYnJvd3Nlci0+bW96RW1iZWQpKTsKLX0KLQotdm9pZAotc3RvcF9jbGlj
a2VkX2NiIChHdGtCdXR0b24gKmJ1dHRvbiwgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0g
IGdfcHJpbnQoInN0b3BfY2xpY2tlZF9jYlxuIik7Ci0gIGd0a19tb3pfZW1iZWRfc3RvcF9sb2Fk
KEdUS19NT1pfRU1CRUQoYnJvd3Nlci0+bW96RW1iZWQpKTsKLX0KLQotdm9pZAotZm9yd2FyZF9j
bGlja2VkX2NiIChHdGtCdXR0b24gKmJ1dHRvbiwgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17
Ci0gIGdfcHJpbnQoImZvcndhcmRfY2xpY2tlZF9jYlxuIik7Ci0gIGd0a19tb3pfZW1iZWRfZ29f
Zm9yd2FyZChHVEtfTU9aX0VNQkVEKGJyb3dzZXItPm1vekVtYmVkKSk7Ci19Ci0KLXZvaWQKLXJl
bG9hZF9jbGlja2VkX2NiICAoR3RrQnV0dG9uICpidXR0b24sIFRlc3RHdGtCcm93c2VyICpicm93
c2VyKQotewotICBnX3ByaW50KCJyZWxvYWRfY2xpY2tlZF9jYlxuIik7Ci0gIEdka01vZGlmaWVy
VHlwZSBzdGF0ZSA9IChHZGtNb2RpZmllclR5cGUpMDsKLSAgZ2ludCB4LCB5OwotICBnZGtfd2lu
ZG93X2dldF9wb2ludGVyKE5VTEwsICZ4LCAmeSwgJnN0YXRlKTsKLSAgCi0gIGd0a19tb3pfZW1i
ZWRfcmVsb2FkKEdUS19NT1pfRU1CRUQoYnJvd3Nlci0+bW96RW1iZWQpLAotCQkgICAgICAgKHN0
YXRlICYgR0RLX1NISUZUX01BU0spID8KLQkJICAgICAgIEdUS19NT1pfRU1CRURfRkxBR19SRUxP
QURCWVBBU1NDQUNIRSA6IAotCQkgICAgICAgR1RLX01PWl9FTUJFRF9GTEFHX1JFTE9BRE5PUk1B
TCk7Ci19Ci0KLXZvaWQgCi1zdHJlYW1fY2xpY2tlZF9jYiAgKEd0a0J1dHRvbiAgICpidXR0b24s
IFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBjb25zdCBjaGFyICpkYXRhOwotICBjb25z
dCBjaGFyICpkYXRhMjsKLSAgZGF0YSA9ICI8aHRtbD5IaSI7Ci0gIGRhdGEyID0gIiB0aGVyZTwv
aHRtbD5cbiI7Ci0gIGdfcHJpbnQoInN0cmVhbV9jbGlja2VkX2NiXG4iKTsKLSAgZ3RrX21vel9l
bWJlZF9vcGVuX3N0cmVhbShHVEtfTU9aX0VNQkVEKGJyb3dzZXItPm1vekVtYmVkKSwKLQkJCSAg
ICAiZmlsZTovLyIsICJ0ZXh0L2h0bWwiKTsKLSAgZ3RrX21vel9lbWJlZF9hcHBlbmRfZGF0YShH
VEtfTU9aX0VNQkVEKGJyb3dzZXItPm1vekVtYmVkKSwKLQkJCSAgICBkYXRhLCBzdHJsZW4oZGF0
YSkpOwotICBndGtfbW96X2VtYmVkX2FwcGVuZF9kYXRhKEdUS19NT1pfRU1CRUQoYnJvd3Nlci0+
bW96RW1iZWQpLAotCQkJICAgIGRhdGEyLCBzdHJsZW4oZGF0YTIpKTsKLSAgZ3RrX21vel9lbWJl
ZF9jbG9zZV9zdHJlYW0oR1RLX01PWl9FTUJFRChicm93c2VyLT5tb3pFbWJlZCkpOwotfQotCi12
b2lkCi11cmxfYWN0aXZhdGVfY2IgICAgKEd0a0VkaXRhYmxlICp3aWRnZXQsIFRlc3RHdGtCcm93
c2VyICpicm93c2VyKQotewotICBnY2hhciAqdGV4dCA9IGd0a19lZGl0YWJsZV9nZXRfY2hhcnMo
d2lkZ2V0LCAwLCAtMSk7Ci0gIGdfcHJpbnQoImxvYWRpbmcgdXJsICVzXG4iLCB0ZXh0KTsKLSAg
Z3RrX21vel9lbWJlZF9sb2FkX3VybChHVEtfTU9aX0VNQkVEKGJyb3dzZXItPm1vekVtYmVkKSwg
dGV4dCk7Ci0gIGdfZnJlZSh0ZXh0KTsKLX0KLQotdm9pZAotbWVudV9vcGVuX25ld19jYiAgIChH
dGtNZW51SXRlbSAqbWVudWl0ZW0sIFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBnX3By
aW50KCJvcGVuaW5nIG5ldyBicm93c2VyLlxuIik7Ci0gIFRlc3RHdGtCcm93c2VyICpuZXdCcm93
c2VyID0gCi0gICAgbmV3X2d0a19icm93c2VyKEdUS19NT1pfRU1CRURfRkxBR19ERUZBVUxUQ0hS
T01FKTsKLSAgZ3RrX3dpZGdldF9zZXRfc2l6ZV9yZXF1ZXN0KG5ld0Jyb3dzZXItPm1vekVtYmVk
LCA0MDAsIDQwMCk7Ci0gIHNldF9icm93c2VyX3Zpc2liaWxpdHkobmV3QnJvd3NlciwgVFJVRSk7
Ci19Ci0KLXZvaWQKLW1lbnVfc3RyZWFtX2NiICAgICAoR3RrTWVudUl0ZW0gKm1lbnVpdGVtLCBU
ZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgZ19wcmludCgibWVudV9zdHJlYW1fY2JcbiIp
OwotICBjb25zdCBjaGFyICpkYXRhOwotICBjb25zdCBjaGFyICpkYXRhMjsKLSAgZGF0YSA9ICI8
aHRtbD5IaSI7Ci0gIGRhdGEyID0gIiA8YSBocmVmPSdmb28uaHRtbCc+dGhlcmU8L2E+PC9odG1s
PlxuIjsKLSAgZ19wcmludCgic3RyZWFtX2NsaWNrZWRfY2JcbiIpOwotICBndGtfbW96X2VtYmVk
X29wZW5fc3RyZWFtKEdUS19NT1pfRU1CRUQoYnJvd3Nlci0+bW96RW1iZWQpLAotCQkJICAgICJm
aWxlOi8vIiwgInRleHQvaHRtbCIpOwotICBndGtfbW96X2VtYmVkX2FwcGVuZF9kYXRhKEdUS19N
T1pfRU1CRUQoYnJvd3Nlci0+bW96RW1iZWQpLAotCQkJICAgIGRhdGEsIHN0cmxlbihkYXRhKSk7
Ci0gIGd0a19tb3pfZW1iZWRfYXBwZW5kX2RhdGEoR1RLX01PWl9FTUJFRChicm93c2VyLT5tb3pF
bWJlZCksCi0JCQkgICAgZGF0YTIsIHN0cmxlbihkYXRhMikpOwotICBndGtfbW96X2VtYmVkX2Ns
b3NlX3N0cmVhbShHVEtfTU9aX0VNQkVEKGJyb3dzZXItPm1vekVtYmVkKSk7Ci19Ci0KLXZvaWQK
LW1lbnVfbWVtb3J5X2NiIChHdGtNZW51SXRlbSAqbWVudWl0ZW0sIFRlc3RHdGtCcm93c2VyICpi
cm93c2VyKQotewotICBnX3ByaW50KCJtZW51X21lbW9yeV9jYlxuIik7Ci0gIG5zQ09NUHRyPG5z
SU9ic2VydmVyU2VydmljZT4gb3MgPSBkb19HZXRTZXJ2aWNlKCJAbW96aWxsYS5vcmcvb2JzZXJ2
ZXItc2VydmljZTsxIik7Ci0gIGlmICghb3MpCi0gICAgcmV0dXJuOwotCi0gIC8vIENvbXBhY3Qg
bGlrZSB5b3UgbWVhbiBpdC4gIFdlIGRvIHRoaXMgdGhyZWUgdGltZXMgdG8gZ2l2ZSB0aGUKLSAg
Ly8gY3ljbGUgY29sbGVjdG9yIGEgY2hhbmNlIHRvIHRyeSBhbmQgcmVjbGFpbSBhcyBtdWNoIGFz
IHdlIGNhbi4KLSAgb3MtPk5vdGlmeU9ic2VydmVycyhuc251bGwsICJtZW1vcnktcHJlc3N1cmUi
LCBOU19MSVRFUkFMX1NUUklORygiaGVhcC1taW5pbWl6ZSIpLmdldCgpKTsKLSAgb3MtPk5vdGlm
eU9ic2VydmVycyhuc251bGwsICJtZW1vcnktcHJlc3N1cmUiLCBOU19MSVRFUkFMX1NUUklORygi
aGVhcC1taW5pbWl6ZSIpLmdldCgpKTsKLSAgb3MtPk5vdGlmeU9ic2VydmVycyhuc251bGwsICJt
ZW1vcnktcHJlc3N1cmUiLCBOU19MSVRFUkFMX1NUUklORygiaGVhcC1taW5pbWl6ZSIpLmdldCgp
KTsKLX0KLQotdm9pZAotbWVudV9jbG9zZV9jYiAoR3RrTWVudUl0ZW0gKm1lbnVpdGVtLCBUZXN0
R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgZ3RrX3dpZGdldF9kZXN0cm95KGJyb3dzZXItPnRv
cExldmVsV2luZG93KTsKLX0KLQotdm9pZAotbWVudV9xdWl0X2NiIChHdGtNZW51SXRlbSAqbWVu
dWl0ZW0sIFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBUZXN0R3RrQnJvd3NlciAqdG1w
QnJvd3NlcjsKLSAgR0xpc3QgKnRtcF9saXN0ID0gYnJvd3Nlcl9saXN0OwotICB0bXBCcm93c2Vy
ID0gKFRlc3RHdGtCcm93c2VyICopdG1wX2xpc3QtPmRhdGE7Ci0gIHdoaWxlICh0bXBCcm93c2Vy
KSB7Ci0gICAgdG1wX2xpc3QgPSB0bXBfbGlzdC0+bmV4dDsKLSAgICBndGtfd2lkZ2V0X2Rlc3Ry
b3kodG1wQnJvd3Nlci0+dG9wTGV2ZWxXaW5kb3cpOwotICAgIHRtcEJyb3dzZXIgPSAoVGVzdEd0
a0Jyb3dzZXIgKil0bXBfbGlzdC0+ZGF0YTsKLSAgfQotfQotCi1nYm9vbGVhbgotZGVsZXRlX2Ni
KEd0a1dpZGdldCAqd2lkZ2V0LCBHZGtFdmVudEFueSAqZXZlbnQsIFRlc3RHdGtCcm93c2VyICpi
cm93c2VyKQotewotICBnX3ByaW50KCJkZWxldGVfY2JcbiIpOwotICBndGtfd2lkZ2V0X2Rlc3Ry
b3kod2lkZ2V0KTsKLSAgcmV0dXJuIFRSVUU7Ci19Ci0KLXN0YXRpYyBnYm9vbGVhbgotaWRsZV9x
dWl0KHZvaWQqKQotewotICBndGtfbWFpbl9xdWl0KCk7Ci0gIHJldHVybiBGQUxTRTsKLX0KLQot
c3RhdGljIGdib29sZWFuCi1pZGxlX3BvcCh2b2lkKikKLXsKLSAgZ3RrX21vel9lbWJlZF9wb3Bf
c3RhcnR1cCgpOwotICByZXR1cm4gRkFMU0U7Ci19Ci0KLXZvaWQKLWRlc3Ryb3lfY2IgICAgICAg
ICAoR3RrV2lkZ2V0ICp3aWRnZXQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBHTGlz
dCAqdG1wX2xpc3Q7Ci0gIGdfcHJpbnQoImRlc3Ryb3lfY2JcbiIpOwotICBudW1fYnJvd3NlcnMt
LTsKLSAgdG1wX2xpc3QgPSBnX2xpc3RfZmluZChicm93c2VyX2xpc3QsIGJyb3dzZXIpOwotICBi
cm93c2VyX2xpc3QgPSBnX2xpc3RfcmVtb3ZlX2xpbmsoYnJvd3Nlcl9saXN0LCB0bXBfbGlzdCk7
Ci0gIGlmIChicm93c2VyLT50ZW1wTWVzc2FnZSkKLSAgICBnX2ZyZWUoYnJvd3Nlci0+dGVtcE1l
c3NhZ2UpOwotICBnX2lkbGVfYWRkKGlkbGVfcG9wLCBOVUxMKTsKLSAgaWYgKG51bV9icm93c2Vy
cyA9PSAwKQotICAgIGdfaWRsZV9hZGQgKGlkbGVfcXVpdCwgTlVMTCk7Ci19Ci0KLXZvaWQKLWxv
Y2F0aW9uX2NoYW5nZWRfY2IgKEd0a01vekVtYmVkICplbWJlZCwgVGVzdEd0a0Jyb3dzZXIgKmJy
b3dzZXIpCi17Ci0gIGNoYXIgKm5ld0xvY2F0aW9uOwotICBpbnQgICBuZXdQb3NpdGlvbiA9IDA7
Ci0gIGdfcHJpbnQoImxvY2F0aW9uX2NoYW5nZWRfY2JcbiIpOwotICBuZXdMb2NhdGlvbiA9IGd0
a19tb3pfZW1iZWRfZ2V0X2xvY2F0aW9uKGVtYmVkKTsKLSAgaWYgKG5ld0xvY2F0aW9uKQotICB7
Ci0gICAgZ3RrX2VkaXRhYmxlX2RlbGV0ZV90ZXh0KEdUS19FRElUQUJMRShicm93c2VyLT51cmxF
bnRyeSksIDAsIC0xKTsKLSAgICBndGtfZWRpdGFibGVfaW5zZXJ0X3RleHQoR1RLX0VESVRBQkxF
KGJyb3dzZXItPnVybEVudHJ5KSwKLQkJCSAgICAgbmV3TG9jYXRpb24sIHN0cmxlbihuZXdMb2Nh
dGlvbiksICZuZXdQb3NpdGlvbik7Ci0gICAgZ19mcmVlKG5ld0xvY2F0aW9uKTsKLSAgfQotICBl
bHNlCi0gICAgZ19wcmludCgiZmFpbGVkIHRvIGdldCBsb2NhdGlvbiFcbiIpOwotICAvLyBhbHdh
eXMgbWFrZSBzdXJlIHRvIGNsZWFyIHRoZSB0ZW1wTWVzc2FnZS4gIGl0IG1pZ2h0IGhhdmUgYmVl
bgotICAvLyBzZXQgZnJvbSB0aGUgbGluayBiZWZvcmUgYSBjbGljayBhbmQgd2Ugd291bGRuJ3Qg
aGF2ZSBnb3R0ZW4gdGhlCi0gIC8vIGNhbGxiYWNrIHRvIHVuc2V0IGl0LgotICB1cGRhdGVfdGVt
cF9tZXNzYWdlKGJyb3dzZXIsIDApOwotICAvLyB1cGRhdGUgdGhlIG5hdiBidXR0b25zIG9uIGEg
bG9jYXRpb24gY2hhbmdlCi0gIHVwZGF0ZV9uYXZfYnV0dG9ucyhicm93c2VyKTsKLX0KLQotdm9p
ZAotdGl0bGVfY2hhbmdlZF9jYiAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBUZXN0R3RrQnJvd3Nl
ciAqYnJvd3NlcikKLXsKLSAgY2hhciAqbmV3VGl0bGU7Ci0gIGdfcHJpbnQoInRpdGxlX2NoYW5n
ZWRfY2JcbiIpOwotICBuZXdUaXRsZSA9IGd0a19tb3pfZW1iZWRfZ2V0X3RpdGxlKGVtYmVkKTsK
LSAgaWYgKG5ld1RpdGxlKQotICB7Ci0gICAgZ3RrX3dpbmRvd19zZXRfdGl0bGUoR1RLX1dJTkRP
Vyhicm93c2VyLT50b3BMZXZlbFdpbmRvdyksIG5ld1RpdGxlKTsKLSAgICBnX2ZyZWUobmV3VGl0
bGUpOwotICB9Ci0gIAotfQotCi12b2lkCi1sb2FkX3N0YXJ0ZWRfY2IgICAgIChHdGtNb3pFbWJl
ZCAqZW1iZWQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBnX3ByaW50KCJsb2FkX3N0
YXJ0ZWRfY2JcbiIpOwotICBndGtfd2lkZ2V0X3NldF9zZW5zaXRpdmUoYnJvd3Nlci0+c3RvcEJ1
dHRvbiwgVFJVRSk7Ci0gIGd0a193aWRnZXRfc2V0X3NlbnNpdGl2ZShicm93c2VyLT5yZWxvYWRC
dXR0b24sIEZBTFNFKTsKLSAgYnJvd3Nlci0+bG9hZFBlcmNlbnQgPSAwOwotICBicm93c2VyLT5i
eXRlc0xvYWRlZCA9IDA7Ci0gIGJyb3dzZXItPm1heEJ5dGVzTG9hZGVkID0gMDsKLSAgdXBkYXRl
X3N0YXR1c19iYXJfdGV4dChicm93c2VyKTsKLX0KLQotdm9pZAotbG9hZF9maW5pc2hlZF9jYiAg
ICAoR3RrTW96RW1iZWQgKmVtYmVkLCBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgZ19w
cmludCgibG9hZF9maW5pc2hlZF9jYlxuIik7Ci0gIGd0a193aWRnZXRfc2V0X3NlbnNpdGl2ZShi
cm93c2VyLT5zdG9wQnV0dG9uLCBGQUxTRSk7Ci0gIGd0a193aWRnZXRfc2V0X3NlbnNpdGl2ZShi
cm93c2VyLT5yZWxvYWRCdXR0b24sIFRSVUUpOwotICBicm93c2VyLT5sb2FkUGVyY2VudCA9IDA7
Ci0gIGJyb3dzZXItPmJ5dGVzTG9hZGVkID0gMDsKLSAgYnJvd3Nlci0+bWF4Qnl0ZXNMb2FkZWQg
PSAwOwotICB1cGRhdGVfc3RhdHVzX2Jhcl90ZXh0KGJyb3dzZXIpOwotICBndGtfcHJvZ3Jlc3Nf
YmFyX3NldF9mcmFjdGlvbihHVEtfUFJPR1JFU1NfQkFSKGJyb3dzZXItPnByb2dyZXNzQmFyKSwg
MCk7Ci19Ci0KLQotdm9pZAotbmV0X3N0YXRlX2NoYW5nZV9jYiAoR3RrTW96RW1iZWQgKmVtYmVk
LCBnaW50IGZsYWdzLCBndWludCBzdGF0dXMsCi0JCSAgICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dz
ZXIpCi17Ci0gIGdfcHJpbnQoIm5ldF9zdGF0ZV9jaGFuZ2VfY2IgJWRcbiIsIGZsYWdzKTsKLSAg
aWYgKGZsYWdzICYgR1RLX01PWl9FTUJFRF9GTEFHX0lTX1JFUVVFU1QpIHsKLSAgICBpZiAoZmxh
Z3MgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfUkVESVJFQ1RJTkcpCi0gICAgYnJvd3Nlci0+c3RhdHVz
TWVzc2FnZSA9ICJSZWRpcmVjdGluZyB0byBzaXRlLi4uIjsKLSAgICBlbHNlIGlmIChmbGFncyAm
IEdUS19NT1pfRU1CRURfRkxBR19UUkFOU0ZFUlJJTkcpCi0gICAgYnJvd3Nlci0+c3RhdHVzTWVz
c2FnZSA9ICJUcmFuc2ZlcnJpbmcgZGF0YSBmcm9tIHNpdGUuLi4iOwotICAgIGVsc2UgaWYgKGZs
YWdzICYgR1RLX01PWl9FTUJFRF9GTEFHX05FR09USUFUSU5HKQotICAgIGJyb3dzZXItPnN0YXR1
c01lc3NhZ2UgPSAiV2FpdGluZyBmb3IgYXV0aG9yaXphdGlvbi4uLiI7Ci0gIH0KLQotICBpZiAo
c3RhdHVzID09IEdUS19NT1pfRU1CRURfU1RBVFVTX0ZBSUxFRF9ETlMpCi0gICAgYnJvd3Nlci0+
c3RhdHVzTWVzc2FnZSA9ICJTaXRlIG5vdCBmb3VuZC4iOwotICBlbHNlIGlmIChzdGF0dXMgPT0g
R1RLX01PWl9FTUJFRF9TVEFUVVNfRkFJTEVEX0NPTk5FQ1QpCi0gICAgYnJvd3Nlci0+c3RhdHVz
TWVzc2FnZSA9ICJGYWlsZWQgdG8gY29ubmVjdCB0byBzaXRlLiI7Ci0gIGVsc2UgaWYgKHN0YXR1
cyA9PSBHVEtfTU9aX0VNQkVEX1NUQVRVU19GQUlMRURfVElNRU9VVCkKLSAgICBicm93c2VyLT5z
dGF0dXNNZXNzYWdlID0gIkZhaWxlZCBkdWUgdG8gY29ubmVjdGlvbiB0aW1lb3V0LiI7Ci0gIGVs
c2UgaWYgKHN0YXR1cyA9PSBHVEtfTU9aX0VNQkVEX1NUQVRVU19GQUlMRURfVVNFUkNBTkNFTEVE
KQotICAgIGJyb3dzZXItPnN0YXR1c01lc3NhZ2UgPSAiVXNlciBjYW5jZWxlZCBjb25uZWN0aW5n
IHRvIHNpdGUuIjsKLQotICBpZiAoZmxhZ3MgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfSVNfRE9DVU1F
TlQpIHsKLSAgICBpZiAoZmxhZ3MgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfU1RBUlQpCi0gICAgICBi
cm93c2VyLT5zdGF0dXNNZXNzYWdlID0gIkxvYWRpbmcgc2l0ZS4uLiI7Ci0gICAgZWxzZSBpZiAo
ZmxhZ3MgJiBHVEtfTU9aX0VNQkVEX0ZMQUdfU1RPUCkKLSAgICAgIGJyb3dzZXItPnN0YXR1c01l
c3NhZ2UgPSAiRG9uZS4iOwotICB9Ci0KLSAgdXBkYXRlX3N0YXR1c19iYXJfdGV4dChicm93c2Vy
KTsKLSAgCi19Ci0KLXZvaWQgbmV0X3N0YXRlX2NoYW5nZV9hbGxfY2IgKEd0a01vekVtYmVkICpl
bWJlZCwgY29uc3QgY2hhciAqdXJpLAotCQkJCSAgICAgZ2ludCBmbGFncywgZ3VpbnQgc3RhdHVz
LAotCQkJCSAgICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIC8vICBnX3ByaW50KCJu
ZXRfc3RhdGVfY2hhbmdlX2FsbF9jYiAlcyAlZCAlZFxuIiwgdXJpLCBmbGFncywgc3RhdHVzKTsK
LX0KLQotdm9pZCBwcm9ncmVzc19jaGFuZ2VfY2IgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBnaW50
IGN1ciwgZ2ludCBtYXgsCi0JCQkgICBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgZ19w
cmludCgicHJvZ3Jlc3NfY2hhbmdlX2NiIGN1ciAlZCBtYXggJWRcbiIsIGN1ciwgbWF4KTsKLQot
ICAvLyBhdm9pZCB0aG9zZSBwZXNreSBkaXZpZGUgYnkgemVybyBlcnJvcnMKLSAgaWYgKG1heCA8
IDEpCi0gIHsKLSAgICBicm93c2VyLT5sb2FkUGVyY2VudCA9IDA7Ci0gICAgYnJvd3Nlci0+Ynl0
ZXNMb2FkZWQgPSBjdXI7Ci0gICAgYnJvd3Nlci0+bWF4Qnl0ZXNMb2FkZWQgPSAwOwotICAgIHVw
ZGF0ZV9zdGF0dXNfYmFyX3RleHQoYnJvd3Nlcik7Ci0gIH0KLSAgZWxzZQotICB7Ci0gICAgYnJv
d3Nlci0+Ynl0ZXNMb2FkZWQgPSBjdXI7Ci0gICAgYnJvd3Nlci0+bWF4Qnl0ZXNMb2FkZWQgPSBt
YXg7Ci0gICAgaWYgKGN1ciA+IG1heCkKLSAgICAgIGJyb3dzZXItPmxvYWRQZXJjZW50ID0gMTAw
OwotICAgIGVsc2UKLSAgICAgIGJyb3dzZXItPmxvYWRQZXJjZW50ID0gKGN1ciAqIDEwMCkgLyBt
YXg7Ci0gICAgdXBkYXRlX3N0YXR1c19iYXJfdGV4dChicm93c2VyKTsKLSAgICBndGtfcHJvZ3Jl
c3NfYmFyX3NldF9mcmFjdGlvbihHVEtfUFJPR1JFU1NfQkFSKGJyb3dzZXItPnByb2dyZXNzQmFy
KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm93c2VyLT5sb2FkUGVyY2Vu
dCAvIDEwMC4wKTsKLSAgfQotICAKLX0KLQotdm9pZCBwcm9ncmVzc19jaGFuZ2VfYWxsX2NiIChH
dGtNb3pFbWJlZCAqZW1iZWQsIGNvbnN0IGNoYXIgKnVyaSwKLQkJCSAgICAgZ2ludCBjdXIsIGdp
bnQgbWF4LAotCQkJICAgICBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgLy9nX3ByaW50
KCJwcm9ncmVzc19jaGFuZ2VfYWxsX2NiICVzIGN1ciAlZCBtYXggJWRcbiIsIHVyaSwgY3VyLCBt
YXgpOwotfQotCi12b2lkCi1saW5rX21lc3NhZ2VfY2IgICAgICAoR3RrTW96RW1iZWQgKmVtYmVk
LCBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgY2hhciAqbWVzc2FnZTsKLSAgZ19wcmlu
dCgibGlua19tZXNzYWdlX2NiXG4iKTsKLSAgbWVzc2FnZSA9IGd0a19tb3pfZW1iZWRfZ2V0X2xp
bmtfbWVzc2FnZShlbWJlZCk7Ci0gIGlmICghbWVzc2FnZSB8fCAhKm1lc3NhZ2UpCi0gICAgdXBk
YXRlX3RlbXBfbWVzc2FnZShicm93c2VyLCAwKTsKLSAgZWxzZQotICAgIHVwZGF0ZV90ZW1wX21l
c3NhZ2UoYnJvd3NlciwgbWVzc2FnZSk7Ci0gIGlmIChtZXNzYWdlKQotICAgIGdfZnJlZShtZXNz
YWdlKTsKLX0KLQotdm9pZAotanNfc3RhdHVzX2NiIChHdGtNb3pFbWJlZCAqZW1iZWQsIFRlc3RH
dGtCcm93c2VyICpicm93c2VyKQotewotIGNoYXIgKm1lc3NhZ2U7Ci0gIGdfcHJpbnQoImpzX3N0
YXR1c19jYlxuIik7Ci0gIG1lc3NhZ2UgPSBndGtfbW96X2VtYmVkX2dldF9qc19zdGF0dXMoZW1i
ZWQpOwotICBpZiAoIW1lc3NhZ2UgfHwgISptZXNzYWdlKQotICAgIHVwZGF0ZV90ZW1wX21lc3Nh
Z2UoYnJvd3NlciwgMCk7Ci0gIGVsc2UKLSAgICB1cGRhdGVfdGVtcF9tZXNzYWdlKGJyb3dzZXIs
IG1lc3NhZ2UpOwotICBpZiAobWVzc2FnZSkKLSAgICBnX2ZyZWUobWVzc2FnZSk7Ci19Ci0KLXZv
aWQKLW5ld193aW5kb3dfY2IgKEd0a01vekVtYmVkICplbWJlZCwgR3RrTW96RW1iZWQgKipuZXdF
bWJlZCwgZ3VpbnQgY2hyb21lbWFzaywgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIGdf
cHJpbnQoIm5ld193aW5kb3dfY2JcbiIpOwotICBnX3ByaW50KCJlbWJlZCBpcyAlcCBjaHJvbWVt
YXNrIGlzICVkXG4iLCAodm9pZCAqKWVtYmVkLCBjaHJvbWVtYXNrKTsKLSAgVGVzdEd0a0Jyb3dz
ZXIgKm5ld0Jyb3dzZXIgPSBuZXdfZ3RrX2Jyb3dzZXIoY2hyb21lbWFzayk7Ci0gIGd0a193aWRn
ZXRfc2V0X3NpemVfcmVxdWVzdChuZXdCcm93c2VyLT5tb3pFbWJlZCwgNDAwLCA0MDApOwotICAq
bmV3RW1iZWQgPSBHVEtfTU9aX0VNQkVEKG5ld0Jyb3dzZXItPm1vekVtYmVkKTsKLSAgZ19wcmlu
dCgibmV3IGJyb3dzZXIgaXMgJXBcbiIsICh2b2lkICopKm5ld0VtYmVkKTsKLX0KLQotdm9pZAot
dmlzaWJpbGl0eV9jYiAoR3RrTW96RW1iZWQgKmVtYmVkLCBnYm9vbGVhbiB2aXNpYmlsaXR5LCBU
ZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgZ19wcmludCgidmlzaWJpbGl0eV9jYiAlZFxu
IiwgdmlzaWJpbGl0eSk7Ci0gIHNldF9icm93c2VyX3Zpc2liaWxpdHkoYnJvd3NlciwgdmlzaWJp
bGl0eSk7Ci19Ci0KLXZvaWQKLWRlc3Ryb3lfYnJzcl9jYiAgICAgIChHdGtNb3pFbWJlZCAqZW1i
ZWQsIFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBnX3ByaW50KCJkZXN0cm95X2Jyc3Jf
Y2JcbiIpOwotICBndGtfd2lkZ2V0X2Rlc3Ryb3koYnJvd3Nlci0+dG9wTGV2ZWxXaW5kb3cpOwot
fQotCi1naW50Ci1vcGVuX3VyaV9jYiAgICAgICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBjb25z
dCBjaGFyICp1cmksIFRlc3RHdGtCcm93c2VyICpicm93c2VyKQotewotICBnX3ByaW50KCJvcGVu
X3VyaV9jYiAlc1xuIiwgdXJpKTsKLQotICAvLyBpbnRlcnJ1cHQgdGhpcyB0ZXN0IGxvYWQKLSAg
aWYgKCFzdHJjbXAodXJpLCAiaHR0cDovL3Blb3BsZS5yZWRoYXQuY29tL2JsaXp6YXJkL21vbmtl
eXMudHh0IikpCi0gICAgcmV0dXJuIFRSVUU7Ci0gIC8vIGRvbid0IGludGVycnVwdCBhbnl0aGlu
ZwotICByZXR1cm4gRkFMU0U7Ci19Ci0KLXZvaWQKLXNpemVfdG9fY2IgKEd0a01vekVtYmVkICpl
bWJlZCwgZ2ludCB3aWR0aCwgZ2ludCBoZWlnaHQsCi0JICAgIFRlc3RHdGtCcm93c2VyICpicm93
c2VyKQotewotICBnX3ByaW50KCIqKiogc2l6ZV90b19jYiAlZCAlZFxuIiwgd2lkdGgsIGhlaWdo
dCk7Ci0gIGd0a193aWRnZXRfc2V0X3NpemVfcmVxdWVzdChicm93c2VyLT5tb3pFbWJlZCwgd2lk
dGgsIGhlaWdodCk7Ci19Ci0KLWdpbnQgZG9tX2tleV9kb3duX2NiICAgICAgKEd0a01vekVtYmVk
ICplbWJlZCwgbnNJRE9NS2V5RXZlbnQgKmV2ZW50LAotCQkJICAgVGVzdEd0a0Jyb3dzZXIgKmJy
b3dzZXIpCi17Ci0gIFBSVWludDMyIGtleUNvZGUgPSAwOwotICAvLyAgZ19wcmludCgiZG9tX2tl
eV9kb3duX2NiXG4iKTsKLSAgZXZlbnQtPkdldEtleUNvZGUoJmtleUNvZGUpOwotICAvLyBnX3By
aW50KCJrZXkgY29kZSBpcyAlZFxuIiwga2V5Q29kZSk7Ci0gIHJldHVybiBOU19PSzsKLX0KLQot
Z2ludCBkb21fa2V5X3ByZXNzX2NiICAgICAoR3RrTW96RW1iZWQgKmVtYmVkLCBuc0lET01LZXlF
dmVudCAqZXZlbnQsCi0JCQkgICBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgUFJVaW50
MzIga2V5Q29kZSA9IDA7Ci0gIC8vIGdfcHJpbnQoImRvbV9rZXlfcHJlc3NfY2JcbiIpOwotICBl
dmVudC0+R2V0Q2hhckNvZGUoJmtleUNvZGUpOwotICAvLyBnX3ByaW50KCJjaGFyIGNvZGUgaXMg
JWRcbiIsIGtleUNvZGUpOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLWdpbnQgZG9tX2tleV91cF9j
YiAgICAgICAgKEd0a01vekVtYmVkICplbWJlZCwgbnNJRE9NS2V5RXZlbnQgKmV2ZW50LAotCQkJ
ICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIFBSVWludDMyIGtleUNvZGUgPSAwOwot
ICAvLyBnX3ByaW50KCJkb21fa2V5X3VwX2NiXG4iKTsKLSAgZXZlbnQtPkdldEtleUNvZGUoJmtl
eUNvZGUpOwotICAvLyBnX3ByaW50KCJrZXkgY29kZSBpcyAlZFxuIiwga2V5Q29kZSk7Ci0gIHJl
dHVybiBOU19PSzsKLX0KLQotZ2ludCBkb21fbW91c2VfZG93bl9jYiAgICAoR3RrTW96RW1iZWQg
KmVtYmVkLCBuc0lET01Nb3VzZUV2ZW50ICpldmVudCwKLQkJCSAgIFRlc3RHdGtCcm93c2VyICpi
cm93c2VyKQotewotICAvLyAgZ19wcmludCgiZG9tX21vdXNlX2Rvd25fY2JcbiIpOwotICByZXR1
cm4gTlNfT0s7Ci0gfQotCi1naW50IGRvbV9tb3VzZV91cF9jYiAgICAgIChHdGtNb3pFbWJlZCAq
ZW1iZWQsIG5zSURPTU1vdXNlRXZlbnQgKmV2ZW50LAotCQkJICAgVGVzdEd0a0Jyb3dzZXIgKmJy
b3dzZXIpCi17Ci0gIC8vICBnX3ByaW50KCJkb21fbW91c2VfdXBfY2JcbiIpOwotICByZXR1cm4g
TlNfT0s7Ci19Ci0KLWdpbnQgZG9tX21vdXNlX2NsaWNrX2NiICAgKEd0a01vekVtYmVkICplbWJl
ZCwgbnNJRE9NTW91c2VFdmVudCAqZXZlbnQsCi0JCQkgICBUZXN0R3RrQnJvd3NlciAqYnJvd3Nl
cikKLXsKLSAgLy8gIGdfcHJpbnQoImRvbV9tb3VzZV9jbGlja19jYlxuIik7Ci0gIFBSVWludDE2
IGJ1dHRvbjsKLSAgZXZlbnQtPkdldEJ1dHRvbigmYnV0dG9uKTsKLSAgcHJpbnRmKCJidXR0b24g
d2FzICVkXG4iLCBidXR0b24pOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLWdpbnQgZG9tX21vdXNl
X2RibF9jbGlja19jYiAoR3RrTW96RW1iZWQgKmVtYmVkLCBuc0lET01Nb3VzZUV2ZW50ICpldmVu
dCwKLQkJCSAgICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIC8vICBnX3ByaW50KCJk
b21fbW91c2VfZGJsX2NsaWNrX2NiXG4iKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1naW50IGRv
bV9tb3VzZV9vdmVyX2NiICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIG5zSURPTU1vdXNlRXZlbnQg
KmV2ZW50LAotCQkJICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIC8vZ19wcmludCgi
ZG9tX21vdXNlX292ZXJfY2JcbiIpOwotICByZXR1cm4gTlNfT0s7Ci19Ci0KLWdpbnQgZG9tX21v
dXNlX291dF9jYiAgICAgKEd0a01vekVtYmVkICplbWJlZCwgbnNJRE9NTW91c2VFdmVudCAqZXZl
bnQsCi0JCQkgICBUZXN0R3RrQnJvd3NlciAqYnJvd3NlcikKLXsKLSAgLy9nX3ByaW50KCJkb21f
bW91c2Vfb3V0X2NiXG4iKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1naW50IGRvbV9hY3RpdmF0
ZV9jYiAgICAgIChHdGtNb3pFbWJlZCAqZW1iZWQsIG5zSURPTVVJRXZlbnQgKmV2ZW50LAotCQkJ
ICAgVGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIC8vZ19wcmludCgiZG9tX2FjdGl2YXRl
X2NiXG4iKTsKLSAgcmV0dXJuIE5TX09LOwotfQotCi1naW50IGRvbV9mb2N1c19pbl9jYiAgICAg
IChHdGtNb3pFbWJlZCAqZW1iZWQsIG5zSURPTVVJRXZlbnQgKmV2ZW50LAotCQkJICAgVGVzdEd0
a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIC8vZ19wcmludCgiZG9tX2ZvY3VzX2luX2NiXG4iKTsK
LSAgcmV0dXJuIE5TX09LOwotfQotCi1naW50IGRvbV9mb2N1c19vdXRfY2IgICAgIChHdGtNb3pF
bWJlZCAqZW1iZWQsIG5zSURPTVVJRXZlbnQgKmV2ZW50LAotCQkJICAgVGVzdEd0a0Jyb3dzZXIg
KmJyb3dzZXIpCi17Ci0gIC8vZ19wcmludCgiZG9tX2ZvY3VzX291dF9jYlxuIik7Ci0gIHJldHVy
biBOU19PSzsKLX0KLQotdm9pZCBuZXdfd2luZG93X29ycGhhbl9jYiAoR3RrTW96RW1iZWRTaW5n
bGUgKmVtYmVkLAotCQkJICAgR3RrTW96RW1iZWQgKipyZXR2YWwsIGd1aW50IGNocm9tZW1hc2ss
Ci0JCQkgICBncG9pbnRlciBkYXRhKQotewotICBnX3ByaW50KCJuZXdfd2luZG93X29ycGhhbl9j
YlxuIik7Ci0gIGdfcHJpbnQoImNocm9tZW1hc2sgaXMgJWRcbiIsIGNocm9tZW1hc2spOwotICBU
ZXN0R3RrQnJvd3NlciAqbmV3QnJvd3NlciA9IG5ld19ndGtfYnJvd3NlcihjaHJvbWVtYXNrKTsK
LSAgKnJldHZhbCA9IEdUS19NT1pfRU1CRUQobmV3QnJvd3Nlci0+bW96RW1iZWQpOwotICBnX3By
aW50KCJuZXcgYnJvd3NlciBpcyAlcFxuIiwgKHZvaWQgKikqcmV0dmFsKTsKLX0KLQotLy8gdXRp
bGl0eSBmdW5jdGlvbnMKLQotdm9pZAotdXBkYXRlX3N0YXR1c19iYXJfdGV4dChUZXN0R3RrQnJv
d3NlciAqYnJvd3NlcikKLXsKLSAgZ2NoYXIgbWVzc2FnZVsyNTZdOwotICAKLSAgZ3RrX3N0YXR1
c2Jhcl9wb3AoR1RLX1NUQVRVU0JBUihicm93c2VyLT5zdGF0dXNCYXIpLCAxKTsKLSAgaWYgKGJy
b3dzZXItPnRlbXBNZXNzYWdlKQotICAgIGd0a19zdGF0dXNiYXJfcHVzaChHVEtfU1RBVFVTQkFS
KGJyb3dzZXItPnN0YXR1c0JhciksIDEsIGJyb3dzZXItPnRlbXBNZXNzYWdlKTsKLSAgZWxzZQot
ICB7Ci0gICAgaWYgKGJyb3dzZXItPmxvYWRQZXJjZW50KQotICAgIHsKLSAgICAgIGdfc25wcmlu
dGYobWVzc2FnZSwgMjU1LCAiJXMgKCVkJSUgY29tcGxldGUsICVkIGJ5dGVzIG9mICVkIGxvYWRl
ZCkiLCBicm93c2VyLT5zdGF0dXNNZXNzYWdlLCBicm93c2VyLT5sb2FkUGVyY2VudCwgYnJvd3Nl
ci0+Ynl0ZXNMb2FkZWQsIGJyb3dzZXItPm1heEJ5dGVzTG9hZGVkKTsKLSAgICB9Ci0gICAgZWxz
ZSBpZiAoYnJvd3Nlci0+Ynl0ZXNMb2FkZWQpCi0gICAgewotICAgICAgZ19zbnByaW50ZihtZXNz
YWdlLCAyNTUsICIlcyAoJWQgYnl0ZXMgbG9hZGVkKSIsIGJyb3dzZXItPnN0YXR1c01lc3NhZ2Us
IGJyb3dzZXItPmJ5dGVzTG9hZGVkKTsKLSAgICB9Ci0gICAgZWxzZSBpZiAoYnJvd3Nlci0+c3Rh
dHVzTWVzc2FnZSA9PSBOVUxMKQotICAgIHsKLSAgICAgIGdfc25wcmludGYobWVzc2FnZSwgMjU1
LCAiICIpOwotICAgIH0KLSAgICBlbHNlCi0gICAgewotICAgICAgZ19zbnByaW50ZihtZXNzYWdl
LCAyNTUsICIlcyIsIGJyb3dzZXItPnN0YXR1c01lc3NhZ2UpOwotICAgIH0KLSAgICBndGtfc3Rh
dHVzYmFyX3B1c2goR1RLX1NUQVRVU0JBUihicm93c2VyLT5zdGF0dXNCYXIpLCAxLCBtZXNzYWdl
KTsKLSAgfQotfQotCi12b2lkCi11cGRhdGVfdGVtcF9tZXNzYWdlKFRlc3RHdGtCcm93c2VyICpi
cm93c2VyLCBjb25zdCBjaGFyICptZXNzYWdlKQotewotICBpZiAoYnJvd3Nlci0+dGVtcE1lc3Nh
Z2UpCi0gICAgZ19mcmVlKGJyb3dzZXItPnRlbXBNZXNzYWdlKTsKLSAgaWYgKG1lc3NhZ2UpCi0g
ICAgYnJvd3Nlci0+dGVtcE1lc3NhZ2UgPSBnX3N0cmR1cChtZXNzYWdlKTsKLSAgZWxzZQotICAg
IGJyb3dzZXItPnRlbXBNZXNzYWdlID0gMDsKLSAgLy8gbm93IHRoYXQgd2UndmUgdXBkYXRlZCB0
aGUgdGVtcCBtZXNzYWdlLCByZWRyYXcgdGhlIHN0YXR1cyBiYXIKLSAgdXBkYXRlX3N0YXR1c19i
YXJfdGV4dChicm93c2VyKTsKLX0KLQotCi12b2lkCi11cGRhdGVfbmF2X2J1dHRvbnMgICAgICAo
VGVzdEd0a0Jyb3dzZXIgKmJyb3dzZXIpCi17Ci0gIGdib29sZWFuIGNhbl9nb19iYWNrOwotICBn
Ym9vbGVhbiBjYW5fZ29fZm9yd2FyZDsKLSAgY2FuX2dvX2JhY2sgPSBndGtfbW96X2VtYmVkX2Nh
bl9nb19iYWNrKEdUS19NT1pfRU1CRUQoYnJvd3Nlci0+bW96RW1iZWQpKTsKLSAgY2FuX2dvX2Zv
cndhcmQgPSBndGtfbW96X2VtYmVkX2Nhbl9nb19mb3J3YXJkKEdUS19NT1pfRU1CRUQoYnJvd3Nl
ci0+bW96RW1iZWQpKTsKLSAgaWYgKGNhbl9nb19iYWNrKQotICAgIGd0a193aWRnZXRfc2V0X3Nl
bnNpdGl2ZShicm93c2VyLT5iYWNrQnV0dG9uLCBUUlVFKTsKLSAgZWxzZQotICAgIGd0a193aWRn
ZXRfc2V0X3NlbnNpdGl2ZShicm93c2VyLT5iYWNrQnV0dG9uLCBGQUxTRSk7Ci0gIGlmIChjYW5f
Z29fZm9yd2FyZCkKLSAgICBndGtfd2lkZ2V0X3NldF9zZW5zaXRpdmUoYnJvd3Nlci0+Zm9yd2Fy
ZEJ1dHRvbiwgVFJVRSk7Ci0gIGVsc2UKLSAgICBndGtfd2lkZ2V0X3NldF9zZW5zaXRpdmUoYnJv
d3Nlci0+Zm9yd2FyZEJ1dHRvbiwgRkFMU0UpOwotIH0KLQpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5n
L2Jyb3dzZXIvZ3RrL3Rlc3RzL1Rlc3RHdGtFbWJlZENoaWxkLmNwcCBiL2VtYmVkZGluZy9icm93
c2VyL2d0ay90ZXN0cy9UZXN0R3RrRW1iZWRDaGlsZC5jcHAKZGVsZXRlZCBmaWxlIG1vZGUgMTAw
NjQ0Ci0tLSBhL2VtYmVkZGluZy9icm93c2VyL2d0ay90ZXN0cy9UZXN0R3RrRW1iZWRDaGlsZC5j
cHAKKysrIC9kZXYvbnVsbApAQCAtMSwxODUgKzAsMCBAQAotLyogKioqKiogQkVHSU4gTElDRU5T
RSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4wL0xHUEwgMi4xCi0gKgot
ICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0byB0aGUgTW96aWxsYSBQ
dWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5IG5v
dCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgKLSAqIHRoZSBMaWNlbnNl
LiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLSAqIGh0dHA6Ly93d3cu
bW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBM
aWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMsCi0gKiBXSVRIT1VUIFdB
UlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExp
Y2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHJpZ2h0cyBhbmQg
bGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoKLSAqIFRoZSBPcmlnaW5hbCBD
b2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9m
IHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBDaHJpc3RvcGhlciBCbGl6emFyZC4KLSAqIFBvcnRp
b25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBDb3B5cmlnaHQgKEMpIDIw
MDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KLSAqCi0g
KiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIgQmxpenphcmQgPGJsaXp6YXJkQG1v
emlsbGEub3JnPgotICoKLSAqIEFsdGVybmF0aXZlbHksIHRoZSBjb250ZW50cyBvZiB0aGlzIGZp
bGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0gKiBlaXRoZXIgdGhlIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAodGhlICJHUEwiKSwgb3IKLSAq
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVyc2lvbiAyLjEgb3IgbGF0
ZXIgKHRoZSAiTEdQTCIpLAotICogaW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlzaW9ucyBvZiB0aGUg
R1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQKLSAqIG9mIHRob3NlIGFib3Zl
LiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmlsZSBv
bmx5Ci0gKiB1bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBHUEwgb3IgdGhlIExHUEwsIGFu
ZCBub3QgdG8gYWxsb3cgb3RoZXJzIHRvCi0gKiB1c2UgeW91ciB2ZXJzaW9uIG9mIHRoaXMgZmls
ZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUgeW91cgotICogZGVjaXNpb24g
YnkgZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJlcGxhY2UgdGhlbSB3aXRoIHRo
ZSBub3RpY2UKLSAqIGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVpcmVkIGJ5IHRoZSBHUEwgb3Ig
dGhlIExHUEwuIElmIHlvdSBkbyBub3QgZGVsZXRlCi0gKiB0aGUgcHJvdmlzaW9ucyBhYm92ZSwg
YSByZWNpcGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBmaWxlIHVuZGVyCi0gKiB0
aGUgdGVybXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BMIG9yIHRoZSBMR1BMLgotICoK
LSAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCi0KLSNpbmNsdWRlICJndGttb3pl
bWJlZC5oIgotI2luY2x1ZGUgPGd0ay9ndGsuaD4KLSNpbmNsdWRlIDxnZGsvZ2RreC5oPgotI2lu
Y2x1ZGUgPHN0ZGlvLmg+Ci0jaW5jbHVkZSA8c3RkbGliLmg+Ci0KLSNpbmNsdWRlICJuc1N0cmlu
Z0FQSS5oIgotI2luY2x1ZGUgImd0a21vemVtYmVkX2dsdWUuY3BwIgotCi1pbnQgKCpvbGRfaGFu
ZGxlcikgKERpc3BsYXkgKiwgWEVycm9yRXZlbnQgKik7Ci0KLWludCBlcnJvcl9oYW5kbGVyIChE
aXNwbGF5ICpkLCBYRXJyb3JFdmVudCAqZSkKLXsKLSAgaWYgKChlLT5lcnJvcl9jb2RlID09IEJh
ZFdpbmRvdykgfHwgKGUtPmVycm9yX2NvZGUgPT0gQmFkRHJhd2FibGUpKQotICAgIHsKLSAgICAg
IFhJRCByZXNvdXJjZWlkID0gZS0+cmVzb3VyY2VpZDsKLSAgICAgIEdka1dpbmRvdyAqd2luZG93
ID0gZ2RrX3dpbmRvd19sb29rdXAgKHJlc291cmNlaWQpOwotCi0gICAgICBpZiAod2luZG93KQot
ICAgICAgICB7Ci0gICAgICAgICAgaWYgKCFnX2RhdGFzZXRfZ2V0X2RhdGEgKHdpbmRvdywgImJv
bm9iby1lcnJvciIpKQotICAgICAgICAgICAgewotICAgICAgICAgICAgICBnX2RhdGFzZXRfc2V0
X2RhdGFfZnVsbCAod2luZG93LCAiYm9ub2JvLWVycm9yIiwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGdfbmV3IChnaW50LCAxKSwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChHRGVzdHJveU5vdGlmeSlnX2ZyZWUpOwotCi0gICAgICAgICAg
ICAgIGdfd2FybmluZyAoIkVycm9yIGFjY2Vzc2luZyB3aW5kb3cgJWxkIiwgcmVzb3VyY2VpZCk7
Ci0gICAgICAgICAgICB9Ci0gICAgICAgIH0KLSAgICAgIHJldHVybiAwOwotICAgIH0KLSAgZWxz
ZQotICAgIHsKLSAgICAgIHJldHVybiAoKm9sZF9oYW5kbGVyKShkLCBlKTsKLSAgICB9Ci19Ci0K
LXZvaWQKLWxvYWRfcGFnZShncG9pbnRlciBkYXRhKTsKLQotR3RrV2lkZ2V0ICplbWJlZCA9IDA7
Ci1HdGtXaWRnZXQgKmVudHJ5ID0gMDsKLQotaW50Ci1tYWluKGludCBhcmdjLCBjaGFyICoqYXJn
dikKLXsKLSAgZ3VpbnQzMiB4aWQ7Ci0KLSAgR3RrV2lkZ2V0ICp3aW5kb3c7Ci0gIEd0a1dpZGdl
dCAqaGJveDsKLSAgR3RrV2lkZ2V0ICp2Ym94OwotICBHdGtXaWRnZXQgKmJ1dHRvbjsKLQotICBn
dGtfaW5pdCgmYXJnYywgJmFyZ3YpOwotCi0gIHN0YXRpYyBjb25zdCBHUkVWZXJzaW9uUmFuZ2Ug
Z3JlVmVyc2lvbiA9IHsKLSAgICAiMS45YSIsIFBSX1RSVUUsCi0gICAgIjIiLCBQUl9UUlVFCi0g
IH07Ci0KLSAgY2hhciB4cGNvbVBhdGhbUEFUSF9NQVhdOwotCi0gIG5zcmVzdWx0IHJ2ID0gR1JF
X0dldEdSRVBhdGhXaXRoUHJvcGVydGllcygmZ3JlVmVyc2lvbiwgMSwgbnNudWxsLCAwLAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeHBjb21QYXRoLCBzaXpl
b2YoeHBjb21QYXRoKSk7Ci0gIGlmIChOU19GQUlMRUQocnYpKSB7Ci0gICAgZnByaW50ZihzdGRl
cnIsICJDb3VsZG4ndCBmaW5kIGEgY29tcGF0aWJsZSBHUkUuXG4iKTsKLSAgICByZXR1cm4gMTsK
LSAgfQotCi0gIHJ2ID0gWFBDT01HbHVlU3RhcnR1cCh4cGNvbVBhdGgpOwotICBpZiAoTlNfRkFJ
TEVEKHJ2KSkgewotICAgIGZwcmludGYoc3RkZXJyLCAiQ291bGRuJ3Qgc3RhcnQgWFBDT00uIik7
Ci0gICAgcmV0dXJuIDE7Ci0gIH0KLQotICBydiA9IEdUS0VtYmVkR2x1ZVN0YXJ0dXAoKTsKLSAg
aWYgKE5TX0ZBSUxFRChydikpIHsKLSAgICBmcHJpbnRmKHN0ZGVyciwgIkNvdWxkbid0IGZpbmQg
R1RLTW96RW1iZWQgc3ltYm9scy4iKTsKLSAgICByZXR1cm4gMTsKLSAgfQotCi0gIGNoYXIgKmxh
c3RTbGFzaCA9IHN0cnJjaHIoeHBjb21QYXRoLCAnLycpOwotICBpZiAobGFzdFNsYXNoKQotICAg
ICpsYXN0U2xhc2ggPSAnXDAnOwotCi0gIGd0a19tb3pfZW1iZWRfc2V0X3BhdGgoeHBjb21QYXRo
KTsKLQotICBvbGRfaGFuZGxlciA9IFhTZXRFcnJvckhhbmRsZXIgKGVycm9yX2hhbmRsZXIpOwot
Ci0gIGlmIChhcmdjIDwgMikgewotICAgIGZwcmludGYoc3RkZXJyLCAiVXNhZ2U6IFRlc3RHdGtF
bWJlZENoaWxkIFdJTkRPV19JRFxuIik7Ci0gICAgZXhpdCgxKTsKLSAgfQotCi0gIHhpZCA9IHN0
cnRvbCAoYXJndlsxXSwgKGNoYXIgKiopTlVMTCwgMCk7Ci0KLSAgaWYgKHhpZCA9PSAwKSB7Ci0g
ICAgZnByaW50ZihzdGRlcnIsICJJbnZhbGlkIHdpbmRvdyBpZCAnJXMnXG4iLCBhcmd2WzFdKTsK
LSAgICBleGl0KDEpOwotICB9Ci0KLSAgd2luZG93ID0gZ3RrX3BsdWdfbmV3KHhpZCk7Ci0KLSAg
Z19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKHdpbmRvdyksICJkZXN0cm95IiwKLSAgICAgICAg
ICAgICAgICAgICBHX0NBTExCQUNLKGd0a19tYWluX3F1aXQpLCBOVUxMKTsKLQotICBndGtfY29u
dGFpbmVyX3NldF9ib3JkZXJfd2lkdGgoR1RLX0NPTlRBSU5FUih3aW5kb3cpLCAwKTsKLQotICB2
Ym94ID0gZ3RrX3Zib3hfbmV3IChGQUxTRSwgMCk7Ci0gIGd0a19jb250YWluZXJfYWRkKEdUS19D
T05UQUlORVIod2luZG93KSwgdmJveCk7Ci0gIGd0a193aWRnZXRfc2hvdyh2Ym94KTsKLQotICBo
Ym94ID0gZ3RrX2hib3hfbmV3IChGQUxTRSwgMCk7Ci0gIGd0a19ib3hfcGFja19zdGFydChHVEtf
Qk9YKHZib3gpLCBoYm94LCBGQUxTRSwgVFJVRSwgMCk7Ci0gIGd0a193aWRnZXRfc2hvdyAoaGJv
eCk7Ci0KLSAgZW50cnkgPSBndGtfZW50cnlfbmV3ICgpOwotICBndGtfYm94X3BhY2tfc3RhcnQg
KEdUS19CT1ggKGhib3gpLCBlbnRyeSwgVFJVRSwgVFJVRSwgMCk7Ci0gIGd0a193aWRnZXRfc2hv
dyAoZW50cnkpOwotCi0gIGJ1dHRvbiA9IGd0a19idXR0b25fbmV3X3dpdGhfbGFiZWwoIkxvYWQi
KTsKLSAgZ3RrX2JveF9wYWNrX3N0YXJ0KEdUS19CT1goaGJveCksIGJ1dHRvbiwgVFJVRSwgVFJV
RSwgMCk7Ci0gIGd0a193aWRnZXRfc2hvdyhidXR0b24pOwotCi0gIGdfc2lnbmFsX2Nvbm5lY3Qo
R1RLX09CSkVDVChidXR0b24pLCAiY2xpY2tlZCIsIEdfQ0FMTEJBQ0sobG9hZF9wYWdlKSwgTlVM
TCk7Ci0KLSAgZW1iZWQgPSBndGtfbW96X2VtYmVkX25ldygpOwotICBndGtfYm94X3BhY2tfc3Rh
cnQoR1RLX0JPWCh2Ym94KSwgZW1iZWQsIFRSVUUsIFRSVUUsIDApOwotICBndGtfd2lkZ2V0X3Nl
dF9zaXplX3JlcXVlc3QoZW1iZWQsIDIwMCwgMjAwKTsKLSAgZ3RrX3dpZGdldF9zaG93KGVtYmVk
KTsKLQotICBndGtfd2lkZ2V0X3Nob3cod2luZG93KTsKLSAgCi0gIGd0a19tYWluKCk7Ci0KLSAg
ZnByaW50ZihzdGRlcnIsICJleGl0aW5nLlxuIik7Ci0KLSAgcmV0dXJuIDA7Ci19Ci0KLXZvaWQK
LWxvYWRfcGFnZShncG9pbnRlciBkYXRhKQotewotICBnY2hhciAqdGV4dCA9IGd0a19lZGl0YWJs
ZV9nZXRfY2hhcnMoR1RLX0VESVRBQkxFKGVudHJ5KSwgMCwgLTEpOwotICBnX3ByaW50KCJsb2Fk
IHVybCAlc1xuIiwgdGV4dCk7Ci0gIGd0a19tb3pfZW1iZWRfbG9hZF91cmwoR1RLX01PWl9FTUJF
RChlbWJlZCksIHRleHQpOwotICBnX2ZyZWUodGV4dCk7Ci19CmRpZmYgLS1naXQgYS9lbWJlZGRp
bmcvYnJvd3Nlci9ndGsvdGVzdHMvVGVzdEd0a0VtYmVkTURJLmNwcCBiL2VtYmVkZGluZy9icm93
c2VyL2d0ay90ZXN0cy9UZXN0R3RrRW1iZWRNREkuY3BwCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0
NAotLS0gYS9lbWJlZGRpbmcvYnJvd3Nlci9ndGsvdGVzdHMvVGVzdEd0a0VtYmVkTURJLmNwcAor
KysgL2Rldi9udWxsCkBAIC0xLDE0MiArMCwwIEBACi0vKiogc2ltcGxlbWRpLmMgKiovCi0vKgot
ICogU2FtcGxlIGNvZGUgZnJvbSAiR05PTUUvR1RLKyBQcm9ncmFtbWluZyBCaWJsZSIgYnkgQXJ0
aHVyIEdyaWZmaXRoCi0gKiBNb2RpZmllZCBieSBLZXZpbiBHaWJicyAoa2dpYmJzQHN0YW5mb3Jk
LmVkdSkgdG8gcHJvdmlkZSBzYW1wbGUgb2YKLSAqIEd0a01vekVtYmVkIHJlYWxpemF0aW9uL3Vu
cmVhbGl6YXRpb24gY3Jhc2hlcy4KLSAqCi0gKiBUbyBnZXQgYSBmYXRhbCBjcmFzaCwgc2ltcGx5
IHJ1biB0aGUgcHJvZ3JhbSwgY2xpY2sgb24gdGhlICJNb3ppbGxhIgotICogdGFiIHRvIGRpc3Bs
YXkgdGhlIE1vekVtYmVkIHdpZGdldCwgYW5kIHRoZW4gdHJ5IHRvIGRyYWcgdGhhdCBNREkgdGFi
Ci0gKiBvZmYgdG8gYSBuZXcgd2luZG93LgotICogCi0gKiBBbHRob3VnaCB0aGlzIHRlc3QgbWln
aHQgc2VlbSBlbGFib3JhdGUsIGl0IGlzIHJlYWxseSBvbmx5IGEgY29udmVuaWVudAotICogdG8g
Y3JlYXRlIGEgc2l0dWF0aW9uIHdoZXJlIHRoZSB3aWRnZXQgaXMgcmVhbGl6ZWQsIHVucmVhbGl6
ZWQsIGFuZAotICogcmVhbGl6ZWQgYWdhaW4gYXQgc29tZSBwb2ludC4gKERyYWdnaW5nIHRoZSBN
REkgdGFiIG9mZiB0byBhIG5ldyB3aW5kb3cKLSAqIGNhdXNlcyBhbGwgd2lkZ2V0cyB0byBiZSB1
bnJlYWxpemVkIGluIHRoZSBvbGQgd2luZG93LCBhbmQgdGhlbiByZWFsaXplZAotICogYWdhaW4g
aW4gdGhlIG5ldyB3aW5kb3cuKSAKLSAqLwotCi0jaW5jbHVkZSA8Z25vbWUuaD4KLSNpbmNsdWRl
ICJndGttb3plbWJlZC5oIgotCi0vLyBUZXN0aW5nIGZsYWdzCi0vLwotCi0vLyBEZWZpbmUgdGhp
cyBmbGFnIHRvIGhhdmUgdGhlIHRlc3QgcHJvZ3JhbSB1c2UgdGhlIGd0a21vemVtYmVkIHdpZGdl
dC4KLS8vIFdpdGhvdXQgdGhpcyBmbGFnLCBtb3ppbGxhIGlzIG5ldmVyIGxvYWRlZCBpbiB0aGUg
cHJvZ3JhbSwgYW5kIGEgc2ltcGxlCi0vLyB3aWRnZXQgaXMgdXNlZCBpbiBwbGFjZSBvZiB0aGUg
bW96ZW1iZWQgd2lkZ2V0LgotI2RlZmluZSBVU0VfTU9aSUxMQV9URVNUCi0KLS8vIERlZmluZSB0
aGlzIGZsYWcgdG8gaGF2ZSBhIHNpbXBsZXIgdGVzdCB0aGFuIHRoZSB1c3VhbCBvbmUuIFRoZSBu
b3JtYWwKLS8vIHRlc3QgYnVpbGRzIGEgbm90ZWJvb2sgaW5zaWRlIG9mIGVhY2ggTURJIHZpZXcs
IHdpdGggb25lIHBhZ2UgYmVpbmcgYSBsYWJlbAotLy8gYW5kIHRoZSBvdGhlciBwYWdlIGJlaW5n
IGEgYnJvd3NlciB3aWRnZXQuIFRoZSBzaW1wbGVyIHRlc3QgZG9lcyBub3QKLS8vIGJ1aWxkIGEg
bm90ZWJvb2sgYW5kIHNpbXBseSBwdXRzIHRoZSBicm93c2VyIHdpZGdldCBpbiB0aGUgTURJIHZp
ZXcgaXRzZWxmLgotLy8gQ3VycmVudGx5LCB0aGlzIHRlc3QgaXMgbm90IHZlcnkgaW50ZXJlc3Rp
bmcsIHNpbmNlIGZvciBzb21lIHJlYXNvbiBhbGwKLS8vIHRoZSB3ZWJzaGVsbHMganVzdCBjcmVh
dGUgYW5kIGRlc3Ryb3kgdGhlbXNlbHZlcy4gKD8/PykKLS8vI2RlZmluZSBTSU1QTEVSX1RFU1QK
LQotLy8gRGVmaW5lIHRoaXMgZmxhZyB0byB1c2UgYSBHbm9tZVBpeG1hcCBpbnN0ZWFkIG9mIGEg
R3RrTGFiZWwgYXMgdGhlCi0vLyByZXBsYWNlbWVudCBmb3IgdGhlIGd0a21vemVtYmVkIHdpZGdl
dCB3aGVuIFVTRV9NT1pJTExBX1RFU1QgaXMKLS8vIHVuZGVmaW5lZC4gVGhpcyBpcyB0byBzdHJl
c3MgdGVzdCB0aGUgcHJvZ3JhbSBhIGJpdCBtb3JlIGJ5IHByb3ZpZGluZyBhCi0vLyByZXBsYWNl
bWVudCB3aWRnZXQgc2xpZ2h0bHkgbW9yZSBjb21wbGV4IHRoYW4gR3RrTGFiZWwuCi0vLyAoSGFz
IG5vIGVmZmVjdCB3aGVuIFVTRV9NT1pJTExBX1RFU1QgaXMgZGVmaW5lZC4pCi0jZGVmaW5lIFNB
TVBMRV9QSVhNQVAKLQotCi1naW50IGV2ZW50RGVsZXRlKEd0a1dpZGdldCAqd2lkZ2V0LAotICAg
ICAgICBHZGtFdmVudCAqZXZlbnQsZ3BvaW50ZXIgZGF0YSk7Ci1naW50IGV2ZW50RGVzdHJveShH
dGtXaWRnZXQgKndpZGdldCwKLSAgICAgICAgR2RrRXZlbnQgKmV2ZW50LGdwb2ludGVyIGRhdGEp
OwotCi1zdGF0aWMgdm9pZCBhZGRDaGlsZChHdGtPYmplY3QgKm1kaSxnY2hhciAqbmFtZSk7Ci1z
dGF0aWMgR3RrV2lkZ2V0ICpzZXRMYWJlbChHbm9tZU1ESUNoaWxkICpjaGlsZCwKLSAgICAgICAg
R3RrV2lkZ2V0ICpjdXJyZW50TGFiZWwsZ3BvaW50ZXIgZGF0YSk7Ci1zdGF0aWMgR3RrV2lkZ2V0
ICpjcmVhdGVWaWV3KEdub21lTURJQ2hpbGQgKmNoaWxkLAotICAgICAgICBncG9pbnRlciBkYXRh
KTsKLQotaW50IG1haW4oaW50IGFyZ2MsY2hhciAqYXJndltdKQotewotICAgIEd0a09iamVjdCAq
bWRpOwotCi0gICAgZ25vbWVfaW5pdCgic2ltcGxlbWRpIiwiMS4wIixhcmdjLGFyZ3YpOwotICAg
IG1kaSA9IGdub21lX21kaV9uZXcoInNpbXBsZW1kaSIsIlNpbXBsZSBNREkiKTsKLSAgICBndGtf
c2lnbmFsX2Nvbm5lY3QobWRpLCJkZXN0cm95IiwKLSAgICAgICAgICAgIEdUS19TSUdOQUxfRlVO
QyhldmVudERlc3Ryb3kpLE5VTEwpOwotCi0gICAgYWRkQ2hpbGQobWRpLCJGaXJzdCIpOwotICAg
IGFkZENoaWxkKG1kaSwiU2Vjb25kIik7Ci0gICAgYWRkQ2hpbGQobWRpLCJUaGlyZCIpOwotICAg
IGFkZENoaWxkKG1kaSwiTGFzdCIpOwotCi0gICAgZ25vbWVfbWRpX3NldF9tb2RlKEdOT01FX01E
SShtZGkpLEdOT01FX01ESV9OT1RFQk9PSyk7Ci0gICAgLy9nbm9tZV9tZGlfb3Blbl90b3BsZXZl
bChHTk9NRV9NREkobWRpKSk7Ci0KLSAgICBndGtfbWFpbigpOwotICAgIGV4aXQoMCk7Ci19Ci1z
dGF0aWMgdm9pZCBhZGRDaGlsZChHdGtPYmplY3QgKm1kaSxnY2hhciAqbmFtZSkKLXsKLSAgICBH
bm9tZU1ESUdlbmVyaWNDaGlsZCAqY2hpbGQ7Ci0KLSAgICBjaGlsZCA9IGdub21lX21kaV9nZW5l
cmljX2NoaWxkX25ldyhuYW1lKTsKLSAgICBnbm9tZV9tZGlfYWRkX2NoaWxkKEdOT01FX01ESSht
ZGkpLAotICAgICAgICAgICAgR05PTUVfTURJX0NISUxEKGNoaWxkKSk7Ci0KLSAgICBnbm9tZV9t
ZGlfZ2VuZXJpY19jaGlsZF9zZXRfdmlld19jcmVhdG9yKGNoaWxkLAotICAgICAgICAgICAgY3Jl
YXRlVmlldyxuYW1lKTsKLSAgICBnbm9tZV9tZGlfZ2VuZXJpY19jaGlsZF9zZXRfbGFiZWxfZnVu
YyhjaGlsZCxzZXRMYWJlbCwKLSAgICAgICAgICAgIE5VTEwpOwotICAgIGdub21lX21kaV9hZGRf
dmlldyhHTk9NRV9NREkobWRpKSwKLSAgICAgICAgICAgIEdOT01FX01ESV9DSElMRChjaGlsZCkp
OwotfQotc3RhdGljIEd0a1dpZGdldCAqY3JlYXRlVmlldyhHbm9tZU1ESUNoaWxkICpjaGlsZCwK
LSAgICAgICAgZ3BvaW50ZXIgZGF0YSkKLXsKLSNpZmRlZiBVU0VfTU9aSUxMQV9URVNUCi0gICAg
R3RrV2lkZ2V0ICpicm93c2VyID0gZ3RrX21vel9lbWJlZF9uZXcoKTsKLSNlbHNlCi0jaWZuZGVm
IFNBTVBMRV9QSVhNQVAKLSAgICBHdGtXaWRnZXQgKmJyb3dzZXIgPSBndGtfbGFiZWxfbmV3KCJs
eW54IDAuMDFhIik7Ci0jZWxzZQotICAgIC8qIEFub3RoZXIgZXhhbXBsZSAtLSAqLwotICAgIEd0
a1dpZGdldCAqYnJvd3NlciA9Ci0gICAgICBnbm9tZV9waXhtYXBfbmV3X2Zyb21fZmlsZSgiL3Vz
ci9zaGFyZS9waXhtYXBzL2VtYWNzLnBuZyIpOwotI2VuZGlmIC8qIFNBTVBMRV9QSVhNQVAgKi8K
LSNlbmRpZiAvKiBVU0VfTU9aSUxMQV9URVNUICovCi0KLSAgICBHdGtXaWRnZXQgKm5vdGVib29r
ID0gZ3RrX25vdGVib29rX25ldygpOwotICAgIGNoYXIgc3RyWzgwXTsKLQotICAgIHNwcmludGYo
c3RyLCJWaWV3IG9mIHRoZVxuJXMgd2lkZ2V0IiwoZ2NoYXIgKilkYXRhKTsKLQotI2lmZGVmIFVT
RV9NT1pJTExBX1RFU1QKLSAgICBndGtfbW96X2VtYmVkX2xvYWRfdXJsKEdUS19NT1pfRU1CRUQo
YnJvd3NlciksICJodHRwOi8vd3d3Lm1vemlsbGEub3JnIik7Ci0jZW5kaWYgLyogVVNFX01PWklM
TEFfVEVTVCAqLwotCi0jaWZuZGVmIFNJTVBMRVJfVEVTVAotICAgIGd0a19ub3RlYm9va19hcHBl
bmRfcGFnZShHVEtfTk9URUJPT0sobm90ZWJvb2spLCBndGtfbGFiZWxfbmV3KHN0ciksCi0JCQkg
ICAgIGd0a19sYWJlbF9uZXcoIkxhYmVsIikpOwotICAgIGd0a19ub3RlYm9va19hcHBlbmRfcGFn
ZShHVEtfTk9URUJPT0sobm90ZWJvb2spLCBicm93c2VyLAotCQkJICAgICBndGtfbGFiZWxfbmV3
KCJNb3ppbGxhIikpOwotICAgIGd0a193aWRnZXRfc2hvd19hbGwobm90ZWJvb2spOwotICAgIHJl
dHVybiAobm90ZWJvb2spOwotI2Vsc2UKLSAgICBndGtfd2lkZ2V0X3Nob3coYnJvd3Nlcik7Ci0g
ICAgcmV0dXJuIChicm93c2VyKTsKLSNlbmRpZiAvKiBTSU1QTEVSX1RFU1QgKi8KLX0KLQotc3Rh
dGljIEd0a1dpZGdldCAqc2V0TGFiZWwoR25vbWVNRElDaGlsZCAqY2hpbGQsCi0gICAgICAgIEd0
a1dpZGdldCAqY3VycmVudExhYmVsLGdwb2ludGVyIGRhdGEpCi17Ci0gICAgaWYoY3VycmVudExh
YmVsID09IE5VTEwpCi0gICAgICAgIHJldHVybihndGtfbGFiZWxfbmV3KGNoaWxkLT5uYW1lKSk7
Ci0KLSAgICBndGtfbGFiZWxfc2V0X3RleHQoR1RLX0xBQkVMKGN1cnJlbnRMYWJlbCksCi0gICAg
ICAgICAgICBjaGlsZC0+bmFtZSk7Ci0gICAgcmV0dXJuKGN1cnJlbnRMYWJlbCk7Ci19Ci1naW50
IGV2ZW50RGVzdHJveShHdGtXaWRnZXQgKndpZGdldCwKLSAgICAgICAgR2RrRXZlbnQgKmV2ZW50
LGdwb2ludGVyIGRhdGEpIHsKLSAgICBndGtfbWFpbl9xdWl0KCk7Ci0gICAgcmV0dXJuKDApOwot
fQpkaWZmIC0tZ2l0IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Rlc3RzL1Rlc3RHdGtFbWJlZE5v
dGVib29rLmNwcCBiL2VtYmVkZGluZy9icm93c2VyL2d0ay90ZXN0cy9UZXN0R3RrRW1iZWROb3Rl
Ym9vay5jcHAKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Ci0tLSBhL2VtYmVkZGluZy9icm93c2Vy
L2d0ay90ZXN0cy9UZXN0R3RrRW1iZWROb3RlYm9vay5jcHAKKysrIC9kZXYvbnVsbApAQCAtMSw4
NiArMCwwIEBACi0jaW5jbHVkZSA8Z3RrL2d0ay5oPgotI2luY2x1ZGUgPGd0a21vemVtYmVkLmg+
Ci0jaW5jbHVkZSA8c3RkaW8uaD4KLSNpbmNsdWRlICJuc1N0cmluZ0FQSS5oIgotI2luY2x1ZGUg
Imd0a21vemVtYmVkX2dsdWUuY3BwIgotCi1pbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltd
KQotewotCUd0a1dpZGdldCAqd2luZG93OwotCUd0a1dpZGdldCAqbGFiZWw7Ci0JR3RrV2lkZ2V0
ICptb3plbWJlZDsKLQlHdGtXaWRnZXQgKmNvbnRhaW5lcjsKLQljaGFyICp1cmw7Ci0KLQlndGtf
aW5pdCgmYXJnYywgJmFyZ3YpOwotCQotICAgICAgICBzdGF0aWMgY29uc3QgR1JFVmVyc2lvblJh
bmdlIGdyZVZlcnNpb24gPSB7Ci0gICAgICAgICAgICAgICAgIjEuOWEiLCBQUl9UUlVFLAotICAg
ICAgICAgICAgICAgICIyIiwgUFJfVFJVRQotICAgICAgICB9OwotCi0gICAgICAgIGNoYXIgeHBj
b21QYXRoW1BBVEhfTUFYXTsKLQotICAgICAgICBuc3Jlc3VsdCBydiA9Ci0gICAgICAgICAgICAg
ICAgR1JFX0dldEdSRVBhdGhXaXRoUHJvcGVydGllcygmZ3JlVmVyc2lvbiwgMSwgbnNudWxsLCAw
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeHBjb21QYXRo
LCBzaXplb2YoeHBjb21QYXRoKSk7Ci0gICAgICAgIGlmIChOU19GQUlMRUQocnYpKSB7Ci0gICAg
ICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJDb3VsZG4ndCBmaW5kIGEgY29tcGF0aWJsZSBH
UkUuXG4iKTsKLSAgICAgICAgICAgICAgICByZXR1cm4gMTsKLSAgICAgICAgfQotCi0gICAgICAg
IHJ2ID0gWFBDT01HbHVlU3RhcnR1cCh4cGNvbVBhdGgpOwotICAgICAgICBpZiAoTlNfRkFJTEVE
KHJ2KSkgewotICAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiQ291bGRuJ3Qgc3RhcnQg
WFBDT00uIik7Ci0gICAgICAgICAgICAgICAgcmV0dXJuIDE7Ci0gICAgICAgIH0KLQotICAgICAg
ICBydiA9IEdUS0VtYmVkR2x1ZVN0YXJ0dXAoKTsKLSAgICAgICAgaWYgKE5TX0ZBSUxFRChydikp
IHsKLSAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkNvdWxkbid0IGZpbmQgR1RLTW96
RW1iZWQgc3ltYm9scy4iKTsKLSAgICAgICAgICAgICAgICByZXR1cm4gMTsKLSAgICAgICAgfQot
Ci0gICAgICAgIGNoYXIgKmxhc3RTbGFzaCA9IHN0cnJjaHIoeHBjb21QYXRoLCAnLycpOwotICAg
ICAgICBpZiAobGFzdFNsYXNoKQotICAgICAgICAgICAgICAgICpsYXN0U2xhc2ggPSAnXDAnOwot
Ci0gICAgICAgIGd0a19tb3pfZW1iZWRfc2V0X3BhdGgoeHBjb21QYXRoKTsKLQotCXdpbmRvdyA9
IGd0a193aW5kb3dfbmV3KEdUS19XSU5ET1dfVE9QTEVWRUwpOwotCQotCWNvbnRhaW5lciA9IGd0
a19ub3RlYm9va19uZXcoKTsKLQltb3plbWJlZCA9IGd0a19tb3pfZW1iZWRfbmV3KCk7Ci0JbGFi
ZWwgPSBndGtfbGFiZWxfbmV3KCJDYW4geW91IHNlZSB0aGlzIG1lc3NhZ2U/XG4iCi0JCQkgICAg
ICAiT25jZSB5b3Ugc3dpdGNoIHRvIG1vemVtYmVkIHBhZ2UgIiAKLQkJCSAgICAgICJ5b3UgbmV2
ZXIgc2VlIHRoaXMgbWVzc2FnZS4iKTsKLQotCWdfc2lnbmFsX2Nvbm5lY3QoR1RLX09CSkVDVCht
b3plbWJlZCksICJkZXN0cm95IiwKLQkgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soZ3RrX21h
aW5fcXVpdCksCi1OVUxMKTsKLQotCWd0a19jb250YWluZXJfYWRkKEdUS19DT05UQUlORVIod2lu
ZG93KSwgY29udGFpbmVyKTsKLQotCWd0a19ub3RlYm9va19hcHBlbmRfcGFnZShHVEtfTk9URUJP
T0soY29udGFpbmVyKSwKLQkJCWxhYmVsLAotCQkJZ3RrX2xhYmVsX25ldygiZ3RrIGxhYmVsIikp
OwotCi0JZ3RrX25vdGVib29rX2FwcGVuZF9wYWdlKEdUS19OT1RFQk9PSyhjb250YWluZXIpLAot
CQkJbW96ZW1iZWQsCi0JCQlndGtfbGFiZWxfbmV3KCJtb3plbWJlZCIpKTsKLQotCi0KLQotCWd0
a193aWRnZXRfc2V0X3NpemVfcmVxdWVzdCh3aW5kb3csIDQwMCwgMzAwKTsKLQlndGtfd2lkZ2V0
X3Nob3cobW96ZW1iZWQpOwotCWd0a193aWRnZXRfc2hvdyhsYWJlbCk7Ci0JZ3RrX3dpZGdldF9z
aG93X2FsbCh3aW5kb3cpOwotCi0JdXJsID0gKGFyZ2MgPiAxKSA/IGFyZ3ZbMV0gOiAoY2hhciAq
KSJsb2NhbGhvc3QiOwotCWd0a19tb3pfZW1iZWRfbG9hZF91cmwoR1RLX01PWl9FTUJFRChtb3pl
bWJlZCksIHVybCk7Ci0KLQlndGtfbWFpbigpOwotCQotCXJldHVybiAwOwotfQpkaWZmIC0tZ2l0
IGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Rlc3RzL1Rlc3RHdGtFbWJlZFNvY2tldC5jcHAgYi9l
bWJlZGRpbmcvYnJvd3Nlci9ndGsvdGVzdHMvVGVzdEd0a0VtYmVkU29ja2V0LmNwcApkZWxldGVk
IGZpbGUgbW9kZSAxMDA2NDQKLS0tIGEvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3Rlc3RzL1Rlc3RH
dGtFbWJlZFNvY2tldC5jcHAKKysrIC9kZXYvbnVsbApAQCAtMSwxMDkgKzAsMCBAQAotLyogKioq
KiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgotICogVmVyc2lvbjogTVBMIDEuMS9HUEwgMi4w
L0xHUEwgMi4xCi0gKgotICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0
byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCi0gKiAxLjEgKHRoZSAiTGljZW5z
ZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGgK
LSAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQK
LSAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLwotICoKLSAqIFNvZnR3YXJlIGRpc3RyaWJ1
dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMs
Ci0gKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBs
aWVkLiBTZWUgdGhlIExpY2Vuc2UKLSAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJu
aW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCi0gKiBMaWNlbnNlLgotICoKLSAq
IFRoZSBPcmlnaW5hbCBDb2RlIGlzIG1vemlsbGEub3JnIGNvZGUuCi0gKgotICogVGhlIEluaXRp
YWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCi0gKiBDaHJpc3RvcGhlciBCbGl6
emFyZC4KLSAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgdGhlIEluaXRpYWwgRGV2ZWxvcGVyIGFyZSBD
b3B5cmlnaHQgKEMpIDIwMDEKLSAqIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBS
ZXNlcnZlZC4KLSAqCi0gKiBDb250cmlidXRvcihzKToKLSAqICAgQ2hyaXN0b3BoZXIgQmxpenph
cmQgPGJsaXp6YXJkQG1vemlsbGEub3JnPgotICoKLSAqIEFsdGVybmF0aXZlbHksIHRoZSBjb250
ZW50cyBvZiB0aGlzIGZpbGUgbWF5IGJlIHVzZWQgdW5kZXIgdGhlIHRlcm1zIG9mCi0gKiBlaXRo
ZXIgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24gMiBvciBsYXRlciAodGhl
ICJHUEwiKSwgb3IKLSAqIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgVmVy
c2lvbiAyLjEgb3IgbGF0ZXIgKHRoZSAiTEdQTCIpLAotICogaW4gd2hpY2ggY2FzZSB0aGUgcHJv
dmlzaW9ucyBvZiB0aGUgR1BMIG9yIHRoZSBMR1BMIGFyZSBhcHBsaWNhYmxlIGluc3RlYWQKLSAq
IG9mIHRob3NlIGFib3ZlLiBJZiB5b3Ugd2lzaCB0byBhbGxvdyB1c2Ugb2YgeW91ciB2ZXJzaW9u
IG9mIHRoaXMgZmlsZSBvbmx5Ci0gKiB1bmRlciB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBHUEwg
b3IgdGhlIExHUEwsIGFuZCBub3QgdG8gYWxsb3cgb3RoZXJzIHRvCi0gKiB1c2UgeW91ciB2ZXJz
aW9uIG9mIHRoaXMgZmlsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIE1QTCwgaW5kaWNhdGUgeW91
cgotICogZGVjaXNpb24gYnkgZGVsZXRpbmcgdGhlIHByb3Zpc2lvbnMgYWJvdmUgYW5kIHJlcGxh
Y2UgdGhlbSB3aXRoIHRoZSBub3RpY2UKLSAqIGFuZCBvdGhlciBwcm92aXNpb25zIHJlcXVpcmVk
IGJ5IHRoZSBHUEwgb3IgdGhlIExHUEwuIElmIHlvdSBkbyBub3QgZGVsZXRlCi0gKiB0aGUgcHJv
dmlzaW9ucyBhYm92ZSwgYSByZWNpcGllbnQgbWF5IHVzZSB5b3VyIHZlcnNpb24gb2YgdGhpcyBm
aWxlIHVuZGVyCi0gKiB0aGUgdGVybXMgb2YgYW55IG9uZSBvZiB0aGUgTVBMLCB0aGUgR1BMIG9y
IHRoZSBMR1BMLgotICoKLSAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCi0KLSNp
bmNsdWRlIDxndGsvZ3RrLmg+Ci0jaW5jbHVkZSA8Z2RrL2dka3guaD4KLSNpbmNsdWRlIDxzdGRp
by5oPgotI2luY2x1ZGUgPHN0ZGxpYi5oPgotI2luY2x1ZGUgPHN5cy90eXBlcy5oPgotI2luY2x1
ZGUgPHVuaXN0ZC5oPgotCi1HdGtXaWRnZXQgKnRvcGxldmVsX3dpbmRvdyA9IDA7Ci1HdGtXaWRn
ZXQgKmJ1dHRvbiA9IDA7Ci1HdGtXaWRnZXQgKnZib3ggPSAwOwotR3RrV2lkZ2V0ICpndGtfc29j
a2V0ID0gMDsKLQotdm9pZAotaW5zZXJ0X21vemlsbGEoZ3BvaW50ZXIgZGF0YSk7Ci0KLWludAot
bWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpCi17Ci0gIGd0a19pbml0KCZhcmdjLCAmYXJndik7
Ci0KLSAgdG9wbGV2ZWxfd2luZG93ID0gZ3RrX3dpbmRvd19uZXcoR1RLX1dJTkRPV19UT1BMRVZF
TCk7Ci0KLSAgZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNUKHRvcGxldmVsX3dpbmRvdyksICJk
ZXN0cm95IiwKLSAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNLKGV4aXQpLCBOVUxMKTsKLQot
ICB2Ym94ID0gZ3RrX3Zib3hfbmV3KEZBTFNFLCAwKTsKLSAgZ3RrX2NvbnRhaW5lcl9hZGQoR1RL
X0NPTlRBSU5FUih0b3BsZXZlbF93aW5kb3cpLCB2Ym94KTsKLSAgZ3RrX3dpZGdldF9zaG93KHZi
b3gpOwotCi0gIGJ1dHRvbiA9IGd0a19idXR0b25fbmV3X3dpdGhfbGFiZWwoIkluc2VydCBNb3pp
bGxhIik7Ci0KLSAgZ3RrX2JveF9wYWNrX3N0YXJ0KEdUS19CT1godmJveCksIGJ1dHRvbiwgRkFM
U0UsIEZBTFNFLCAwKTsKLSAgZ3RrX3dpZGdldF9zaG93KGJ1dHRvbik7Ci0KLSAgZ19zaWduYWxf
Y29ubmVjdChHVEtfT0JKRUNUKGJ1dHRvbiksICJjbGlja2VkIiwKLSAgICAgICAgICAgICAgICAg
ICBHX0NBTExCQUNLKGluc2VydF9tb3ppbGxhKSwgTlVMTCk7Ci0KLSAgZ3RrX3dpZGdldF9zaG93
KHRvcGxldmVsX3dpbmRvdyk7Ci0KLSAgZ3RrX21haW4oKTsKLQotICByZXR1cm4gMDsKLX0KLQot
dm9pZAotaW5zZXJ0X21vemlsbGEoZ3BvaW50ZXIgZGF0YSkKLXsKLSAgY2hhciBidWZmZXJbMjBd
OwotICBpbnQgcGlkOwotCi0gIGlmIChndGtfc29ja2V0KQotICAgIHJldHVybjsKLQotICBndGtf
c29ja2V0ID0gZ3RrX3NvY2tldF9uZXcoKTsKLSAgZ3RrX2JveF9wYWNrX3N0YXJ0KEdUS19CT1go
dmJveCksIGd0a19zb2NrZXQsIFRSVUUsIFRSVUUsIDApOwotICBndGtfd2lkZ2V0X3Nob3coZ3Rr
X3NvY2tldCk7Ci0KLSAgc3ByaW50ZihidWZmZXIsICIlI2x4IiwgR0RLX1dJTkRPV19YV0lORE9X
KGd0a19zb2NrZXQtPndpbmRvdykpOwotCi0gIGdka19mbHVzaCgpOwotCi0gIGlmICgocGlkID0g
Zm9yaygpKSA9PSAwKSB7IC8qIGNoaWxkICovCi0gICAgZXhlY2woIi4vVGVzdEd0a0VtYmVkQ2hp
bGQiLCAiLi9UZXN0R3RrRW1iZWRDaGlsZCIsIGJ1ZmZlciwgTlVMTCk7Ci0gICAgZnByaW50Zihz
dGRlcnIsICJjYW4ndCBleGVjIGNoaWxkXG4iKTsKLSAgICBfZXhpdCgxKTsKLSAgfQotICBlbHNl
IGlmIChwaWQgPiAwKSB7IC8qIHBhcmVudCAqLwotICB9Ci0gIGVsc2UgewotICAgIGZwcmludGYo
c3RkZXJyLCAiQ2FuJ3QgZm9yay5cbiIpOwotICB9Ci19CmRpZmYgLS1naXQgYS90b29sa2l0L2xp
YnJhcnkvTWFrZWZpbGUuaW4gYi90b29sa2l0L2xpYnJhcnkvTWFrZWZpbGUuaW4KLS0tIGEvdG9v
bGtpdC9saWJyYXJ5L01ha2VmaWxlLmluCisrKyBiL3Rvb2xraXQvbGlicmFyeS9NYWtlZmlsZS5p
bgpAQCAtNzEsMjMgKzcxLDE2IEBAIGVuZGlmCiBpZmVxICgkKE9TX0FSQ0gpLFdJTkNFKQogQ1BQ
U1JDUyArPSBkbGxkZXBzLXh1bC5jcHAKIGVuZGlmCiAKIGlmZXEgKCQoT1NfQVJDSCksT1MyKQog
Q1BQU1JDUyArPSBkbGxkZXBzLXh1bC5jcHAKIGVuZGlmCiAKLSMgZGVwZW5kZW50IGxpYnJhcmll
cwotaWZuZXEgKCwkKE1PWl9FTkFCTEVfR1RLMikpCi1TSEFSRURfTElCUkFSWV9MSUJTICs9IFwK
LSAgJChERVBUSCkvZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy8kKExJQl9QUkVGSVgpZ3RrZW1i
ZWRtb3ouJChMSUJfU1VGRklYKQotREVGSU5FUyArPSAtRE1PWl9FTkFCTEVfR1RLMgotZW5kaWYK
LQogU0hBUkVEX0xJQlJBUllfTElCUyArPSBcCiAJJChERVBUSCkvdG9vbGtpdC94cmUvJChMSUJf
UFJFRklYKXh1bGFwcF9zLiQoTElCX1NVRkZJWCkgXAogCSQoTlVMTCkKIAogU0hBUkVEX0xJQlJB
UllfTElCUyArPSBcCiAJJChmb3JlYWNoIGNvbXBvbmVudCwkKENPTVBPTkVOVF9MSUJTKSwkKERF
UFRIKS9zdGF0aWNsaWIvY29tcG9uZW50cy8kKExJQl9QUkVGSVgpJChjb21wb25lbnQpLiQoTElC
X1NVRkZJWCkpIFwKIAkkKGZvcmVhY2ggbGliLCQoU1RBVElDX0xJQlMpLCQoREVQVEgpL3N0YXRp
Y2xpYi8kKExJQl9QUkVGSVgpJChsaWIpLiQoTElCX1NVRkZJWCkpIFwKIAkkKE5VTEwpCmRpZmYg
LS1naXQgYS90b29sa2l0L3Rvb2xraXQtbWFrZWZpbGVzLnNoIGIvdG9vbGtpdC90b29sa2l0LW1h
a2VmaWxlcy5zaAotLS0gYS90b29sa2l0L3Rvb2xraXQtbWFrZWZpbGVzLnNoCisrKyBiL3Rvb2xr
aXQvdG9vbGtpdC1tYWtlZmlsZXMuc2gKQEAgLTU0OCwxOSArNTQ4LDE2IEBAIE1BS0VGSUxFU19l
bWJlZGRpbmc9IgogICBlbWJlZGRpbmcvYnJvd3Nlci9NYWtlZmlsZQogICBlbWJlZGRpbmcvYnJv
d3Nlci9hY3RpdmV4L3NyYy9NYWtlZmlsZQogICBlbWJlZGRpbmcvYnJvd3Nlci9hY3RpdmV4L3Ny
Yy9jb21tb24vTWFrZWZpbGUKICAgZW1iZWRkaW5nL2Jyb3dzZXIvYWN0aXZleC9zcmMvY29udHJv
bC9NYWtlZmlsZQogICBlbWJlZGRpbmcvYnJvd3Nlci9hY3RpdmV4L3NyYy9jb250cm9sX2tpY2tl
ci9NYWtlZmlsZQogICBlbWJlZGRpbmcvYnJvd3Nlci9hY3RpdmV4L3NyYy9wbHVnaW4vTWFrZWZp
bGUKICAgZW1iZWRkaW5nL2Jyb3dzZXIvYnVpbGQvTWFrZWZpbGUKICAgZW1iZWRkaW5nL2Jyb3dz
ZXIvd2ViQnJvd3Nlci9NYWtlZmlsZQotICBlbWJlZGRpbmcvYnJvd3Nlci9ndGsvTWFrZWZpbGUK
LSAgZW1iZWRkaW5nL2Jyb3dzZXIvZ3RrL3NyYy9NYWtlZmlsZQotICBlbWJlZGRpbmcvYnJvd3Nl
ci9ndGsvdGVzdHMvTWFrZWZpbGUKICAgZW1iZWRkaW5nL2NvbXBvbmVudHMvTWFrZWZpbGUKICAg
ZW1iZWRkaW5nL2NvbXBvbmVudHMvYXBwc3RhcnR1cC9NYWtlZmlsZQogICBlbWJlZGRpbmcvY29t
cG9uZW50cy9hcHBzdGFydHVwL3NyYy9NYWtlZmlsZQogICBlbWJlZGRpbmcvY29tcG9uZW50cy9i
dWlsZC9NYWtlZmlsZQogICBlbWJlZGRpbmcvY29tcG9uZW50cy9jb21tYW5kaGFuZGxlci9NYWtl
ZmlsZQogICBlbWJlZGRpbmcvY29tcG9uZW50cy9jb21tYW5kaGFuZGxlci9wdWJsaWMvTWFrZWZp
bGUKICAgZW1iZWRkaW5nL2NvbXBvbmVudHMvY29tbWFuZGhhbmRsZXIvc3JjL01ha2VmaWxlCiAg
IGVtYmVkZGluZy9jb21wb25lbnRzL2ZpbmQvTWFrZWZpbGUKZGlmZiAtLWdpdCBhL3Rvb2xraXQv
dG9vbGtpdC10aWVycy5tayBiL3Rvb2xraXQvdG9vbGtpdC10aWVycy5tawotLS0gYS90b29sa2l0
L3Rvb2xraXQtdGllcnMubWsKKysrIGIvdG9vbGtpdC90b29sa2l0LXRpZXJzLm1rCkBAIC0yMzYs
MjIgKzIzNiwxNiBAQCBlbmRpZgogCiB0aWVyX3BsYXRmb3JtX2RpcnMgKz0gc2VydmljZXMvY3J5
cHRvL2NvbXBvbmVudAogCiAjIEphdmFYUENPTSBKTkkgY29kZSBpcyBjb21waWxlZCBpbnRvIGxp
YlhVTAogaWZkZWYgTU9aX0pBVkFYUENPTQogdGllcl9wbGF0Zm9ybV9kaXJzICs9IGV4dGVuc2lv
bnMvamF2YS94cGNvbS9zcmMKIGVuZGlmCiAKLWlmbmRlZiBCVUlMRF9TVEFUSUNfTElCUwotaWZu
ZXEgKCwkKE1PWl9FTkFCTEVfR1RLMikpCi10aWVyX3BsYXRmb3JtX2RpcnMgKz0gZW1iZWRkaW5n
L2Jyb3dzZXIvZ3RrCi1lbmRpZgotZW5kaWYKLQogaWZkZWYgTU9aX0VOQUJMRV9MSUJYVUwKIHRp
ZXJfcGxhdGZvcm1fZGlycyArPSBzdGFydHVwY2FjaGUKIGVuZGlmCiAKIGlmbmRlZiBCVUlMRF9T
VEFUSUNfTElCUwogaWZkZWYgQVBQX0xJQlhVTF9TVEFUSUNESVJTCiAjIEFwcGxpY2F0aW9ucyBj
YW4gY2hlYXQgYW5kIGFzayBmb3IgY29kZSB0byBiZQogIyBidWlsdCBiZWZvcmUgbGlieHVsIHNv
IGxpYnh1bCBjYW4gYmUgbGlua2VkIGFnYWluc3QgaXQuCg==
</data>
<flag name="review"
          id="437979"
          type_id="4"
          status="+"
          setter="bzbarsky"
    />
          </attachment>
      

    </bug>

</bugzilla>